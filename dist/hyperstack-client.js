/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/array/extract_options"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $truthy = Opal.truthy, $hash2 = Opal.hash2;

  Opal.add_stubs(['$instance_of?', '$is_a?', '$last', '$extractable_options?', '$pop']);
  
  (function($base, $super, $parent_nesting) {
    function $Hash(){};
    var self = $Hash = $klass($base, $super, 'Hash', $Hash);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Hash_extractable_options$q_1;

    return (Opal.defn(self, '$extractable_options?', TMP_Hash_extractable_options$q_1 = function() {
      var self = this;

      return self['$instance_of?'](Opal.const_get_relative($nesting, 'Hash'))
    }, TMP_Hash_extractable_options$q_1.$$arity = 0), nil) && 'extractable_options?'
  })($nesting[0], null, $nesting);
  return (function($base, $super, $parent_nesting) {
    function $Array(){};
    var self = $Array = $klass($base, $super, 'Array', $Array);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Array_extract_options$B_2;

    return (Opal.defn(self, '$extract_options!', TMP_Array_extract_options$B_2 = function() {
      var $a, self = this;

      if ($truthy(($truthy($a = self.$last()['$is_a?'](Opal.const_get_relative($nesting, 'Hash'))) ? self.$last()['$extractable_options?']() : $a))) {
        return self.$pop()
        } else {
        return $hash2([], {})
      }
    }, TMP_Array_extract_options$B_2.$$arity = 0), nil) && 'extract_options!'
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/array/wrap"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $truthy = Opal.truthy;

  Opal.add_stubs(['$nil?', '$respond_to?', '$to_ary']);
  return (function($base, $super, $parent_nesting) {
    function $Array(){};
    var self = $Array = $klass($base, $super, 'Array', $Array);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Array_wrap_1;

    return Opal.defs(self, '$wrap', TMP_Array_wrap_1 = function $$wrap(object) {
      var $a, self = this;

      if ($truthy(object['$nil?']())) {
        return []
      } else if ($truthy(object['$respond_to?']("to_ary"))) {
        return ($truthy($a = object.$to_ary()) ? $a : [object])
        } else {
        return [object]
      }
    }, TMP_Array_wrap_1.$$arity = 1)
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/array/grouping"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_times(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);
  }
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $send = Opal.send, $truthy = Opal.truthy;

  Opal.add_stubs(['$==', '$%', '$-', '$size', '$concat', '$dup', '$*', '$each_slice', '$<<', '$div', '$times', '$+', '$>', '$slice', '$!=', '$each', '$inject', '$call', '$last']);
  return (function($base, $super, $parent_nesting) {
    function $Array(){};
    var self = $Array = $klass($base, $super, 'Array', $Array);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Array_in_groups_of_1, TMP_Array_in_groups_5, TMP_Array_split_7;

    
    
    Opal.defn(self, '$in_groups_of', TMP_Array_in_groups_of_1 = function $$in_groups_of(number, fill_with) {
      var TMP_2, TMP_3, self = this, $iter = TMP_Array_in_groups_of_1.$$p, $yield = $iter || nil, collection = nil, padding = nil, groups = nil;

      if (fill_with == null) {
        fill_with = nil;
      }
      if ($iter) TMP_Array_in_groups_of_1.$$p = null;
      
      if (fill_with['$=='](false)) {
        collection = self
        } else {
        
        padding = $rb_minus(number, self.$size()['$%'](number))['$%'](number);
        collection = self.$dup().$concat($rb_times([fill_with], padding));
      };
      if (($yield !== nil)) {
        return $send(collection, 'each_slice', [number], (TMP_2 = function(slice){var self = TMP_2.$$s || this;
if (slice == null) slice = nil;
        return Opal.yield1($yield, slice);}, TMP_2.$$s = self, TMP_2.$$arity = 1, TMP_2))
        } else {
        
        groups = [];
        $send(collection, 'each_slice', [number], (TMP_3 = function(group){var self = TMP_3.$$s || this;
if (group == null) group = nil;
        return groups['$<<'](group)}, TMP_3.$$s = self, TMP_3.$$arity = 1, TMP_3));
        return groups;
      };
    }, TMP_Array_in_groups_of_1.$$arity = -2);
    
    Opal.defn(self, '$in_groups', TMP_Array_in_groups_5 = function $$in_groups(number, fill_with) {
      var TMP_4, TMP_6, self = this, $iter = TMP_Array_in_groups_5.$$p, $yield = $iter || nil, division = nil, modulo = nil, groups = nil, start = nil;

      if (fill_with == null) {
        fill_with = nil;
      }
      if ($iter) TMP_Array_in_groups_5.$$p = null;
      
      division = self.$size().$div(number);
      modulo = self.$size()['$%'](number);
      groups = [];
      start = 0;
      $send(number, 'times', [], (TMP_4 = function(index){var self = TMP_4.$$s || this, $a, $b, length = nil, last_group = nil;
if (index == null) index = nil;
      
        length = $rb_plus(division, (function() {if ($truthy(($truthy($a = $rb_gt(modulo, 0)) ? $rb_gt(modulo, index) : $a))) {
          return 1
          } else {
          return 0
        }; return nil; })());
        groups['$<<']((last_group = self.$slice(start, length)));
        if ($truthy(($truthy($a = ($truthy($b = fill_with['$!='](false)) ? $rb_gt(modulo, 0) : $b)) ? length['$=='](division) : $a))) {
          last_group['$<<'](fill_with)};
        return (start = $rb_plus(start, length));}, TMP_4.$$s = self, TMP_4.$$arity = 1, TMP_4));
      if (($yield !== nil)) {
        return $send(groups, 'each', [], (TMP_6 = function(g){var self = TMP_6.$$s || this;
if (g == null) g = nil;
        return Opal.yield1($yield, g);}, TMP_6.$$s = self, TMP_6.$$arity = 1, TMP_6))
        } else {
        return groups
      };
    }, TMP_Array_in_groups_5.$$arity = -2);
    return (Opal.defn(self, '$split', TMP_Array_split_7 = function $$split(value) {
      var TMP_8, self = this, $iter = TMP_Array_split_7.$$p, block = $iter || nil;

      if (value == null) {
        value = nil;
      }
      if ($iter) TMP_Array_split_7.$$p = null;
      return $send(self, 'inject', [[[]]], (TMP_8 = function(results, element){var self = TMP_8.$$s || this, $a, $b;
if (results == null) results = nil;if (element == null) element = nil;
      
        if ($truthy(($truthy($a = ($truthy($b = block) ? block.$call(element) : $b)) ? $a : value['$=='](element)))) {
          results['$<<']([])
          } else {
          results.$last()['$<<'](element)
        };
        return results;}, TMP_8.$$s = self, TMP_8.$$arity = 2, TMP_8))
    }, TMP_Array_split_7.$$arity = -1), nil) && 'split';
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/array"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  
  self.$require("active_support/core_ext/array/extract_options");
  self.$require("active_support/core_ext/array/wrap");
  return self.$require("active_support/core_ext/array/grouping");
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/kernel/singleton_class"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send;

  Opal.add_stubs(['$class_eval', '$singleton_class', '$to_proc']);
  return (function($base, $parent_nesting) {
    var $Kernel, self = $Kernel = $module($base, 'Kernel');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Kernel_class_eval_1;

    
    Opal.defn(self, '$class_eval', TMP_Kernel_class_eval_1 = function $$class_eval($a_rest) {
      var self = this, args, $iter = TMP_Kernel_class_eval_1.$$p, block = $iter || nil;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      if ($iter) TMP_Kernel_class_eval_1.$$p = null;
      return $send(self.$singleton_class(), 'class_eval', Opal.to_a(args), block.$to_proc())
    }, TMP_Kernel_class_eval_1.$$arity = -1)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/module/remove_method"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$method_defined?', '$private_method_defined?', '$undef_method', '$remove_possible_method', '$define_method', '$to_proc']);
  return (function($base, $super, $parent_nesting) {
    function $Module(){};
    var self = $Module = $klass($base, $super, 'Module', $Module);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Module_remove_possible_method_1, TMP_Module_redefine_method_2;

    
    
    Opal.defn(self, '$remove_possible_method', TMP_Module_remove_possible_method_1 = function $$remove_possible_method(method) {
      var $a, self = this;

      if ($truthy(($truthy($a = self['$method_defined?'](method)) ? $a : self['$private_method_defined?'](method)))) {
        return self.$undef_method(method)
        } else {
        return nil
      }
    }, TMP_Module_remove_possible_method_1.$$arity = 1);
    return (Opal.defn(self, '$redefine_method', TMP_Module_redefine_method_2 = function $$redefine_method(method) {
      var self = this, $iter = TMP_Module_redefine_method_2.$$p, block = $iter || nil;

      if ($iter) TMP_Module_redefine_method_2.$$p = null;
      
      self.$remove_possible_method(method);
      return $send(self, 'define_method', [method], block.$to_proc());
    }, TMP_Module_redefine_method_2.$$arity = 1), nil) && 'redefine_method';
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/class/attribute"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$require', '$extract_options!', '$fetch', '$each', '$define_singleton_method', '$!', '$public_send', '$class_eval', '$singleton_class', '$remove_possible_method', '$define_method', '$singleton_class?', '$instance_variable_defined?', '$instance_variable_get', '$send', '$class', '$attr_writer', '$private', '$respond_to?', '$!=', '$first', '$ancestors']);
  
  self.$require("active_support/core_ext/kernel/singleton_class");
  self.$require("active_support/core_ext/module/remove_method");
  self.$require("active_support/core_ext/array/extract_options");
  return (function($base, $super, $parent_nesting) {
    function $Class(){};
    var self = $Class = $klass($base, $super, 'Class', $Class);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Class_class_attribute_11, TMP_Class_singleton_class$q_12;

    
    
    Opal.defn(self, '$class_attribute', TMP_Class_class_attribute_11 = function $$class_attribute($a_rest) {
      var $b, TMP_1, self = this, attrs, options = nil, instance_reader = nil, instance_writer = nil, instance_predicate = nil;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      attrs = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        attrs[$arg_idx - 0] = arguments[$arg_idx];
      }
      
      options = attrs['$extract_options!']();
      instance_reader = ($truthy($b = options.$fetch("instance_accessor", true)) ? options.$fetch("instance_reader", true) : $b);
      instance_writer = ($truthy($b = options.$fetch("instance_accessor", true)) ? options.$fetch("instance_writer", true) : $b);
      instance_predicate = options.$fetch("instance_predicate", true);
      return $send(attrs, 'each', [], (TMP_1 = function(name){var self = TMP_1.$$s || this, TMP_2, TMP_3, TMP_4, TMP_9, TMP_10, ivar = nil;
if (name == null) name = nil;
      
        $send(self, 'define_singleton_method', [name], (TMP_2 = function(){var self = TMP_2.$$s || this;

        return nil}, TMP_2.$$s = self, TMP_2.$$arity = 0, TMP_2));
        if ($truthy(instance_predicate)) {
          $send(self, 'define_singleton_method', ["" + (name) + "?"], (TMP_3 = function(){var self = TMP_3.$$s || this;

          return self.$public_send(name)['$!']()['$!']()}, TMP_3.$$s = self, TMP_3.$$arity = 0, TMP_3))};
        ivar = "" + "@" + (name);
        $send(self, 'define_singleton_method', ["" + (name) + "="], (TMP_4 = function(val){var self = TMP_4.$$s || this, TMP_5, TMP_7;
if (val == null) val = nil;
        
          $send(self.$singleton_class(), 'class_eval', [], (TMP_5 = function(){var self = TMP_5.$$s || this, TMP_6;

          
            self.$remove_possible_method(name);
            return $send(self, 'define_method', [name], (TMP_6 = function(){var self = TMP_6.$$s || this;

            return val}, TMP_6.$$s = self, TMP_6.$$arity = 0, TMP_6));}, TMP_5.$$s = self, TMP_5.$$arity = 0, TMP_5));
          if ($truthy(self['$singleton_class?']())) {
            $send(self, 'class_eval', [], (TMP_7 = function(){var self = TMP_7.$$s || this, TMP_8;

            
              self.$remove_possible_method(name);
              return $send(self, 'define_method', [name], (TMP_8 = function(){var self = TMP_8.$$s || this;

              if ($truthy(self['$instance_variable_defined?'](ivar))) {
                  return self.$instance_variable_get(ivar)
                  } else {
                  return self.$singleton_class().$send(name)
                }}, TMP_8.$$s = self, TMP_8.$$arity = 0, TMP_8));}, TMP_7.$$s = self, TMP_7.$$arity = 0, TMP_7))};
          return val;}, TMP_4.$$s = self, TMP_4.$$arity = 1, TMP_4));
        if ($truthy(instance_reader)) {
          
          self.$remove_possible_method(name);
          $send(self, 'define_method', [name], (TMP_9 = function(){var self = TMP_9.$$s || this;

          if ($truthy(self['$instance_variable_defined?'](ivar))) {
              return self.$instance_variable_get(ivar)
              } else {
              return self.$class().$public_send(name)
            }}, TMP_9.$$s = self, TMP_9.$$arity = 0, TMP_9));
          if ($truthy(instance_predicate)) {
            $send(self, 'define_method', ["" + (name) + "?"], (TMP_10 = function(){var self = TMP_10.$$s || this;

            return self.$public_send(name)['$!']()['$!']()}, TMP_10.$$s = self, TMP_10.$$arity = 0, TMP_10))};};
        if ($truthy(instance_writer)) {
          return self.$attr_writer(name)
          } else {
          return nil
        };}, TMP_1.$$s = self, TMP_1.$$arity = 1, TMP_1));
    }, TMP_Class_class_attribute_11.$$arity = -1);
    self.$private();
    if ($truthy(self['$respond_to?']("singleton_class?"))) {
      return nil
      } else {
      return (Opal.defn(self, '$singleton_class?', TMP_Class_singleton_class$q_12 = function() {
        var $a, self = this;

        return ($truthy($a = true) ? $a : self.$ancestors().$first()['$!='](self))
      }, TMP_Class_singleton_class$q_12.$$arity = 0), nil) && 'singleton_class?'
    };
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/class"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  return self.$require("active_support/core_ext/class/attribute")
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/enumerable"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send;

  Opal.add_stubs(['$enum_for', '$new', '$destructure', '$[]=', '$-']);
  return (function($base, $parent_nesting) {
    var $Enumerable, self = $Enumerable = $module($base, 'Enumerable');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Enumerable_index_by_1;

    
    Opal.defn(self, '$index_by', TMP_Enumerable_index_by_1 = function $$index_by() {
      var self = this, $iter = TMP_Enumerable_index_by_1.$$p, block = $iter || nil, hash = nil, $writer = nil;

      if ($iter) TMP_Enumerable_index_by_1.$$p = null;
      
      if ((block !== nil)) {
        } else {
        return self.$enum_for("index_by")
      };
      hash = Opal.const_get_relative($nesting, 'Hash').$new();
      
      var result;

      self.$each._p = function() {
        var param = Opal.const_get_relative($nesting, 'Opal').$destructure(arguments),
            value = $opal.$yield1(block, param);

        if (value === $breaker) {
          result = $breaker.$v;
          return $breaker;
        }

        (($writer = [value, param]), $send(hash, '[]=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]);
      }

      self.$each();

      if (result !== undefined) {
        return result;
      }
    ;
      return hash;
    }, TMP_Enumerable_index_by_1.$$arity = 0)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/hash_with_indifferent_access"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$dup', '$respond_to?', '$update', '$to_hash', '$tap', '$new', '$default', '$default=', '$-', '$default_proc', '$default_proc=']);
  return (function($base, $parent_nesting) {
    var $ActiveSupport, self = $ActiveSupport = $module($base, 'ActiveSupport');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $HashWithIndifferentAccess(){};
      var self = $HashWithIndifferentAccess = $klass($base, $super, 'HashWithIndifferentAccess', $HashWithIndifferentAccess);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_HashWithIndifferentAccess_extractable_options$q_1, TMP_HashWithIndifferentAccess_with_indifferent_access_2, TMP_HashWithIndifferentAccess_nested_under_indifferent_access_3, TMP_HashWithIndifferentAccess_initialize_4, TMP_HashWithIndifferentAccess_new_from_hash_copying_default_6;

      
      
      Opal.defn(self, '$extractable_options?', TMP_HashWithIndifferentAccess_extractable_options$q_1 = function() {
        var self = this;

        return true
      }, TMP_HashWithIndifferentAccess_extractable_options$q_1.$$arity = 0);
      
      Opal.defn(self, '$with_indifferent_access', TMP_HashWithIndifferentAccess_with_indifferent_access_2 = function $$with_indifferent_access() {
        var self = this;

        return self.$dup()
      }, TMP_HashWithIndifferentAccess_with_indifferent_access_2.$$arity = 0);
      
      Opal.defn(self, '$nested_under_indifferent_access', TMP_HashWithIndifferentAccess_nested_under_indifferent_access_3 = function $$nested_under_indifferent_access() {
        var self = this;

        return self
      }, TMP_HashWithIndifferentAccess_nested_under_indifferent_access_3.$$arity = 0);
      
      Opal.defn(self, '$initialize', TMP_HashWithIndifferentAccess_initialize_4 = function $$initialize(constructor) {
        var self = this, $iter = TMP_HashWithIndifferentAccess_initialize_4.$$p, $yield = $iter || nil;

        if (constructor == null) {
          constructor = $hash2([], {});
        }
        if ($iter) TMP_HashWithIndifferentAccess_initialize_4.$$p = null;
        if ($truthy(constructor['$respond_to?']("to_hash"))) {
          
          $send(self, Opal.find_super_dispatcher(self, 'initialize', TMP_HashWithIndifferentAccess_initialize_4, false), [], null);
          return self.$update(constructor);
          } else {
          return $send(self, Opal.find_super_dispatcher(self, 'initialize', TMP_HashWithIndifferentAccess_initialize_4, false), [constructor], null)
        }
      }, TMP_HashWithIndifferentAccess_initialize_4.$$arity = -1);
      return Opal.defs(self, '$new_from_hash_copying_default', TMP_HashWithIndifferentAccess_new_from_hash_copying_default_6 = function $$new_from_hash_copying_default(hash) {
        var TMP_5, self = this;

        
        hash = hash.$to_hash();
        return $send(self.$new(hash), 'tap', [], (TMP_5 = function(new_hash){var self = TMP_5.$$s || this, $writer = nil;
if (new_hash == null) new_hash = nil;
        
          
          $writer = [hash.$default()];
          $send(new_hash, 'default=', Opal.to_a($writer));
          $writer[$rb_minus($writer["length"], 1)];;
          if ($truthy(hash.$default_proc())) {
            
            $writer = [hash.$default_proc()];
            $send(new_hash, 'default_proc=', Opal.to_a($writer));
            return $writer[$rb_minus($writer["length"], 1)];
            } else {
            return nil
          };}, TMP_5.$$s = self, TMP_5.$$arity = 1, TMP_5));
      }, TMP_HashWithIndifferentAccess_new_from_hash_copying_default_6.$$arity = 1);
    })($nesting[0], Opal.const_get_relative($nesting, 'Hash'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/hash/indifferent_access"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  Opal.add_stubs(['$require', '$new_from_hash_copying_default']);
  
  self.$require("active_support/hash_with_indifferent_access");
  return (function($base, $super, $parent_nesting) {
    function $Hash(){};
    var self = $Hash = $klass($base, $super, 'Hash', $Hash);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Hash_with_indifferent_access_1;

    
    
    Opal.defn(self, '$with_indifferent_access', TMP_Hash_with_indifferent_access_1 = function $$with_indifferent_access() {
      var self = this;

      return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'ActiveSupport'), 'HashWithIndifferentAccess').$new_from_hash_copying_default(self)
    }, TMP_Hash_with_indifferent_access_1.$$arity = 0);
    return Opal.alias(self, "nested_under_indifferent_access", "with_indifferent_access");
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/hash"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  return self.$require("active_support/core_ext/hash/indifferent_access")
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/numeric/time"] = function(Opal) {
  function $rb_times(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  Opal.add_stubs(['$*', '$hours', '$days', '$weeks', '$-', '$current', '$+']);
  return (function($base, $super, $parent_nesting) {
    function $Numeric(){};
    var self = $Numeric = $klass($base, $super, 'Numeric', $Numeric);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Numeric_seconds_1, TMP_Numeric_minutes_2, TMP_Numeric_hours_3, TMP_Numeric_days_4, TMP_Numeric_weeks_5, TMP_Numeric_fortnights_6, TMP_Numeric_ago_7, TMP_Numeric_since_8;

    
    
    Opal.defn(self, '$seconds', TMP_Numeric_seconds_1 = function $$seconds() {
      var self = this;

      return self
    }, TMP_Numeric_seconds_1.$$arity = 0);
    Opal.alias(self, "second", "seconds");
    
    Opal.defn(self, '$minutes', TMP_Numeric_minutes_2 = function $$minutes() {
      var self = this;

      return $rb_times(self, 60)
    }, TMP_Numeric_minutes_2.$$arity = 0);
    Opal.alias(self, "minute", "minutes");
    
    Opal.defn(self, '$hours', TMP_Numeric_hours_3 = function $$hours() {
      var self = this;

      return $rb_times(self, 3600)
    }, TMP_Numeric_hours_3.$$arity = 0);
    Opal.alias(self, "hour", "hours");
    
    Opal.defn(self, '$days', TMP_Numeric_days_4 = function $$days() {
      var self = this;

      return $rb_times(self, (24).$hours())
    }, TMP_Numeric_days_4.$$arity = 0);
    Opal.alias(self, "day", "days");
    
    Opal.defn(self, '$weeks', TMP_Numeric_weeks_5 = function $$weeks() {
      var self = this;

      return $rb_times(self, (7).$days())
    }, TMP_Numeric_weeks_5.$$arity = 0);
    Opal.alias(self, "week", "weeks");
    
    Opal.defn(self, '$fortnights', TMP_Numeric_fortnights_6 = function $$fortnights() {
      var self = this;

      return $rb_times(self, (2).$weeks())
    }, TMP_Numeric_fortnights_6.$$arity = 0);
    Opal.alias(self, "fortnight", "fortnights");
    
    Opal.defn(self, '$ago', TMP_Numeric_ago_7 = function $$ago(time) {
      var self = this;

      if (time == null) {
        time = Opal.const_get_qualified('::', 'Time').$current();
      }
      return $rb_minus(time, self)
    }, TMP_Numeric_ago_7.$$arity = -1);
    Opal.alias(self, "until", "ago");
    
    Opal.defn(self, '$since', TMP_Numeric_since_8 = function $$since(time) {
      var self = this;

      if (time == null) {
        time = Opal.const_get_qualified('::', 'Time').$current();
      }
      return $rb_plus(time, self)
    }, TMP_Numeric_since_8.$$arity = -1);
    return Opal.alias(self, "from_now", "since");
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/integer/time"] = function(Opal) {
  function $rb_times(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  Opal.add_stubs(['$require', '$*', '$days']);
  
  self.$require("active_support/core_ext/numeric/time");
  return (function($base, $super, $parent_nesting) {
    function $Numeric(){};
    var self = $Numeric = $klass($base, $super, 'Numeric', $Numeric);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Numeric_months_1, TMP_Numeric_years_2;

    
    
    Opal.defn(self, '$months', TMP_Numeric_months_1 = function $$months() {
      var self = this;

      return $rb_times(self, (30).$days())
    }, TMP_Numeric_months_1.$$arity = 0);
    Opal.alias(self, "month", "months");
    
    Opal.defn(self, '$years', TMP_Numeric_years_2 = function $$years() {
      var self = this;

      return $rb_times(self, (365.25).$days())
    }, TMP_Numeric_years_2.$$arity = 0);
    return Opal.alias(self, "year", "years");
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/integer"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  return self.$require("active_support/core_ext/integer/time")
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/kernel"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  return self.$require("active_support/core_ext/kernel/singleton_class")
};

/* Generated by Opal 0.11.4 */
Opal.modules["set"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  function $rb_le(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $module = Opal.module;

  Opal.add_stubs(['$include', '$new', '$nil?', '$===', '$raise', '$each', '$add', '$call', '$merge', '$class', '$respond_to?', '$subtract', '$dup', '$join', '$to_a', '$equal?', '$instance_of?', '$==', '$instance_variable_get', '$is_a?', '$size', '$all?', '$include?', '$[]=', '$-', '$enum_for', '$[]', '$<<', '$replace', '$delete', '$select', '$each_key', '$to_proc', '$empty?', '$eql?', '$instance_eval', '$clear', '$<', '$<=', '$keys']);
  
  (function($base, $super, $parent_nesting) {
    function $Set(){};
    var self = $Set = $klass($base, $super, 'Set', $Set);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Set_$$_1, TMP_Set_initialize_2, TMP_Set_dup_4, TMP_Set_$_5, TMP_Set_inspect_6, TMP_Set_$eq$eq_8, TMP_Set_add_9, TMP_Set_classify_10, TMP_Set_collect$B_13, TMP_Set_delete_15, TMP_Set_delete$q_16, TMP_Set_delete_if_17, TMP_Set_add$q_20, TMP_Set_each_21, TMP_Set_empty$q_22, TMP_Set_eql$q_24, TMP_Set_clear_25, TMP_Set_include$q_26, TMP_Set_merge_28, TMP_Set_replace_29, TMP_Set_size_30, TMP_Set_subtract_32, TMP_Set_$_33, TMP_Set_superset$q_35, TMP_Set_proper_superset$q_37, TMP_Set_subset$q_39, TMP_Set_proper_subset$q_41, TMP_Set_to_a_42;

    def.hash = nil;
    
    self.$include(Opal.const_get_relative($nesting, 'Enumerable'));
    Opal.defs(self, '$[]', TMP_Set_$$_1 = function($a_rest) {
      var self = this, ary;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      ary = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        ary[$arg_idx - 0] = arguments[$arg_idx];
      }
      return self.$new(ary)
    }, TMP_Set_$$_1.$$arity = -1);
    
    Opal.defn(self, '$initialize', TMP_Set_initialize_2 = function $$initialize(enum$) {
      var TMP_3, self = this, $iter = TMP_Set_initialize_2.$$p, block = $iter || nil;

      if (enum$ == null) {
        enum$ = nil;
      }
      if ($iter) TMP_Set_initialize_2.$$p = null;
      
      self.hash = Opal.const_get_relative($nesting, 'Hash').$new();
      if ($truthy(enum$['$nil?']())) {
        return nil};
      if ($truthy(Opal.const_get_relative($nesting, 'Enumerable')['$==='](enum$))) {
        } else {
        self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "value must be enumerable")
      };
      if ($truthy(block)) {
        return $send(enum$, 'each', [], (TMP_3 = function(item){var self = TMP_3.$$s || this;
if (item == null) item = nil;
        return self.$add(block.$call(item))}, TMP_3.$$s = self, TMP_3.$$arity = 1, TMP_3))
        } else {
        return self.$merge(enum$)
      };
    }, TMP_Set_initialize_2.$$arity = -1);
    
    Opal.defn(self, '$dup', TMP_Set_dup_4 = function $$dup() {
      var self = this, result = nil;

      
      result = self.$class().$new();
      return result.$merge(self);
    }, TMP_Set_dup_4.$$arity = 0);
    
    Opal.defn(self, '$-', TMP_Set_$_5 = function(enum$) {
      var self = this;

      
      if ($truthy(enum$['$respond_to?']("each"))) {
        } else {
        self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "value must be enumerable")
      };
      return self.$dup().$subtract(enum$);
    }, TMP_Set_$_5.$$arity = 1);
    Opal.alias(self, "difference", "-");
    
    Opal.defn(self, '$inspect', TMP_Set_inspect_6 = function $$inspect() {
      var self = this;

      return "" + "#<Set: {" + (self.$to_a().$join(",")) + "}>"
    }, TMP_Set_inspect_6.$$arity = 0);
    
    Opal.defn(self, '$==', TMP_Set_$eq$eq_8 = function(other) {
      var $a, TMP_7, self = this;

      if ($truthy(self['$equal?'](other))) {
        return true
      } else if ($truthy(other['$instance_of?'](self.$class()))) {
        return self.hash['$=='](other.$instance_variable_get("@hash"))
      } else if ($truthy(($truthy($a = other['$is_a?'](Opal.const_get_relative($nesting, 'Set'))) ? self.$size()['$=='](other.$size()) : $a))) {
        return $send(other, 'all?', [], (TMP_7 = function(o){var self = TMP_7.$$s || this;
          if (self.hash == null) self.hash = nil;
if (o == null) o = nil;
        return self.hash['$include?'](o)}, TMP_7.$$s = self, TMP_7.$$arity = 1, TMP_7))
        } else {
        return false
      }
    }, TMP_Set_$eq$eq_8.$$arity = 1);
    
    Opal.defn(self, '$add', TMP_Set_add_9 = function $$add(o) {
      var self = this, $writer = nil;

      
      
      $writer = [o, true];
      $send(self.hash, '[]=', Opal.to_a($writer));
      $writer[$rb_minus($writer["length"], 1)];;
      return self;
    }, TMP_Set_add_9.$$arity = 1);
    Opal.alias(self, "<<", "add");
    
    Opal.defn(self, '$classify', TMP_Set_classify_10 = function $$classify() {
      var TMP_11, TMP_12, self = this, $iter = TMP_Set_classify_10.$$p, block = $iter || nil, result = nil;

      if ($iter) TMP_Set_classify_10.$$p = null;
      
      if ((block !== nil)) {
        } else {
        return self.$enum_for("classify")
      };
      result = $send(Opal.const_get_relative($nesting, 'Hash'), 'new', [], (TMP_11 = function(h, k){var self = TMP_11.$$s || this, $writer = nil;
if (h == null) h = nil;if (k == null) k = nil;
      
        $writer = [k, self.$class().$new()];
        $send(h, '[]=', Opal.to_a($writer));
        return $writer[$rb_minus($writer["length"], 1)];}, TMP_11.$$s = self, TMP_11.$$arity = 2, TMP_11));
      $send(self, 'each', [], (TMP_12 = function(item){var self = TMP_12.$$s || this;
if (item == null) item = nil;
      return result['$[]'](Opal.yield1(block, item)).$add(item)}, TMP_12.$$s = self, TMP_12.$$arity = 1, TMP_12));
      return result;
    }, TMP_Set_classify_10.$$arity = 0);
    
    Opal.defn(self, '$collect!', TMP_Set_collect$B_13 = function() {
      var TMP_14, self = this, $iter = TMP_Set_collect$B_13.$$p, block = $iter || nil, result = nil;

      if ($iter) TMP_Set_collect$B_13.$$p = null;
      
      if ((block !== nil)) {
        } else {
        return self.$enum_for("collect!")
      };
      result = self.$class().$new();
      $send(self, 'each', [], (TMP_14 = function(item){var self = TMP_14.$$s || this;
if (item == null) item = nil;
      return result['$<<'](Opal.yield1(block, item))}, TMP_14.$$s = self, TMP_14.$$arity = 1, TMP_14));
      return self.$replace(result);
    }, TMP_Set_collect$B_13.$$arity = 0);
    Opal.alias(self, "map!", "collect!");
    
    Opal.defn(self, '$delete', TMP_Set_delete_15 = function(o) {
      var self = this;

      
      self.hash.$delete(o);
      return self;
    }, TMP_Set_delete_15.$$arity = 1);
    
    Opal.defn(self, '$delete?', TMP_Set_delete$q_16 = function(o) {
      var self = this;

      if ($truthy(self['$include?'](o))) {
        
        self.$delete(o);
        return self;
        } else {
        return nil
      }
    }, TMP_Set_delete$q_16.$$arity = 1);
    
    Opal.defn(self, '$delete_if', TMP_Set_delete_if_17 = function $$delete_if() {try {

      var $a, TMP_18, TMP_19, self = this, $iter = TMP_Set_delete_if_17.$$p, $yield = $iter || nil;

      if ($iter) TMP_Set_delete_if_17.$$p = null;
      
      ($truthy($a = ($yield !== nil)) ? $a : Opal.ret(self.$enum_for("delete_if")));
      $send($send(self, 'select', [], (TMP_18 = function(o){var self = TMP_18.$$s || this;
if (o == null) o = nil;
      return Opal.yield1($yield, o);}, TMP_18.$$s = self, TMP_18.$$arity = 1, TMP_18)), 'each', [], (TMP_19 = function(o){var self = TMP_19.$$s || this;
        if (self.hash == null) self.hash = nil;
if (o == null) o = nil;
      return self.hash.$delete(o)}, TMP_19.$$s = self, TMP_19.$$arity = 1, TMP_19));
      return self;
      } catch ($returner) { if ($returner === Opal.returner) { return $returner.$v } throw $returner; }
    }, TMP_Set_delete_if_17.$$arity = 0);
    
    Opal.defn(self, '$add?', TMP_Set_add$q_20 = function(o) {
      var self = this;

      if ($truthy(self['$include?'](o))) {
        return nil
        } else {
        return self.$add(o)
      }
    }, TMP_Set_add$q_20.$$arity = 1);
    
    Opal.defn(self, '$each', TMP_Set_each_21 = function $$each() {
      var self = this, $iter = TMP_Set_each_21.$$p, block = $iter || nil;

      if ($iter) TMP_Set_each_21.$$p = null;
      
      if ((block !== nil)) {
        } else {
        return self.$enum_for("each")
      };
      $send(self.hash, 'each_key', [], block.$to_proc());
      return self;
    }, TMP_Set_each_21.$$arity = 0);
    
    Opal.defn(self, '$empty?', TMP_Set_empty$q_22 = function() {
      var self = this;

      return self.hash['$empty?']()
    }, TMP_Set_empty$q_22.$$arity = 0);
    
    Opal.defn(self, '$eql?', TMP_Set_eql$q_24 = function(other) {
      var TMP_23, self = this;

      return self.hash['$eql?']($send(other, 'instance_eval', [], (TMP_23 = function(){var self = TMP_23.$$s || this;
        if (self.hash == null) self.hash = nil;

      return self.hash}, TMP_23.$$s = self, TMP_23.$$arity = 0, TMP_23)))
    }, TMP_Set_eql$q_24.$$arity = 1);
    
    Opal.defn(self, '$clear', TMP_Set_clear_25 = function $$clear() {
      var self = this;

      
      self.hash.$clear();
      return self;
    }, TMP_Set_clear_25.$$arity = 0);
    
    Opal.defn(self, '$include?', TMP_Set_include$q_26 = function(o) {
      var self = this;

      return self.hash['$include?'](o)
    }, TMP_Set_include$q_26.$$arity = 1);
    Opal.alias(self, "member?", "include?");
    
    Opal.defn(self, '$merge', TMP_Set_merge_28 = function $$merge(enum$) {
      var TMP_27, self = this;

      
      $send(enum$, 'each', [], (TMP_27 = function(item){var self = TMP_27.$$s || this;
if (item == null) item = nil;
      return self.$add(item)}, TMP_27.$$s = self, TMP_27.$$arity = 1, TMP_27));
      return self;
    }, TMP_Set_merge_28.$$arity = 1);
    
    Opal.defn(self, '$replace', TMP_Set_replace_29 = function $$replace(enum$) {
      var self = this;

      
      self.$clear();
      self.$merge(enum$);
      return self;
    }, TMP_Set_replace_29.$$arity = 1);
    
    Opal.defn(self, '$size', TMP_Set_size_30 = function $$size() {
      var self = this;

      return self.hash.$size()
    }, TMP_Set_size_30.$$arity = 0);
    Opal.alias(self, "length", "size");
    
    Opal.defn(self, '$subtract', TMP_Set_subtract_32 = function $$subtract(enum$) {
      var TMP_31, self = this;

      
      $send(enum$, 'each', [], (TMP_31 = function(item){var self = TMP_31.$$s || this;
if (item == null) item = nil;
      return self.$delete(item)}, TMP_31.$$s = self, TMP_31.$$arity = 1, TMP_31));
      return self;
    }, TMP_Set_subtract_32.$$arity = 1);
    
    Opal.defn(self, '$|', TMP_Set_$_33 = function(enum$) {
      var self = this;

      
      if ($truthy(enum$['$respond_to?']("each"))) {
        } else {
        self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "value must be enumerable")
      };
      return self.$dup().$merge(enum$);
    }, TMP_Set_$_33.$$arity = 1);
    
    Opal.defn(self, '$superset?', TMP_Set_superset$q_35 = function(set) {
      var $a, TMP_34, self = this;

      
      ($truthy($a = set['$is_a?'](Opal.const_get_relative($nesting, 'Set'))) ? $a : self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "value must be a set"));
      if ($truthy($rb_lt(self.$size(), set.$size()))) {
        return false};
      return $send(set, 'all?', [], (TMP_34 = function(o){var self = TMP_34.$$s || this;
if (o == null) o = nil;
      return self['$include?'](o)}, TMP_34.$$s = self, TMP_34.$$arity = 1, TMP_34));
    }, TMP_Set_superset$q_35.$$arity = 1);
    Opal.alias(self, ">=", "superset?");
    
    Opal.defn(self, '$proper_superset?', TMP_Set_proper_superset$q_37 = function(set) {
      var $a, TMP_36, self = this;

      
      ($truthy($a = set['$is_a?'](Opal.const_get_relative($nesting, 'Set'))) ? $a : self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "value must be a set"));
      if ($truthy($rb_le(self.$size(), set.$size()))) {
        return false};
      return $send(set, 'all?', [], (TMP_36 = function(o){var self = TMP_36.$$s || this;
if (o == null) o = nil;
      return self['$include?'](o)}, TMP_36.$$s = self, TMP_36.$$arity = 1, TMP_36));
    }, TMP_Set_proper_superset$q_37.$$arity = 1);
    Opal.alias(self, ">", "proper_superset?");
    
    Opal.defn(self, '$subset?', TMP_Set_subset$q_39 = function(set) {
      var $a, TMP_38, self = this;

      
      ($truthy($a = set['$is_a?'](Opal.const_get_relative($nesting, 'Set'))) ? $a : self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "value must be a set"));
      if ($truthy($rb_lt(set.$size(), self.$size()))) {
        return false};
      return $send(self, 'all?', [], (TMP_38 = function(o){var self = TMP_38.$$s || this;
if (o == null) o = nil;
      return set['$include?'](o)}, TMP_38.$$s = self, TMP_38.$$arity = 1, TMP_38));
    }, TMP_Set_subset$q_39.$$arity = 1);
    Opal.alias(self, "<=", "subset?");
    
    Opal.defn(self, '$proper_subset?', TMP_Set_proper_subset$q_41 = function(set) {
      var $a, TMP_40, self = this;

      
      ($truthy($a = set['$is_a?'](Opal.const_get_relative($nesting, 'Set'))) ? $a : self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "value must be a set"));
      if ($truthy($rb_le(set.$size(), self.$size()))) {
        return false};
      return $send(self, 'all?', [], (TMP_40 = function(o){var self = TMP_40.$$s || this;
if (o == null) o = nil;
      return set['$include?'](o)}, TMP_40.$$s = self, TMP_40.$$arity = 1, TMP_40));
    }, TMP_Set_proper_subset$q_41.$$arity = 1);
    Opal.alias(self, "<", "proper_subset?");
    Opal.alias(self, "+", "|");
    Opal.alias(self, "union", "|");
    return (Opal.defn(self, '$to_a', TMP_Set_to_a_42 = function $$to_a() {
      var self = this;

      return self.hash.$keys()
    }, TMP_Set_to_a_42.$$arity = 0), nil) && 'to_a';
  })($nesting[0], null, $nesting);
  return (function($base, $parent_nesting) {
    var $Enumerable, self = $Enumerable = $module($base, 'Enumerable');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Enumerable_to_set_43;

    
    Opal.defn(self, '$to_set', TMP_Enumerable_to_set_43 = function $$to_set(klass, $a_rest) {
      var self = this, args, $iter = TMP_Enumerable_to_set_43.$$p, block = $iter || nil;

      if (klass == null) {
        klass = Opal.const_get_relative($nesting, 'Set');
      }
      var $args_len = arguments.length, $rest_len = $args_len - 1;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 1] = arguments[$arg_idx];
      }
      if ($iter) TMP_Enumerable_to_set_43.$$p = null;
      return $send(klass, 'new', [self].concat(Opal.to_a(args)), block.$to_proc())
    }, TMP_Enumerable_to_set_43.$$arity = -1)
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/inflector/inflections"] = function(Opal) {
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send, $klass = Opal.klass, $range = Opal.range;

  Opal.add_stubs(['$require', '$extend', '$instance', '$split', '$empty?', '$const_get', '$>', '$size', '$first', '$shift', '$inject', '$==', '$const_defined?', '$ancestors', '$apply_inflections', '$plurals', '$inflections', '$singulars', '$to_s', '$include?', '$uncountables', '$downcase', '$detect', '$index', '$sub', '$new', '$attr_reader', '$unshift', '$each', '$<<', '$delete', '$[]', '$upcase', '$plural', '$+', '$singular']);
  
  self.$require("set");
  return (function($base, $parent_nesting) {
    var $ActiveSupport, self = $ActiveSupport = $module($base, 'ActiveSupport');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Inflector, self = $Inflector = $module($base, 'Inflector');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Inflector_inflections_1, TMP_Inflector_constantize_4, TMP_Inflector_pluralize_5, TMP_Inflector_singularize_6, TMP_Inflector_apply_inflections_8;

      
      self.$extend(self);
      
      Opal.defn(self, '$inflections', TMP_Inflector_inflections_1 = function $$inflections(lang) {
        var self = this, $iter = TMP_Inflector_inflections_1.$$p, $yield = $iter || nil;

        if (lang == null) {
          lang = "en";
        }
        if ($iter) TMP_Inflector_inflections_1.$$p = null;
        if (($yield !== nil)) {
          return Opal.yield1($yield, Opal.const_get_relative($nesting, 'Inflections').$instance());
          } else {
          return Opal.const_get_relative($nesting, 'Inflections').$instance()
        }
      }, TMP_Inflector_inflections_1.$$arity = -1);
      
      Opal.defn(self, '$constantize', TMP_Inflector_constantize_4 = function $$constantize(camel_cased_word) {
        var $a, TMP_2, self = this, names = nil;

        
        names = camel_cased_word.$split("::");
        if ($truthy(names['$empty?']())) {
          Opal.const_get_relative($nesting, 'Object').$const_get(camel_cased_word)};
        if ($truthy(($truthy($a = $rb_gt(names.$size(), 1)) ? names.$first()['$empty?']() : $a))) {
          names.$shift()};
        return (function(){var $brk = Opal.new_brk(); try {return $send(names, 'inject', [Opal.const_get_relative($nesting, 'Object')], (TMP_2 = function(constant, name){var self = TMP_2.$$s || this, TMP_3, candidate = nil;
if (constant == null) constant = nil;if (name == null) name = nil;
        if (constant['$=='](Opal.const_get_relative($nesting, 'Object'))) {
            return constant.$const_get(name)
            } else {
            
            candidate = constant.$const_get(name);
            if ($truthy(constant['$const_defined?'](name, false))) {
              return candidate;};
            if ($truthy(Opal.const_get_relative($nesting, 'Object')['$const_defined?'](name))) {
              } else {
              return candidate;
            };
            constant = (function(){var $brk = Opal.new_brk(); try {return $send(constant.$ancestors(), 'inject', [], (TMP_3 = function(const$, ancestor){var self = TMP_3.$$s || this;
if (const$ == null) const$ = nil;if (ancestor == null) ancestor = nil;
            
              if (ancestor['$=='](Opal.const_get_relative($nesting, 'Object'))) {
                
                Opal.brk(const$, $brk)};
              if ($truthy(ancestor['$const_defined?'](name, false))) {
                
                Opal.brk(ancestor, $brk)};
              return const$;}, TMP_3.$$s = self, TMP_3.$$brk = $brk, TMP_3.$$arity = 2, TMP_3))
            } catch (err) { if (err === $brk) { return err.$v } else { throw err } }})();
            return constant.$const_get(name, false);
          }}, TMP_2.$$s = self, TMP_2.$$brk = $brk, TMP_2.$$arity = 2, TMP_2))
        } catch (err) { if (err === $brk) { return err.$v } else { throw err } }})();
      }, TMP_Inflector_constantize_4.$$arity = 1);
      
      Opal.defn(self, '$pluralize', TMP_Inflector_pluralize_5 = function $$pluralize(word) {
        var self = this;

        return self.$apply_inflections(word, self.$inflections().$plurals())
      }, TMP_Inflector_pluralize_5.$$arity = 1);
      
      Opal.defn(self, '$singularize', TMP_Inflector_singularize_6 = function $$singularize(word) {
        var self = this;

        return self.$apply_inflections(word, self.$inflections().$singulars())
      }, TMP_Inflector_singularize_6.$$arity = 1);
      
      Opal.defn(self, '$apply_inflections', TMP_Inflector_apply_inflections_8 = function $$apply_inflections(word, rules) {
        var TMP_7, self = this, result = nil;

        
        result = word.$to_s();
        if ($truthy(self.$inflections().$uncountables()['$include?'](result.$downcase()))) {
          return result
          } else {
          return (function(){var $brk = Opal.new_brk(); try {return $send(rules, 'detect', [], (TMP_7 = function(rule, replacement){var self = TMP_7.$$s || this;
if (rule == null) rule = nil;if (replacement == null) replacement = nil;
          if ($truthy(result.$index(rule))) {
              
              Opal.brk(result.$sub(rule, replacement), $brk)
              } else {
              return nil
            }}, TMP_7.$$s = self, TMP_7.$$brk = $brk, TMP_7.$$arity = 2, TMP_7))
          } catch (err) { if (err === $brk) { return err.$v } else { throw err } }})()
        };
      }, TMP_Inflector_apply_inflections_8.$$arity = 2);
      (function($base, $super, $parent_nesting) {
        function $Inflections(){};
        var self = $Inflections = $klass($base, $super, 'Inflections', $Inflections);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Inflections_instance_9, TMP_Inflections_initialize_10, TMP_Inflections_plural_11, TMP_Inflections_singular_12, TMP_Inflections_uncountable_14, TMP_Inflections_irregular_15;

        def.plurals = def.singulars = def.uncountables = nil;
        
        Opal.defs(self, '$instance', TMP_Inflections_instance_9 = function $$instance() {
          var $a, self = this;
          if (self.__instance__ == null) self.__instance__ = nil;

          return (self.__instance__ = ($truthy($a = self.__instance__) ? $a : self.$new()))
        }, TMP_Inflections_instance_9.$$arity = 0);
        self.$attr_reader("plurals", "singulars", "uncountables");
        
        Opal.defn(self, '$initialize', TMP_Inflections_initialize_10 = function $$initialize() {
          var $a, self = this;

          return $a = [[], [], Opal.const_get_relative($nesting, 'Set').$new()], (self.plurals = $a[0]), (self.singulars = $a[1]), (self.uncountables = $a[2]), $a
        }, TMP_Inflections_initialize_10.$$arity = 0);
        
        Opal.defn(self, '$plural', TMP_Inflections_plural_11 = function $$plural(rule, replacement) {
          var self = this;

          return self.plurals.$unshift([rule, replacement])
        }, TMP_Inflections_plural_11.$$arity = 2);
        
        Opal.defn(self, '$singular', TMP_Inflections_singular_12 = function $$singular(rule, replacement) {
          var self = this;

          return self.singulars.$unshift([rule, replacement])
        }, TMP_Inflections_singular_12.$$arity = 2);
        
        Opal.defn(self, '$uncountable', TMP_Inflections_uncountable_14 = function $$uncountable(words) {
          var TMP_13, self = this;

          return $send(words, 'each', [], (TMP_13 = function(w){var self = TMP_13.$$s || this;
            if (self.uncountables == null) self.uncountables = nil;
if (w == null) w = nil;
          return self.uncountables['$<<'](w.$downcase())}, TMP_13.$$s = self, TMP_13.$$arity = 1, TMP_13))
        }, TMP_Inflections_uncountable_14.$$arity = 1);
        return (Opal.defn(self, '$irregular', TMP_Inflections_irregular_15 = function $$irregular(singular, plural) {
          var self = this, s0 = nil, srest = nil, p0 = nil, prest = nil;

          
          self.uncountables.$delete(singular);
          self.uncountables.$delete(plural);
          s0 = singular['$[]'](0);
          srest = singular['$[]']($range(1, -1, false));
          p0 = plural['$[]'](0);
          prest = plural['$[]']($range(1, -1, false));
          if (s0.$upcase()['$=='](p0.$upcase())) {
            
            self.$plural(new RegExp("" + "(" + (s0) + ")" + (srest) + "$", 'i'), $rb_plus("\\1", prest));
            self.$plural(new RegExp("" + "(" + (p0) + ")" + (prest) + "$", 'i'), $rb_plus("\\1", prest));
            self.$singular(new RegExp("" + "(" + (s0) + ")" + (srest) + "$", 'i'), $rb_plus("\\1", srest));
            return self.$singular(new RegExp("" + "(" + (p0) + ")" + (prest) + "$", 'i'), $rb_plus("\\1", srest));
            } else {
            
            self.$plural(new RegExp("" + (s0.$upcase()) + "(?i)" + (srest) + "$"), $rb_plus(p0.$upcase(), prest));
            self.$plural(new RegExp("" + (s0.$downcase()) + "(?i)" + (srest) + "$"), $rb_plus(p0.$downcase(), prest));
            self.$plural(new RegExp("" + (p0.$upcase()) + "(?i)" + (prest) + "$"), $rb_plus(p0.$upcase(), prest));
            self.$plural(new RegExp("" + (p0.$downcase()) + "(?i)" + (prest) + "$"), $rb_plus(p0.$downcase(), prest));
            self.$singular(new RegExp("" + (s0.$upcase()) + "(?i)" + (srest) + "$"), $rb_plus(s0.$upcase(), srest));
            self.$singular(new RegExp("" + (s0.$downcase()) + "(?i)" + (srest) + "$"), $rb_plus(s0.$downcase(), srest));
            self.$singular(new RegExp("" + (p0.$upcase()) + "(?i)" + (prest) + "$"), $rb_plus(s0.$upcase(), srest));
            return self.$singular(new RegExp("" + (p0.$downcase()) + "(?i)" + (prest) + "$"), $rb_plus(s0.$downcase(), srest));
          };
        }, TMP_Inflections_irregular_15.$$arity = 2), nil) && 'irregular';
      })($nesting[0], null, $nesting);
    })($nesting[0], $nesting)
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/inflections"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send;

  Opal.add_stubs(['$inflections', '$plural', '$singular', '$irregular', '$uncountable']);
  return (function($base, $parent_nesting) {
    var $ActiveSupport, self = $ActiveSupport = $module($base, 'ActiveSupport');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ActiveSupport_1;

    $send(Opal.const_get_relative($nesting, 'Inflector'), 'inflections', ["en"], (TMP_ActiveSupport_1 = function(inflect){var self = TMP_ActiveSupport_1.$$s || this;
if (inflect == null) inflect = nil;
    
      inflect.$plural(/$/, "s");
      inflect.$plural(/s$/i, "s");
      inflect.$plural(/^(ax|test)is$/i, "\\1es");
      inflect.$plural(/(octop|vir)us$/i, "\\1i");
      inflect.$plural(/(octop|vir)i$/i, "\\1i");
      inflect.$plural(/(alias|status)$/i, "\\1es");
      inflect.$plural(/(bu)s$/i, "\\1ses");
      inflect.$plural(/(buffal|tomat)o$/i, "\\1oes");
      inflect.$plural(/([ti])um$/i, "\\1a");
      inflect.$plural(/([ti])a$/i, "\\1a");
      inflect.$plural(/sis$/i, "ses");
      inflect.$plural(/(?:([^f])fe|([lr])f)$/i, "\\1\\2ves");
      inflect.$plural(/(hive)$/i, "\\1s");
      inflect.$plural(/([^aeiouy]|qu)y$/i, "\\1ies");
      inflect.$plural(/(x|ch|ss|sh)$/i, "\\1es");
      inflect.$plural(/(matr|vert|ind)(?:ix|ex)$/i, "\\1ices");
      inflect.$plural(/^(m|l)ouse$/i, "\\1ice");
      inflect.$plural(/^(m|l)ice$/i, "\\1ice");
      inflect.$plural(/^(ox)$/i, "\\1en");
      inflect.$plural(/^(oxen)$/i, "\\1");
      inflect.$plural(/(quiz)$/i, "\\1zes");
      inflect.$singular(/s$/i, "");
      inflect.$singular(/(ss)$/i, "\\1");
      inflect.$singular(/(n)ews$/i, "\\1ews");
      inflect.$singular(/([ti])a$/i, "\\1um");
      inflect.$singular(/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)(sis|ses)$/i, "\\1sis");
      inflect.$singular(/(^analy)(sis|ses)$/i, "\\1sis");
      inflect.$singular(/([^f])ves$/i, "\\1fe");
      inflect.$singular(/(hive)s$/i, "\\1");
      inflect.$singular(/(tive)s$/i, "\\1");
      inflect.$singular(/([lr])ves$/i, "\\1f");
      inflect.$singular(/([^aeiouy]|qu)ies$/i, "\\1y");
      inflect.$singular(/(s)eries$/i, "\\1eries");
      inflect.$singular(/(m)ovies$/i, "\\1ovie");
      inflect.$singular(/(x|ch|ss|sh)es$/i, "\\1");
      inflect.$singular(/^(m|l)ice$/i, "\\1ouse");
      inflect.$singular(/(bus)(es)?$/i, "\\1");
      inflect.$singular(/(o)es$/i, "\\1");
      inflect.$singular(/(shoe)s$/i, "\\1");
      inflect.$singular(/(cris|test)(is|es)$/i, "\\1is");
      inflect.$singular(/^(a)x[ie]s$/i, "\\1xis");
      inflect.$singular(/(octop|vir)(us|i)$/i, "\\1us");
      inflect.$singular(/(alias|status)(es)?$/i, "\\1");
      inflect.$singular(/^(ox)en/i, "\\1");
      inflect.$singular(/(vert|ind)ices$/i, "\\1ex");
      inflect.$singular(/(matr)ices$/i, "\\1ix");
      inflect.$singular(/(quiz)zes$/i, "\\1");
      inflect.$singular(/(database)s$/i, "\\1");
      inflect.$irregular("person", "people");
      inflect.$irregular("man", "men");
      inflect.$irregular("child", "children");
      inflect.$irregular("sex", "sexes");
      inflect.$irregular("move", "moves");
      inflect.$irregular("zombie", "zombies");
      return inflect.$uncountable(["equipment", "information", "rice", "money", "species", "series", "fish", "sheep", "jeans", "police"]);}, TMP_ActiveSupport_1.$$s = self, TMP_ActiveSupport_1.$$arity = 1, TMP_ActiveSupport_1))
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/inflector"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  
  self.$require("active_support/inflector/inflections");
  return self.$require("active_support/inflections");
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/module/introspection"] = function(Opal) {
  function $rb_times(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $truthy = Opal.truthy, $gvars = Opal.gvars;

  Opal.add_stubs(['$require', '$=~', '$name', '$freeze', '$parent_name', '$constantize', '$split', '$empty?', '$<<', '$*', '$pop', '$include?', '$constants']);
  
  self.$require("active_support/inflector");
  return (function($base, $super, $parent_nesting) {
    function $Module(){};
    var self = $Module = $klass($base, $super, 'Module', $Module);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Module_parent_name_1, TMP_Module_parent_2, TMP_Module_parents_3, TMP_Module_local_constants_4;

    def.parent_name = nil;
    
    
    Opal.defn(self, '$parent_name', TMP_Module_parent_name_1 = function $$parent_name() {
      var $a, $b, self = this;

      if ($truthy((($a = self['parent_name'], $a != null && $a !== nil) ? 'instance-variable' : nil))) {
        return self.parent_name
        } else {
        return (self.parent_name = (function() {if ($truthy(self.$name()['$=~'](/::[^:]+$/))) {
          return (($b = $gvars['~']) === nil ? nil : $b.$pre_match()).$freeze()
          } else {
          return nil
        }; return nil; })())
      }
    }, TMP_Module_parent_name_1.$$arity = 0);
    
    Opal.defn(self, '$parent', TMP_Module_parent_2 = function $$parent() {
      var self = this;

      if ($truthy(self.$parent_name())) {
        return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'ActiveSupport'), 'Inflector').$constantize(self.$parent_name())
        } else {
        return Opal.const_get_relative($nesting, 'Object')
      }
    }, TMP_Module_parent_2.$$arity = 0);
    
    Opal.defn(self, '$parents', TMP_Module_parents_3 = function $$parents() {
      var $a, self = this, parents = nil, parts = nil;

      
      parents = [];
      if ($truthy(self.$parent_name())) {
        
        parts = self.$parent_name().$split("::");
        while (!($truthy(parts['$empty?']()))) {
          
          parents['$<<'](Opal.const_get_qualified(Opal.const_get_relative($nesting, 'ActiveSupport'), 'Inflector').$constantize($rb_times(parts, "::")));
          parts.$pop();
        };};
      if ($truthy(parents['$include?'](Opal.const_get_relative($nesting, 'Object')))) {
        } else {
        parents['$<<'](Opal.const_get_relative($nesting, 'Object'))
      };
      return parents;
    }, TMP_Module_parents_3.$$arity = 0);
    return (Opal.defn(self, '$local_constants', TMP_Module_local_constants_4 = function $$local_constants() {
      var self = this;

      return self.$constants(false)
    }, TMP_Module_local_constants_4.$$arity = 0), nil) && 'local_constants';
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/module/delegation"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $range = Opal.range;

  Opal.add_stubs(['$pop', '$is_a?', '$[]', '$raise', '$values_at', '$==', '$=~', '$to_s', '$each', '$+', '$lambda', '$start_with?', '$__send__', '$new', '$inspect', '$define_method', '$to_proc']);
  return (function($base, $super, $parent_nesting) {
    function $Module(){};
    var self = $Module = $klass($base, $super, 'Module', $Module);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Module_delegate_6;

    
    (function($base, $super, $parent_nesting) {
      function $DelegationError(){};
      var self = $DelegationError = $klass($base, $super, 'DelegationError', $DelegationError);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return nil
    })($nesting[0], Opal.const_get_relative($nesting, 'NoMethodError'), $nesting);
    return (Opal.defn(self, '$delegate', TMP_Module_delegate_6 = function $$delegate($a_rest) {
      var $b, $c, TMP_1, self = this, methods, options = nil, to = nil, prefix = nil, allow_nil = nil, method_prefix = nil;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      methods = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        methods[$arg_idx - 0] = arguments[$arg_idx];
      }
      
      options = methods.$pop();
      if ($truthy(($truthy($b = options['$is_a?'](Opal.const_get_relative($nesting, 'Hash'))) ? (to = options['$[]']("to")) : $b))) {
        } else {
        self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "Delegation needs a target. Supply an options hash with a :to key as the last argument (e.g. delegate :hello, to: :greeter).")
      };
      $c = options.$values_at("prefix", "allow_nil"), $b = Opal.to_ary($c), (prefix = ($b[0] == null ? nil : $b[0])), (allow_nil = ($b[1] == null ? nil : $b[1])), $c;
      if ($truthy((($b = prefix['$=='](true)) ? to['$=~'](/^[^a-z_]/) : prefix['$=='](true)))) {
        self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "Can only automatically set the delegation prefix when delegating to a method.")};
      method_prefix = (function() {if ($truthy(prefix)) {
        return "" + ((function() {if (prefix['$=='](true)) {
          return to
          } else {
          return prefix
        }; return nil; })()) + "_"
        } else {
        return ""
      }; return nil; })();
      to = to.$to_s();
      return $send(methods, 'each', [], (TMP_1 = function(method){var self = TMP_1.$$s || this, TMP_2, TMP_3, TMP_4, TMP_5, has_block = nil, method_name = nil, resolve_to = nil, exception = nil;
if (method == null) method = nil;
      
        has_block = (function() {if ($truthy(method['$=~'](/[^\]]=$/))) {
          return false
          } else {
          return true
        }; return nil; })();
        method_name = $rb_plus(method_prefix, method);
        resolve_to = $send(self, 'lambda', [], (TMP_2 = function(scope){var self = TMP_2.$$s || this, ivar_name = nil;
if (scope == null) scope = nil;
        if ($truthy(to['$start_with?']("@"))) {
            
            ivar_name = to['$[]']($range(1, -1, false));
            return scope[ivar_name];
            } else {
            return scope.$__send__(to)
          }}, TMP_2.$$s = self, TMP_2.$$arity = 1, TMP_2));
        exception = $send(self, 'lambda', [], (TMP_3 = function(scope){var self = TMP_3.$$s || this;
if (scope == null) scope = nil;
        return Opal.const_get_relative($nesting, 'DelegationError').$new("" + (scope) + (method_name) + " delegated to " + (to) + "." + (method) + " but " + (to) + " is nil: " + (scope.$inspect()), method_name)}, TMP_3.$$s = self, TMP_3.$$arity = 1, TMP_3));
        if ($truthy(has_block)) {
          return $send(self, 'define_method', [method_name], (TMP_4 = function($a_rest){var self = TMP_4.$$s || this, block, args, to_resolved = nil;

            block = TMP_4.$$p || nil;
            if (block) TMP_4.$$p = null;
            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
          
            to_resolved = resolve_to['$[]'](self);
            if ($truthy(to_resolved)) {
              } else {
              
              if ($truthy(allow_nil)) {
                return nil;};
              self.$raise(exception['$[]'](self));
            };
            return $send(to_resolved, '__send__', [method].concat(Opal.to_a(args)), block.$to_proc());}, TMP_4.$$s = self, TMP_4.$$arity = -1, TMP_4))
          } else {
          return $send(self, 'define_method', [method_name], (TMP_5 = function(arg){var self = TMP_5.$$s || this, to_resolved = nil;
if (arg == null) arg = nil;
          
            to_resolved = resolve_to['$[]'](self);
            if ($truthy(to_resolved)) {
              } else {
              
              if ($truthy(allow_nil)) {
                return nil;};
              self.$raise(exception['$[]'](self));
            };
            return to_resolved.$__send__(method, arg);}, TMP_5.$$s = self, TMP_5.$$arity = 1, TMP_5))
        };}, TMP_1.$$s = self, TMP_1.$$arity = 1, TMP_1));
    }, TMP_Module_delegate_6.$$arity = -1), nil) && 'delegate';
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/module"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  
  self.$require("active_support/core_ext/module/introspection");
  self.$require("active_support/core_ext/module/remove_method");
  return self.$require("active_support/core_ext/module/delegation");
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/numeric/calculations"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  return (function(self, $parent_nesting) {
    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    return Opal.alias(self, "current", "now")
  })(Opal.get_singleton_class(Opal.const_get_relative($nesting, 'Time')), $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/numeric"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  
  self.$require("active_support/core_ext/numeric/time");
  return self.$require("active_support/core_ext/numeric/calculations");
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/object/blank"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $truthy = Opal.truthy;

  Opal.add_stubs(['$respond_to?', '$empty?', '$!', '$blank?', '$present?', '$==', '$alias_method', '$!~']);
  
  (function($base, $super, $parent_nesting) {
    function $Object(){};
    var self = $Object = $klass($base, $super, 'Object', $Object);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Object_blank$q_1, TMP_Object_present$q_2, TMP_Object_presence_3;

    
    
    Opal.defn(self, '$blank?', TMP_Object_blank$q_1 = function() {
      var self = this;

      if ($truthy(self['$respond_to?']("empty?"))) {
        return self['$empty?']()
        } else {
        return self['$!']()
      }
    }, TMP_Object_blank$q_1.$$arity = 0);
    
    Opal.defn(self, '$present?', TMP_Object_present$q_2 = function() {
      var self = this;

      return self['$blank?']()['$!']()
    }, TMP_Object_present$q_2.$$arity = 0);
    return (Opal.defn(self, '$presence', TMP_Object_presence_3 = function $$presence() {
      var self = this;

      if ($truthy(self['$present?']())) {
        return self
        } else {
        return nil
      }
    }, TMP_Object_presence_3.$$arity = 0), nil) && 'presence';
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $NilClass(){};
    var self = $NilClass = $klass($base, $super, 'NilClass', $NilClass);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_NilClass_blank$q_4;

    return (Opal.defn(self, '$blank?', TMP_NilClass_blank$q_4 = function() {
      var self = this;

      return true
    }, TMP_NilClass_blank$q_4.$$arity = 0), nil) && 'blank?'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Boolean(){};
    var self = $Boolean = $klass($base, $super, 'Boolean', $Boolean);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Boolean_blank$q_5;

    return (Opal.defn(self, '$blank?', TMP_Boolean_blank$q_5 = function() {
      var self = this;

      return self['$=='](false)
    }, TMP_Boolean_blank$q_5.$$arity = 0), nil) && 'blank?'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Array(){};
    var self = $Array = $klass($base, $super, 'Array', $Array);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    return self.$alias_method("blank?", "empty?")
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Hash(){};
    var self = $Hash = $klass($base, $super, 'Hash', $Hash);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    return self.$alias_method("blank?", "empty?")
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $String(){};
    var self = $String = $klass($base, $super, 'String', $String);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_String_blank$q_6;

    return (Opal.defn(self, '$blank?', TMP_String_blank$q_6 = function() {
      var self = this;

      return self['$!~'](/[^\s　]/)
    }, TMP_String_blank$q_6.$$arity = 0), nil) && 'blank?'
  })($nesting[0], null, $nesting);
  return (function($base, $super, $parent_nesting) {
    function $Numeric(){};
    var self = $Numeric = $klass($base, $super, 'Numeric', $Numeric);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Numeric_blank$q_7;

    return (Opal.defn(self, '$blank?', TMP_Numeric_blank$q_7 = function() {
      var self = this;

      return false
    }, TMP_Numeric_blank$q_7.$$arity = 0), nil) && 'blank?'
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/object/try"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$empty?', '$respond_to?', '$first', '$try!', '$to_proc', '$zero?', '$arity', '$instance_eval', '$public_send']);
  
  (function($base, $super, $parent_nesting) {
    function $Object(){};
    var self = $Object = $klass($base, $super, 'Object', $Object);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Object_try_1, TMP_Object_try$B_2;

    
    
    Opal.defn(self, '$try', TMP_Object_try_1 = function($a_rest) {
      var $b, self = this, a, $iter = TMP_Object_try_1.$$p, b = $iter || nil;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      a = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        a[$arg_idx - 0] = arguments[$arg_idx];
      }
      if ($iter) TMP_Object_try_1.$$p = null;
      if ($truthy(($truthy($b = a['$empty?']()) ? $b : self['$respond_to?'](a.$first())))) {
        return $send(self, 'try!', Opal.to_a(a), b.$to_proc())
        } else {
        return nil
      }
    }, TMP_Object_try_1.$$arity = -1);
    return (Opal.defn(self, '$try!', TMP_Object_try$B_2 = function($a_rest) {
      var $b, self = this, a, $iter = TMP_Object_try$B_2.$$p, b = $iter || nil;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      a = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        a[$arg_idx - 0] = arguments[$arg_idx];
      }
      if ($iter) TMP_Object_try$B_2.$$p = null;
      if ($truthy(($truthy($b = a['$empty?']()) ? (b !== nil) : $b))) {
        if ($truthy(b.$arity()['$zero?']())) {
          return $send(self, 'instance_eval', [], b.$to_proc())
          } else {
          return Opal.yield1(b, self);
        }
        } else {
        return $send(self, 'public_send', Opal.to_a(a), b.$to_proc())
      }
    }, TMP_Object_try$B_2.$$arity = -1), nil) && 'try!';
  })($nesting[0], null, $nesting);
  return (function($base, $super, $parent_nesting) {
    function $NilClass(){};
    var self = $NilClass = $klass($base, $super, 'NilClass', $NilClass);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_NilClass_try_3, TMP_NilClass_try$B_4;

    
    
    Opal.defn(self, '$try', TMP_NilClass_try_3 = function($a_rest) {
      var self = this, args;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      return nil
    }, TMP_NilClass_try_3.$$arity = -1);
    return (Opal.defn(self, '$try!', TMP_NilClass_try$B_4 = function($a_rest) {
      var self = this, args;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      return nil
    }, TMP_NilClass_try$B_4.$$arity = -1), nil) && 'try!';
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/object"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  
  self.$require("active_support/core_ext/object/blank");
  return self.$require("active_support/core_ext/object/try");
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/string/inflections"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  Opal.add_stubs(['$require', '$pluralize', '$singularize', '$constantize']);
  
  self.$require("active_support/inflector");
  return (function($base, $super, $parent_nesting) {
    function $String(){};
    var self = $String = $klass($base, $super, 'String', $String);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_String_pluralize_1, TMP_String_singularize_2, TMP_String_constantize_3;

    
    
    Opal.defn(self, '$pluralize', TMP_String_pluralize_1 = function $$pluralize() {
      var self = this;

      return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'ActiveSupport'), 'Inflector').$pluralize(self)
    }, TMP_String_pluralize_1.$$arity = 0);
    
    Opal.defn(self, '$singularize', TMP_String_singularize_2 = function $$singularize() {
      var self = this;

      return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'ActiveSupport'), 'Inflector').$singularize(self)
    }, TMP_String_singularize_2.$$arity = 0);
    return (Opal.defn(self, '$constantize', TMP_String_constantize_3 = function $$constantize() {
      var self = this;

      return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'ActiveSupport'), 'Inflector').$constantize(self)
    }, TMP_String_constantize_3.$$arity = 0), nil) && 'constantize';
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext/string"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  Opal.add_stubs(['$require', '$gsub', '$strip', '$downcase', '$underscore', '$alias_method']);
  
  self.$require("active_support/core_ext/string/inflections");
  return (function($base, $super, $parent_nesting) {
    function $String(){};
    var self = $String = $klass($base, $super, 'String', $String);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_String_parameterize_1, TMP_String_dasherize_2, TMP_String_demodulize_3, TMP_String_underscore_4, TMP_String_camelize_5;

    
    
    Opal.defn(self, '$parameterize', TMP_String_parameterize_1 = function $$parameterize() {
      var self = this;

      return self.$downcase().$strip().$gsub(/\W+/, "-")
    }, TMP_String_parameterize_1.$$arity = 0);
    
    Opal.defn(self, '$dasherize', TMP_String_dasherize_2 = function $$dasherize() {
      var self = this, result = nil;

      
      result = self.replace(/[-_\s]+/g, '-')
            .replace(/([A-Z\d]+)([A-Z][a-z])/g, '$1-$2')
            .replace(/([a-z\d])([A-Z])/g, '$1-$2')
            .toLowerCase();
      return result;
    }, TMP_String_dasherize_2.$$arity = 0);
    
    Opal.defn(self, '$demodulize', TMP_String_demodulize_3 = function $$demodulize() {
      var self = this;

      
      var idx = self.lastIndexOf('::');

      if (idx > -1) {
        return self.substr(idx + 2);
      }

      return self;
    
    }, TMP_String_demodulize_3.$$arity = 0);
    
    Opal.defn(self, '$underscore', TMP_String_underscore_4 = function $$underscore() {
      var self = this, result = nil;

      
      result = self.replace(/[-\s]+/g, '_')
            .replace(/([A-Z\d]+)([A-Z][a-z])/g, '$1_$2')
            .replace(/([a-z\d])([A-Z])/g, '$1_$2')
            .replace(/-/g, '_')
            .toLowerCase();
      return result;
    }, TMP_String_underscore_4.$$arity = 0);
    
    Opal.defn(self, '$camelize', TMP_String_camelize_5 = function $$camelize(first_letter) {
      var self = this, result = nil;

      if (first_letter == null) {
        first_letter = "upper";
      }
      
      result = self.$underscore().replace(/(^|_)([^_]+)/g, function(match, pre, word, index) {
      var capitalize = first_letter === "upper" || index > 0;
      return capitalize ? word.substr(0,1).toUpperCase()+word.substr(1) : word;
    });
      return result;
    }, TMP_String_camelize_5.$$arity = -1);
    return self.$alias_method("camelcase", "camelize");
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support/core_ext"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  
  self.$require("active_support/core_ext/array");
  self.$require("active_support/core_ext/class");
  self.$require("active_support/core_ext/enumerable");
  self.$require("active_support/core_ext/hash");
  self.$require("active_support/core_ext/integer");
  self.$require("active_support/core_ext/kernel");
  self.$require("active_support/core_ext/module");
  self.$require("active_support/core_ext/numeric");
  self.$require("active_support/core_ext/object");
  return self.$require("active_support/core_ext/string");
};

/* Generated by Opal 0.11.4 */
Opal.modules["active_support"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  return self.$require("active_support/core_ext")
};

/* Generated by Opal 0.11.4 */
Opal.modules["browser/interval"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $gvars = Opal.gvars;

  Opal.add_stubs(['$attr_reader', '$convert', '$nil?', '$stopped?', '$aborted?', '$raise', '$call', '$tap', '$new', '$to_proc', '$every', '$every!']);
  
  (function($base, $parent_nesting) {
    var $Browser, self = $Browser = $module($base, 'Browser');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    
    (function($base, $super, $parent_nesting) {
      function $Interval(){};
      var self = $Interval = $klass($base, $super, 'Interval', $Interval);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Interval_initialize_1, TMP_Interval_stopped$q_2, TMP_Interval_aborted$q_3, TMP_Interval_abort_4, TMP_Interval_stop_5, TMP_Interval_start_6, TMP_Interval_call_7;

      def.id = def.aborted = def.window = def.block = def.every = nil;
      
      self.$attr_reader("every");
      
      Opal.defn(self, '$initialize', TMP_Interval_initialize_1 = function $$initialize(window, time) {
        var self = this, $iter = TMP_Interval_initialize_1.$$p, block = $iter || nil;

        if ($iter) TMP_Interval_initialize_1.$$p = null;
        
        self.window = Opal.const_get_relative($nesting, 'Native').$convert(window);
        self.every = time;
        self.block = block;
        return (self.aborted = false);
      }, TMP_Interval_initialize_1.$$arity = 2);
      
      Opal.defn(self, '$stopped?', TMP_Interval_stopped$q_2 = function() {
        var self = this;

        return self.id['$nil?']()
      }, TMP_Interval_stopped$q_2.$$arity = 0);
      
      Opal.defn(self, '$aborted?', TMP_Interval_aborted$q_3 = function() {
        var self = this;

        return self.aborted
      }, TMP_Interval_aborted$q_3.$$arity = 0);
      
      Opal.defn(self, '$abort', TMP_Interval_abort_4 = function $$abort() {
        var self = this;

        
        self.window.clearInterval(self.id);
        self.aborted = true;
        return (self.id = nil);
      }, TMP_Interval_abort_4.$$arity = 0);
      
      Opal.defn(self, '$stop', TMP_Interval_stop_5 = function $$stop() {
        var self = this;

        
        if ($truthy(self['$stopped?']())) {
          return nil};
        self.window.clearInterval(self.id);
        self.stopped = true;
        return (self.id = nil);
      }, TMP_Interval_stop_5.$$arity = 0);
      
      Opal.defn(self, '$start', TMP_Interval_start_6 = function $$start() {
        var self = this;

        
        if ($truthy(self['$aborted?']())) {
          self.$raise("the interval has been aborted")};
        if ($truthy(self['$stopped?']())) {
          } else {
          return nil
        };
        return (self.id = self.window.setInterval(self.block, self.every * 1000));
      }, TMP_Interval_start_6.$$arity = 0);
      return (Opal.defn(self, '$call', TMP_Interval_call_7 = function $$call() {
        var self = this;

        return self.block.$call()
      }, TMP_Interval_call_7.$$arity = 0), nil) && 'call';
    })($nesting[0], null, $nesting);
    (function($base, $super, $parent_nesting) {
      function $Window(){};
      var self = $Window = $klass($base, $super, 'Window', $Window);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Window_every_8, TMP_Window_every$B_9;

      def["native"] = nil;
      
      
      Opal.defn(self, '$every', TMP_Window_every_8 = function $$every(time) {
        var self = this, $iter = TMP_Window_every_8.$$p, block = $iter || nil;

        if ($iter) TMP_Window_every_8.$$p = null;
        return $send($send(Opal.const_get_relative($nesting, 'Interval'), 'new', [self["native"], time], block.$to_proc()), 'tap', [], "start".$to_proc())
      }, TMP_Window_every_8.$$arity = 1);
      return (Opal.defn(self, '$every!', TMP_Window_every$B_9 = function(time) {
        var self = this, $iter = TMP_Window_every$B_9.$$p, block = $iter || nil;

        if ($iter) TMP_Window_every$B_9.$$p = null;
        return $send(Opal.const_get_relative($nesting, 'Interval'), 'new', [self["native"], time], block.$to_proc())
      }, TMP_Window_every$B_9.$$arity = 1), nil) && 'every!';
    })($nesting[0], null, $nesting);
  })($nesting[0], $nesting);
  (function($base, $parent_nesting) {
    var $Kernel, self = $Kernel = $module($base, 'Kernel');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Kernel_every_10, TMP_Kernel_every$B_11;

    
    
    Opal.defn(self, '$every', TMP_Kernel_every_10 = function $$every(time) {
      var self = this, $iter = TMP_Kernel_every_10.$$p, block = $iter || nil;
      if ($gvars.window == null) $gvars.window = nil;

      if ($iter) TMP_Kernel_every_10.$$p = null;
      return $send($gvars.window, 'every', [time], block.$to_proc())
    }, TMP_Kernel_every_10.$$arity = 1);
    
    Opal.defn(self, '$every!', TMP_Kernel_every$B_11 = function(time) {
      var self = this, $iter = TMP_Kernel_every$B_11.$$p, block = $iter || nil;
      if ($gvars.window == null) $gvars.window = nil;

      if ($iter) TMP_Kernel_every$B_11.$$p = null;
      return $send($gvars.window, 'every!', [time], block.$to_proc())
    }, TMP_Kernel_every$B_11.$$arity = 1);
  })($nesting[0], $nesting);
  return (function($base, $super, $parent_nesting) {
    function $Proc(){};
    var self = $Proc = $klass($base, $super, 'Proc', $Proc);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Proc_every_12, TMP_Proc_every$B_13;

    
    
    Opal.defn(self, '$every', TMP_Proc_every_12 = function $$every(time) {
      var self = this;
      if ($gvars.window == null) $gvars.window = nil;

      return $send($gvars.window, 'every', [time], self.$to_proc())
    }, TMP_Proc_every_12.$$arity = 1);
    return (Opal.defn(self, '$every!', TMP_Proc_every$B_13 = function(time) {
      var self = this;
      if ($gvars.window == null) $gvars.window = nil;

      return $send($gvars.window, 'every!', [time], self.$to_proc())
    }, TMP_Proc_every$B_13.$$arity = 1), nil) && 'every!';
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["browser/delay"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $gvars = Opal.gvars;

  Opal.add_stubs(['$attr_reader', '$convert', '$to_n', '$tap', '$new', '$to_proc', '$after', '$after!']);
  
  (function($base, $parent_nesting) {
    var $Browser, self = $Browser = $module($base, 'Browser');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    
    (function($base, $super, $parent_nesting) {
      function $Delay(){};
      var self = $Delay = $klass($base, $super, 'Delay', $Delay);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Delay_initialize_1, TMP_Delay_abort_2, TMP_Delay_start_3;

      def.window = def.id = def.block = def.after = nil;
      
      self.$attr_reader("after");
      
      Opal.defn(self, '$initialize', TMP_Delay_initialize_1 = function $$initialize(window, time) {
        var self = this, $iter = TMP_Delay_initialize_1.$$p, block = $iter || nil;

        if ($iter) TMP_Delay_initialize_1.$$p = null;
        
        self.window = Opal.const_get_relative($nesting, 'Native').$convert(window);
        self.after = time;
        return (self.block = block);
      }, TMP_Delay_initialize_1.$$arity = 2);
      
      Opal.defn(self, '$abort', TMP_Delay_abort_2 = function $$abort() {
        var self = this;

        return self.window.clearTimeout(self.id)
      }, TMP_Delay_abort_2.$$arity = 0);
      return (Opal.defn(self, '$start', TMP_Delay_start_3 = function $$start() {
        var self = this;

        return (self.id = self.window.setTimeout(self.block.$to_n(), self.after * 1000))
      }, TMP_Delay_start_3.$$arity = 0), nil) && 'start';
    })($nesting[0], null, $nesting);
    (function($base, $super, $parent_nesting) {
      function $Window(){};
      var self = $Window = $klass($base, $super, 'Window', $Window);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Window_after_4, TMP_Window_after$B_5;

      def["native"] = nil;
      
      
      Opal.defn(self, '$after', TMP_Window_after_4 = function $$after(time) {
        var self = this, $iter = TMP_Window_after_4.$$p, block = $iter || nil;

        if ($iter) TMP_Window_after_4.$$p = null;
        return $send($send(Opal.const_get_relative($nesting, 'Delay'), 'new', [self["native"], time], block.$to_proc()), 'tap', [], "start".$to_proc())
      }, TMP_Window_after_4.$$arity = 1);
      return (Opal.defn(self, '$after!', TMP_Window_after$B_5 = function(time) {
        var self = this, $iter = TMP_Window_after$B_5.$$p, block = $iter || nil;

        if ($iter) TMP_Window_after$B_5.$$p = null;
        return $send(Opal.const_get_relative($nesting, 'Delay'), 'new', [self["native"], time], block.$to_proc())
      }, TMP_Window_after$B_5.$$arity = 1), nil) && 'after!';
    })($nesting[0], null, $nesting);
  })($nesting[0], $nesting);
  (function($base, $parent_nesting) {
    var $Kernel, self = $Kernel = $module($base, 'Kernel');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Kernel_after_6, TMP_Kernel_after$B_7;

    
    
    Opal.defn(self, '$after', TMP_Kernel_after_6 = function $$after(time) {
      var self = this, $iter = TMP_Kernel_after_6.$$p, block = $iter || nil;
      if ($gvars.window == null) $gvars.window = nil;

      if ($iter) TMP_Kernel_after_6.$$p = null;
      return $send($gvars.window, 'after', [time], block.$to_proc())
    }, TMP_Kernel_after_6.$$arity = 1);
    
    Opal.defn(self, '$after!', TMP_Kernel_after$B_7 = function(time) {
      var self = this, $iter = TMP_Kernel_after$B_7.$$p, block = $iter || nil;
      if ($gvars.window == null) $gvars.window = nil;

      if ($iter) TMP_Kernel_after$B_7.$$p = null;
      return $send($gvars.window, 'after!', [time], block.$to_proc())
    }, TMP_Kernel_after$B_7.$$arity = 1);
  })($nesting[0], $nesting);
  return (function($base, $super, $parent_nesting) {
    function $Proc(){};
    var self = $Proc = $klass($base, $super, 'Proc', $Proc);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Proc_after_8, TMP_Proc_after$B_9;

    
    
    Opal.defn(self, '$after', TMP_Proc_after_8 = function $$after(time) {
      var self = this;
      if ($gvars.window == null) $gvars.window = nil;

      return $send($gvars.window, 'after', [time], self.$to_proc())
    }, TMP_Proc_after_8.$$arity = 1);
    return (Opal.defn(self, '$after!', TMP_Proc_after$B_9 = function(time) {
      var self = this;
      if ($gvars.window == null) $gvars.window = nil;

      return $send($gvars.window, 'after!', [time], self.$to_proc())
    }, TMP_Proc_after$B_9.$$arity = 1), nil) && 'after!';
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["native"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_ge(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send, $range = Opal.range, $hash2 = Opal.hash2, $klass = Opal.klass, $gvars = Opal.gvars;

  Opal.add_stubs(['$try_convert', '$native?', '$respond_to?', '$to_n', '$raise', '$inspect', '$Native', '$proc', '$map!', '$end_with?', '$define_method', '$[]', '$convert', '$call', '$to_proc', '$new', '$each', '$native_reader', '$native_writer', '$extend', '$is_a?', '$map', '$alias_method', '$to_a', '$_Array', '$include', '$method_missing', '$bind', '$instance_method', '$slice', '$-', '$length', '$[]=', '$enum_for', '$===', '$>=', '$<<', '$each_pair', '$_initialize', '$name', '$exiting_mid', '$native_module']);
  
  (function($base, $parent_nesting) {
    var $Native, self = $Native = $module($base, 'Native');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Native_is_a$q_1, TMP_Native_try_convert_2, TMP_Native_convert_3, TMP_Native_call_4, TMP_Native_proc_5, TMP_Native_included_19, TMP_Native_initialize_20, TMP_Native_to_n_21;

    
    Opal.defs(self, '$is_a?', TMP_Native_is_a$q_1 = function(object, klass) {
      var self = this;

      
      try {
        return object instanceof self.$try_convert(klass);
      }
      catch (e) {
        return false;
      }
    
    }, TMP_Native_is_a$q_1.$$arity = 2);
    Opal.defs(self, '$try_convert', TMP_Native_try_convert_2 = function $$try_convert(value, default$) {
      var self = this;

      if (default$ == null) {
        default$ = nil;
      }
      
      if (self['$native?'](value)) {
        return value;
      }
      else if (value['$respond_to?']("to_n")) {
        return value.$to_n();
      }
      else {
        return default$;
      }
    
    }, TMP_Native_try_convert_2.$$arity = -2);
    Opal.defs(self, '$convert', TMP_Native_convert_3 = function $$convert(value) {
      var self = this;

      
      if (self['$native?'](value)) {
        return value;
      }
      else if (value['$respond_to?']("to_n")) {
        return value.$to_n();
      }
      else {
        self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "" + (value.$inspect()) + " isn't native");
      }
    
    }, TMP_Native_convert_3.$$arity = 1);
    Opal.defs(self, '$call', TMP_Native_call_4 = function $$call(obj, key, $a_rest) {
      var self = this, args, $iter = TMP_Native_call_4.$$p, block = $iter || nil;

      var $args_len = arguments.length, $rest_len = $args_len - 2;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 2; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 2] = arguments[$arg_idx];
      }
      if ($iter) TMP_Native_call_4.$$p = null;
      
      var prop = obj[key];

      if (prop instanceof Function) {
        var converted = new Array(args.length);

        for (var i = 0, l = args.length; i < l; i++) {
          var item = args[i],
              conv = self.$try_convert(item);

          converted[i] = conv === nil ? item : conv;
        }

        if (block !== nil) {
          converted.push(block);
        }

        return self.$Native(prop.apply(obj, converted));
      }
      else {
        return self.$Native(prop);
      }
    
    }, TMP_Native_call_4.$$arity = -3);
    Opal.defs(self, '$proc', TMP_Native_proc_5 = function $$proc() {
      var TMP_6, self = this, $iter = TMP_Native_proc_5.$$p, block = $iter || nil;

      if ($iter) TMP_Native_proc_5.$$p = null;
      
      if ($truthy(block)) {
        } else {
        self.$raise(Opal.const_get_relative($nesting, 'LocalJumpError'), "no block given")
      };
      return $send(Opal.const_get_qualified('::', 'Kernel'), 'proc', [], (TMP_6 = function($a_rest){var self = TMP_6.$$s || this, args, TMP_7, instance = nil;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 0] = arguments[$arg_idx];
        }
      
        $send(args, 'map!', [], (TMP_7 = function(arg){var self = TMP_7.$$s || this;
if (arg == null) arg = nil;
        return self.$Native(arg)}, TMP_7.$$s = self, TMP_7.$$arity = 1, TMP_7));
        instance = self.$Native(this);
        
        // if global is current scope, run the block in the scope it was defined
        if (this === Opal.global) {
          return block.apply(self, args);
        }

        var self_ = block.$$s;
        block.$$s = null;

        try {
          return block.apply(instance, args);
        }
        finally {
          block.$$s = self_;
        }
      ;}, TMP_6.$$s = self, TMP_6.$$arity = -1, TMP_6));
    }, TMP_Native_proc_5.$$arity = 0);
    (function($base, $parent_nesting) {
      var $Helpers, self = $Helpers = $module($base, 'Helpers');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Helpers_alias_native_11, TMP_Helpers_native_reader_14, TMP_Helpers_native_writer_17, TMP_Helpers_native_accessor_18;

      
      
      Opal.defn(self, '$alias_native', TMP_Helpers_alias_native_11 = function $$alias_native(new$, $old, $kwargs) {
        var TMP_8, TMP_9, TMP_10, self = this, $post_args, as, old;

        $post_args = Opal.slice.call(arguments, 1, arguments.length);
        $kwargs = Opal.extract_kwargs($post_args);
        if ($kwargs == null || !$kwargs.$$is_hash) {
          if ($kwargs == null) {
            $kwargs = $hash2([], {});
          } else {
            throw Opal.ArgumentError.$new('expected kwargs');
          }
        }
        as = $kwargs.$$smap["as"];
        if (as == null) {
          as = nil
        }
        if (0 < $post_args.length) {
          old = $post_args.splice(0,1)[0];
        }
        if (old == null) {
          old = new$;
        }
        if ($truthy(old['$end_with?']("="))) {
          return $send(self, 'define_method', [new$], (TMP_8 = function(value){var self = TMP_8.$$s || this;
            if (self["native"] == null) self["native"] = nil;
if (value == null) value = nil;
          
            self["native"][old['$[]']($range(0, -2, false))] = Opal.const_get_relative($nesting, 'Native').$convert(value);
            return value;}, TMP_8.$$s = self, TMP_8.$$arity = 1, TMP_8))
        } else if ($truthy(as)) {
          return $send(self, 'define_method', [new$], (TMP_9 = function($a_rest){var self = TMP_9.$$s || this, block, args, value = nil;
            if (self["native"] == null) self["native"] = nil;

            block = TMP_9.$$p || nil;
            if (block) TMP_9.$$p = null;
            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
          if ($truthy((value = $send(Opal.const_get_relative($nesting, 'Native'), 'call', [self["native"], old].concat(Opal.to_a(args)), block.$to_proc())))) {
              return as.$new(value.$to_n())
              } else {
              return nil
            }}, TMP_9.$$s = self, TMP_9.$$arity = -1, TMP_9))
          } else {
          return $send(self, 'define_method', [new$], (TMP_10 = function($a_rest){var self = TMP_10.$$s || this, block, args;
            if (self["native"] == null) self["native"] = nil;

            block = TMP_10.$$p || nil;
            if (block) TMP_10.$$p = null;
            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
          return $send(Opal.const_get_relative($nesting, 'Native'), 'call', [self["native"], old].concat(Opal.to_a(args)), block.$to_proc())}, TMP_10.$$s = self, TMP_10.$$arity = -1, TMP_10))
        }
      }, TMP_Helpers_alias_native_11.$$arity = -2);
      
      Opal.defn(self, '$native_reader', TMP_Helpers_native_reader_14 = function $$native_reader($a_rest) {
        var TMP_12, self = this, names;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        names = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          names[$arg_idx - 0] = arguments[$arg_idx];
        }
        return $send(names, 'each', [], (TMP_12 = function(name){var self = TMP_12.$$s || this, TMP_13;
if (name == null) name = nil;
        return $send(self, 'define_method', [name], (TMP_13 = function(){var self = TMP_13.$$s || this;
            if (self["native"] == null) self["native"] = nil;

          return self.$Native(self["native"][name])}, TMP_13.$$s = self, TMP_13.$$arity = 0, TMP_13))}, TMP_12.$$s = self, TMP_12.$$arity = 1, TMP_12))
      }, TMP_Helpers_native_reader_14.$$arity = -1);
      
      Opal.defn(self, '$native_writer', TMP_Helpers_native_writer_17 = function $$native_writer($a_rest) {
        var TMP_15, self = this, names;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        names = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          names[$arg_idx - 0] = arguments[$arg_idx];
        }
        return $send(names, 'each', [], (TMP_15 = function(name){var self = TMP_15.$$s || this, TMP_16;
if (name == null) name = nil;
        return $send(self, 'define_method', ["" + (name) + "="], (TMP_16 = function(value){var self = TMP_16.$$s || this;
            if (self["native"] == null) self["native"] = nil;
if (value == null) value = nil;
          return self.$Native(self["native"][name] = value)}, TMP_16.$$s = self, TMP_16.$$arity = 1, TMP_16))}, TMP_15.$$s = self, TMP_15.$$arity = 1, TMP_15))
      }, TMP_Helpers_native_writer_17.$$arity = -1);
      
      Opal.defn(self, '$native_accessor', TMP_Helpers_native_accessor_18 = function $$native_accessor($a_rest) {
        var self = this, names;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        names = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          names[$arg_idx - 0] = arguments[$arg_idx];
        }
        
        $send(self, 'native_reader', Opal.to_a(names));
        return $send(self, 'native_writer', Opal.to_a(names));
      }, TMP_Helpers_native_accessor_18.$$arity = -1);
    })($nesting[0], $nesting);
    Opal.defs(self, '$included', TMP_Native_included_19 = function $$included(klass) {
      var self = this;

      return klass.$extend(Opal.const_get_relative($nesting, 'Helpers'))
    }, TMP_Native_included_19.$$arity = 1);
    
    Opal.defn(self, '$initialize', TMP_Native_initialize_20 = function $$initialize(native$) {
      var self = this;

      
      if ($truthy(Opal.const_get_qualified('::', 'Kernel')['$native?'](native$))) {
        } else {
        Opal.const_get_qualified('::', 'Kernel').$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "" + (native$.$inspect()) + " isn't native")
      };
      return (self["native"] = native$);
    }, TMP_Native_initialize_20.$$arity = 1);
    
    Opal.defn(self, '$to_n', TMP_Native_to_n_21 = function $$to_n() {
      var self = this;
      if (self["native"] == null) self["native"] = nil;

      return self["native"]
    }, TMP_Native_to_n_21.$$arity = 0);
  })($nesting[0], $nesting);
  (function($base, $parent_nesting) {
    var $Kernel, self = $Kernel = $module($base, 'Kernel');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Kernel_native$q_22, TMP_Kernel_Native_25, TMP_Kernel_Array_26;

    
    
    Opal.defn(self, '$native?', TMP_Kernel_native$q_22 = function(value) {
      var self = this;

      return value == null || !value.$$class
    }, TMP_Kernel_native$q_22.$$arity = 1);
    
    Opal.defn(self, '$Native', TMP_Kernel_Native_25 = function $$Native(obj) {
      var TMP_23, TMP_24, self = this;

      if ($truthy(obj == null)) {
        return nil
      } else if ($truthy(self['$native?'](obj))) {
        return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Native'), 'Object').$new(obj)
      } else if ($truthy(obj['$is_a?'](Opal.const_get_relative($nesting, 'Array')))) {
        return $send(obj, 'map', [], (TMP_23 = function(o){var self = TMP_23.$$s || this;
if (o == null) o = nil;
        return self.$Native(o)}, TMP_23.$$s = self, TMP_23.$$arity = 1, TMP_23))
      } else if ($truthy(obj['$is_a?'](Opal.const_get_relative($nesting, 'Proc')))) {
        return $send(self, 'proc', [], (TMP_24 = function($a_rest){var self = TMP_24.$$s || this, block, args;

          block = TMP_24.$$p || nil;
          if (block) TMP_24.$$p = null;
          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
        return self.$Native($send(obj, 'call', Opal.to_a(args), block.$to_proc()))}, TMP_24.$$s = self, TMP_24.$$arity = -1, TMP_24))
        } else {
        return obj
      }
    }, TMP_Kernel_Native_25.$$arity = 1);
    self.$alias_method("_Array", "Array");
    
    Opal.defn(self, '$Array', TMP_Kernel_Array_26 = function $$Array(object, $a_rest) {
      var self = this, args, $iter = TMP_Kernel_Array_26.$$p, block = $iter || nil;

      var $args_len = arguments.length, $rest_len = $args_len - 1;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 1] = arguments[$arg_idx];
      }
      if ($iter) TMP_Kernel_Array_26.$$p = null;
      
      if ($truthy(self['$native?'](object))) {
        return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Native'), 'Array'), 'new', [object].concat(Opal.to_a(args)), block.$to_proc()).$to_a()};
      return self.$_Array(object);
    }, TMP_Kernel_Array_26.$$arity = -2);
  })($nesting[0], $nesting);
  (function($base, $super, $parent_nesting) {
    function $Object(){};
    var self = $Object = $klass($base, $super, 'Object', $Object);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Object_$eq$eq_27, TMP_Object_has_key$q_28, TMP_Object_each_29, TMP_Object_$$_30, TMP_Object_$$$eq_31, TMP_Object_merge$B_32, TMP_Object_respond_to$q_33, TMP_Object_respond_to_missing$q_34, TMP_Object_method_missing_35, TMP_Object_nil$q_36, TMP_Object_is_a$q_37, TMP_Object_instance_of$q_38, TMP_Object_class_39, TMP_Object_to_a_40, TMP_Object_inspect_41;

    def["native"] = nil;
    
    self.$include(Opal.const_get_qualified('::', 'Native'));
    
    Opal.defn(self, '$==', TMP_Object_$eq$eq_27 = function(other) {
      var self = this;

      return self["native"] === Opal.const_get_qualified('::', 'Native').$try_convert(other)
    }, TMP_Object_$eq$eq_27.$$arity = 1);
    
    Opal.defn(self, '$has_key?', TMP_Object_has_key$q_28 = function(name) {
      var self = this;

      return Opal.hasOwnProperty.call(self["native"], name)
    }, TMP_Object_has_key$q_28.$$arity = 1);
    Opal.alias(self, "key?", "has_key?");
    Opal.alias(self, "include?", "has_key?");
    Opal.alias(self, "member?", "has_key?");
    
    Opal.defn(self, '$each', TMP_Object_each_29 = function $$each($a_rest) {
      var self = this, args, $iter = TMP_Object_each_29.$$p, $yield = $iter || nil;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      if ($iter) TMP_Object_each_29.$$p = null;
      if (($yield !== nil)) {
        
        
        for (var key in self["native"]) {
          Opal.yieldX($yield, [key, self["native"][key]])
        }
      ;
        return self;
        } else {
        return $send(self, 'method_missing', ["each"].concat(Opal.to_a(args)))
      }
    }, TMP_Object_each_29.$$arity = -1);
    
    Opal.defn(self, '$[]', TMP_Object_$$_30 = function(key) {
      var self = this;

      
      var prop = self["native"][key];

      if (prop instanceof Function) {
        return prop;
      }
      else {
        return Opal.const_get_qualified('::', 'Native').$call(self["native"], key)
      }
    
    }, TMP_Object_$$_30.$$arity = 1);
    
    Opal.defn(self, '$[]=', TMP_Object_$$$eq_31 = function(key, value) {
      var self = this, native$ = nil;

      
      native$ = Opal.const_get_qualified('::', 'Native').$try_convert(value);
      if ($truthy(native$ === nil)) {
        return self["native"][key] = value
        } else {
        return self["native"][key] = native$
      };
    }, TMP_Object_$$$eq_31.$$arity = 2);
    
    Opal.defn(self, '$merge!', TMP_Object_merge$B_32 = function(other) {
      var self = this;

      
      
      other = Opal.const_get_qualified('::', 'Native').$convert(other);

      for (var prop in other) {
        self["native"][prop] = other[prop];
      }
    ;
      return self;
    }, TMP_Object_merge$B_32.$$arity = 1);
    
    Opal.defn(self, '$respond_to?', TMP_Object_respond_to$q_33 = function(name, include_all) {
      var self = this;

      if (include_all == null) {
        include_all = false;
      }
      return Opal.const_get_qualified('::', 'Kernel').$instance_method("respond_to?").$bind(self).$call(name, include_all)
    }, TMP_Object_respond_to$q_33.$$arity = -2);
    
    Opal.defn(self, '$respond_to_missing?', TMP_Object_respond_to_missing$q_34 = function(name, include_all) {
      var self = this;

      if (include_all == null) {
        include_all = false;
      }
      return Opal.hasOwnProperty.call(self["native"], name)
    }, TMP_Object_respond_to_missing$q_34.$$arity = -2);
    
    Opal.defn(self, '$method_missing', TMP_Object_method_missing_35 = function $$method_missing(mid, $a_rest) {
      var self = this, args, $iter = TMP_Object_method_missing_35.$$p, block = $iter || nil, $writer = nil;

      var $args_len = arguments.length, $rest_len = $args_len - 1;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 1] = arguments[$arg_idx];
      }
      if ($iter) TMP_Object_method_missing_35.$$p = null;
      
      if (mid.charAt(mid.length - 1) === '=') {
        return (($writer = [mid.$slice(0, $rb_minus(mid.$length(), 1)), args['$[]'](0)]), $send(self, '[]=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]);
      }
      else {
        return $send(Opal.const_get_qualified('::', 'Native'), 'call', [self["native"], mid].concat(Opal.to_a(args)), block.$to_proc());
      }
    
    }, TMP_Object_method_missing_35.$$arity = -2);
    
    Opal.defn(self, '$nil?', TMP_Object_nil$q_36 = function() {
      var self = this;

      return false
    }, TMP_Object_nil$q_36.$$arity = 0);
    
    Opal.defn(self, '$is_a?', TMP_Object_is_a$q_37 = function(klass) {
      var self = this;

      return Opal.is_a(self, klass)
    }, TMP_Object_is_a$q_37.$$arity = 1);
    Opal.alias(self, "kind_of?", "is_a?");
    
    Opal.defn(self, '$instance_of?', TMP_Object_instance_of$q_38 = function(klass) {
      var self = this;

      return self.$$class === klass
    }, TMP_Object_instance_of$q_38.$$arity = 1);
    
    Opal.defn(self, '$class', TMP_Object_class_39 = function() {
      var self = this;

      return self.$$class
    }, TMP_Object_class_39.$$arity = 0);
    
    Opal.defn(self, '$to_a', TMP_Object_to_a_40 = function $$to_a(options) {
      var self = this, $iter = TMP_Object_to_a_40.$$p, block = $iter || nil;

      if (options == null) {
        options = $hash2([], {});
      }
      if ($iter) TMP_Object_to_a_40.$$p = null;
      return $send(Opal.const_get_qualified(Opal.const_get_qualified('::', 'Native'), 'Array'), 'new', [self["native"], options], block.$to_proc()).$to_a()
    }, TMP_Object_to_a_40.$$arity = -1);
    return (Opal.defn(self, '$inspect', TMP_Object_inspect_41 = function $$inspect() {
      var self = this;

      return "" + "#<Native:" + (String(self["native"])) + ">"
    }, TMP_Object_inspect_41.$$arity = 0), nil) && 'inspect';
  })(Opal.const_get_relative($nesting, 'Native'), Opal.const_get_relative($nesting, 'BasicObject'), $nesting);
  (function($base, $super, $parent_nesting) {
    function $Array(){};
    var self = $Array = $klass($base, $super, 'Array', $Array);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Array_initialize_42, TMP_Array_each_43, TMP_Array_$$_44, TMP_Array_$$$eq_45, TMP_Array_last_46, TMP_Array_length_47, TMP_Array_inspect_48;

    def.named = def["native"] = def.get = def.block = def.set = def.length = nil;
    
    self.$include(Opal.const_get_relative($nesting, 'Native'));
    self.$include(Opal.const_get_relative($nesting, 'Enumerable'));
    
    Opal.defn(self, '$initialize', TMP_Array_initialize_42 = function $$initialize(native$, options) {
      var $a, self = this, $iter = TMP_Array_initialize_42.$$p, block = $iter || nil;

      if (options == null) {
        options = $hash2([], {});
      }
      if ($iter) TMP_Array_initialize_42.$$p = null;
      
      $send(self, Opal.find_super_dispatcher(self, 'initialize', TMP_Array_initialize_42, false), [native$], null);
      self.get = ($truthy($a = options['$[]']("get")) ? $a : options['$[]']("access"));
      self.named = options['$[]']("named");
      self.set = ($truthy($a = options['$[]']("set")) ? $a : options['$[]']("access"));
      self.length = ($truthy($a = options['$[]']("length")) ? $a : "length");
      self.block = block;
      if ($truthy(self.$length() == null)) {
        return self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "no length found on the array-like object")
        } else {
        return nil
      };
    }, TMP_Array_initialize_42.$$arity = -2);
    
    Opal.defn(self, '$each', TMP_Array_each_43 = function $$each() {
      var self = this, $iter = TMP_Array_each_43.$$p, block = $iter || nil;

      if ($iter) TMP_Array_each_43.$$p = null;
      
      if ($truthy(block)) {
        } else {
        return self.$enum_for("each")
      };
      
      for (var i = 0, length = self.$length(); i < length; i++) {
        Opal.yield1(block, self['$[]'](i));
      }
    ;
      return self;
    }, TMP_Array_each_43.$$arity = 0);
    
    Opal.defn(self, '$[]', TMP_Array_$$_44 = function(index) {
      var self = this, result = nil, $case = nil;

      
      result = (function() {$case = index;
      if (Opal.const_get_relative($nesting, 'String')['$===']($case) || Opal.const_get_relative($nesting, 'Symbol')['$===']($case)) {if ($truthy(self.named)) {
        return self["native"][self.named](index)
        } else {
        return self["native"][index]
      }}
      else if (Opal.const_get_relative($nesting, 'Integer')['$===']($case)) {if ($truthy(self.get)) {
        return self["native"][self.get](index)
        } else {
        return self["native"][index]
      }}
      else { return nil }})();
      if ($truthy(result)) {
        if ($truthy(self.block)) {
          return self.block.$call(result)
          } else {
          return self.$Native(result)
        }
        } else {
        return nil
      };
    }, TMP_Array_$$_44.$$arity = 1);
    
    Opal.defn(self, '$[]=', TMP_Array_$$$eq_45 = function(index, value) {
      var self = this;

      if ($truthy(self.set)) {
        return self["native"][self.set](index, Opal.const_get_relative($nesting, 'Native').$convert(value))
        } else {
        return self["native"][index] = Opal.const_get_relative($nesting, 'Native').$convert(value)
      }
    }, TMP_Array_$$$eq_45.$$arity = 2);
    
    Opal.defn(self, '$last', TMP_Array_last_46 = function $$last(count) {
      var $a, self = this, index = nil, result = nil;

      if (count == null) {
        count = nil;
      }
      if ($truthy(count)) {
        
        index = $rb_minus(self.$length(), 1);
        result = [];
        while ($truthy($rb_ge(index, 0))) {
          
          result['$<<'](self['$[]'](index));
          index = $rb_minus(index, 1);
        };
        return result;
        } else {
        return self['$[]']($rb_minus(self.$length(), 1))
      }
    }, TMP_Array_last_46.$$arity = -1);
    
    Opal.defn(self, '$length', TMP_Array_length_47 = function $$length() {
      var self = this;

      return self["native"][self.length]
    }, TMP_Array_length_47.$$arity = 0);
    Opal.alias(self, "to_ary", "to_a");
    return (Opal.defn(self, '$inspect', TMP_Array_inspect_48 = function $$inspect() {
      var self = this;

      return self.$to_a().$inspect()
    }, TMP_Array_inspect_48.$$arity = 0), nil) && 'inspect';
  })(Opal.const_get_relative($nesting, 'Native'), null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Numeric(){};
    var self = $Numeric = $klass($base, $super, 'Numeric', $Numeric);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Numeric_to_n_49;

    return (Opal.defn(self, '$to_n', TMP_Numeric_to_n_49 = function $$to_n() {
      var self = this;

      return self.valueOf()
    }, TMP_Numeric_to_n_49.$$arity = 0), nil) && 'to_n'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Proc(){};
    var self = $Proc = $klass($base, $super, 'Proc', $Proc);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Proc_to_n_50;

    return (Opal.defn(self, '$to_n', TMP_Proc_to_n_50 = function $$to_n() {
      var self = this;

      return self
    }, TMP_Proc_to_n_50.$$arity = 0), nil) && 'to_n'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $String(){};
    var self = $String = $klass($base, $super, 'String', $String);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_String_to_n_51;

    return (Opal.defn(self, '$to_n', TMP_String_to_n_51 = function $$to_n() {
      var self = this;

      return self.valueOf()
    }, TMP_String_to_n_51.$$arity = 0), nil) && 'to_n'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Regexp(){};
    var self = $Regexp = $klass($base, $super, 'Regexp', $Regexp);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Regexp_to_n_52;

    return (Opal.defn(self, '$to_n', TMP_Regexp_to_n_52 = function $$to_n() {
      var self = this;

      return self.valueOf()
    }, TMP_Regexp_to_n_52.$$arity = 0), nil) && 'to_n'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $MatchData(){};
    var self = $MatchData = $klass($base, $super, 'MatchData', $MatchData);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_MatchData_to_n_53;

    def.matches = nil;
    return (Opal.defn(self, '$to_n', TMP_MatchData_to_n_53 = function $$to_n() {
      var self = this;

      return self.matches
    }, TMP_MatchData_to_n_53.$$arity = 0), nil) && 'to_n'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Struct(){};
    var self = $Struct = $klass($base, $super, 'Struct', $Struct);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Struct_to_n_55;

    return (Opal.defn(self, '$to_n', TMP_Struct_to_n_55 = function $$to_n() {
      var TMP_54, self = this, result = nil;

      
      result = {};
      $send(self, 'each_pair', [], (TMP_54 = function(name, value){var self = TMP_54.$$s || this;
if (name == null) name = nil;if (value == null) value = nil;
      return result[name] = Opal.const_get_relative($nesting, 'Native').$try_convert(value, value)}, TMP_54.$$s = self, TMP_54.$$arity = 2, TMP_54));
      return result;
    }, TMP_Struct_to_n_55.$$arity = 0), nil) && 'to_n'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Array(){};
    var self = $Array = $klass($base, $super, 'Array', $Array);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Array_to_n_56;

    return (Opal.defn(self, '$to_n', TMP_Array_to_n_56 = function $$to_n() {
      var self = this;

      
      var result = [];

      for (var i = 0, length = self.length; i < length; i++) {
        var obj = self[i];

        result.push(Opal.const_get_relative($nesting, 'Native').$try_convert(obj, obj));
      }

      return result;
    
    }, TMP_Array_to_n_56.$$arity = 0), nil) && 'to_n'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Boolean(){};
    var self = $Boolean = $klass($base, $super, 'Boolean', $Boolean);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Boolean_to_n_57;

    return (Opal.defn(self, '$to_n', TMP_Boolean_to_n_57 = function $$to_n() {
      var self = this;

      return self.valueOf()
    }, TMP_Boolean_to_n_57.$$arity = 0), nil) && 'to_n'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Time(){};
    var self = $Time = $klass($base, $super, 'Time', $Time);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Time_to_n_58;

    return (Opal.defn(self, '$to_n', TMP_Time_to_n_58 = function $$to_n() {
      var self = this;

      return self
    }, TMP_Time_to_n_58.$$arity = 0), nil) && 'to_n'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $NilClass(){};
    var self = $NilClass = $klass($base, $super, 'NilClass', $NilClass);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_NilClass_to_n_59;

    return (Opal.defn(self, '$to_n', TMP_NilClass_to_n_59 = function $$to_n() {
      var self = this;

      return null
    }, TMP_NilClass_to_n_59.$$arity = 0), nil) && 'to_n'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Hash(){};
    var self = $Hash = $klass($base, $super, 'Hash', $Hash);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Hash_initialize_60, TMP_Hash_to_n_61;

    
    self.$alias_method("_initialize", "initialize");
    
    Opal.defn(self, '$initialize', TMP_Hash_initialize_60 = function $$initialize(defaults) {
      var self = this, $iter = TMP_Hash_initialize_60.$$p, block = $iter || nil;

      if ($iter) TMP_Hash_initialize_60.$$p = null;
      
      if (defaults != null &&
           (defaults.constructor === undefined ||
             defaults.constructor === Object)) {
        var smap = self.$$smap,
            keys = self.$$keys,
            key, value;

        for (key in defaults) {
          value = defaults[key];

          if (value &&
               (value.constructor === undefined ||
                 value.constructor === Object)) {
            smap[key] = Opal.const_get_relative($nesting, 'Hash').$new(value);
          } else if (value && value.$$is_array) {
            value = value.map(function(item) {
              if (item &&
                   (item.constructor === undefined ||
                     item.constructor === Object)) {
                return Opal.const_get_relative($nesting, 'Hash').$new(item);
              }

              return self.$Native(item);
            });
            smap[key] = value
          } else {
            smap[key] = self.$Native(value);
          }

          keys.push(key);
        }

        return self;
      }

      return $send(self, '_initialize', [defaults], block.$to_proc());
    
    }, TMP_Hash_initialize_60.$$arity = -1);
    return (Opal.defn(self, '$to_n', TMP_Hash_to_n_61 = function $$to_n() {
      var self = this;

      
      var result = {},
          keys = self.$$keys,
          smap = self.$$smap,
          key, value;

      for (var i = 0, length = keys.length; i < length; i++) {
        key = keys[i];

        if (key.$$is_string) {
          value = smap[key];
        } else {
          key = key.key;
          value = key.value;
        }

        result[key] = Opal.const_get_relative($nesting, 'Native').$try_convert(value, value);
      }

      return result;
    
    }, TMP_Hash_to_n_61.$$arity = 0), nil) && 'to_n';
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Module(){};
    var self = $Module = $klass($base, $super, 'Module', $Module);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Module_native_module_62;

    return (Opal.defn(self, '$native_module', TMP_Module_native_module_62 = function $$native_module() {
      var self = this;

      return Opal.global[self.$name()] = self
    }, TMP_Module_native_module_62.$$arity = 0), nil) && 'native_module'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Class(){};
    var self = $Class = $klass($base, $super, 'Class', $Class);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Class_native_alias_63, TMP_Class_native_class_64;

    
    
    Opal.defn(self, '$native_alias', TMP_Class_native_alias_63 = function $$native_alias(new_jsid, existing_mid) {
      var self = this;

      
      var aliased = self.$$proto['$' + existing_mid];
      if (!aliased) {
        self.$raise(Opal.const_get_relative($nesting, 'NameError').$new("" + "undefined method `" + (existing_mid) + "' for class `" + (self.$inspect()) + "'", self.$exiting_mid()));
      }
      self.$$proto[new_jsid] = aliased;
    
    }, TMP_Class_native_alias_63.$$arity = 2);
    return (Opal.defn(self, '$native_class', TMP_Class_native_class_64 = function $$native_class() {
      var self = this;

      
      self.$native_module();
      return self["new"] = self.$new;;
    }, TMP_Class_native_class_64.$$arity = 0), nil) && 'native_class';
  })($nesting[0], null, $nesting);
  return ($gvars.$ = ($gvars.global = self.$Native(Opal.global)));
};

/* Generated by Opal 0.11.4 */
Opal.modules["opal/jquery/constants"] = function(Opal) {
  var $a, self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $truthy = Opal.truthy;

  Opal.add_stubs(['$require', '$raise']);
  
  self.$require("native");
  if ($truthy((($a = Opal.const_get_relative($nesting, 'JQUERY_CLASS', 'skip_raise')) ? 'constant' : nil))) {
    return nil
    } else {
    return (function() {
    if ($truthy(!!Opal.global.jQuery)) {return Opal.const_set($nesting[0], 'JQUERY_CLASS', Opal.const_set($nesting[0], 'JQUERY_SELECTOR', Opal.global.jQuery))}
    else if ($truthy(!!Opal.global.Zepto)) {
    Opal.const_set($nesting[0], 'JQUERY_SELECTOR', Opal.global.Zepto);
    return Opal.const_set($nesting[0], 'JQUERY_CLASS', Opal.global.Zepto.zepto.Z);}
    else {return self.$raise(Opal.const_get_relative($nesting, 'NameError'), "Can't find jQuery or Zepto. jQuery must be included before opal-jquery")}})()
  };
};

/* Generated by Opal 0.11.4 */
Opal.modules["opal/jquery/element"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $send = Opal.send, $truthy = Opal.truthy;

  Opal.add_stubs(['$require', '$to_n', '$include', '$each', '$alias_native', '$attr_reader', '$call', '$nil?', '$raise', '$is_a?', '$has_key?', '$delete', '$from_object', '$gsub', '$upcase', '$[]', '$compact', '$map', '$respond_to?', '$<<', '$Native', '$arity', '$new']);
  
  self.$require("native");
  self.$require("opal/jquery/constants");
  return (function($base, $super, $parent_nesting) {
    function $Element(){};
    var self = $Element = $klass($base, $super, 'Element', $Element);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Element_find_1, TMP_Element_$$_2, TMP_Element_id_3, TMP_Element_new_4, TMP_Element_parse_5, TMP_Element_expose_7, TMP_Element_prop_8, TMP_Element_to_n_9, TMP_Element_$$_10, TMP_Element_$$$eq_11, TMP_Element_attr_12, TMP_Element_has_attribute$q_13, TMP_Element_append_to_body_14, TMP_Element_append_to_head_15, TMP_Element_at_16, TMP_Element_class_name_17, TMP_Element_class_name$eq_18, TMP_Element_css_19, TMP_Element_animate_20, TMP_Element_data_21, TMP_Element_effect_22, TMP_Element_visible$q_25, TMP_Element_offset_26, TMP_Element_each_27, TMP_Element_first_28, TMP_Element_html_29, TMP_Element_id_30, TMP_Element_id$eq_31, TMP_Element_tag_name_32, TMP_Element_inspect_33, TMP_Element_to_s_34, TMP_Element_length_35, TMP_Element_any$q_36, TMP_Element_empty$q_37, TMP_Element_on_38, TMP_Element_one_39, TMP_Element_off_40, TMP_Element_serialize_array_42, TMP_Element_value_43, TMP_Element_height_44, TMP_Element_width_45, TMP_Element_position_46, TMP_Element_$eq$eq_47, TMP_Element_respond_to_missing$q_48, TMP_Element_method_missing_49;

    
    var $ = Opal.const_get_relative($nesting, 'JQUERY_SELECTOR').$to_n();
    self.$include(Opal.const_get_relative($nesting, 'Enumerable'));
    Opal.defs(self, '$find', TMP_Element_find_1 = function $$find(selector) {
      var self = this;

      return $(selector)
    }, TMP_Element_find_1.$$arity = 1);
    Opal.defs(self, '$[]', TMP_Element_$$_2 = function(selector) {
      var self = this;

      return $(selector)
    }, TMP_Element_$$_2.$$arity = 1);
    Opal.defs(self, '$id', TMP_Element_id_3 = function $$id(id) {
      var self = this;

      
      var el = document.getElementById(id);

      if (!el) {
        return nil;
      }

      return $(el);
    
    }, TMP_Element_id_3.$$arity = 1);
    Opal.defs(self, '$new', TMP_Element_new_4 = function(tag) {
      var self = this;

      if (tag == null) {
        tag = "div";
      }
      return $(document.createElement(tag))
    }, TMP_Element_new_4.$$arity = -1);
    Opal.defs(self, '$parse', TMP_Element_parse_5 = function $$parse(str) {
      var self = this;

      return $.parseHTML ? $($.parseHTML(str)) : $(str)
    }, TMP_Element_parse_5.$$arity = 1);
    Opal.defs(self, '$expose', TMP_Element_expose_7 = function $$expose($a_rest) {
      var TMP_6, self = this, methods;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      methods = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        methods[$arg_idx - 0] = arguments[$arg_idx];
      }
      return $send(methods, 'each', [], (TMP_6 = function(method){var self = TMP_6.$$s || this;
if (method == null) method = nil;
      return self.$alias_native(method)}, TMP_6.$$s = self, TMP_6.$$arity = 1, TMP_6))
    }, TMP_Element_expose_7.$$arity = -1);
    self.$attr_reader("selector");
    self.$alias_native("after");
    self.$alias_native("before");
    self.$alias_native("parent");
    self.$alias_native("parents");
    self.$alias_native("prev");
    self.$alias_native("remove");
    self.$alias_native("hide");
    self.$alias_native("show");
    self.$alias_native("toggle");
    self.$alias_native("children");
    self.$alias_native("blur");
    self.$alias_native("closest");
    self.$alias_native("detach");
    self.$alias_native("focus");
    self.$alias_native("find");
    self.$alias_native("next");
    self.$alias_native("siblings");
    self.$alias_native("text");
    self.$alias_native("trigger");
    self.$alias_native("append");
    self.$alias_native("prepend");
    self.$alias_native("serialize");
    self.$alias_native("is");
    self.$alias_native("filter");
    self.$alias_native("not");
    self.$alias_native("last");
    self.$alias_native("wrap");
    self.$alias_native("stop");
    self.$alias_native("clone");
    self.$alias_native("empty");
    self.$alias_native("get");
    
    Opal.defn(self, '$prop', TMP_Element_prop_8 = function $$prop($a_rest) {
      var self = this, args;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      return $send(Opal.const_get_relative($nesting, 'Native'), 'call', [self, "prop"].concat(Opal.to_a(args)))
    }, TMP_Element_prop_8.$$arity = -1);
    Opal.alias(self, "succ", "next");
    Opal.alias(self, "<<", "append");
    self.$alias_native("add_class", "addClass");
    self.$alias_native("append_to", "appendTo");
    self.$alias_native("has_class?", "hasClass");
    self.$alias_native("html=", "html");
    self.$alias_native("index");
    self.$alias_native("is?", "is");
    self.$alias_native("remove_attr", "removeAttr");
    self.$alias_native("remove_class", "removeClass");
    self.$alias_native("submit");
    self.$alias_native("click");
    self.$alias_native("text=", "text");
    self.$alias_native("toggle_class", "toggleClass");
    self.$alias_native("value=", "val");
    self.$alias_native("scroll_top=", "scrollTop");
    self.$alias_native("scroll_top", "scrollTop");
    self.$alias_native("scroll_left=", "scrollLeft");
    self.$alias_native("scroll_left", "scrollLeft");
    self.$alias_native("remove_attribute", "removeAttr");
    self.$alias_native("slide_down", "slideDown");
    self.$alias_native("slide_up", "slideUp");
    self.$alias_native("slide_toggle", "slideToggle");
    self.$alias_native("fade_toggle", "fadeToggle");
    self.$alias_native("height=", "height");
    self.$alias_native("width=", "width");
    self.$alias_native("outer_width", "outerWidth");
    self.$alias_native("outer_height", "outerHeight");
    
    Opal.defn(self, '$to_n', TMP_Element_to_n_9 = function $$to_n() {
      var self = this;

      return self
    }, TMP_Element_to_n_9.$$arity = 0);
    
    Opal.defn(self, '$[]', TMP_Element_$$_10 = function(name) {
      var self = this;

      
      var value = self.attr(name);
      if(value === undefined) return nil;
      return value;
    
    }, TMP_Element_$$_10.$$arity = 1);
    
    Opal.defn(self, '$[]=', TMP_Element_$$$eq_11 = function(name, value) {
      var self = this;

      
      if ($truthy(value['$nil?']())) {
        return self.removeAttr(name)};
      return self.attr(name, value);
    }, TMP_Element_$$$eq_11.$$arity = 2);
    
    Opal.defn(self, '$attr', TMP_Element_attr_12 = function $$attr($a_rest) {
      var self = this, args;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      
      var size = args.length;
      switch (size) {
      case 1:
        var result = self.attr(args[0]);
        return( (result == null) ? nil : result );
        break;
      case 2:
        return self.attr(args[0], args[1]);
        break;
      default:
        self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "#attr only accepts 1 or 2 arguments")
      }
    
    }, TMP_Element_attr_12.$$arity = -1);
    
    Opal.defn(self, '$has_attribute?', TMP_Element_has_attribute$q_13 = function(name) {
      var self = this;

      return self.attr(name) !== undefined
    }, TMP_Element_has_attribute$q_13.$$arity = 1);
    
    Opal.defn(self, '$append_to_body', TMP_Element_append_to_body_14 = function $$append_to_body() {
      var self = this;

      return self.appendTo(document.body)
    }, TMP_Element_append_to_body_14.$$arity = 0);
    
    Opal.defn(self, '$append_to_head', TMP_Element_append_to_head_15 = function $$append_to_head() {
      var self = this;

      return self.appendTo(document.head)
    }, TMP_Element_append_to_head_15.$$arity = 0);
    
    Opal.defn(self, '$at', TMP_Element_at_16 = function $$at(index) {
      var self = this;

      
      var length = self.length;

      if (index < 0) {
        index += length;
      }

      if (index < 0 || index >= length) {
        return nil;
      }

      return $(self[index]);
    
    }, TMP_Element_at_16.$$arity = 1);
    
    Opal.defn(self, '$class_name', TMP_Element_class_name_17 = function $$class_name() {
      var self = this;

      
      var first = self[0];
      return (first && first.className) || "";
    
    }, TMP_Element_class_name_17.$$arity = 0);
    
    Opal.defn(self, '$class_name=', TMP_Element_class_name$eq_18 = function(name) {
      var self = this;

      
      
      for (var i = 0, length = self.length; i < length; i++) {
        self[i].className = name;
      }
    ;
      return self;
    }, TMP_Element_class_name$eq_18.$$arity = 1);
    
    Opal.defn(self, '$css', TMP_Element_css_19 = function $$css(name, value) {
      var $a, self = this;

      if (value == null) {
        value = nil;
      }
      
      if ($truthy(($truthy($a = value['$nil?']()) ? name['$is_a?'](Opal.const_get_relative($nesting, 'String')) : $a))) {
        return self.css(name)
      } else if ($truthy(name['$is_a?'](Opal.const_get_relative($nesting, 'Hash')))) {
        self.css(name.$to_n())
        } else {
        self.css(name, value)
      };
      return self;
    }, TMP_Element_css_19.$$arity = -2);
    
    Opal.defn(self, '$animate', TMP_Element_animate_20 = function $$animate(params) {
      var self = this, $iter = TMP_Element_animate_20.$$p, block = $iter || nil, speed = nil;

      if ($iter) TMP_Element_animate_20.$$p = null;
      
      speed = (function() {if ($truthy(params['$has_key?']("speed"))) {
        return params.$delete("speed")
        } else {
        return 400
      }; return nil; })();
      if ((block !== nil)) {
        return self.animate(params.$to_n(), speed, block)
        } else {
        return self.animate(params.$to_n(), speed)
      };
    }, TMP_Element_animate_20.$$arity = 1);
    
    Opal.defn(self, '$data', TMP_Element_data_21 = function $$data($a_rest) {
      var self = this, args;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      
      var result = self.data.apply(self, args);
      if (
        (typeof(result) === 'object') && !(result instanceof Opal.const_get_relative($nesting, 'JQUERY_CLASS'))
      ) {
        result = Opal.const_get_relative($nesting, 'JSON').$from_object(result);
      }
      return result == null ? nil : result;
    
    }, TMP_Element_data_21.$$arity = -1);
    
    Opal.defn(self, '$effect', TMP_Element_effect_22 = function $$effect(name, $a_rest) {
      var TMP_23, TMP_24, self = this, args, $iter = TMP_Element_effect_22.$$p, block = $iter || nil;

      var $args_len = arguments.length, $rest_len = $args_len - 1;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 1] = arguments[$arg_idx];
      }
      if ($iter) TMP_Element_effect_22.$$p = null;
      
      name = $send(name, 'gsub', [/_\w/], (TMP_23 = function(match){var self = TMP_23.$$s || this;
if (match == null) match = nil;
      return match['$[]'](1).$upcase()}, TMP_23.$$s = self, TMP_23.$$arity = 1, TMP_23));
      args = $send(args, 'map', [], (TMP_24 = function(a){var self = TMP_24.$$s || this;
if (a == null) a = nil;
      if ($truthy(a['$respond_to?']("to_n"))) {
          return a.$to_n()
          } else {
          return nil
        }}, TMP_24.$$s = self, TMP_24.$$arity = 1, TMP_24)).$compact();
      args['$<<'](function() { (function() {if ((block !== nil)) {
        return block.$call()
        } else {
        return nil
      }; return nil; })() });
      return self[name].apply(self, args);
    }, TMP_Element_effect_22.$$arity = -2);
    
    Opal.defn(self, '$visible?', TMP_Element_visible$q_25 = function() {
      var self = this;

      return self.is(':visible')
    }, TMP_Element_visible$q_25.$$arity = 0);
    
    Opal.defn(self, '$offset', TMP_Element_offset_26 = function $$offset() {
      var self = this;

      return self.$Native(self.offset())
    }, TMP_Element_offset_26.$$arity = 0);
    
    Opal.defn(self, '$each', TMP_Element_each_27 = function $$each() {
      var self = this, $iter = TMP_Element_each_27.$$p, $yield = $iter || nil;

      if ($iter) TMP_Element_each_27.$$p = null;
      
      for (var i = 0, length = self.length; i < length; i++) {;
      Opal.yield1($yield, $(self[i]));
      };
      return self;
    }, TMP_Element_each_27.$$arity = 0);
    
    Opal.defn(self, '$first', TMP_Element_first_28 = function $$first() {
      var self = this;

      return self.length ? self.first() : nil
    }, TMP_Element_first_28.$$arity = 0);
    
    Opal.defn(self, '$html', TMP_Element_html_29 = function $$html(content) {
      var self = this;

      
      if (content != null) {
        return self.html(content);
      }

      return self.html() || '';
    
    }, TMP_Element_html_29.$$arity = -1);
    
    Opal.defn(self, '$id', TMP_Element_id_30 = function $$id() {
      var self = this;

      
      var first = self[0];
      return (first && first.id) || "";
    
    }, TMP_Element_id_30.$$arity = 0);
    
    Opal.defn(self, '$id=', TMP_Element_id$eq_31 = function(id) {
      var self = this;

      
      var first = self[0];

      if (first) {
        first.id = id;
      }

      return self;
    
    }, TMP_Element_id$eq_31.$$arity = 1);
    
    Opal.defn(self, '$tag_name', TMP_Element_tag_name_32 = function $$tag_name() {
      var self = this;

      return self.length > 0 ? self[0].tagName.toLowerCase() : nil
    }, TMP_Element_tag_name_32.$$arity = 0);
    
    Opal.defn(self, '$inspect', TMP_Element_inspect_33 = function $$inspect() {
      var self = this;

      
      if      (self[0] === document) return '#<Element [document]>'
      else if (self[0] === window  ) return '#<Element [window]>'

      var val, el, str, result = [];

      for (var i = 0, length = self.length; i < length; i++) {
        el  = self[i];
        if (!el.tagName) { return '#<Element ['+el.toString()+']'; }

        str = "<" + el.tagName.toLowerCase();

        if (val = el.id) str += (' id="' + val + '"');
        if (val = el.className) str += (' class="' + val + '"');

        result.push(str + '>');
      }

      return '#<Element [' + result.join(', ') + ']>';
    
    }, TMP_Element_inspect_33.$$arity = 0);
    
    Opal.defn(self, '$to_s', TMP_Element_to_s_34 = function $$to_s() {
      var self = this;

      
      var val, el, result = [];

      for (var i = 0, length = self.length; i < length; i++) {
        el  = self[i];

        result.push(el.outerHTML)
      }

      return result.join(', ');
    
    }, TMP_Element_to_s_34.$$arity = 0);
    
    Opal.defn(self, '$length', TMP_Element_length_35 = function $$length() {
      var self = this;

      return self.length
    }, TMP_Element_length_35.$$arity = 0);
    
    Opal.defn(self, '$any?', TMP_Element_any$q_36 = function() {
      var self = this;

      return self.length > 0
    }, TMP_Element_any$q_36.$$arity = 0);
    
    Opal.defn(self, '$empty?', TMP_Element_empty$q_37 = function() {
      var self = this;

      return self.length === 0
    }, TMP_Element_empty$q_37.$$arity = 0);
    Opal.alias(self, "empty?", "none?");
    
    Opal.defn(self, '$on', TMP_Element_on_38 = function $$on(name, sel) {
      var self = this, $iter = TMP_Element_on_38.$$p, block = $iter || nil;

      if (sel == null) {
        sel = nil;
      }
      if ($iter) TMP_Element_on_38.$$p = null;
      
      
      var has_args = block.$arity() !== 0;

      var wrapper = function() {
        for(var args = new Array(arguments.length), i = 0, ii = args.length; i < ii; i++) {
          args[i] = arguments[i];
        }

        // Use preventDefault as a canary for native events
        if (has_args && args[0].preventDefault) {
          args[0] = Opal.const_get_relative($nesting, 'Event').$new(args[0]);
        }

        return block.apply(null, args);
      };

      block.$$jqwrap = wrapper;

      if (sel == nil) {
        self.on(name, wrapper);
      }
      else {
        self.on(name, sel, wrapper);
      }
    ;
      return block;
    }, TMP_Element_on_38.$$arity = -2);
    
    Opal.defn(self, '$one', TMP_Element_one_39 = function $$one(name, sel) {
      var self = this, $iter = TMP_Element_one_39.$$p, block = $iter || nil;

      if (sel == null) {
        sel = nil;
      }
      if ($iter) TMP_Element_one_39.$$p = null;
      
      
      var has_args = block.$arity() !== 0;

      var wrapper = function() {
        for(var args = new Array(arguments.length), i = 0, ii = args.length; i < ii; i++) {
          args[i] = arguments[i];
        }

        // Use preventDefault as a canary for native events
        if (has_args && args[0].preventDefault) {
          args[0] = Opal.const_get_relative($nesting, 'Event').$new(args[0]);
        }

        return block.apply(null, args);
      };

      block.$$jqwrap = wrapper;

      if (sel == nil) {
        self.one(name, wrapper);
      }
      else {
        self.one(name, sel, wrapper);
      }
    ;
      return block;
    }, TMP_Element_one_39.$$arity = -2);
    
    Opal.defn(self, '$off', TMP_Element_off_40 = function $$off(name, sel, block) {
      var self = this;

      if (block == null) {
        block = nil;
      }
      
      if (sel == null) {
        return self.off(name);
      }
      else if (block === nil) {
        return self.off(name, sel.$$jqwrap);
      }
      else {
        return self.off(name, sel, block.$$jqwrap);
      }
    
    }, TMP_Element_off_40.$$arity = -3);
    
    Opal.defn(self, '$serialize_array', TMP_Element_serialize_array_42 = function $$serialize_array() {
      var TMP_41, self = this;

      return $send((self.serializeArray()), 'map', [], (TMP_41 = function(e){var self = TMP_41.$$s || this;
if (e == null) e = nil;
      return Opal.const_get_relative($nesting, 'Hash').$new(e)}, TMP_41.$$s = self, TMP_41.$$arity = 1, TMP_41))
    }, TMP_Element_serialize_array_42.$$arity = 0);
    Opal.alias(self, "size", "length");
    
    Opal.defn(self, '$value', TMP_Element_value_43 = function $$value() {
      var $a, self = this;

      return ($truthy($a = self.val()) ? $a : "")
    }, TMP_Element_value_43.$$arity = 0);
    
    Opal.defn(self, '$height', TMP_Element_height_44 = function $$height() {
      var $a, self = this;

      return ($truthy($a = self.height()) ? $a : nil)
    }, TMP_Element_height_44.$$arity = 0);
    
    Opal.defn(self, '$width', TMP_Element_width_45 = function $$width() {
      var $a, self = this;

      return ($truthy($a = self.width()) ? $a : nil)
    }, TMP_Element_width_45.$$arity = 0);
    
    Opal.defn(self, '$position', TMP_Element_position_46 = function $$position() {
      var self = this;

      return self.$Native(self.position())
    }, TMP_Element_position_46.$$arity = 0);
    
    Opal.defn(self, '$==', TMP_Element_$eq$eq_47 = function(other) {
      var self = this;

      return self.is(other)
    }, TMP_Element_$eq$eq_47.$$arity = 1);
    
    Opal.defn(self, '$respond_to_missing?', TMP_Element_respond_to_missing$q_48 = function(name, _) {
      var self = this, $iter = TMP_Element_respond_to_missing$q_48.$$p, $yield = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

      if ($iter) TMP_Element_respond_to_missing$q_48.$$p = null;
      // Prepare super implicit arguments
      for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
        $zuper[$zuper_i] = arguments[$zuper_i];
      }
      
      var method = self[name];
      if (typeof(method) === 'function') {
        return true;
      } else {
        return $send(self, Opal.find_super_dispatcher(self, 'respond_to_missing?', TMP_Element_respond_to_missing$q_48, false), $zuper, $iter);
      }
    
    }, TMP_Element_respond_to_missing$q_48.$$arity = 2);
    return (Opal.defn(self, '$method_missing', TMP_Element_method_missing_49 = function $$method_missing(name, $a_rest) {
      var self = this, args, $iter = TMP_Element_method_missing_49.$$p, block = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

      var $args_len = arguments.length, $rest_len = $args_len - 1;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 1] = arguments[$arg_idx];
      }
      if ($iter) TMP_Element_method_missing_49.$$p = null;
      // Prepare super implicit arguments
      for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
        $zuper[$zuper_i] = arguments[$zuper_i];
      }
      
      if ((block !== nil)) {
        args['$<<'](block)};
      
      var method = self[name];
      if (typeof(method) === 'function') {
        return method.apply(self, args.$to_n());
      } else {
        return $send(self, Opal.find_super_dispatcher(self, 'method_missing', TMP_Element_method_missing_49, false), $zuper, $iter);
      }
    ;
    }, TMP_Element_method_missing_49.$$arity = -2), nil) && 'method_missing';
  })($nesting[0], Opal.const_get_relative($nesting, 'JQUERY_CLASS').$to_n(), $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["opal/jquery/window"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $gvars = Opal.gvars;

  Opal.add_stubs(['$require', '$include', '$find', '$on', '$element', '$to_proc', '$off', '$trigger', '$new']);
  
  self.$require("opal/jquery/element");
  (function($base, $parent_nesting) {
    var $Browser, self = $Browser = $module($base, 'Browser');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Window(){};
      var self = $Window = $klass($base, $super, 'Window', $Window);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Window_element_1, TMP_Window_on_2, TMP_Window_off_3, TMP_Window_trigger_4;

      def.element = nil;
      
      self.$include(Opal.const_get_relative($nesting, 'Native'));
      
      Opal.defn(self, '$element', TMP_Window_element_1 = function $$element() {
        var $a, self = this;

        return (self.element = ($truthy($a = self.element) ? $a : Opal.const_get_relative($nesting, 'Element').$find(window)))
      }, TMP_Window_element_1.$$arity = 0);
      
      Opal.defn(self, '$on', TMP_Window_on_2 = function $$on($a_rest) {
        var self = this, args, $iter = TMP_Window_on_2.$$p, block = $iter || nil;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 0] = arguments[$arg_idx];
        }
        if ($iter) TMP_Window_on_2.$$p = null;
        return $send(self.$element(), 'on', Opal.to_a(args), block.$to_proc())
      }, TMP_Window_on_2.$$arity = -1);
      
      Opal.defn(self, '$off', TMP_Window_off_3 = function $$off($a_rest) {
        var self = this, args, $iter = TMP_Window_off_3.$$p, block = $iter || nil;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 0] = arguments[$arg_idx];
        }
        if ($iter) TMP_Window_off_3.$$p = null;
        return $send(self.$element(), 'off', Opal.to_a(args), block.$to_proc())
      }, TMP_Window_off_3.$$arity = -1);
      return (Opal.defn(self, '$trigger', TMP_Window_trigger_4 = function $$trigger($a_rest) {
        var self = this, args;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 0] = arguments[$arg_idx];
        }
        return $send(self.$element(), 'trigger', Opal.to_a(args))
      }, TMP_Window_trigger_4.$$arity = -1), nil) && 'trigger';
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting);
  Opal.const_set($nesting[0], 'Window', Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Browser'), 'Window').$new(window));
  return ($gvars.window = Opal.const_get_relative($nesting, 'Window'));
};

/* Generated by Opal 0.11.4 */
Opal.modules["opal/jquery/document"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send, $gvars = Opal.gvars;

  Opal.add_stubs(['$require', '$to_n', '$call', '$new', '$ready?', '$resolve', '$module_function', '$find', '$extend']);
  
  self.$require("opal/jquery/constants");
  self.$require("opal/jquery/element");
  (function($base, $parent_nesting) {
    var $Browser, self = $Browser = $module($base, 'Browser');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $DocumentMethods, self = $DocumentMethods = $module($base, 'DocumentMethods');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_DocumentMethods_ready$q_1, TMP_DocumentMethods_ready_3, TMP_DocumentMethods_4, TMP_DocumentMethods_title_5, TMP_DocumentMethods_title$eq_6, TMP_DocumentMethods_head_7, TMP_DocumentMethods_body_8;

      
      var $ = Opal.const_get_relative($nesting, 'JQUERY_SELECTOR').$to_n();
      
      Opal.defn(self, '$ready?', TMP_DocumentMethods_ready$q_1 = function() {
        var $a, self = this, $iter = TMP_DocumentMethods_ready$q_1.$$p, block = $iter || nil;

        if ($iter) TMP_DocumentMethods_ready$q_1.$$p = null;
        if ((block !== nil)) {
          if ($truthy((($a = $DocumentMethods.$$cvars['@@__isReady']) == null ? nil : $a))) {
            return block.$call()
            } else {
            return $(block)
          }
          } else {
          return nil
        }
      }, TMP_DocumentMethods_ready$q_1.$$arity = 0);
      
      Opal.defn(self, '$ready', TMP_DocumentMethods_ready_3 = function $$ready() {
        var TMP_2, self = this, promise = nil;

        
        promise = Opal.const_get_relative($nesting, 'Promise').$new();
        $send(Opal.const_get_relative($nesting, 'Document'), 'ready?', [], (TMP_2 = function(){var self = TMP_2.$$s || this;

        return promise.$resolve()}, TMP_2.$$s = self, TMP_2.$$arity = 0, TMP_2));
        return promise;
      }, TMP_DocumentMethods_ready_3.$$arity = 0);
      self.$module_function("ready?");
      $send(self, 'ready?', [], (TMP_DocumentMethods_4 = function(){var self = TMP_DocumentMethods_4.$$s || this;

      return (Opal.class_variable_set($DocumentMethods, '@@__isReady', true))}, TMP_DocumentMethods_4.$$s = self, TMP_DocumentMethods_4.$$arity = 0, TMP_DocumentMethods_4));
      
      Opal.defn(self, '$title', TMP_DocumentMethods_title_5 = function $$title() {
        var self = this;

        return document.title
      }, TMP_DocumentMethods_title_5.$$arity = 0);
      
      Opal.defn(self, '$title=', TMP_DocumentMethods_title$eq_6 = function(title) {
        var self = this;

        return document.title = title
      }, TMP_DocumentMethods_title$eq_6.$$arity = 1);
      
      Opal.defn(self, '$head', TMP_DocumentMethods_head_7 = function $$head() {
        var self = this;

        return Opal.const_get_relative($nesting, 'Element').$find(document.head)
      }, TMP_DocumentMethods_head_7.$$arity = 0);
      
      Opal.defn(self, '$body', TMP_DocumentMethods_body_8 = function $$body() {
        var self = this;

        return Opal.const_get_relative($nesting, 'Element').$find(document.body)
      }, TMP_DocumentMethods_body_8.$$arity = 0);
    })($nesting[0], $nesting)
  })($nesting[0], $nesting);
  Opal.const_set($nesting[0], 'Document', Opal.const_get_relative($nesting, 'Element').$find(document));
  Opal.const_get_relative($nesting, 'Document').$extend(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Browser'), 'DocumentMethods'));
  return ($gvars.document = Opal.const_get_relative($nesting, 'Document'));
};

/* Generated by Opal 0.11.4 */
Opal.modules["opal/jquery/event"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  Opal.add_stubs(['$require', '$to_n', '$stop', '$prevent']);
  
  self.$require("opal/jquery/constants");
  return (function($base, $super, $parent_nesting) {
    function $Event(){};
    var self = $Event = $klass($base, $super, 'Event', $Event);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Event_initialize_1, TMP_Event_to_n_2, TMP_Event_$$_3, TMP_Event_type_4, TMP_Event_element_5, TMP_Event_target_6, TMP_Event_prevented$q_7, TMP_Event_prevent_8, TMP_Event_stopped$q_9, TMP_Event_stop_10, TMP_Event_stop_immediate_11, TMP_Event_kill_12, TMP_Event_page_x_13, TMP_Event_page_y_14, TMP_Event_touch_x_15, TMP_Event_touch_y_16, TMP_Event_ctrl_key_17, TMP_Event_meta_key_18, TMP_Event_alt_key_19, TMP_Event_shift_key_20, TMP_Event_key_code_21, TMP_Event_which_22;

    def["native"] = nil;
    
    var $ = Opal.const_get_relative($nesting, 'JQUERY_SELECTOR').$to_n();
    
    Opal.defn(self, '$initialize', TMP_Event_initialize_1 = function $$initialize(native$) {
      var self = this;

      return (self["native"] = native$)
    }, TMP_Event_initialize_1.$$arity = 1);
    
    Opal.defn(self, '$to_n', TMP_Event_to_n_2 = function $$to_n() {
      var self = this;

      return self["native"]
    }, TMP_Event_to_n_2.$$arity = 0);
    
    Opal.defn(self, '$[]', TMP_Event_$$_3 = function(name) {
      var self = this;

      return self["native"][name]
    }, TMP_Event_$$_3.$$arity = 1);
    
    Opal.defn(self, '$type', TMP_Event_type_4 = function $$type() {
      var self = this;

      return self["native"].type
    }, TMP_Event_type_4.$$arity = 0);
    
    Opal.defn(self, '$element', TMP_Event_element_5 = function $$element() {
      var self = this;

      return $(self["native"].currentTarget)
    }, TMP_Event_element_5.$$arity = 0);
    Opal.alias(self, "current_target", "element");
    
    Opal.defn(self, '$target', TMP_Event_target_6 = function $$target() {
      var self = this;

      return $(self["native"].target)
    }, TMP_Event_target_6.$$arity = 0);
    
    Opal.defn(self, '$prevented?', TMP_Event_prevented$q_7 = function() {
      var self = this;

      return self["native"].isDefaultPrevented()
    }, TMP_Event_prevented$q_7.$$arity = 0);
    
    Opal.defn(self, '$prevent', TMP_Event_prevent_8 = function $$prevent() {
      var self = this;

      return self["native"].preventDefault()
    }, TMP_Event_prevent_8.$$arity = 0);
    
    Opal.defn(self, '$stopped?', TMP_Event_stopped$q_9 = function() {
      var self = this;

      return self["native"].isPropagationStopped()
    }, TMP_Event_stopped$q_9.$$arity = 0);
    
    Opal.defn(self, '$stop', TMP_Event_stop_10 = function $$stop() {
      var self = this;

      return self["native"].stopPropagation()
    }, TMP_Event_stop_10.$$arity = 0);
    
    Opal.defn(self, '$stop_immediate', TMP_Event_stop_immediate_11 = function $$stop_immediate() {
      var self = this;

      return self["native"].stopImmediatePropagation()
    }, TMP_Event_stop_immediate_11.$$arity = 0);
    
    Opal.defn(self, '$kill', TMP_Event_kill_12 = function $$kill() {
      var self = this;

      
      self.$stop();
      return self.$prevent();
    }, TMP_Event_kill_12.$$arity = 0);
    
    Opal.defn(self, '$page_x', TMP_Event_page_x_13 = function $$page_x() {
      var self = this;

      return self["native"].pageX
    }, TMP_Event_page_x_13.$$arity = 0);
    
    Opal.defn(self, '$page_y', TMP_Event_page_y_14 = function $$page_y() {
      var self = this;

      return self["native"].pageY
    }, TMP_Event_page_y_14.$$arity = 0);
    
    Opal.defn(self, '$touch_x', TMP_Event_touch_x_15 = function $$touch_x() {
      var self = this;

      return self["native"].originalEvent.touches[0].pageX
    }, TMP_Event_touch_x_15.$$arity = 0);
    
    Opal.defn(self, '$touch_y', TMP_Event_touch_y_16 = function $$touch_y() {
      var self = this;

      return self["native"].originalEvent.touches[0].pageY
    }, TMP_Event_touch_y_16.$$arity = 0);
    
    Opal.defn(self, '$ctrl_key', TMP_Event_ctrl_key_17 = function $$ctrl_key() {
      var self = this;

      return self["native"].ctrlKey
    }, TMP_Event_ctrl_key_17.$$arity = 0);
    
    Opal.defn(self, '$meta_key', TMP_Event_meta_key_18 = function $$meta_key() {
      var self = this;

      return self["native"].metaKey
    }, TMP_Event_meta_key_18.$$arity = 0);
    
    Opal.defn(self, '$alt_key', TMP_Event_alt_key_19 = function $$alt_key() {
      var self = this;

      return self["native"].altKey
    }, TMP_Event_alt_key_19.$$arity = 0);
    
    Opal.defn(self, '$shift_key', TMP_Event_shift_key_20 = function $$shift_key() {
      var self = this;

      return self["native"].shiftKey
    }, TMP_Event_shift_key_20.$$arity = 0);
    
    Opal.defn(self, '$key_code', TMP_Event_key_code_21 = function $$key_code() {
      var self = this;

      return self["native"].keyCode
    }, TMP_Event_key_code_21.$$arity = 0);
    
    Opal.defn(self, '$which', TMP_Event_which_22 = function $$which() {
      var self = this;

      return self["native"].which
    }, TMP_Event_which_22.$$arity = 0);
    Opal.alias(self, "default_prevented?", "prevented?");
    Opal.alias(self, "prevent_default", "prevent");
    Opal.alias(self, "propagation_stopped?", "stopped?");
    Opal.alias(self, "stop_propagation", "stop");
    return Opal.alias(self, "stop_immediate_propagation", "stop_immediate");
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["json"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $truthy = Opal.truthy, $hash2 = Opal.hash2;

  Opal.add_stubs(['$raise', '$new', '$push', '$[]=', '$-', '$[]', '$create_id', '$json_create', '$const_get', '$attr_accessor', '$create_id=', '$===', '$parse', '$generate', '$from_object', '$merge', '$to_json', '$responds_to?', '$to_io', '$write', '$to_s', '$to_a', '$strftime']);
  
  (function($base, $parent_nesting) {
    var $JSON, self = $JSON = $module($base, 'JSON');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_JSON_$$_1, TMP_JSON_parse_2, TMP_JSON_parse$B_3, TMP_JSON_load_4, TMP_JSON_from_object_5, TMP_JSON_generate_6, TMP_JSON_dump_7, $writer = nil;

    
    (function($base, $super, $parent_nesting) {
      function $JSONError(){};
      var self = $JSONError = $klass($base, $super, 'JSONError', $JSONError);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return nil
    })($nesting[0], Opal.const_get_relative($nesting, 'StandardError'), $nesting);
    (function($base, $super, $parent_nesting) {
      function $ParserError(){};
      var self = $ParserError = $klass($base, $super, 'ParserError', $ParserError);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return nil
    })($nesting[0], Opal.const_get_relative($nesting, 'JSONError'), $nesting);
    
    var $hasOwn = Opal.hasOwnProperty;

    function $parse(source) {
      try {
        return JSON.parse(source);
      } catch (e) {
        self.$raise(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'JSON'), 'ParserError'), e.message);
      }
    };

    function to_opal(value, options) {
      var klass, arr, hash, i, ii, k;

      switch (typeof value) {
        case 'string':
          return value;

        case 'number':
          return value;

        case 'boolean':
          return !!value;

        case 'null':
          return nil;

        case 'object':
          if (!value) return nil;

          if (value.$$is_array) {
            arr = (options.array_class).$new();

            for (i = 0, ii = value.length; i < ii; i++) {
              (arr).$push(to_opal(value[i], options));
            }

            return arr;
          }
          else {
            hash = (options.object_class).$new();

            for (k in value) {
              if ($hasOwn.call(value, k)) {
                (($writer = [k, to_opal(value[k], options)]), $send((hash), '[]=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]);
              }
            }

            if (!options.parse && (klass = (hash)['$[]'](Opal.const_get_relative($nesting, 'JSON').$create_id())) != nil) {
              return Opal.const_get_qualified('::', 'Object').$const_get(klass).$json_create(hash);
            }
            else {
              return hash;
            }
          }
        }
    };
  ;
    (function(self, $parent_nesting) {
      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return self.$attr_accessor("create_id")
    })(Opal.get_singleton_class(self), $nesting);
    
    $writer = ["json_class"];
    $send(self, 'create_id=', Opal.to_a($writer));
    $writer[$rb_minus($writer["length"], 1)];;
    Opal.defs(self, '$[]', TMP_JSON_$$_1 = function(value, options) {
      var self = this;

      if (options == null) {
        options = $hash2([], {});
      }
      if ($truthy(Opal.const_get_relative($nesting, 'String')['$==='](value))) {
        return self.$parse(value, options)
        } else {
        return self.$generate(value, options)
      }
    }, TMP_JSON_$$_1.$$arity = -2);
    Opal.defs(self, '$parse', TMP_JSON_parse_2 = function $$parse(source, options) {
      var self = this;

      if (options == null) {
        options = $hash2([], {});
      }
      return self.$from_object($parse(source), options.$merge($hash2(["parse"], {"parse": true})))
    }, TMP_JSON_parse_2.$$arity = -2);
    Opal.defs(self, '$parse!', TMP_JSON_parse$B_3 = function(source, options) {
      var self = this;

      if (options == null) {
        options = $hash2([], {});
      }
      return self.$parse(source, options)
    }, TMP_JSON_parse$B_3.$$arity = -2);
    Opal.defs(self, '$load', TMP_JSON_load_4 = function $$load(source, options) {
      var self = this;

      if (options == null) {
        options = $hash2([], {});
      }
      return self.$from_object($parse(source), options)
    }, TMP_JSON_load_4.$$arity = -2);
    Opal.defs(self, '$from_object', TMP_JSON_from_object_5 = function $$from_object(js_object, options) {
      var $a, self = this, $writer = nil;

      if (options == null) {
        options = $hash2([], {});
      }
      
      ($truthy($a = options['$[]']("object_class")) ? $a : (($writer = ["object_class", Opal.const_get_relative($nesting, 'Hash')]), $send(options, '[]=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]));
      ($truthy($a = options['$[]']("array_class")) ? $a : (($writer = ["array_class", Opal.const_get_relative($nesting, 'Array')]), $send(options, '[]=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]));
      return to_opal(js_object, options.$$smap);
    }, TMP_JSON_from_object_5.$$arity = -2);
    Opal.defs(self, '$generate', TMP_JSON_generate_6 = function $$generate(obj, options) {
      var self = this;

      if (options == null) {
        options = $hash2([], {});
      }
      return obj.$to_json(options)
    }, TMP_JSON_generate_6.$$arity = -2);
    Opal.defs(self, '$dump', TMP_JSON_dump_7 = function $$dump(obj, io, limit) {
      var self = this, string = nil;

      if (io == null) {
        io = nil;
      }
      if (limit == null) {
        limit = nil;
      }
      
      string = self.$generate(obj);
      if ($truthy(io)) {
        
        if ($truthy(io['$responds_to?']("to_io"))) {
          io = io.$to_io()};
        io.$write(string);
        return io;
        } else {
        return string
      };
    }, TMP_JSON_dump_7.$$arity = -2);
  })($nesting[0], $nesting);
  (function($base, $super, $parent_nesting) {
    function $Object(){};
    var self = $Object = $klass($base, $super, 'Object', $Object);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Object_to_json_8;

    return (Opal.defn(self, '$to_json', TMP_Object_to_json_8 = function $$to_json() {
      var self = this;

      return self.$to_s().$to_json()
    }, TMP_Object_to_json_8.$$arity = 0), nil) && 'to_json'
  })($nesting[0], null, $nesting);
  (function($base, $parent_nesting) {
    var $Enumerable, self = $Enumerable = $module($base, 'Enumerable');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Enumerable_to_json_9;

    
    Opal.defn(self, '$to_json', TMP_Enumerable_to_json_9 = function $$to_json() {
      var self = this;

      return self.$to_a().$to_json()
    }, TMP_Enumerable_to_json_9.$$arity = 0)
  })($nesting[0], $nesting);
  (function($base, $super, $parent_nesting) {
    function $Array(){};
    var self = $Array = $klass($base, $super, 'Array', $Array);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Array_to_json_10;

    return (Opal.defn(self, '$to_json', TMP_Array_to_json_10 = function $$to_json() {
      var self = this;

      
      var result = [];

      for (var i = 0, length = self.length; i < length; i++) {
        result.push((self[i]).$to_json());
      }

      return '[' + result.join(', ') + ']';
    
    }, TMP_Array_to_json_10.$$arity = 0), nil) && 'to_json'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Boolean(){};
    var self = $Boolean = $klass($base, $super, 'Boolean', $Boolean);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Boolean_to_json_11;

    return (Opal.defn(self, '$to_json', TMP_Boolean_to_json_11 = function $$to_json() {
      var self = this;

      return (self == true) ? 'true' : 'false'
    }, TMP_Boolean_to_json_11.$$arity = 0), nil) && 'to_json'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Hash(){};
    var self = $Hash = $klass($base, $super, 'Hash', $Hash);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Hash_to_json_12;

    return (Opal.defn(self, '$to_json', TMP_Hash_to_json_12 = function $$to_json() {
      var self = this;

      
      var result = [];

      for (var i = 0, keys = self.$$keys, length = keys.length, key, value; i < length; i++) {
        key = keys[i];

        if (key.$$is_string) {
          value = self.$$smap[key];
        } else {
          value = key.value;
          key = key.key;
        }

        result.push((key).$to_s().$to_json() + ':' + (value).$to_json());
      }

      return '{' + result.join(', ') + '}';
    
    }, TMP_Hash_to_json_12.$$arity = 0), nil) && 'to_json'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $NilClass(){};
    var self = $NilClass = $klass($base, $super, 'NilClass', $NilClass);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_NilClass_to_json_13;

    return (Opal.defn(self, '$to_json', TMP_NilClass_to_json_13 = function $$to_json() {
      var self = this;

      return "null"
    }, TMP_NilClass_to_json_13.$$arity = 0), nil) && 'to_json'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Numeric(){};
    var self = $Numeric = $klass($base, $super, 'Numeric', $Numeric);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Numeric_to_json_14;

    return (Opal.defn(self, '$to_json', TMP_Numeric_to_json_14 = function $$to_json() {
      var self = this;

      return self.toString()
    }, TMP_Numeric_to_json_14.$$arity = 0), nil) && 'to_json'
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $String(){};
    var self = $String = $klass($base, $super, 'String', $String);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    return Opal.alias(self, "to_json", "inspect")
  })($nesting[0], null, $nesting);
  (function($base, $super, $parent_nesting) {
    function $Time(){};
    var self = $Time = $klass($base, $super, 'Time', $Time);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Time_to_json_15;

    return (Opal.defn(self, '$to_json', TMP_Time_to_json_15 = function $$to_json() {
      var self = this;

      return self.$strftime("%FT%T%z").$to_json()
    }, TMP_Time_to_json_15.$$arity = 0), nil) && 'to_json'
  })($nesting[0], null, $nesting);
  return (function($base, $super, $parent_nesting) {
    function $Date(){};
    var self = $Date = $klass($base, $super, 'Date', $Date);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Date_to_json_16, TMP_Date_as_json_17;

    
    
    Opal.defn(self, '$to_json', TMP_Date_to_json_16 = function $$to_json() {
      var self = this;

      return self.$to_s().$to_json()
    }, TMP_Date_to_json_16.$$arity = 0);
    return (Opal.defn(self, '$as_json', TMP_Date_as_json_17 = function $$as_json() {
      var self = this;

      return self.$to_s()
    }, TMP_Date_as_json_17.$$arity = 0), nil) && 'as_json';
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["promise"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_le(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$resolve', '$new', '$reject', '$attr_reader', '$===', '$value', '$has_key?', '$keys', '$!', '$==', '$<<', '$>>', '$exception?', '$[]', '$resolved?', '$rejected?', '$error', '$include?', '$action', '$realized?', '$raise', '$^', '$call', '$resolve!', '$exception!', '$any?', '$each', '$reject!', '$there_can_be_only_one!', '$then', '$to_proc', '$fail', '$always', '$trace', '$class', '$object_id', '$+', '$inspect', '$act?', '$nil?', '$prev', '$push', '$concat', '$it', '$proc', '$reverse', '$pop', '$<=', '$length', '$shift', '$-', '$wait', '$map', '$reduce', '$try', '$tap', '$all?', '$find']);
  return (function($base, $super, $parent_nesting) {
    function $Promise(){};
    var self = $Promise = $klass($base, $super, 'Promise', $Promise);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Promise_value_1, TMP_Promise_error_2, TMP_Promise_when_3, TMP_Promise_initialize_4, TMP_Promise_value_5, TMP_Promise_act$q_6, TMP_Promise_action_7, TMP_Promise_exception$q_8, TMP_Promise_realized$q_9, TMP_Promise_resolved$q_10, TMP_Promise_rejected$q_11, TMP_Promise_$_12, TMP_Promise_$lt$lt_13, TMP_Promise_$gt$gt_14, TMP_Promise_resolve_15, TMP_Promise_resolve$B_17, TMP_Promise_reject_18, TMP_Promise_reject$B_20, TMP_Promise_exception$B_21, TMP_Promise_then_22, TMP_Promise_then$B_23, TMP_Promise_fail_24, TMP_Promise_fail$B_25, TMP_Promise_always_26, TMP_Promise_always$B_27, TMP_Promise_trace_28, TMP_Promise_trace$B_29, TMP_Promise_there_can_be_only_one$B_30, TMP_Promise_inspect_31;

    def.value = def.action = def.exception = def.realized = def.next = def.delayed = def.error = def.prev = nil;
    
    Opal.defs(self, '$value', TMP_Promise_value_1 = function $$value(value) {
      var self = this;

      return self.$new().$resolve(value)
    }, TMP_Promise_value_1.$$arity = 1);
    Opal.defs(self, '$error', TMP_Promise_error_2 = function $$error(value) {
      var self = this;

      return self.$new().$reject(value)
    }, TMP_Promise_error_2.$$arity = 1);
    Opal.defs(self, '$when', TMP_Promise_when_3 = function $$when($a_rest) {
      var self = this, promises;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      promises = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        promises[$arg_idx - 0] = arguments[$arg_idx];
      }
      return Opal.const_get_relative($nesting, 'When').$new(promises)
    }, TMP_Promise_when_3.$$arity = -1);
    self.$attr_reader("error", "prev", "next");
    
    Opal.defn(self, '$initialize', TMP_Promise_initialize_4 = function $$initialize(action) {
      var self = this;

      if (action == null) {
        action = $hash2([], {});
      }
      
      self.action = action;
      self.realized = false;
      self.exception = false;
      self.value = nil;
      self.error = nil;
      self.delayed = false;
      self.prev = nil;
      return (self.next = []);
    }, TMP_Promise_initialize_4.$$arity = -1);
    
    Opal.defn(self, '$value', TMP_Promise_value_5 = function $$value() {
      var self = this;

      if ($truthy(Opal.const_get_relative($nesting, 'Promise')['$==='](self.value))) {
        return self.value.$value()
        } else {
        return self.value
      }
    }, TMP_Promise_value_5.$$arity = 0);
    
    Opal.defn(self, '$act?', TMP_Promise_act$q_6 = function() {
      var $a, self = this;

      return ($truthy($a = self.action['$has_key?']("success")) ? $a : self.action['$has_key?']("always"))
    }, TMP_Promise_act$q_6.$$arity = 0);
    
    Opal.defn(self, '$action', TMP_Promise_action_7 = function $$action() {
      var self = this;

      return self.action.$keys()
    }, TMP_Promise_action_7.$$arity = 0);
    
    Opal.defn(self, '$exception?', TMP_Promise_exception$q_8 = function() {
      var self = this;

      return self.exception
    }, TMP_Promise_exception$q_8.$$arity = 0);
    
    Opal.defn(self, '$realized?', TMP_Promise_realized$q_9 = function() {
      var self = this;

      return self.realized['$!']()['$!']()
    }, TMP_Promise_realized$q_9.$$arity = 0);
    
    Opal.defn(self, '$resolved?', TMP_Promise_resolved$q_10 = function() {
      var self = this;

      return self.realized['$==']("resolve")
    }, TMP_Promise_resolved$q_10.$$arity = 0);
    
    Opal.defn(self, '$rejected?', TMP_Promise_rejected$q_11 = function() {
      var self = this;

      return self.realized['$==']("reject")
    }, TMP_Promise_rejected$q_11.$$arity = 0);
    
    Opal.defn(self, '$^', TMP_Promise_$_12 = function(promise) {
      var self = this;

      
      promise['$<<'](self);
      self['$>>'](promise);
      return promise;
    }, TMP_Promise_$_12.$$arity = 1);
    
    Opal.defn(self, '$<<', TMP_Promise_$lt$lt_13 = function(promise) {
      var self = this;

      
      self.prev = promise;
      return self;
    }, TMP_Promise_$lt$lt_13.$$arity = 1);
    
    Opal.defn(self, '$>>', TMP_Promise_$gt$gt_14 = function(promise) {
      var $a, self = this;

      
      self.next['$<<'](promise);
      if ($truthy(self['$exception?']())) {
        promise.$reject(self.delayed['$[]'](0))
      } else if ($truthy(self['$resolved?']())) {
        promise.$resolve((function() {if ($truthy(self.delayed)) {
          return self.delayed['$[]'](0)
          } else {
          return self.$value()
        }; return nil; })())
      } else if ($truthy(self['$rejected?']())) {
        if ($truthy(($truthy($a = self.action['$has_key?']("failure")['$!']()) ? $a : Opal.const_get_relative($nesting, 'Promise')['$===']((function() {if ($truthy(self.delayed)) {
          return self.delayed['$[]'](0)
          } else {
          return self.error
        }; return nil; })())))) {
          promise.$reject((function() {if ($truthy(self.delayed)) {
            return self.delayed['$[]'](0)
            } else {
            return self.$error()
          }; return nil; })())
        } else if ($truthy(promise.$action()['$include?']("always"))) {
          promise.$reject((function() {if ($truthy(self.delayed)) {
            return self.delayed['$[]'](0)
            } else {
            return self.$error()
          }; return nil; })())}};
      return self;
    }, TMP_Promise_$gt$gt_14.$$arity = 1);
    
    Opal.defn(self, '$resolve', TMP_Promise_resolve_15 = function $$resolve(value) {
      var $a, self = this, block = nil, e = nil;

      if (value == null) {
        value = nil;
      }
      
      if ($truthy(self['$realized?']())) {
        self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "the promise has already been realized")};
      if ($truthy(Opal.const_get_relative($nesting, 'Promise')['$==='](value))) {
        return value['$<<'](self.prev)['$^'](self)};
      
      try {
        
        if ($truthy((block = ($truthy($a = self.action['$[]']("success")) ? $a : self.action['$[]']("always"))))) {
          value = block.$call(value)};
        self['$resolve!'](value);
      } catch ($err) {
        if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exception')])) {e = $err;
          try {
            self['$exception!'](e)
          } finally { Opal.pop_exception() }
        } else { throw $err; }
      };;
      return self;
    }, TMP_Promise_resolve_15.$$arity = -1);
    
    Opal.defn(self, '$resolve!', TMP_Promise_resolve$B_17 = function(value) {
      var TMP_16, self = this;

      
      self.realized = "resolve";
      self.value = value;
      if ($truthy(self.next['$any?']())) {
        return $send(self.next, 'each', [], (TMP_16 = function(p){var self = TMP_16.$$s || this;
if (p == null) p = nil;
        return p.$resolve(value)}, TMP_16.$$s = self, TMP_16.$$arity = 1, TMP_16))
        } else {
        return (self.delayed = [value])
      };
    }, TMP_Promise_resolve$B_17.$$arity = 1);
    
    Opal.defn(self, '$reject', TMP_Promise_reject_18 = function $$reject(value) {
      var $a, self = this, block = nil, e = nil;

      if (value == null) {
        value = nil;
      }
      
      if ($truthy(self['$realized?']())) {
        self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "the promise has already been realized")};
      if ($truthy(Opal.const_get_relative($nesting, 'Promise')['$==='](value))) {
        return value['$<<'](self.prev)['$^'](self)};
      
      try {
        
        if ($truthy((block = ($truthy($a = self.action['$[]']("failure")) ? $a : self.action['$[]']("always"))))) {
          value = block.$call(value)};
        if ($truthy(self.action['$has_key?']("always"))) {
          self['$resolve!'](value)
          } else {
          self['$reject!'](value)
        };
      } catch ($err) {
        if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exception')])) {e = $err;
          try {
            self['$exception!'](e)
          } finally { Opal.pop_exception() }
        } else { throw $err; }
      };;
      return self;
    }, TMP_Promise_reject_18.$$arity = -1);
    
    Opal.defn(self, '$reject!', TMP_Promise_reject$B_20 = function(value) {
      var TMP_19, self = this;

      
      self.realized = "reject";
      self.error = value;
      if ($truthy(self.next['$any?']())) {
        return $send(self.next, 'each', [], (TMP_19 = function(p){var self = TMP_19.$$s || this;
if (p == null) p = nil;
        return p.$reject(value)}, TMP_19.$$s = self, TMP_19.$$arity = 1, TMP_19))
        } else {
        return (self.delayed = [value])
      };
    }, TMP_Promise_reject$B_20.$$arity = 1);
    
    Opal.defn(self, '$exception!', TMP_Promise_exception$B_21 = function(error) {
      var self = this;

      
      self.exception = true;
      return self['$reject!'](error);
    }, TMP_Promise_exception$B_21.$$arity = 1);
    
    Opal.defn(self, '$then', TMP_Promise_then_22 = function $$then() {
      var self = this, $iter = TMP_Promise_then_22.$$p, block = $iter || nil;

      if ($iter) TMP_Promise_then_22.$$p = null;
      return self['$^'](Opal.const_get_relative($nesting, 'Promise').$new($hash2(["success"], {"success": block})))
    }, TMP_Promise_then_22.$$arity = 0);
    
    Opal.defn(self, '$then!', TMP_Promise_then$B_23 = function() {
      var self = this, $iter = TMP_Promise_then$B_23.$$p, block = $iter || nil;

      if ($iter) TMP_Promise_then$B_23.$$p = null;
      
      self['$there_can_be_only_one!']();
      return $send(self, 'then', [], block.$to_proc());
    }, TMP_Promise_then$B_23.$$arity = 0);
    Opal.alias(self, "do", "then");
    Opal.alias(self, "do!", "then!");
    
    Opal.defn(self, '$fail', TMP_Promise_fail_24 = function $$fail() {
      var self = this, $iter = TMP_Promise_fail_24.$$p, block = $iter || nil;

      if ($iter) TMP_Promise_fail_24.$$p = null;
      return self['$^'](Opal.const_get_relative($nesting, 'Promise').$new($hash2(["failure"], {"failure": block})))
    }, TMP_Promise_fail_24.$$arity = 0);
    
    Opal.defn(self, '$fail!', TMP_Promise_fail$B_25 = function() {
      var self = this, $iter = TMP_Promise_fail$B_25.$$p, block = $iter || nil;

      if ($iter) TMP_Promise_fail$B_25.$$p = null;
      
      self['$there_can_be_only_one!']();
      return $send(self, 'fail', [], block.$to_proc());
    }, TMP_Promise_fail$B_25.$$arity = 0);
    Opal.alias(self, "rescue", "fail");
    Opal.alias(self, "catch", "fail");
    Opal.alias(self, "rescue!", "fail!");
    Opal.alias(self, "catch!", "fail!");
    
    Opal.defn(self, '$always', TMP_Promise_always_26 = function $$always() {
      var self = this, $iter = TMP_Promise_always_26.$$p, block = $iter || nil;

      if ($iter) TMP_Promise_always_26.$$p = null;
      return self['$^'](Opal.const_get_relative($nesting, 'Promise').$new($hash2(["always"], {"always": block})))
    }, TMP_Promise_always_26.$$arity = 0);
    
    Opal.defn(self, '$always!', TMP_Promise_always$B_27 = function() {
      var self = this, $iter = TMP_Promise_always$B_27.$$p, block = $iter || nil;

      if ($iter) TMP_Promise_always$B_27.$$p = null;
      
      self['$there_can_be_only_one!']();
      return $send(self, 'always', [], block.$to_proc());
    }, TMP_Promise_always$B_27.$$arity = 0);
    Opal.alias(self, "finally", "always");
    Opal.alias(self, "ensure", "always");
    Opal.alias(self, "finally!", "always!");
    Opal.alias(self, "ensure!", "always!");
    
    Opal.defn(self, '$trace', TMP_Promise_trace_28 = function $$trace(depth) {
      var self = this, $iter = TMP_Promise_trace_28.$$p, block = $iter || nil;

      if (depth == null) {
        depth = nil;
      }
      if ($iter) TMP_Promise_trace_28.$$p = null;
      return self['$^'](Opal.const_get_relative($nesting, 'Trace').$new(depth, block))
    }, TMP_Promise_trace_28.$$arity = -1);
    
    Opal.defn(self, '$trace!', TMP_Promise_trace$B_29 = function($a_rest) {
      var self = this, args, $iter = TMP_Promise_trace$B_29.$$p, block = $iter || nil;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      if ($iter) TMP_Promise_trace$B_29.$$p = null;
      
      self['$there_can_be_only_one!']();
      return $send(self, 'trace', Opal.to_a(args), block.$to_proc());
    }, TMP_Promise_trace$B_29.$$arity = -1);
    
    Opal.defn(self, '$there_can_be_only_one!', TMP_Promise_there_can_be_only_one$B_30 = function() {
      var self = this;

      if ($truthy(self.next['$any?']())) {
        return self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "a promise has already been chained")
        } else {
        return nil
      }
    }, TMP_Promise_there_can_be_only_one$B_30.$$arity = 0);
    
    Opal.defn(self, '$inspect', TMP_Promise_inspect_31 = function $$inspect() {
      var $a, self = this, result = nil;

      
      result = "" + "#<" + (self.$class()) + "(" + (self.$object_id()) + ")";
      if ($truthy(self.next['$any?']())) {
        result = $rb_plus(result, "" + " >> " + (self.next.$inspect()))};
      if ($truthy(self['$realized?']())) {
        result = $rb_plus(result, "" + ": " + (($truthy($a = self.value) ? $a : self.error).$inspect()) + ">")
        } else {
        result = $rb_plus(result, ">")
      };
      return result;
    }, TMP_Promise_inspect_31.$$arity = 0);
    (function($base, $super, $parent_nesting) {
      function $Trace(){};
      var self = $Trace = $klass($base, $super, 'Trace', $Trace);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Trace_it_32, TMP_Trace_initialize_33;

      
      Opal.defs(self, '$it', TMP_Trace_it_32 = function $$it(promise) {
        var $a, self = this, current = nil, prev = nil;

        
        current = [];
        if ($truthy(($truthy($a = promise['$act?']()) ? $a : promise.$prev()['$nil?']()))) {
          current.$push(promise.$value())};
        if ($truthy((prev = promise.$prev()))) {
          return current.$concat(self.$it(prev))
          } else {
          return current
        };
      }, TMP_Trace_it_32.$$arity = 1);
      return (Opal.defn(self, '$initialize', TMP_Trace_initialize_33 = function $$initialize(depth, block) {
        var TMP_34, self = this, $iter = TMP_Trace_initialize_33.$$p, $yield = $iter || nil;

        if ($iter) TMP_Trace_initialize_33.$$p = null;
        
        self.depth = depth;
        return $send(self, Opal.find_super_dispatcher(self, 'initialize', TMP_Trace_initialize_33, false), [$hash2(["success"], {"success": $send(self, 'proc', [], (TMP_34 = function(){var self = TMP_34.$$s || this, $a, trace = nil;

        
          trace = Opal.const_get_relative($nesting, 'Trace').$it(self).$reverse();
          trace.$pop();
          if ($truthy(($truthy($a = depth) ? $rb_le(depth, trace.$length()) : $a))) {
            trace.$shift($rb_minus(trace.$length(), depth))};
          return $send(block, 'call', Opal.to_a(trace));}, TMP_34.$$s = self, TMP_34.$$arity = 0, TMP_34))})], null);
      }, TMP_Trace_initialize_33.$$arity = 2), nil) && 'initialize';
    })($nesting[0], self, $nesting);
    return (function($base, $super, $parent_nesting) {
      function $When(){};
      var self = $When = $klass($base, $super, 'When', $When);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_When_initialize_35, TMP_When_each_37, TMP_When_collect_39, TMP_When_inject_41, TMP_When_wait_44, TMP_When_$gt$gt_45, TMP_When_try_47;

      def.wait = nil;
      
      
      Opal.defn(self, '$initialize', TMP_When_initialize_35 = function $$initialize(promises) {
        var TMP_36, self = this, $iter = TMP_When_initialize_35.$$p, $yield = $iter || nil;

        if (promises == null) {
          promises = [];
        }
        if ($iter) TMP_When_initialize_35.$$p = null;
        
        $send(self, Opal.find_super_dispatcher(self, 'initialize', TMP_When_initialize_35, false), [], null);
        self.wait = [];
        return $send(promises, 'each', [], (TMP_36 = function(promise){var self = TMP_36.$$s || this;
if (promise == null) promise = nil;
        return self.$wait(promise)}, TMP_36.$$s = self, TMP_36.$$arity = 1, TMP_36));
      }, TMP_When_initialize_35.$$arity = -1);
      
      Opal.defn(self, '$each', TMP_When_each_37 = function $$each() {
        var TMP_38, self = this, $iter = TMP_When_each_37.$$p, block = $iter || nil;

        if ($iter) TMP_When_each_37.$$p = null;
        
        if ($truthy(block)) {
          } else {
          self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "no block given")
        };
        return $send(self, 'then', [], (TMP_38 = function(values){var self = TMP_38.$$s || this;
if (values == null) values = nil;
        return $send(values, 'each', [], block.$to_proc())}, TMP_38.$$s = self, TMP_38.$$arity = 1, TMP_38));
      }, TMP_When_each_37.$$arity = 0);
      
      Opal.defn(self, '$collect', TMP_When_collect_39 = function $$collect() {
        var TMP_40, self = this, $iter = TMP_When_collect_39.$$p, block = $iter || nil;

        if ($iter) TMP_When_collect_39.$$p = null;
        
        if ($truthy(block)) {
          } else {
          self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "no block given")
        };
        return $send(self, 'then', [], (TMP_40 = function(values){var self = TMP_40.$$s || this;
if (values == null) values = nil;
        return Opal.const_get_relative($nesting, 'When').$new($send(values, 'map', [], block.$to_proc()))}, TMP_40.$$s = self, TMP_40.$$arity = 1, TMP_40));
      }, TMP_When_collect_39.$$arity = 0);
      
      Opal.defn(self, '$inject', TMP_When_inject_41 = function $$inject($a_rest) {
        var TMP_42, self = this, args, $iter = TMP_When_inject_41.$$p, block = $iter || nil;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 0] = arguments[$arg_idx];
        }
        if ($iter) TMP_When_inject_41.$$p = null;
        return $send(self, 'then', [], (TMP_42 = function(values){var self = TMP_42.$$s || this;
if (values == null) values = nil;
        return $send(values, 'reduce', Opal.to_a(args), block.$to_proc())}, TMP_42.$$s = self, TMP_42.$$arity = 1, TMP_42))
      }, TMP_When_inject_41.$$arity = -1);
      Opal.alias(self, "map", "collect");
      Opal.alias(self, "reduce", "inject");
      
      Opal.defn(self, '$wait', TMP_When_wait_44 = function $$wait(promise) {
        var TMP_43, self = this;

        
        if ($truthy(Opal.const_get_relative($nesting, 'Promise')['$==='](promise))) {
          } else {
          promise = Opal.const_get_relative($nesting, 'Promise').$value(promise)
        };
        if ($truthy(promise['$act?']())) {
          promise = promise.$then()};
        self.wait['$<<'](promise);
        $send(promise, 'always', [], (TMP_43 = function(){var self = TMP_43.$$s || this;
          if (self.next == null) self.next = nil;

        if ($truthy(self.next['$any?']())) {
            return self.$try()
            } else {
            return nil
          }}, TMP_43.$$s = self, TMP_43.$$arity = 0, TMP_43));
        return self;
      }, TMP_When_wait_44.$$arity = 1);
      Opal.alias(self, "and", "wait");
      
      Opal.defn(self, '$>>', TMP_When_$gt$gt_45 = function($a_rest) {
        var TMP_46, self = this, $iter = TMP_When_$gt$gt_45.$$p, $yield = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

        if ($iter) TMP_When_$gt$gt_45.$$p = null;
        // Prepare super implicit arguments
        for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
          $zuper[$zuper_i] = arguments[$zuper_i];
        }
        return $send($send(self, Opal.find_super_dispatcher(self, '>>', TMP_When_$gt$gt_45, false), $zuper, $iter), 'tap', [], (TMP_46 = function(){var self = TMP_46.$$s || this;

        return self.$try()}, TMP_46.$$s = self, TMP_46.$$arity = 0, TMP_46))
      }, TMP_When_$gt$gt_45.$$arity = -1);
      return (Opal.defn(self, '$try', TMP_When_try_47 = function() {
        var self = this, promise = nil;

        if ($truthy($send(self.wait, 'all?', [], "realized?".$to_proc()))) {
          if ($truthy((promise = $send(self.wait, 'find', [], "rejected?".$to_proc())))) {
            return self.$reject(promise.$error())
            } else {
            return self.$resolve($send(self.wait, 'map', [], "value".$to_proc()))
          }
          } else {
          return nil
        }
      }, TMP_When_try_47.$$arity = 0), nil) && 'try';
    })($nesting[0], self, $nesting);
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["opal/jquery/http"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $send = Opal.send, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$require', '$to_n', '$each', '$define_singleton_method', '$send', '$new', '$define_method', '$attr_reader', '$delete', '$update', '$upcase', '$succeed', '$fail', '$promise', '$parse', '$private', '$tap', '$proc', '$ok?', '$resolve', '$reject', '$from_object', '$call']);
  
  self.$require("json");
  self.$require("native");
  self.$require("promise");
  self.$require("opal/jquery/constants");
  return (function($base, $super, $parent_nesting) {
    function $HTTP(){};
    var self = $HTTP = $klass($base, $super, 'HTTP', $HTTP);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_HTTP_1, TMP_HTTP_setup_4, TMP_HTTP_setup$eq_5, TMP_HTTP_initialize_6, TMP_HTTP_send_7, TMP_HTTP_json_8, TMP_HTTP_ok$q_9, TMP_HTTP_get_header_10, TMP_HTTP_inspect_11, TMP_HTTP_promise_14, TMP_HTTP_succeed_15, TMP_HTTP_fail_16;

    def.settings = def.payload = def.url = def.method = def.handler = def.json = def.body = def.ok = def.xhr = def.promise = def.status_code = nil;
    
    var $ = Opal.const_get_relative($nesting, 'JQUERY_SELECTOR').$to_n();
    Opal.const_set($nesting[0], 'ACTIONS', ["get", "post", "put", "delete", "patch", "head"]);
    $send(Opal.const_get_relative($nesting, 'ACTIONS'), 'each', [], (TMP_HTTP_1 = function(action){var self = TMP_HTTP_1.$$s || this, TMP_2, TMP_3;
if (action == null) action = nil;
    
      $send(self, 'define_singleton_method', [action], (TMP_2 = function(url, options){var self = TMP_2.$$s || this, block;

        block = TMP_2.$$p || nil;
        if (block) TMP_2.$$p = null;
        if (options == null) {
          options = $hash2([], {});
        }if (url == null) url = nil;
      return self.$new().$send(action, url, options, block)}, TMP_2.$$s = self, TMP_2.$$arity = -2, TMP_2));
      return $send(self, 'define_method', [action], (TMP_3 = function(url, options){var self = TMP_3.$$s || this, block;

        block = TMP_3.$$p || nil;
        if (block) TMP_3.$$p = null;
        if (options == null) {
          options = $hash2([], {});
        }if (url == null) url = nil;
      return self.$send(action, url, options, block)}, TMP_3.$$s = self, TMP_3.$$arity = -2, TMP_3));}, TMP_HTTP_1.$$s = self, TMP_HTTP_1.$$arity = 1, TMP_HTTP_1));
    Opal.defs(self, '$setup', TMP_HTTP_setup_4 = function $$setup() {
      var self = this;

      return Opal.const_get_relative($nesting, 'Hash').$new($.ajaxSetup())
    }, TMP_HTTP_setup_4.$$arity = 0);
    Opal.defs(self, '$setup=', TMP_HTTP_setup$eq_5 = function(settings) {
      var self = this;

      return $.ajaxSetup(settings.$to_n())
    }, TMP_HTTP_setup$eq_5.$$arity = 1);
    self.$attr_reader("body", "error_message", "method", "status_code", "url", "xhr");
    
    Opal.defn(self, '$initialize', TMP_HTTP_initialize_6 = function $$initialize() {
      var self = this;

      
      self.settings = $hash2([], {});
      return (self.ok = true);
    }, TMP_HTTP_initialize_6.$$arity = 0);
    
    Opal.defn(self, '$send', TMP_HTTP_send_7 = function $$send(method, url, options, block) {
      var $a, self = this, settings = nil, payload = nil;

      
      self.method = method;
      self.url = url;
      self.payload = options.$delete("payload");
      self.handler = block;
      self.settings.$update(options);
      $a = [self.settings.$to_n(), self.payload], (settings = $a[0]), (payload = $a[1]), $a;
      
      if (typeof(payload) === 'string') {
        settings.data = payload;
      }
      else if (payload != nil) {
        settings.data = payload.$to_json();
        settings.contentType = 'application/json';
      }

      settings.url  = self.url;
      settings.type = self.method.$upcase();

      settings.success = function(data, status, xhr) {
        return self.$succeed(data, status, xhr);
      };

      settings.error = function(xhr, status, error) {
        return self.$fail(xhr, status, error);
      };

      $.ajax(settings);
    ;
      if ($truthy(self.handler)) {
        return self
        } else {
        return self.$promise()
      };
    }, TMP_HTTP_send_7.$$arity = 4);
    
    Opal.defn(self, '$json', TMP_HTTP_json_8 = function $$json() {
      var $a, self = this;

      return (self.json = ($truthy($a = self.json) ? $a : Opal.const_get_relative($nesting, 'JSON').$parse(self.body)))
    }, TMP_HTTP_json_8.$$arity = 0);
    
    Opal.defn(self, '$ok?', TMP_HTTP_ok$q_9 = function() {
      var self = this;

      return self.ok
    }, TMP_HTTP_ok$q_9.$$arity = 0);
    
    Opal.defn(self, '$get_header', TMP_HTTP_get_header_10 = function $$get_header(key) {
      var self = this;

      
      var value = self.xhr.getResponseHeader(key);
      return (value === null) ? nil : value;
    
    }, TMP_HTTP_get_header_10.$$arity = 1);
    
    Opal.defn(self, '$inspect', TMP_HTTP_inspect_11 = function $$inspect() {
      var self = this;

      return "" + "#<HTTP @url=" + (self.url) + " @method=" + (self.method) + ">"
    }, TMP_HTTP_inspect_11.$$arity = 0);
    self.$private();
    
    Opal.defn(self, '$promise', TMP_HTTP_promise_14 = function $$promise() {
      var TMP_12, self = this;

      
      if ($truthy(self.promise)) {
        return self.promise};
      return (self.promise = $send(Opal.const_get_relative($nesting, 'Promise').$new(), 'tap', [], (TMP_12 = function(promise){var self = TMP_12.$$s || this, TMP_13;
if (promise == null) promise = nil;
      return (self.handler = $send(self, 'proc', [], (TMP_13 = function(res){var self = TMP_13.$$s || this;
if (res == null) res = nil;
        if ($truthy(res['$ok?']())) {
            return promise.$resolve(res)
            } else {
            return promise.$reject(res)
          }}, TMP_13.$$s = self, TMP_13.$$arity = 1, TMP_13)))}, TMP_12.$$s = self, TMP_12.$$arity = 1, TMP_12)));
    }, TMP_HTTP_promise_14.$$arity = 0);
    
    Opal.defn(self, '$succeed', TMP_HTTP_succeed_15 = function $$succeed(data, status, xhr) {
      var self = this;

      
      
      self.body = data;
      self.xhr  = xhr;
      self.status_code = xhr.status;

      if (typeof(data) === 'object') {
        self.json = Opal.const_get_relative($nesting, 'JSON').$from_object(data);
      }
    ;
      if ($truthy(self.handler)) {
        return self.handler.$call(self)
        } else {
        return nil
      };
    }, TMP_HTTP_succeed_15.$$arity = 3);
    return (Opal.defn(self, '$fail', TMP_HTTP_fail_16 = function $$fail(xhr, status, error) {
      var self = this;

      
      
      self.body = xhr.responseText;
      self.xhr = xhr;
      self.status_code = xhr.status;
    ;
      self.ok = false;
      if ($truthy(self.handler)) {
        return self.handler.$call(self)
        } else {
        return nil
      };
    }, TMP_HTTP_fail_16.$$arity = 3), nil) && 'fail';
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["opal/jquery/kernel"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module;

  return (function($base, $parent_nesting) {
    var $Kernel, self = $Kernel = $module($base, 'Kernel');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Kernel_alert_1;

    
    Opal.defn(self, '$alert', TMP_Kernel_alert_1 = function $$alert(msg) {
      var self = this;

      
      alert(msg);
      return nil;
    }, TMP_Kernel_alert_1.$$arity = 1)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["opal/jquery"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$==', '$require']);
  if (Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$==']("opal")) {
    
    self.$require("opal/jquery/window");
    self.$require("opal/jquery/document");
    self.$require("opal/jquery/element");
    self.$require("opal/jquery/event");
    self.$require("opal/jquery/http");
    return self.$require("opal/jquery/kernel");
    } else {
    return nil
  }
};

/* Generated by Opal 0.11.4 */
Opal.modules["opal-jquery"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  return self.$require("opal/jquery")
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/boot"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $klass = Opal.klass, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$attr_reader', '$<<', '$receivers', '$set_var', '$new', '$each', '$call']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), $a;

    if ($truthy((($a = Opal.const_get_relative($nesting, 'Operation', 'skip_raise')) ? 'constant' : nil))) {
      } else {
      
      (function($base, $super, $parent_nesting) {
        function $Operation(){};
        var self = $Operation = $klass($base, $super, 'Operation', $Operation);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        return nil
      })($nesting[0], null, $nesting);
      (function($base, $super, $parent_nesting) {
        function $Application(){};
        var self = $Application = $klass($base, $super, 'Application', $Application);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        return (function($base, $super, $parent_nesting) {
          function $Boot(){};
          var self = $Boot = $klass($base, $super, 'Boot', $Boot);

          var def = self.$$proto, $nesting = [self].concat($parent_nesting);

          
          (function($base, $super, $parent_nesting) {
            function $ReactDummyParams(){};
            var self = $ReactDummyParams = $klass($base, $super, 'ReactDummyParams', $ReactDummyParams);

            var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ReactDummyParams_initialize_1;

            
            self.$attr_reader("context");
            return (Opal.defn(self, '$initialize', TMP_ReactDummyParams_initialize_1 = function $$initialize(context) {
              var self = this;

              return (self.context = context)
            }, TMP_ReactDummyParams_initialize_1.$$arity = 1), nil) && 'initialize';
          })($nesting[0], null, $nesting);
          return (function(self, $parent_nesting) {
            var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_on_dispatch_2, TMP_receivers_4, TMP_run_6;

            
            
            Opal.defn(self, '$on_dispatch', TMP_on_dispatch_2 = function $$on_dispatch() {
              var self = this, $iter = TMP_on_dispatch_2.$$p, block = $iter || nil;

              if ($iter) TMP_on_dispatch_2.$$p = null;
              return self.$receivers()['$<<'](block)
            }, TMP_on_dispatch_2.$$arity = 0);
            
            Opal.defn(self, '$receivers', TMP_receivers_4 = function $$receivers() {
              var TMP_3, self = this;

              return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Context'), 'set_var', [self, "@receivers", $hash2(["force"], {"force": true})], (TMP_3 = function(){var self = TMP_3.$$s || this;

              return []}, TMP_3.$$s = self, TMP_3.$$arity = 0, TMP_3))
            }, TMP_receivers_4.$$arity = 0);
            return (Opal.defn(self, '$run', TMP_run_6 = function $$run($kwargs) {
              var TMP_5, self = this, context, params = nil;

              if ($kwargs == null || !$kwargs.$$is_hash) {
                if ($kwargs == null) {
                  $kwargs = $hash2([], {});
                } else {
                  throw Opal.ArgumentError.$new('expected kwargs');
                }
              }
              context = $kwargs.$$smap["context"];
              if (context == null) {
                context = nil
              }
              
              params = Opal.const_get_relative($nesting, 'ReactDummyParams').$new(context);
              return $send(self.$receivers(), 'each', [], (TMP_5 = function(receiver){var self = TMP_5.$$s || this;
if (receiver == null) receiver = nil;
              return receiver.$call(params)}, TMP_5.$$s = self, TMP_5.$$arity = 1, TMP_5));
            }, TMP_run_6.$$arity = -1), nil) && 'run';
          })(Opal.get_singleton_class(self), $nesting);
        })($nesting[0], Opal.const_get_relative($nesting, 'Operation'), $nesting)
      })($nesting[0], null, $nesting);
    }
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/deprecation_warning"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy;

  Opal.add_stubs(['$production?', '$env', '$include?', '$<<']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Hyperstack_deprecation_warning_1;

    Opal.defs(self, '$deprecation_warning', TMP_Hyperstack_deprecation_warning_1 = function $$deprecation_warning(name, message) {
      var $a, self = this;
      if (self.deprecation_messages == null) self.deprecation_messages = nil;

      
      if ($truthy(self.$env()['$production?']())) {
        return nil};
      self.deprecation_messages = ($truthy($a = self.deprecation_messages) ? $a : []);
      message = "" + "Warning: Deprecated feature used in " + (name) + ". " + (message);
      if ($truthy(self.deprecation_messages['$include?'](message))) {
        return nil};
      self.deprecation_messages['$<<'](message);
      return console.warn.apply(console, [message]);
    }, TMP_Hyperstack_deprecation_warning_1.$$arity = 2)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/string"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  return (function($base, $super, $parent_nesting) {
    function $String(){};
    var self = $String = $klass($base, $super, 'String', $String);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_String_to_json_1;

    return (Opal.defn(self, '$to_json', TMP_String_to_json_1 = function $$to_json() {
      var self = this;

      return JSON.stringify(self)
    }, TMP_String_to_json_1.$$arity = 0), nil) && 'to_json'
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/client_stubs"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module;

  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function(self, $parent_nesting) {
      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_import_1, TMP_imports_2, TMP_import_tree_3;

      
      
      Opal.defn(self, '$import', TMP_import_1 = function($a_rest) {
        var self = this, args;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 0] = arguments[$arg_idx];
        }
        return nil
      }, TMP_import_1.$$arity = -1);
      
      Opal.defn(self, '$imports', TMP_imports_2 = function $$imports($a_rest) {
        var self = this, args;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 0] = arguments[$arg_idx];
        }
        return nil
      }, TMP_imports_2.$$arity = -1);
      return (Opal.defn(self, '$import_tree', TMP_import_tree_3 = function $$import_tree($a_rest) {
        var self = this, args;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 0] = arguments[$arg_idx];
        }
        return nil
      }, TMP_import_tree_3.$$arity = -1), nil) && 'import_tree';
    })(Opal.get_singleton_class(self), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/context"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$instance_variable_get', '$!', '$key?', '$[]', '$dup', '$[]=', '$-', '$instance_variable_set', '$each', '$run', '$new']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Context, self = $Context = $module($base, 'Context');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Context_set_var_1, TMP_Context_reset$B_5;

      
      Opal.defs(self, '$set_var', TMP_Context_set_var_1 = function $$set_var(ctx, var$, $kwargs) {
        var $a, $b, self = this, force, $iter = TMP_Context_set_var_1.$$p, $yield = $iter || nil, inst_value_b4 = nil, $writer = nil;
        if (self.context == null) self.context = nil;

        if ($kwargs == null || !$kwargs.$$is_hash) {
          if ($kwargs == null) {
            $kwargs = $hash2([], {});
          } else {
            throw Opal.ArgumentError.$new('expected kwargs');
          }
        }
        force = $kwargs.$$smap["force"];
        if (force == null) {
          force = nil
        }
        if ($iter) TMP_Context_set_var_1.$$p = null;
        
        inst_value_b4 = ctx.$instance_variable_get(var$);
        if ($truthy(($truthy($a = ($truthy($b = self.context) ? self.context['$[]'](ctx)['$key?'](var$)['$!']() : $b)) ? ($truthy($b = force) ? $b : inst_value_b4['$!']()) : $a))) {
          
          $writer = [var$, ($truthy($a = inst_value_b4) ? inst_value_b4.$dup() : $a)];
          $send(self.context['$[]'](ctx), '[]=', Opal.to_a($writer));
          $writer[$rb_minus($writer["length"], 1)];};
        return ($truthy($a = inst_value_b4) ? $a : ctx.$instance_variable_set(var$, Opal.yieldX($yield, [])));
      }, TMP_Context_set_var_1.$$arity = -3);
      Opal.defs(self, '$reset!', TMP_Context_reset$B_5 = function(reboot) {
        var TMP_2, TMP_4, self = this;
        if (self.context == null) self.context = nil;

        if (reboot == null) {
          reboot = true;
        }
        if ($truthy(self.context)) {
          
          $send(self.context, 'each', [], (TMP_2 = function(ctx, vars){var self = TMP_2.$$s || this, TMP_3;
if (ctx == null) ctx = nil;if (vars == null) vars = nil;
          return $send(vars, 'each', [], (TMP_3 = function(var$, init){var self = TMP_3.$$s || this;
if (var$ == null) var$ = nil;if (init == null) init = nil;
            return ctx.$instance_variable_set(var$, init.$dup())}, TMP_3.$$s = self, TMP_3.$$arity = 2, TMP_3))}, TMP_2.$$s = self, TMP_2.$$arity = 2, TMP_2));
          if ($truthy(reboot)) {
            return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Application'), 'Boot').$run()
            } else {
            return nil
          };
          } else {
          return (self.context = $send(Opal.const_get_relative($nesting, 'Hash'), 'new', [], (TMP_4 = function(h, k){var self = TMP_4.$$s || this, $writer = nil;
if (h == null) h = nil;if (k == null) k = nil;
          
            $writer = [k, $hash2([], {})];
            $send(h, '[]=', Opal.to_a($writer));
            return $writer[$rb_minus($writer["length"], 1)];}, TMP_4.$$s = self, TMP_4.$$arity = 2, TMP_4)))
        }
      }, TMP_Context_reset$B_5.$$arity = -1);
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/js_imports"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$!=', '$!', '$each', '$raise']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function(self, $parent_nesting) {
      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_js_import_2;

      return (Opal.defn(self, '$js_import', TMP_js_import_2 = function $$js_import(value, $kwargs) {
        var $a, $b, TMP_1, self = this, client_only, server_only, defines, on_server = nil;

        if ($kwargs == null || !$kwargs.$$is_hash) {
          if ($kwargs == null) {
            $kwargs = $hash2([], {});
          } else {
            throw Opal.ArgumentError.$new('expected kwargs');
          }
        }
        client_only = $kwargs.$$smap["client_only"];
        if (client_only == null) {
          client_only = nil
        }
        server_only = $kwargs.$$smap["server_only"];
        if (server_only == null) {
          server_only = nil
        }
        if (!Opal.hasOwnProperty.call($kwargs.$$smap, 'defines')) {
          throw Opal.ArgumentError.$new('missing keyword: defines');
        }
        defines = $kwargs.$$smap["defines"];
        
        defines = [].concat(Opal.to_a(defines));
        if ($truthy(Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$!=']("opal"))) {
          return nil
          } else {
          
          on_server = typeof Opal.global.document === 'undefined';
          if ($truthy(($truthy($a = ($truthy($b = server_only) ? on_server['$!']() : $b)) ? $a : ($truthy($b = client_only) ? on_server : $b)))) {
            return nil};
          return $send(defines, 'each', [], (TMP_1 = function(name){var self = TMP_1.$$s || this;
if (name == null) name = nil;
          
            if ($truthy(Opal.global[name] === undefined)) {
              } else {
              return nil;
            };
            return self.$raise("" + ("" + "The package " + (name) + " was not found. Add it to the webpack ") + ("" + ((function() {if ($truthy(client_only)) {
              return "client_only.js"
              } else {
              return "client_and_server.js"
            }; return nil; })()) + " manifest."));}, TMP_1.$$s = self, TMP_1.$$arity = 1, TMP_1));
        };
      }, TMP_js_import_2.$$arity = 2), nil) && 'js_import'
    })(Opal.get_singleton_class(self), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/on_client"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module;

  Opal.add_stubs(['$==', '$!']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Hyperstack_on_client$q_1;

    Opal.defs(self, '$on_client?', TMP_Hyperstack_on_client$q_1 = function() {
      var self = this;

      if (Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$==']("opal")) {
        return (typeof Opal.global.document === 'undefined')['$!']()
        } else {
        return nil
      }
    }, TMP_Hyperstack_on_client$q_1.$$arity = 0)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/active_support_string_inquirer"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $range = Opal.range;

  Opal.add_stubs(['$private', '$==', '$[]']);
  return (function($base, $parent_nesting) {
    var $ActiveSupport, self = $ActiveSupport = $module($base, 'ActiveSupport');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $StringInquirer(){};
      var self = $StringInquirer = $klass($base, $super, 'StringInquirer', $StringInquirer);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_StringInquirer_respond_to_missing$q_1, TMP_StringInquirer_method_missing_2;

      
      self.$private();
      
      Opal.defn(self, '$respond_to_missing?', TMP_StringInquirer_respond_to_missing$q_1 = function(method_name, include_private) {
        var $a, self = this, $iter = TMP_StringInquirer_respond_to_missing$q_1.$$p, $yield = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

        if (include_private == null) {
          include_private = false;
        }
        if ($iter) TMP_StringInquirer_respond_to_missing$q_1.$$p = null;
        // Prepare super implicit arguments
        for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
          $zuper[$zuper_i] = arguments[$zuper_i];
        }
        return ($truthy($a = method_name['$[]'](-1)['$==']("?")) ? $a : $send(self, Opal.find_super_dispatcher(self, 'respond_to_missing?', TMP_StringInquirer_respond_to_missing$q_1, false), $zuper, $iter))
      }, TMP_StringInquirer_respond_to_missing$q_1.$$arity = -2);
      return (Opal.defn(self, '$method_missing', TMP_StringInquirer_method_missing_2 = function $$method_missing(method_name, $a_rest) {
        var self = this, arguments$, $iter = TMP_StringInquirer_method_missing_2.$$p, $yield = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

        var $args_len = arguments.length, $rest_len = $args_len - 1;
        if ($rest_len < 0) { $rest_len = 0; }
        arguments$ = new Array($rest_len);
        for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
          arguments$[$arg_idx - 1] = arguments[$arg_idx];
        }
        if ($iter) TMP_StringInquirer_method_missing_2.$$p = null;
        // Prepare super implicit arguments
        for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
          $zuper[$zuper_i] = arguments[$zuper_i];
        }
        if (method_name['$[]'](-1)['$==']("?")) {
          return self['$=='](method_name['$[]']($range(0, -2, false)))
          } else {
          return $send(self, Opal.find_super_dispatcher(self, 'method_missing', TMP_StringInquirer_method_missing_2, false), $zuper, $iter)
        }
      }, TMP_StringInquirer_method_missing_2.$$arity = -2), nil) && 'method_missing';
    })($nesting[0], Opal.const_get_relative($nesting, 'String'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack_env"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy;

  Opal.add_stubs(['$new']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Hyperstack_env_1;

    Opal.defs(self, '$env', TMP_Hyperstack_env_1 = function $$env() {
      var $a, self = this;
      if (self.environment == null) self.environment = nil;

      return (self.environment = ($truthy($a = self.environment) ? $a : Opal.const_get_qualified(Opal.const_get_relative($nesting, 'ActiveSupport'), 'StringInquirer').$new("development")))
    }, TMP_Hyperstack_env_1.$$arity = 0)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/hotloader/stub"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $klass = Opal.klass;

  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), $a;

    if ($truthy((($a = Opal.const_get_relative($nesting, 'Hotloader', 'skip_raise')) ? 'constant' : nil))) {
      } else {
      (function($base, $super, $parent_nesting) {
        function $Hotloader(){};
        var self = $Hotloader = $klass($base, $super, 'Hotloader', $Hotloader);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Hotloader_when_file_updates_1;

        return Opal.defs(self, '$when_file_updates', TMP_Hotloader_when_file_updates_1 = function $$when_file_updates() {
          var self = this, $iter = TMP_Hotloader_when_file_updates_1.$$p, block = $iter || nil;

          if ($iter) TMP_Hotloader_when_file_updates_1.$$p = null;
          return nil
        }, TMP_Hotloader_when_file_updates_1.$$arity = 0)
      })($nesting[0], null, $nesting)
    }
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack-config"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module;

  Opal.add_stubs(['$require', '$==']);
  
  self.$require("hyperstack/boot");
  (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Hyperstack_naming_convention_1;

    Opal.defs(self, '$naming_convention', TMP_Hyperstack_naming_convention_1 = function $$naming_convention() {
      var self = this;

      return "camelize_params"
    }, TMP_Hyperstack_naming_convention_1.$$arity = 0)
  })($nesting[0], $nesting);
  if (Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$==']("opal")) {
    
    self.$require("hyperstack/deprecation_warning");
    self.$require("hyperstack/string");
    self.$require("hyperstack/client_stubs");
    self.$require("hyperstack/context");
    self.$require("hyperstack/js_imports");
    self.$require("hyperstack/on_client");
    self.$require("hyperstack/active_support_string_inquirer.rb");
    self.$require("hyperstack_env");
    return self.$require("hyperstack/hotloader/stub");
    } else {
    return nil
  };
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/component"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy;

  Opal.add_stubs(['$require', '$!=', '$attr_accessor']);
  
  self.$require("hyperstack-config");
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    
    if ($truthy(Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$!=']("opal"))) {
      nil};
    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Component, self = $Component = $module($base, 'Component');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function(self, $parent_nesting) {
          var def = self.$$proto, $nesting = [self].concat($parent_nesting);

          return self.$attr_accessor("after_error_args")
        })(Opal.get_singleton_class(self), $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting);
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/callbacks"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$!=', '$extend', '$each', '$flatten', '$callbacks_for', '$class', '$is_a?', '$instance_exec', '$to_proc', '$send', '$define_singleton_method', '$set_var', '$<<', '$push', '$when_file_updates', '$delete_if', '$equal?', '$call', '$+', '$respond_to?', '$superclass', '$any?']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Callbacks, self = $Callbacks = $module($base, 'Callbacks');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Callbacks_included_1, TMP_Callbacks_run_callback_3;

        
        if ($truthy(Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$!=']("opal"))) {
          nil};
        Opal.defs(self, '$included', TMP_Callbacks_included_1 = function $$included(base) {
          var self = this;

          return base.$extend(Opal.const_get_relative($nesting, 'ClassMethods'))
        }, TMP_Callbacks_included_1.$$arity = 1);
        
        Opal.defn(self, '$run_callback', TMP_Callbacks_run_callback_3 = function $$run_callback(name, $a_rest) {
          var TMP_2, self = this, args, $iter = TMP_Callbacks_run_callback_3.$$p, $yield = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 1;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 1] = arguments[$arg_idx];
          }
          if ($iter) TMP_Callbacks_run_callback_3.$$p = null;
          
          $send(self.$class().$callbacks_for(name).$flatten(), 'each', [], (TMP_2 = function(callback){var self = TMP_2.$$s || this, result = nil;
if (callback == null) callback = nil;
          
            result = (function() {if ($truthy(callback['$is_a?'](Opal.const_get_relative($nesting, 'Proc')))) {
              return $send(self, 'instance_exec', Opal.to_a(args), callback.$to_proc())
              } else {
              return $send(self, 'send', [callback].concat(Opal.to_a(args)))
            }; return nil; })();
            if (($yield !== nil)) {
              return (args = Opal.yield1($yield, result))
              } else {
              return nil
            };}, TMP_2.$$s = self, TMP_2.$$arity = 1, TMP_2));
          return args;
        }, TMP_Callbacks_run_callback_3.$$arity = -2);
        (function($base, $parent_nesting) {
          var $ClassMethods, self = $ClassMethods = $module($base, 'ClassMethods');

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ClassMethods_define_callback_4, TMP_ClassMethods_callbacks_for_10, TMP_ClassMethods_callbacks$q_11;

          
          
          Opal.defn(self, '$define_callback', TMP_ClassMethods_define_callback_4 = function $$define_callback(callback_name) {
            var TMP_5, TMP_7, self = this, $iter = TMP_ClassMethods_define_callback_4.$$p, after_define_hook = $iter || nil, wrapper_name = nil;

            if ($iter) TMP_ClassMethods_define_callback_4.$$p = null;
            
            wrapper_name = "" + "_" + (callback_name) + "_callbacks";
            $send(self, 'define_singleton_method', [wrapper_name], (TMP_5 = function(){var self = TMP_5.$$s || this, TMP_6;

            return $send(Opal.const_get_relative($nesting, 'Context'), 'set_var', [self, "" + "@" + (wrapper_name), $hash2(["force"], {"force": true})], (TMP_6 = function(){var self = TMP_6.$$s || this;

              return []}, TMP_6.$$s = self, TMP_6.$$arity = 0, TMP_6))}, TMP_5.$$s = self, TMP_5.$$arity = 0, TMP_5));
            return $send(self, 'define_singleton_method', [callback_name], (TMP_7 = function($a_rest){var self = TMP_7.$$s || this, block, args, TMP_8;

              block = TMP_7.$$p || nil;
              if (block) TMP_7.$$p = null;
              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              args = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                args[$arg_idx - 0] = arguments[$arg_idx];
              }
            
              if ((block !== nil)) {
                args['$<<'](block)};
              self.$send(wrapper_name).$push(args);
              $send(Opal.const_get_relative($nesting, 'Hotloader'), 'when_file_updates', [], (TMP_8 = function(){var self = TMP_8.$$s || this, TMP_9;

              return $send(self.$send(wrapper_name), 'delete_if', [], (TMP_9 = function(item){var self = TMP_9.$$s || this;
if (item == null) item = nil;
                return item['$equal?'](args)}, TMP_9.$$s = self, TMP_9.$$arity = 1, TMP_9))}, TMP_8.$$s = self, TMP_8.$$arity = 0, TMP_8));
              if ($truthy(after_define_hook)) {
                return $send(after_define_hook, 'call', Opal.to_a(args), block.$to_proc())
                } else {
                return nil
              };}, TMP_7.$$s = self, TMP_7.$$arity = -1, TMP_7));
          }, TMP_ClassMethods_define_callback_4.$$arity = 1);
          
          Opal.defn(self, '$callbacks_for', TMP_ClassMethods_callbacks_for_10 = function $$callbacks_for(callback_name) {
            var self = this, wrapper_name = nil;

            
            wrapper_name = "" + "_" + (callback_name) + "_callbacks";
            return $rb_plus((function() {if ($truthy(self.$superclass()['$respond_to?']("callbacks_for"))) {
              return self.$superclass().$callbacks_for(callback_name)
              } else {
              return []
            }; return nil; })(), self.$send(wrapper_name));
          }, TMP_ClassMethods_callbacks_for_10.$$arity = 1);
          
          Opal.defn(self, '$callbacks?', TMP_ClassMethods_callbacks$q_11 = function(name) {
            var self = this;

            return self.$callbacks_for(name)['$any?']()
          }, TMP_ClassMethods_callbacks$q_11.$$arity = 1);
        })($nesting[0], $nesting);
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/auto_unmount"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send, $truthy = Opal.truthy;

  Opal.add_stubs(['$include', '$class_eval', '$define_callback', '$run_callback', '$each', '$[]', '$objects_to_unmount', '$to_proc', '$delete', '$instance_variables', '$instance_variable_get', '$respond_to?', '$unmount', '$==', '$unmounted?', '$tap', '$define_singleton_method', '$abort', '$<<', '$new', '$[]=', '$-']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $AutoUnmount, self = $AutoUnmount = $module($base, 'AutoUnmount');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_AutoUnmount_included_2, TMP_AutoUnmount_unmounted$q_3, TMP_AutoUnmount_unmount_5, TMP_AutoUnmount_every_6, TMP_AutoUnmount_after_9;

        
        Opal.defs(self, '$included', TMP_AutoUnmount_included_2 = function $$included(base) {
          var TMP_1, self = this;

          
          base.$include(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Callbacks'));
          return $send(base, 'class_eval', [], (TMP_1 = function(){var self = TMP_1.$$s || this;

          return self.$define_callback("before_unmount")}, TMP_1.$$s = self, TMP_1.$$arity = 0, TMP_1));
        }, TMP_AutoUnmount_included_2.$$arity = 1);
        
        Opal.defn(self, '$unmounted?', TMP_AutoUnmount_unmounted$q_3 = function() {
          var self = this;
          if (self.__hyperstack_internal_auto_unmount_unmounted == null) self.__hyperstack_internal_auto_unmount_unmounted = nil;

          return self.__hyperstack_internal_auto_unmount_unmounted
        }, TMP_AutoUnmount_unmounted$q_3.$$arity = 0);
        
        Opal.defn(self, '$unmount', TMP_AutoUnmount_unmount_5 = function $$unmount() {
          var TMP_4, self = this;

          
          self.$run_callback("before_unmount");
          $send(Opal.const_get_relative($nesting, 'AutoUnmount').$objects_to_unmount()['$[]'](self), 'each', [], "unmount".$to_proc());
          Opal.const_get_relative($nesting, 'AutoUnmount').$objects_to_unmount().$delete(self);
          $send(self.$instance_variables(), 'each', [], (TMP_4 = function(var$){var self = TMP_4.$$s || this, val = nil;
if (var$ == null) var$ = nil;
          
            val = self.$instance_variable_get(var$);
            
            try {
              if ($truthy(val['$respond_to?']("unmount"))) {
                return val.$unmount()
                } else {
                return nil
              }
            } catch ($err) {
              if (Opal.rescue($err, [(function() {if (Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$==']("opal")) {
                return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'JS'), 'Error')
                } else {
                return nil
              }; return nil; })()])) {
                try {
                  return nil
                } finally { Opal.pop_exception() }
              } else { throw $err; }
            };;}, TMP_4.$$s = self, TMP_4.$$arity = 1, TMP_4));
          return (self.__hyperstack_internal_auto_unmount_unmounted = true);
        }, TMP_AutoUnmount_unmount_5.$$arity = 0);
        
        Opal.defn(self, '$every', TMP_AutoUnmount_every_6 = function $$every($a_rest) {
          var TMP_7, self = this, args, $iter = TMP_AutoUnmount_every_6.$$p, block = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_AutoUnmount_every_6.$$p = null;
          // Prepare super implicit arguments
          for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
            $zuper[$zuper_i] = arguments[$zuper_i];
          }
          
          if ($truthy(self['$unmounted?']())) {
            return nil};
          return $send($send(self, Opal.find_super_dispatcher(self, 'every', TMP_AutoUnmount_every_6, false), $zuper, $iter), 'tap', [], (TMP_7 = function(id){var self = TMP_7.$$s || this, TMP_8, sself = nil;
if (id == null) id = nil;
          
            sself = self;
            $send(id, 'define_singleton_method', ["unmount"], (TMP_8 = function(){var self = TMP_8.$$s || this;

            return self.$abort()}, TMP_8.$$s = self, TMP_8.$$arity = 0, TMP_8));
            return Opal.const_get_relative($nesting, 'AutoUnmount').$objects_to_unmount()['$[]'](self)['$<<'](id);}, TMP_7.$$s = self, TMP_7.$$arity = 1, TMP_7));
        }, TMP_AutoUnmount_every_6.$$arity = -1);
        
        Opal.defn(self, '$after', TMP_AutoUnmount_after_9 = function $$after($a_rest) {
          var TMP_10, self = this, args, $iter = TMP_AutoUnmount_after_9.$$p, block = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_AutoUnmount_after_9.$$p = null;
          // Prepare super implicit arguments
          for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
            $zuper[$zuper_i] = arguments[$zuper_i];
          }
          
          if ($truthy(self['$unmounted?']())) {
            return nil};
          return $send($send(self, Opal.find_super_dispatcher(self, 'after', TMP_AutoUnmount_after_9, false), $zuper, $iter), 'tap', [], (TMP_10 = function(id){var self = TMP_10.$$s || this, TMP_11, sself = nil;
if (id == null) id = nil;
          
            sself = self;
            $send(id, 'define_singleton_method', ["unmount"], (TMP_11 = function(){var self = TMP_11.$$s || this;

            return self.$abort()}, TMP_11.$$s = self, TMP_11.$$arity = 0, TMP_11));
            return Opal.const_get_relative($nesting, 'AutoUnmount').$objects_to_unmount()['$[]'](self)['$<<'](id);}, TMP_10.$$s = self, TMP_10.$$arity = 1, TMP_10));
        }, TMP_AutoUnmount_after_9.$$arity = -1);
        (function(self, $parent_nesting) {
          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_objects_to_unmount_13;

          return (Opal.defn(self, '$objects_to_unmount', TMP_objects_to_unmount_13 = function $$objects_to_unmount() {
            var $a, TMP_12, self = this;
            if (self.objects_to_unmount == null) self.objects_to_unmount = nil;

            return (self.objects_to_unmount = ($truthy($a = self.objects_to_unmount) ? $a : $send(Opal.const_get_relative($nesting, 'Hash'), 'new', [], (TMP_12 = function(h, k){var self = TMP_12.$$s || this, $writer = nil;
if (h == null) h = nil;if (k == null) k = nil;
            
              $writer = [k, Opal.const_get_relative($nesting, 'Set').$new()];
              $send(h, '[]=', Opal.to_a($writer));
              return $writer[$rb_minus($writer["length"], 1)];}, TMP_12.$$s = self, TMP_12.$$arity = 2, TMP_12))))
          }, TMP_objects_to_unmount_13.$$arity = 0), nil) && 'objects_to_unmount'
        })(Opal.get_singleton_class(self), $nesting);
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/state/observer"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$observing', '$to_proc', '$update_objects_to_observe', '$remove']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $State, self = $State = $module($base, 'State');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Observer, self = $Observer = $module($base, 'Observer');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Observer_observing_1, TMP_Observer_update_objects_to_observe_2, TMP_Observer_remove_3;

        
        
        Opal.defn(self, '$observing', TMP_Observer_observing_1 = function $$observing($kwargs) {
          var self = this, immediate_update, rendering, update_objects, $iter = TMP_Observer_observing_1.$$p, block = $iter || nil;

          if ($kwargs == null || !$kwargs.$$is_hash) {
            if ($kwargs == null) {
              $kwargs = $hash2([], {});
            } else {
              throw Opal.ArgumentError.$new('expected kwargs');
            }
          }
          immediate_update = $kwargs.$$smap["immediate_update"];
          if (immediate_update == null) {
            immediate_update = false
          }
          rendering = $kwargs.$$smap["rendering"];
          if (rendering == null) {
            rendering = false
          }
          update_objects = $kwargs.$$smap["update_objects"];
          if (update_objects == null) {
            update_objects = false
          }
          if ($iter) TMP_Observer_observing_1.$$p = null;
          return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper'), 'observing', [self, immediate_update, rendering, update_objects], block.$to_proc())
        }, TMP_Observer_observing_1.$$arity = -1);
        
        Opal.defn(self, '$update_objects_to_observe', TMP_Observer_update_objects_to_observe_2 = function $$update_objects_to_observe() {
          var self = this;

          return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper').$update_objects_to_observe(self)
        }, TMP_Observer_update_objects_to_observe_2.$$arity = 0);
        
        Opal.defn(self, '$remove', TMP_Observer_remove_3 = function $$remove() {
          var self = this;

          return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper').$remove(self)
        }, TMP_Observer_remove_3.$$arity = 0);
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/component/validator"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$attr_accessor', '$attr_reader', '$private', '$tap', '$new', '$each', '$instance_variable_set', '$dup', '$instance_variable_get', '$build', '$to_proc', '$instance_eval', '$[]=', '$-', '$define_rule', '$coerce_native_hash_values', '$rules', '$define_all_others', '$props_wrapper', '$reject', '$[]', '$errors=', '$allow_undefined_props?', '$validate_undefined', '$defined_props', '$validate_required', '$validate_types', '$validate_allowed', '$errors', '$inject', '$select', '$include?', '$keys', '$!', '$define_param', '$is_a?', '$type_check', '$>', '$length', '$validate_value_array', '$nil?', '$respond_to?', '$_react_param_conversion', '$<<', '$each_with_index', '$Native']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Component, self = $Component = $module($base, 'Component');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $super, $parent_nesting) {
          function $Validator(){};
          var self = $Validator = $klass($base, $super, 'Validator', $Validator);

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Validator_copy_3, TMP_Validator_initialize_4, TMP_Validator_build_5, TMP_Validator_build_6, TMP_Validator_requires_7, TMP_Validator_optional_8, TMP_Validator_event_9, TMP_Validator_all_other_params_12, TMP_Validator_validate_14, TMP_Validator_default_props_17, TMP_Validator_defined_props_19, TMP_Validator_allow_undefined_props$q_20, TMP_Validator_rules_21, TMP_Validator_define_rule_22, TMP_Validator_errors_23, TMP_Validator_validate_types_24, TMP_Validator_type_check_25, TMP_Validator_validate_allowed_26, TMP_Validator_validate_required_28, TMP_Validator_validate_undefined_30, TMP_Validator_validate_value_array_32, TMP_Validator_coerce_native_hash_values_34;

          def.allow_undefined_props = def.rules = def.errors = nil;
          
          self.$attr_accessor("errors");
          self.$attr_reader("props_wrapper");
          self.$private("errors", "props_wrapper");
          
          Opal.defn(self, '$copy', TMP_Validator_copy_3 = function $$copy(new_props_wrapper) {
            var TMP_1, self = this;

            return $send(Opal.const_get_relative($nesting, 'Validator').$new(new_props_wrapper), 'tap', [], (TMP_1 = function(c){var self = TMP_1.$$s || this, TMP_2;
if (c == null) c = nil;
            return $send(["@allow_undefined_props", "@rules", "@errors"], 'each', [], (TMP_2 = function(var$){var self = TMP_2.$$s || this;
if (var$ == null) var$ = nil;
              return c.$instance_variable_set(var$, self.$instance_variable_get(var$).$dup())}, TMP_2.$$s = self, TMP_2.$$arity = 1, TMP_2))}, TMP_1.$$s = self, TMP_1.$$arity = 1, TMP_1))
          }, TMP_Validator_copy_3.$$arity = 1);
          
          Opal.defn(self, '$initialize', TMP_Validator_initialize_4 = function $$initialize(props_wrapper) {
            var self = this;

            if (props_wrapper == null) {
              props_wrapper = Opal.const_get_relative($nesting, 'Class').$new(Opal.const_get_relative($nesting, 'PropsWrapper'));
            }
            return (self.props_wrapper = props_wrapper)
          }, TMP_Validator_initialize_4.$$arity = -1);
          Opal.defs(self, '$build', TMP_Validator_build_5 = function $$build() {
            var self = this, $iter = TMP_Validator_build_5.$$p, block = $iter || nil;

            if ($iter) TMP_Validator_build_5.$$p = null;
            return $send(self.$new(), 'build', [], block.$to_proc())
          }, TMP_Validator_build_5.$$arity = 0);
          
          Opal.defn(self, '$build', TMP_Validator_build_6 = function $$build() {
            var self = this, $iter = TMP_Validator_build_6.$$p, block = $iter || nil;

            if ($iter) TMP_Validator_build_6.$$p = null;
            
            $send(self, 'instance_eval', [], block.$to_proc());
            return self;
          }, TMP_Validator_build_6.$$arity = 0);
          
          Opal.defn(self, '$requires', TMP_Validator_requires_7 = function $$requires(name, options) {
            var self = this, $writer = nil;

            if (options == null) {
              options = $hash2([], {});
            }
            
            
            $writer = ["required", true];
            $send(options, '[]=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];;
            return self.$define_rule(name, options);
          }, TMP_Validator_requires_7.$$arity = -2);
          
          Opal.defn(self, '$optional', TMP_Validator_optional_8 = function $$optional(name, options) {
            var self = this, $writer = nil;

            if (options == null) {
              options = $hash2([], {});
            }
            
            
            $writer = ["required", false];
            $send(options, '[]=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];;
            return self.$define_rule(name, options);
          }, TMP_Validator_optional_8.$$arity = -2);
          
          Opal.defn(self, '$event', TMP_Validator_event_9 = function $$event(name) {
            var self = this, $writer = nil;

            
            $writer = [name, self.$coerce_native_hash_values($hash2(["default", "type", "allow_nil"], {"default": nil, "type": Opal.const_get_relative($nesting, 'Proc'), "allow_nil": true}))];
            $send(self.$rules(), '[]=', Opal.to_a($writer));
            return $writer[$rb_minus($writer["length"], 1)];
          }, TMP_Validator_event_9.$$arity = 1);
          
          Opal.defn(self, '$all_other_params', TMP_Validator_all_other_params_12 = function $$all_other_params(name) {
            var TMP_10, self = this;

            
            self.allow_undefined_props = true;
            return $send(self.$props_wrapper(), 'define_all_others', [name], (TMP_10 = function(props){var self = TMP_10.$$s || this, TMP_11;
if (props == null) props = nil;
            return $send(props, 'reject', [], (TMP_11 = function(name, value){var self = TMP_11.$$s || this;
if (name == null) name = nil;if (value == null) value = nil;
              return self.$rules()['$[]'](name)}, TMP_11.$$s = self, TMP_11.$$arity = 2, TMP_11))}, TMP_10.$$s = self, TMP_10.$$arity = 1, TMP_10));
          }, TMP_Validator_all_other_params_12.$$arity = 1);
          
          Opal.defn(self, '$validate', TMP_Validator_validate_14 = function $$validate(props) {
            var TMP_13, self = this, $writer = nil;

            
            
            $writer = [[]];
            $send(self, 'errors=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];;
            if ($truthy(self['$allow_undefined_props?']())) {
              } else {
              self.$validate_undefined(props)
            };
            props = self.$coerce_native_hash_values(self.$defined_props(props));
            self.$validate_required(props);
            $send(props, 'each', [], (TMP_13 = function(name, value){var self = TMP_13.$$s || this;
if (name == null) name = nil;if (value == null) value = nil;
            
              self.$validate_types(name, value);
              return self.$validate_allowed(name, value);}, TMP_13.$$s = self, TMP_13.$$arity = 2, TMP_13));
            return self.$errors();
          }, TMP_Validator_validate_14.$$arity = 1);
          
          Opal.defn(self, '$default_props', TMP_Validator_default_props_17 = function $$default_props() {
            var TMP_15, TMP_16, self = this;

            return $send($send(self.$rules(), 'select', [], (TMP_15 = function(key, value){var self = TMP_15.$$s || this;
if (key == null) key = nil;if (value == null) value = nil;
            return value.$keys()['$include?']("default")}, TMP_15.$$s = self, TMP_15.$$arity = 2, TMP_15)), 'inject', [$hash2([], {})], (TMP_16 = function(memo, $a){var self = TMP_16.$$s || this, $a_args, k, v, $writer = nil;

              if ($a == null) {
                $a = nil;
              }
              $a = Opal.to_ary($a);
              $a_args = Opal.slice.call($a, 0, $a.length);
              k = $a_args.splice(0,1)[0];
              if (k == null) {
                k = nil;
              }
              v = $a_args.splice(0,1)[0];
              if (v == null) {
                v = nil;
              }if (memo == null) memo = nil;
            
              
              $writer = [k, v['$[]']("default")];
              $send(memo, '[]=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;
              return memo;}, TMP_16.$$s = self, TMP_16.$$arity = 2, TMP_16.$$has_top_level_mlhs_arg = true, TMP_16))
          }, TMP_Validator_default_props_17.$$arity = 0);
          self.$private();
          
          Opal.defn(self, '$defined_props', TMP_Validator_defined_props_19 = function $$defined_props(props) {
            var TMP_18, self = this;

            return $send(props, 'select', [], (TMP_18 = function(name){var self = TMP_18.$$s || this;
if (name == null) name = nil;
            return self.$rules().$keys()['$include?'](name)}, TMP_18.$$s = self, TMP_18.$$arity = 1, TMP_18))
          }, TMP_Validator_defined_props_19.$$arity = 1);
          
          Opal.defn(self, '$allow_undefined_props?', TMP_Validator_allow_undefined_props$q_20 = function() {
            var self = this;

            return self.allow_undefined_props['$!']()['$!']()
          }, TMP_Validator_allow_undefined_props$q_20.$$arity = 0);
          
          Opal.defn(self, '$rules', TMP_Validator_rules_21 = function $$rules() {
            var $a, self = this;

            return (self.rules = ($truthy($a = self.rules) ? $a : $hash2(["children"], {"children": $hash2(["required"], {"required": false})})))
          }, TMP_Validator_rules_21.$$arity = 0);
          
          Opal.defn(self, '$define_rule', TMP_Validator_define_rule_22 = function $$define_rule(name, options) {
            var self = this, $writer = nil;

            if (options == null) {
              options = $hash2([], {});
            }
            
            
            $writer = [name, self.$coerce_native_hash_values(options)];
            $send(self.$rules(), '[]=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];;
            return self.$props_wrapper().$define_param(name, options['$[]']("type"), options['$[]']("alias"));
          }, TMP_Validator_define_rule_22.$$arity = -2);
          
          Opal.defn(self, '$errors', TMP_Validator_errors_23 = function $$errors() {
            var $a, self = this;

            return (self.errors = ($truthy($a = self.errors) ? $a : []))
          }, TMP_Validator_errors_23.$$arity = 0);
          
          Opal.defn(self, '$validate_types', TMP_Validator_validate_types_24 = function $$validate_types(prop_name, value) {
            var self = this, klass = nil, allow_nil = nil;

            
            if ($truthy((klass = self.$rules()['$[]'](prop_name)['$[]']("type")))) {
              } else {
              return nil
            };
            if ($truthy(klass['$is_a?'](Opal.const_get_relative($nesting, 'Array'))['$!']())) {
              
              allow_nil = self.$rules()['$[]'](prop_name)['$[]']("allow_nil")['$!']()['$!']();
              return self.$type_check("" + "`" + (prop_name) + "`", value, klass, allow_nil);
            } else if ($truthy($rb_gt(klass.$length(), 0))) {
              return self.$validate_value_array(prop_name, value)
              } else {
              
              allow_nil = self.$rules()['$[]'](prop_name)['$[]']("allow_nil")['$!']()['$!']();
              return self.$type_check("" + "`" + (prop_name) + "`", value, Opal.const_get_relative($nesting, 'Array'), allow_nil);
            };
          }, TMP_Validator_validate_types_24.$$arity = 2);
          
          Opal.defn(self, '$type_check', TMP_Validator_type_check_25 = function $$type_check(prop_name, value, klass, allow_nil) {
            var $a, self = this;

            
            if ($truthy(($truthy($a = allow_nil) ? value['$nil?']() : $a))) {
              return nil};
            if ($truthy(value['$is_a?'](klass))) {
              return nil};
            if ($truthy(($truthy($a = klass['$respond_to?']("_react_param_conversion")) ? klass.$_react_param_conversion(value, "validate_only") : $a))) {
              return nil};
            return self.$errors()['$<<']("" + "Provided prop " + (prop_name) + " could not be converted to " + (klass));
          }, TMP_Validator_type_check_25.$$arity = 4);
          
          Opal.defn(self, '$validate_allowed', TMP_Validator_validate_allowed_26 = function $$validate_allowed(prop_name, value) {
            var self = this, values = nil;

            
            if ($truthy((values = self.$rules()['$[]'](prop_name)['$[]']("values")))) {
              } else {
              return nil
            };
            if ($truthy(values['$include?'](value))) {
              return nil};
            return self.$errors()['$<<']("" + "Value `" + (value) + "` for prop `" + (prop_name) + "` is not an allowed value");
          }, TMP_Validator_validate_allowed_26.$$arity = 2);
          
          Opal.defn(self, '$validate_required', TMP_Validator_validate_required_28 = function $$validate_required(props) {
            var TMP_27, self = this;

            return $send($rb_minus(self.$rules().$keys(), props.$keys()), 'each', [], (TMP_27 = function(name){var self = TMP_27.$$s || this;
if (name == null) name = nil;
            
              if ($truthy(self.$rules()['$[]'](name)['$[]']("required"))) {
                } else {
                return nil;
              };
              return self.$errors()['$<<']("" + "Required prop `" + (name) + "` was not specified");}, TMP_27.$$s = self, TMP_27.$$arity = 1, TMP_27))
          }, TMP_Validator_validate_required_28.$$arity = 1);
          
          Opal.defn(self, '$validate_undefined', TMP_Validator_validate_undefined_30 = function $$validate_undefined(props) {
            var TMP_29, self = this;

            return $send($rb_minus(props.$keys(), self.$rules().$keys()), 'each', [], (TMP_29 = function(prop_name){var self = TMP_29.$$s || this;
if (prop_name == null) prop_name = nil;
            return self.$errors()['$<<']("" + "Provided prop `" + (prop_name) + "` not specified in spec")}, TMP_29.$$s = self, TMP_29.$$arity = 1, TMP_29))
          }, TMP_Validator_validate_undefined_30.$$arity = 1);
          
          Opal.defn(self, '$validate_value_array', TMP_Validator_validate_value_array_32 = function $$validate_value_array(name, value) {
            var TMP_31, self = this, klass = nil, allow_nil = nil;

            try {
              
              klass = self.$rules()['$[]'](name)['$[]']("type");
              allow_nil = self.$rules()['$[]'](name)['$[]']("allow_nil")['$!']()['$!']();
              return $send(value, 'each_with_index', [], (TMP_31 = function(item, index){var self = TMP_31.$$s || this;
if (item == null) item = nil;if (index == null) index = nil;
              return self.$type_check("" + "`" + (name) + "`[" + (index) + "]", self.$Native(item), klass['$[]'](0), allow_nil)}, TMP_31.$$s = self, TMP_31.$$arity = 2, TMP_31));
            } catch ($err) {
              if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'NoMethodError')])) {
                try {
                  return self.$errors()['$<<']("" + "Provided prop `" + (name) + "` was not an Array")
                } finally { Opal.pop_exception() }
              } else { throw $err; }
            }
          }, TMP_Validator_validate_value_array_32.$$arity = 2);
          return (Opal.defn(self, '$coerce_native_hash_values', TMP_Validator_coerce_native_hash_values_34 = function $$coerce_native_hash_values(hash) {
            var TMP_33, self = this;

            return $send(hash, 'each', [], (TMP_33 = function(key, value){var self = TMP_33.$$s || this, $writer = nil;
if (key == null) key = nil;if (value == null) value = nil;
            
              $writer = [key, self.$Native(value)];
              $send(hash, '[]=', Opal.to_a($writer));
              return $writer[$rb_minus($writer["length"], 1)];}, TMP_33.$$s = self, TMP_33.$$arity = 2, TMP_33))
          }, TMP_Validator_coerce_native_hash_values_34.$$arity = 1), nil) && 'coerce_native_hash_values';
        })($nesting[0], null, $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/ext/component/string"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  return (function($base, $super, $parent_nesting) {
    function $String(){};
    var self = $String = $klass($base, $super, 'String', $String);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_String_event_camelize_1;

    return (Opal.defn(self, '$event_camelize', TMP_String_event_camelize_1 = function $$event_camelize() {
      var self = this;

      return self.replace(/(^|_)([^_]+)/g, function(match, pre, word, index) {
      var capitalize = true;
      return capitalize ? word.substr(0,1).toUpperCase()+word.substr(1) : word;
    })
    }, TMP_String_event_camelize_1.$$arity = 0), nil) && 'event_camelize'
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/component/element"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $hash2 = Opal.hash2, $send = Opal.send, $hash = Opal.hash;

  Opal.add_stubs(['$require', '$include', '$alias_native', '$attr_reader', '$attr_accessor', '$_update_ref', '$raise', '$is_a?', '$ref', '$dom_node', '$each', '$merge_event_prop!', '$to_proc', '$shallow_to_n', '$empty?', '$render', '$convert_props', '$new', '$type', '$block', '$delete', '$private', '$=~', '$merge_component_event_prop!', '$gsub', '$include?', '$event_camelize', '$merge_built_in_event_prop!', '$==', '$key_code', '$instance_variable_get', '$merge!', '$ignore_bulk_updates', '$Array']);
  
  self.$require("hyperstack/ext/component/string");
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Component, self = $Component = $module($base, 'Component');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $super, $parent_nesting) {
        function $Element(){};
        var self = $Element = $klass($base, $super, 'Element', $Element);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Element_initialize_1, TMP_Element__update_ref_2, TMP_Element_ref_3, TMP_Element_dom_node_4, TMP_Element_on_5, TMP_Element_render_7, TMP_Element_delete_8, TMP_Element_merge_event_prop$B_9, TMP_Element_merge_built_in_event_prop$B_11, TMP_Element_merge_component_event_prop$B_12;

        def._child_element = def.ref = def.type = def["native"] = def.properties = nil;
        
        self.$include(Opal.const_get_relative($nesting, 'Native'));
        self.$alias_native("element_type", "type");
        self.$alias_native("props", "props");
        self.$attr_reader("type");
        self.$attr_reader("properties");
        self.$attr_reader("block");
        self.$attr_accessor("waiting_on_resources");
        
        Opal.defn(self, '$initialize', TMP_Element_initialize_1 = function $$initialize(native_element, type, properties, block) {
          var $a, self = this;

          if (type == null) {
            type = nil;
          }
          if (properties == null) {
            properties = $hash2([], {});
          }
          if (block == null) {
            block = nil;
          }
          
          self.type = type;
          self.properties = ($truthy($a = (function() {if ($truthy(typeof properties === 'undefined')) {
            return nil
            } else {
            return properties
          }; return nil; })()) ? $a : $hash2([], {}));
          self.block = block;
          return (self["native"] = native_element);
        }, TMP_Element_initialize_1.$$arity = -2);
        
        Opal.defn(self, '$_update_ref', TMP_Element__update_ref_2 = function $$_update_ref(x) {
          var self = this;

          
          self.ref = x;
          if ($truthy(self._child_element)) {
            return self._child_element.$_update_ref(x)
            } else {
            return nil
          };
        }, TMP_Element__update_ref_2.$$arity = 1);
        
        Opal.defn(self, '$ref', TMP_Element_ref_3 = function $$ref() {
          var $a, self = this;

          return ($truthy($a = self.ref) ? $a : self.$raise("" + (self) + " has not been mounted yet"))
        }, TMP_Element_ref_3.$$arity = 0);
        
        Opal.defn(self, '$dom_node', TMP_Element_dom_node_4 = function $$dom_node() {
          var self = this;

          if ($truthy(self.type['$is_a?'](Opal.const_get_relative($nesting, 'String')))) {
            return self.$ref()
            } else {
            return self.$ref().$dom_node()
          }
        }, TMP_Element_dom_node_4.$$arity = 0);
        
        Opal.defn(self, '$on', TMP_Element_on_5 = function $$on($a_rest) {
          var TMP_6, self = this, event_names, $iter = TMP_Element_on_5.$$p, block = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          event_names = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            event_names[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_Element_on_5.$$p = null;
          
          $send(event_names, 'each', [], (TMP_6 = function(event_name){var self = TMP_6.$$s || this;
if (event_name == null) event_name = nil;
          return $send(self, 'merge_event_prop!', [event_name], block.$to_proc())}, TMP_6.$$s = self, TMP_6.$$arity = 1, TMP_6));
          self["native"] = React.cloneElement(self["native"], self.properties.$shallow_to_n());
          return self;
        }, TMP_Element_on_5.$$arity = -1);
        
        Opal.defn(self, '$render', TMP_Element_render_7 = function $$render($a_rest) {
          var self = this, props;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          props = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            props[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($truthy(props['$empty?']())) {
            return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext').$render(self)
            } else {
            
            props = $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'ReactWrapper'), 'convert_props', [self.type, self.properties].concat(Opal.to_a(props)));
            return (self._child_element = Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext').$render(Opal.const_get_relative($nesting, 'Element').$new(React.cloneElement(self["native"], props.$shallow_to_n()), self.$type(), props, self.$block())));
          }
        }, TMP_Element_render_7.$$arity = -1);
        
        Opal.defn(self, '$delete', TMP_Element_delete_8 = function() {
          var self = this;

          return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext').$delete(self)
        }, TMP_Element_delete_8.$$arity = 0);
        Opal.alias(self, "as_node", "delete");
        self.$private();
        
        Opal.defn(self, '$merge_event_prop!', TMP_Element_merge_event_prop$B_9 = function(event_name) {
          var TMP_10, self = this, $iter = TMP_Element_merge_event_prop$B_9.$$p, block = $iter || nil, name = nil;

          if ($iter) TMP_Element_merge_event_prop$B_9.$$p = null;
          if ($truthy(event_name['$=~'](/^<(.+)>$/))) {
            return $send(self, 'merge_component_event_prop!', [event_name.$gsub(/^<(.+)>$/, "\\1")], block.$to_proc())
          } else if ($truthy(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Event'), 'BUILT_IN_EVENTS')['$include?']((name = "" + "on" + (event_name.$event_camelize()))))) {
            return $send(self, 'merge_built_in_event_prop!', [name], block.$to_proc())
          } else if (event_name['$==']("enter")) {
            return $send(self, 'merge_built_in_event_prop!', ["onKeyDown"], (TMP_10 = function(evt){var self = TMP_10.$$s || this;
if (evt == null) evt = nil;
            if (evt.$key_code()['$=='](13)) {
                return Opal.yield1(block, evt);
                } else {
                return nil
              }}, TMP_10.$$s = self, TMP_10.$$arity = 1, TMP_10))
          } else if ($truthy(self.type.$instance_variable_get("@native_import"))) {
            return $send(self, 'merge_component_event_prop!', [name], block.$to_proc())
            } else {
            return $send(self, 'merge_component_event_prop!', ["" + "on_" + (event_name)], block.$to_proc())
          }
        }, TMP_Element_merge_event_prop$B_9.$$arity = 1);
        
        Opal.defn(self, '$merge_built_in_event_prop!', TMP_Element_merge_built_in_event_prop$B_11 = function(prop_name) {
          var self = this, $iter = TMP_Element_merge_built_in_event_prop$B_11.$$p, block = $iter || nil;

          if ($iter) TMP_Element_merge_built_in_event_prop$B_11.$$p = null;
          return self.properties['$merge!']($hash(prop_name, 
            function(){
              var react_event = arguments[0];
              var all_args;
              var other_args;
              if (arguments.length > 1) {
                all_args = Array.prototype.slice.call(arguments);
                other_args = all_args.slice(1, arguments.length);
                return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper'), 'ignore_bulk_updates', [Opal.const_get_relative($nesting, 'Event').$new(react_event)].concat(Opal.to_a((other_args))), block.$to_proc());
              } else {
                return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper'), 'ignore_bulk_updates', [Opal.const_get_relative($nesting, 'Event').$new(react_event)], block.$to_proc());
              }
            }
          ))
        }, TMP_Element_merge_built_in_event_prop$B_11.$$arity = 1);
        return (Opal.defn(self, '$merge_component_event_prop!', TMP_Element_merge_component_event_prop$B_12 = function(prop_name) {
          var self = this, $iter = TMP_Element_merge_component_event_prop$B_12.$$p, $yield = $iter || nil;

          if ($iter) TMP_Element_merge_component_event_prop$B_12.$$p = null;
          return self.properties['$merge!']($hash(prop_name, 
            function(){
              return Opal.yieldX($yield, Opal.to_a(self.$Array(arguments)))
            }
          ))
        }, TMP_Element_merge_component_event_prop$B_12.$$arity = 1), nil) && 'merge_component_event_prop!';
      })($nesting[0], null, $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/component/native_library"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $truthy = Opal.truthy, $range = Opal.range;

  Opal.add_stubs(['$each', '$lookup_native_name', '$create_component_wrapper', '$create_library_wrapper', '$raise', '$name', '$scope_native_name', '$+', '$downcase', '$[]', '$import_const_from_native', '$const_defined?', '$const_get', '$render', '$to_proc', '$private', '$native_react_component?', '$const_set', '$imports', '$new', '$class_eval', '$include']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Component, self = $Component = $module($base, 'Component');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $super, $parent_nesting) {
        function $NativeLibrary(){};
        var self = $NativeLibrary = $klass($base, $super, 'NativeLibrary', $NativeLibrary);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        
        (function(self, $parent_nesting) {
          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_imports_1, TMP_rename_3, TMP_import_const_from_native_4, TMP_const_missing_5, TMP_method_missing_6, TMP_lookup_native_name_7, TMP_scope_native_name_8, TMP_create_component_wrapper_10, TMP_create_library_wrapper_11;

          
          
          Opal.defn(self, '$imports', TMP_imports_1 = function $$imports(native_name) {
            var self = this;

            
            self.__hyperstack_component_native_prefix = "" + (native_name) + ".";
            return self;
          }, TMP_imports_1.$$arity = 1);
          
          Opal.defn(self, '$rename', TMP_rename_3 = function $$rename(rename_list) {
            var TMP_2, self = this;

            return $send(rename_list, 'each', [], (TMP_2 = function(js_name, ruby_name){var self = TMP_2.$$s || this, $a, native_name = nil;
if (js_name == null) js_name = nil;if (ruby_name == null) ruby_name = nil;
            
              native_name = self.$lookup_native_name(js_name);
              if ($truthy(self.$lookup_native_name(js_name))) {
                return ($truthy($a = self.$create_component_wrapper(self, native_name, ruby_name)) ? $a : self.$create_library_wrapper(self, native_name, ruby_name))
                } else {
                return self.$raise("" + ("" + "class " + (self.$name()) + " < Hyperstack::Component::NativeLibrary could not import " + (js_name) + ". ") + ("" + "Native value " + (self.$scope_native_name(js_name)) + " is undefined."))
              };}, TMP_2.$$s = self, TMP_2.$$arity = 2, TMP_2))
          }, TMP_rename_3.$$arity = 1);
          
          Opal.defn(self, '$import_const_from_native', TMP_import_const_from_native_4 = function $$import_const_from_native(klass, const_name, create_library) {
            var $a, $b, $c, self = this, native_name = nil;

            
            native_name = ($truthy($a = self.$lookup_native_name(const_name)) ? $a : self.$lookup_native_name($rb_plus(const_name['$[]'](0).$downcase(), const_name['$[]']($range(1, -1, false)))));
            return ($truthy($a = native_name) ? ($truthy($b = self.$create_component_wrapper(klass, native_name, const_name)) ? $b : ($truthy($c = create_library) ? self.$create_library_wrapper(klass, native_name, const_name) : $c)) : $a);
          }, TMP_import_const_from_native_4.$$arity = 3);
          
          Opal.defn(self, '$const_missing', TMP_const_missing_5 = function $$const_missing(const_name) {
            var $a, self = this, $iter = TMP_const_missing_5.$$p, $yield = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

            if ($iter) TMP_const_missing_5.$$p = null;
            // Prepare super implicit arguments
            for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
              $zuper[$zuper_i] = arguments[$zuper_i];
            }
            return ($truthy($a = self.$import_const_from_native(self, const_name, true)) ? $a : $send(self, Opal.find_super_dispatcher(self, 'const_missing', TMP_const_missing_5, false), $zuper, $iter))
          }, TMP_const_missing_5.$$arity = 1);
          
          Opal.defn(self, '$method_missing', TMP_method_missing_6 = function $$method_missing(method, $a_rest) {
            var $b, self = this, args, $iter = TMP_method_missing_6.$$p, block = $iter || nil, component_class = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 1;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 1] = arguments[$arg_idx];
            }
            if ($iter) TMP_method_missing_6.$$p = null;
            
            if ($truthy(self['$const_defined?'](method, false))) {
              component_class = self.$const_get(method)};
            component_class = ($truthy($b = component_class) ? $b : self.$import_const_from_native(self, method, false));
            if ($truthy(component_class)) {
              } else {
              self.$raise("" + "could not import a react component named: " + ("" + (self.$scope_native_name(method))))
            };
            return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext'), 'render', [component_class].concat(Opal.to_a(args)), block.$to_proc());
          }, TMP_method_missing_6.$$arity = -2);
          self.$private();
          
          Opal.defn(self, '$lookup_native_name', TMP_lookup_native_name_7 = function $$lookup_native_name(js_name) {
            var self = this, native_name = nil;

            try {
              
              native_name = self.$scope_native_name(js_name);
              return eval(native_name) !== undefined && native_name;
            } catch ($err) {
              if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exception')])) {
                try {
                  return nil
                } finally { Opal.pop_exception() }
              } else { throw $err; }
            }
          }, TMP_lookup_native_name_7.$$arity = 1);
          
          Opal.defn(self, '$scope_native_name', TMP_scope_native_name_8 = function $$scope_native_name(js_name) {
            var self = this;
            if (self.__hyperstack_component_native_prefix == null) self.__hyperstack_component_native_prefix = nil;

            return "" + (self.__hyperstack_component_native_prefix) + (js_name)
          }, TMP_scope_native_name_8.$$arity = 1);
          
          Opal.defn(self, '$create_component_wrapper', TMP_create_component_wrapper_10 = function $$create_component_wrapper(klass, native_name, ruby_name) {
            var TMP_9, self = this, new_klass = nil;

            if ($truthy(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'ReactWrapper')['$native_react_component?'](native_name))) {
              
              new_klass = klass.$const_set(ruby_name, Opal.const_get_relative($nesting, 'Class').$new(Opal.const_get_relative($nesting, 'NativeLibrary')).$imports(native_name));
              $send(new_klass, 'class_eval', [], (TMP_9 = function(){var self = TMP_9.$$s || this;

              
                self.$include(Opal.const_get_relative($nesting, 'Component'));
                return self.$imports(native_name);}, TMP_9.$$s = self, TMP_9.$$arity = 0, TMP_9));
              return new_klass;
              } else {
              return nil
            }
          }, TMP_create_component_wrapper_10.$$arity = 3);
          return (Opal.defn(self, '$create_library_wrapper', TMP_create_library_wrapper_11 = function $$create_library_wrapper(klass, native_name, ruby_name) {
            var self = this;

            return klass.$const_set(ruby_name, Opal.const_get_relative($nesting, 'Class').$new(Opal.const_get_relative($nesting, 'NativeLibrary')).$imports(native_name))
          }, TMP_create_library_wrapper_11.$$arity = 3), nil) && 'create_library_wrapper';
        })(Opal.get_singleton_class(self), $nesting);
        return self.$imports("NativeLibrary");
      })($nesting[0], null, $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/component/react_wrapper"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $send = Opal.send, $truthy = Opal.truthy, $range = Opal.range;

  Opal.add_stubs(['$require', '$instance_variable_set', '$[]=', '$-', '$raise', '$stateless?', '$eval_native_react_component', '$add_after_error_hook_to_native', '$[]', '$!', '$method_defined?', '$respond_to?', '$native_mixins', '$to_n', '$static_call_backs', '$new', '$name', '$default_props', '$prop_types', '$callbacks?', '$<<', '$is_a?', '$create_native_react_class', '$include?', '$lambda', '$_update_ref', '$convert_props', '$shallow_to_n', '$flatten', '$call', '$each', '$split', '$==', '$merge', '$lower_camelize', '$join', '$to_key', '$ignore_mutations', '$const_defined?', '$gsub', '$html_attr?', '$private', '$first', '$concat', '$map', '$+', '$upcase']);
  
  self.$require("hyperstack/component/native_library");
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Component, self = $Component = $module($base, 'Component');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $super, $parent_nesting) {
          function $ReactWrapper(){};
          var self = $ReactWrapper = $klass($base, $super, 'ReactWrapper', $ReactWrapper);

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ReactWrapper_stateless$q_1, TMP_ReactWrapper_import_native_component_2, TMP_ReactWrapper_eval_native_react_component_3, TMP_ReactWrapper_native_react_component$q_4, TMP_ReactWrapper_add_after_error_hook_5, TMP_ReactWrapper_add_after_error_hook_to_native_6, TMP_ReactWrapper_create_native_react_class_7, TMP_ReactWrapper_create_element_8, TMP_ReactWrapper_clear_component_class_cache_10, TMP_ReactWrapper_convert_props_21, TMP_ReactWrapper_lower_camelize_23;

          
          (Opal.class_variable_set($ReactWrapper, '@@component_classes', $hash2([], {})));
          Opal.defs(self, '$stateless?', TMP_ReactWrapper_stateless$q_1 = function(ncc) {
            var self = this;

            return typeof ncc === 'function' && !(ncc.prototype && ncc.prototype.isReactComponent)
          }, TMP_ReactWrapper_stateless$q_1.$$arity = 1);
          Opal.defs(self, '$import_native_component', TMP_ReactWrapper_import_native_component_2 = function $$import_native_component(opal_class, native_class) {
            var $a, self = this, $writer = nil;

            
            opal_class.$instance_variable_set("@native_import", true);
            
            $writer = [opal_class, native_class];
            $send((($a = $ReactWrapper.$$cvars['@@component_classes']) == null ? nil : $a), '[]=', Opal.to_a($writer));
            return $writer[$rb_minus($writer["length"], 1)];;
          }, TMP_ReactWrapper_import_native_component_2.$$arity = 2);
          Opal.defs(self, '$eval_native_react_component', TMP_ReactWrapper_eval_native_react_component_3 = function $$eval_native_react_component(name) {
            var $a, $b, self = this, component = nil, is_component_class = nil, has_render_method = nil;

            
            component = eval(name);
            if ($truthy(component === undefined)) {
              self.$raise("" + (name) + " is not defined")};
            is_component_class = ($truthy($a = component.prototype !== undefined) ? ($truthy($b = !!component.prototype.isReactComponent) ? $b : !!component.prototype.render) : $a);
            has_render_method = typeof component.render === "function";
            if ($truthy(($truthy($a = ($truthy($b = is_component_class) ? $b : self['$stateless?'](component))) ? $a : has_render_method))) {
              } else {
              self.$raise("does not appear to be a native react component")
            };
            return component;
          }, TMP_ReactWrapper_eval_native_react_component_3.$$arity = 1);
          Opal.defs(self, '$native_react_component?', TMP_ReactWrapper_native_react_component$q_4 = function(name) {
            var self = this;

            if (name == null) {
              name = nil;
            }
            try {
              
              if ($truthy(name)) {
                } else {
                return false
              };
              self.$eval_native_react_component(name);
              return true;
            } catch ($err) {
              if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'StandardError')])) {
                try {
                  return false
                } finally { Opal.pop_exception() }
              } else { throw $err; }
            }
          }, TMP_ReactWrapper_native_react_component$q_4.$$arity = -1);
          Opal.defs(self, '$add_after_error_hook', TMP_ReactWrapper_add_after_error_hook_5 = function $$add_after_error_hook(klass) {
            var $a, self = this;

            return self.$add_after_error_hook_to_native((($a = $ReactWrapper.$$cvars['@@component_classes']) == null ? nil : $a)['$[]'](klass))
          }, TMP_ReactWrapper_add_after_error_hook_5.$$arity = 1);
          Opal.defs(self, '$add_after_error_hook_to_native', TMP_ReactWrapper_add_after_error_hook_to_native_6 = function $$add_after_error_hook_to_native(native_comp) {
            var self = this;

            
            if ($truthy(native_comp)) {
              } else {
              return nil
            };
            
            native_comp.prototype.componentDidCatch = function(error, info) {
              this.__opalInstanceSyncSetState = false;
              this.__opalInstance.$component_did_catch(error, Opal.Hash.$new(info));
            }
          ;
          }, TMP_ReactWrapper_add_after_error_hook_to_native_6.$$arity = 1);
          Opal.defs(self, '$create_native_react_class', TMP_ReactWrapper_create_native_react_class_7 = function $$create_native_react_class(type) {
            var $a, $b, self = this, render_fn = nil, $writer = nil, comp = nil;

            
            if ($truthy(type['$method_defined?']("render")['$!']())) {
              self.$raise("Provided class should define `render` method")};
            render_fn = (function() {if ($truthy(type['$method_defined?']("_render_wrapper"))) {
              return "_render_wrapper"
              } else {
              return "render"
            }; return nil; })();
            return ($truthy($a = (($b = $ReactWrapper.$$cvars['@@component_classes']) == null ? nil : $b)['$[]'](type)) ? $a : (($writer = [type, ((comp = 
              class extends React.Component {
                constructor(props) {
                  super(props);
                  this.mixins = (function() {if ($truthy(type['$respond_to?']("native_mixins"))) {
              return type.$native_mixins()
              } else {
              return []
            }; return nil; })();
                  this.statics = (function() {if ($truthy(type['$respond_to?']("static_call_backs"))) {
              return type.$static_call_backs().$to_n()
              } else {
              return {}
            }; return nil; })();
                  this.state = {};
                  this.__opalInstanceInitializedState = false;
                  this.__opalInstanceSyncSetState = true;
                  this.__opalInstance = type.$new(this);
                  this.__opalInstanceInitializedState = true;
                  this.__opalInstanceSyncSetState = false;
                  this.__name = type.$name();
                }
                static get displayName() {
                  if (typeof this.__name != "undefined") {
                    return this.__name;
                  } else {
                    return type.$name();
                  }
                }
                static set displayName(name) {
                  this.__name = name;
                }
                static get defaultProps() {
                  return (function() {if ($truthy(type['$respond_to?']("default_props"))) {
              return type.$default_props().$to_n()
              } else {
              return {}
            }; return nil; })();
                }
                static get propTypes() {
                  return  (function() {if ($truthy(type['$respond_to?']("prop_types"))) {
              return type.$prop_types().$to_n()
              } else {
              return {}
            }; return nil; })();
                }
                componentWillMount() {
                  if (type['$method_defined?']("component_will_mount")) {
                    this.__opalInstanceSyncSetState = true;
                    this.__opalInstance.$component_will_mount();
                    this.__opalInstanceSyncSetState = false;
                  }
                }
                componentDidMount() {
                  this.__opalInstance.__hyperstack_component_is_mounted = true
                  if (type['$method_defined?']("component_did_mount")) {
                    this.__opalInstanceSyncSetState = false;
                    this.__opalInstance.$component_did_mount();
                  }
                }
                componentWillReceiveProps(next_props) {
                  if (type['$method_defined?']("component_will_receive_props")) {
                    this.__opalInstanceSyncSetState = true;
                    this.__opalInstance.$component_will_receive_props(Opal.Hash.$new(next_props));
                    this.__opalInstanceSyncSetState = false;
                  }
                }
                shouldComponentUpdate(next_props, next_state) {
                  if (type['$method_defined?']("should_component_update?")) {
                    this.__opalInstanceSyncSetState = false;
                    return this.__opalInstance["$should_component_update?"](Opal.Hash.$new(next_props), Opal.Hash.$new(next_state));
                  } else { return true; }
                }
                componentWillUpdate(next_props, next_state) {
                  if (type['$method_defined?']("component_will_update")) {
                    this.__opalInstanceSyncSetState = false;
                    this.__opalInstance.$component_will_update(Opal.Hash.$new(next_props), Opal.Hash.$new(next_state));
                  }
                }
                componentDidUpdate(prev_props, prev_state) {
                  if (type['$method_defined?']("component_did_update")) {
                    this.__opalInstanceSyncSetState = false;
                    this.__opalInstance.$component_did_update(Opal.Hash.$new(prev_props), Opal.Hash.$new(prev_state));
                  }
                }
                componentWillUnmount() {
                  if (type['$method_defined?']("component_will_unmount")) {
                    this.__opalInstanceSyncSetState = false;
                    this.__opalInstance.$component_will_unmount();
                  }
                  this.__opalInstance.__hyperstack_component_is_mounted = false;
                }

                render() {
                  this.__opalInstanceSyncSetState = false;
                  return this.__opalInstance.$send(render_fn).$to_n();
                }
              }
            ), (function() {if ($truthy(($truthy($b = type['$respond_to?']("callbacks?")) ? type['$callbacks?']("after_error") : $b))) {
              return self.$add_after_error_hook_to_native(comp)
              } else {
              return nil
            }; return nil; })(), comp)]), $send((($b = $ReactWrapper.$$cvars['@@component_classes']) == null ? nil : $b), '[]=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]));
          }, TMP_ReactWrapper_create_native_react_class_7.$$arity = 1);
          Opal.defs(self, '$create_element', TMP_ReactWrapper_create_element_8 = function $$create_element(type, $a_rest) {
            var $b, TMP_9, self = this, args, $iter = TMP_ReactWrapper_create_element_8.$$p, block = $iter || nil, params = nil, ncc = nil, ele = nil, ref = nil, properties = nil, a = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 1;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 1] = arguments[$arg_idx];
            }
            if ($iter) TMP_ReactWrapper_create_element_8.$$p = null;
            
            params = [];
            ncc = (($b = $ReactWrapper.$$cvars['@@component_classes']) == null ? nil : $b)['$[]'](type);
            if ($truthy(ncc)) {
              params['$<<'](ncc)
            } else if ($truthy(type['$is_a?'](Opal.const_get_relative($nesting, 'Class')))) {
              params['$<<'](self.$create_native_react_class(type))
            } else if ($truthy(($truthy($b = (block !== nil)) ? $b : Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Tags'), 'HTML_TAGS')['$include?'](type)))) {
              params['$<<'](type)
            } else if ($truthy(type['$is_a?'](Opal.const_get_relative($nesting, 'String')))) {
              return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Element').$new(type)
              } else {
              self.$raise("" + (type) + " not implemented")
            };
            ele = nil;
            if ($truthy(self['$stateless?'](ncc))) {
              } else {
              ref = $send(self, 'lambda', [], (TMP_9 = function(ref){var self = TMP_9.$$s || this;
if (ref == null) ref = nil;
              return ele.$_update_ref(ref)}, TMP_9.$$s = self, TMP_9.$$arity = 1, TMP_9))
            };
            properties = $send(self, 'convert_props', [type, $hash2(["ref"], {"ref": ref})].concat(Opal.to_a(args)));
            params['$<<'](properties.$shallow_to_n());
            if ($truthy(block)) {
              
              a = [block.$call()].$flatten();
              
              for(var i=0, l=a.length; i<l; i++) {
                params.push(a[i].$to_n());
              }
            ;};
            return (ele = Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Element').$new(React.createElement.apply(null, params), type, properties, block));
          }, TMP_ReactWrapper_create_element_8.$$arity = -2);
          Opal.defs(self, '$clear_component_class_cache', TMP_ReactWrapper_clear_component_class_cache_10 = function $$clear_component_class_cache() {
            var self = this;

            return (Opal.class_variable_set($ReactWrapper, '@@component_classes', $hash2([], {})))
          }, TMP_ReactWrapper_clear_component_class_cache_10.$$arity = 0);
          Opal.defs(self, '$convert_props', TMP_ReactWrapper_convert_props_21 = function $$convert_props(type, $a_rest) {
            var TMP_11, TMP_13, self = this, args, properties = nil, props = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 1;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 1] = arguments[$arg_idx];
            }
            
            properties = $hash2([], {});
            $send(args, 'each', [], (TMP_11 = function(arg){var self = TMP_11.$$s || this, TMP_12, $writer = nil;
if (arg == null) arg = nil;
            if ($truthy(arg['$is_a?'](Opal.const_get_relative($nesting, 'String')))) {
                
                $writer = [arg, true];
                $send(properties, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];
              } else if ($truthy(arg['$is_a?'](Opal.const_get_relative($nesting, 'Hash')))) {
                return $send(arg, 'each', [], (TMP_12 = function(key, value){var self = TMP_12.$$s || this, $a;
if (key == null) key = nil;if (value == null) value = nil;
                if ($truthy(["class", "className", "class_name"]['$include?'](key))) {
                    
                    if ($truthy(value)) {
                      } else {
                      return nil;
                    };
                    if ($truthy(value['$is_a?'](Opal.const_get_relative($nesting, 'String')))) {
                      value = value.$split(" ")
                    } else if ($truthy(value['$is_a?'](Opal.const_get_relative($nesting, 'Array'))['$!']())) {
                      self.$raise("The class param must be a string or array of strings")};
                    
                    $writer = ["className", [].concat(Opal.to_a(properties['$[]']("className"))).concat(Opal.to_a(value))];
                    $send(properties, '[]=', Opal.to_a($writer));
                    return $writer[$rb_minus($writer["length"], 1)];;
                  } else if (key['$==']("style")) {
                    
                    if ($truthy(value)) {
                      } else {
                      return nil;
                    };
                    if ($truthy(value['$is_a?'](Opal.const_get_relative($nesting, 'Hash'))['$!']())) {
                      self.$raise("The style param must be a Hash")};
                    
                    $writer = ["style", ($truthy($a = properties['$[]']("style")) ? $a : $hash2([], {})).$merge(value)];
                    $send(properties, '[]=', Opal.to_a($writer));
                    return $writer[$rb_minus($writer["length"], 1)];;
                  } else if ($truthy(($truthy($a = Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'ReactAPI'), 'HASH_ATTRIBUTES')['$include?'](key)) ? value['$is_a?'](Opal.const_get_relative($nesting, 'Hash')) : $a))) {
                    
                    $writer = [key, ($truthy($a = properties['$[]'](key)) ? $a : $hash2([], {})).$merge(value)];
                    $send(properties, '[]=', Opal.to_a($writer));
                    return $writer[$rb_minus($writer["length"], 1)];
                    } else {
                    
                    $writer = [key, value];
                    $send(properties, '[]=', Opal.to_a($writer));
                    return $writer[$rb_minus($writer["length"], 1)];
                  }}, TMP_12.$$s = self, TMP_12.$$arity = 2, TMP_12))
                } else {
                return nil
              }}, TMP_11.$$s = self, TMP_11.$$arity = 1, TMP_11));
            props = $hash2([], {});
            $send(properties, 'each', [], (TMP_13 = function(key, value){var self = TMP_13.$$s || this, TMP_14, TMP_15, TMP_16, TMP_17, TMP_18, TMP_19, $a, TMP_20, $writer = nil, fn = nil;
if (key == null) key = nil;if (value == null) value = nil;
            if ($truthy(["style", "dangerously_set_inner_HTML"]['$include?'](key))) {
                
                $writer = [self.$lower_camelize(key), value.$to_n()];
                $send(props, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];
              } else if (key['$==']("className")) {
                
                $writer = [key, value.$join(" ")];
                $send(props, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];
              } else if (key['$==']("key")) {
                
                $writer = ["key", value.$to_key()];
                $send(props, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];
              } else if (key['$==']("init")) {
                
                if ($truthy(["select", "textarea"]['$include?'](type))) {
                  key = "defaultValue"
                } else if (type['$==']("input")) {
                  key = (function() {if ($truthy(["radio", "checkbox"]['$include?'](properties['$[]']("type")))) {
                    return "defaultChecked"
                    } else {
                    return "defaultValue"
                  }; return nil; })()};
                
                $writer = [key, value];
                $send(props, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];;
              } else if (key['$==']("ref")) {
                
                if ($truthy(value)) {
                  } else {
                  return nil;
                };
                if ($truthy(value['$respond_to?']("call"))) {
                  } else {
                  self.$raise("" + "The ref and dom params must be given a Proc.\n" + "If you want to capture the ref in an instance variable use the `set` method.\n" + "For example `ref: set(:TheRef)` will capture assign the ref to `@TheRef`\n")
                };
                if ($truthy(value.__hyperstack_component_ref_is_already_wrapped)) {
                  } else {
                  
                  fn = value;
                  value = 
                          function(dom_node){
                            if (dom_node !== null && dom_node.__opalInstance !== undefined && dom_node.__opalInstance !== null) {
                              $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'State'), 'Mapper'), 'ignore_mutations', [], (TMP_14 = function(){var self = TMP_14.$$s || this;

                  return fn.$call(dom_node.__opalInstance)}, TMP_14.$$s = self, TMP_14.$$arity = 0, TMP_14));
                            } else if(dom_node !== null && ReactDOM.findDOMNode !== undefined && dom_node.nodeType === undefined) {
                              $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'State'), 'Mapper'), 'ignore_mutations', [], (TMP_15 = function(){var self = TMP_15.$$s || this;

                  return fn.$call(ReactDOM.findDOMNode(dom_node))}, TMP_15.$$s = self, TMP_15.$$arity = 0, TMP_15));
                            } else if(dom_node !== null){
                              $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'State'), 'Mapper'), 'ignore_mutations', [], (TMP_16 = function(){var self = TMP_16.$$s || this;

                  return fn.$call(dom_node)}, TMP_16.$$s = self, TMP_16.$$arity = 0, TMP_16));
                            }
                          }
                        ;
                  value.__hyperstack_component_ref_is_already_wrapped = true;
                };
                
                $writer = [key, value];
                $send(props, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];;
              } else if (key['$==']("jq_ref")) {
                
                if ($truthy(value['$respond_to?']("call"))) {
                  } else {
                  self.$raise("" + "The ref and dom params must be given a Proc.\n" + "If you want to capture the dom node in an instance variable use the `set` method.\n" + "For example `dom: set(:DomNode)` will assign the dom node to `@DomNode`\n")
                };
                if ($truthy(Opal.const_get_relative($nesting, 'Module')['$const_defined?']("Element"))) {
                  } else {
                  self.$raise("" + "You must include 'hyperstack/component/jquery' " + "in your manifest to use the `dom` reference key.\n" + "For example if using rails include " + "`config.import 'hyperstack/component/jquery', client_only: true`" + "in your config/initializer/hyperstack.rb file")
                };
                
                $writer = ["ref", 
                              function(dom_node){
                                if (dom_node !== null && dom_node.__opalInstance !== undefined && dom_node.__opalInstance !== null) {
                                  $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'State'), 'Mapper'), 'ignore_mutations', [], (TMP_17 = function(){var self = TMP_17.$$s || this;

                return value.$call(Opal.const_get_qualified('::', 'Element')['$[]'](dom_node.__opalInstance))}, TMP_17.$$s = self, TMP_17.$$arity = 0, TMP_17));
                                } else if(dom_node !== null && ReactDOM.findDOMNode !== undefined && dom_node.nodeType === undefined) {
                                  $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'State'), 'Mapper'), 'ignore_mutations', [], (TMP_18 = function(){var self = TMP_18.$$s || this;

                return value.$call(Opal.const_get_qualified('::', 'Element')['$[]'](ReactDOM.findDOMNode(dom_node)))}, TMP_18.$$s = self, TMP_18.$$arity = 0, TMP_18));
                                } else if(dom_node !== null) {
                                  $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'State'), 'Mapper'), 'ignore_mutations', [], (TMP_19 = function(){var self = TMP_19.$$s || this;

                return value.$call(Opal.const_get_qualified('::', 'Element')['$[]'](dom_node))}, TMP_19.$$s = self, TMP_19.$$arity = 0, TMP_19));
                                }
                              }
                            ];
                $send(props, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];;
              } else if ($truthy(($truthy($a = Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'ReactAPI'), 'HASH_ATTRIBUTES')['$include?'](key)) ? value['$is_a?'](Opal.const_get_relative($nesting, 'Hash')) : $a))) {
                return $send(value, 'each', [], (TMP_20 = function(k, v){var self = TMP_20.$$s || this;
if (k == null) k = nil;if (v == null) v = nil;
                
                  $writer = ["" + (key) + "-" + (k.$gsub(/__|_/, $hash2(["__", "_"], {"__": "_", "_": "-"}))), v.$to_n()];
                  $send(props, '[]=', Opal.to_a($writer));
                  return $writer[$rb_minus($writer["length"], 1)];}, TMP_20.$$s = self, TMP_20.$$arity = 2, TMP_20))
                } else {
                
                $writer = [(function() {if ($truthy(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'ReactAPI')['$html_attr?'](self.$lower_camelize(key)))) {
                  return self.$lower_camelize(key)
                  } else {
                  return key
                }; return nil; })(), value];
                $send(props, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];
              }}, TMP_13.$$s = self, TMP_13.$$arity = 2, TMP_13));
            return props;
          }, TMP_ReactWrapper_convert_props_21.$$arity = -2);
          self.$private();
          return Opal.defs(self, '$lower_camelize', TMP_ReactWrapper_lower_camelize_23 = function $$lower_camelize(snake_cased_word) {
            var TMP_22, self = this, words = nil, result = nil;

            
            words = snake_cased_word.$split("_");
            result = [words.$first()];
            return result.$concat($send(words['$[]']($range(1, -1, false)), 'map', [], (TMP_22 = function(word){var self = TMP_22.$$s || this;
if (word == null) word = nil;
            return $rb_plus(word['$[]'](0).$upcase(), word['$[]']($range(1, -1, false)))}, TMP_22.$$s = self, TMP_22.$$arity = 1, TMP_22))).$join("");
          }, TMP_ReactWrapper_lower_camelize_23.$$arity = 1);
        })($nesting[0], null, $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/ext/component/hash"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $send = Opal.send;

  Opal.add_stubs(['$each']);
  return (function($base, $super, $parent_nesting) {
    function $Hash(){};
    var self = $Hash = $klass($base, $super, 'Hash', $Hash);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Hash_shallow_to_n_2;

    return (Opal.defn(self, '$shallow_to_n', TMP_Hash_shallow_to_n_2 = function $$shallow_to_n() {
      var TMP_1, self = this, hash = nil;

      
      hash = {};
      $send(self, 'each', [], (TMP_1 = function(key, value){var self = TMP_1.$$s || this;
if (key == null) key = nil;if (value == null) value = nil;
      return hash[key] = value}, TMP_1.$$s = self, TMP_1.$$arity = 2, TMP_1));
      return hash;
    }, TMP_Hash_shallow_to_n_2.$$arity = 0), nil) && 'shallow_to_n'
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/component/rendering_context"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$attr_accessor', '$waiting_on_resources', '$raise_if_not_quiet?', '$raise', '$new', '$!', '$remove_nodes_from_args', '$build', '$waiting_on_resources=', '$-', '$run_child_block', '$nil?', '$to_proc', '$dup', '$tap', '$create_element', '$detect', '$respond_to?', '$is_a?', '$last', '$to_s', '$render', '$<<', '$delete', '$include?', '$index', '$[]=', '$[]', '$each', '$acts_as_string?', '$empty?', '$!=', '$raise_render_error', '$==', '$count', '$improper_render', '$>', '$try', '$class', '$define_method', '$unshift', '$hyper_component?', '$send']);
  
  (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Component, self = $Component = $module($base, 'Component');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $super, $parent_nesting) {
          function $RenderingContext(){};
          var self = $RenderingContext = $klass($base, $super, 'RenderingContext', $RenderingContext);

          var def = self.$$proto, $nesting = [self].concat($parent_nesting);

          
          (function($base, $super, $parent_nesting) {
            function $NotQuiet(){};
            var self = $NotQuiet = $klass($base, $super, 'NotQuiet', $NotQuiet);

            var def = self.$$proto, $nesting = [self].concat($parent_nesting);

            return nil
          })($nesting[0], Opal.const_get_relative($nesting, 'Exception'), $nesting);
          return (function(self, $parent_nesting) {
            var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_raise_if_not_quiet$q_1, TMP_raise_if_not_quiet$eq_2, TMP_quiet_test_3, TMP_render_4, TMP_build_12, TMP_delete_13, TMP_rendered$q_14, TMP_replace_15, TMP_remove_nodes_from_args_17, TMP_run_child_block_18, TMP_raise_render_error_20, TMP_improper_render_21;

            
            self.$attr_accessor("waiting_on_resources");
            
            Opal.defn(self, '$raise_if_not_quiet?', TMP_raise_if_not_quiet$q_1 = function() {
              var self = this;
              if (self.raise_if_not_quiet == null) self.raise_if_not_quiet = nil;

              return self.raise_if_not_quiet
            }, TMP_raise_if_not_quiet$q_1.$$arity = 0);
            
            Opal.defn(self, '$raise_if_not_quiet=', TMP_raise_if_not_quiet$eq_2 = function(x) {
              var self = this;

              return (self.raise_if_not_quiet = x)
            }, TMP_raise_if_not_quiet$eq_2.$$arity = 1);
            
            Opal.defn(self, '$quiet_test', TMP_quiet_test_3 = function $$quiet_test(component) {
              var $a, self = this;

              
              if ($truthy(($truthy($a = component.$waiting_on_resources()) ? self['$raise_if_not_quiet?']() : $a))) {
                } else {
                return nil
              };
              return self.$raise(Opal.const_get_relative($nesting, 'NotQuiet').$new("" + (component) + " is waiting on resources"));
            }, TMP_quiet_test_3.$$arity = 1);
            
            Opal.defn(self, '$render', TMP_render_4 = function $$render(name, $a_rest) {
              var $b, TMP_5, self = this, args, $iter = TMP_render_4.$$p, block = $iter || nil, was_outer_most = nil, element = nil, $writer = nil;
              if (self.not_outer_most == null) self.not_outer_most = nil;
              if (self.buffer == null) self.buffer = nil;

              var $args_len = arguments.length, $rest_len = $args_len - 1;
              if ($rest_len < 0) { $rest_len = 0; }
              args = new Array($rest_len);
              for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
                args[$arg_idx - 1] = arguments[$arg_idx];
              }
              if ($iter) TMP_render_4.$$p = null;
              return (function() { try {
              
              was_outer_most = self.not_outer_most['$!']();
              self.not_outer_most = true;
              self.$remove_nodes_from_args(args);
              if ($truthy(self.buffer)) {
                } else {
                self.buffer = ($truthy($b = self.buffer) ? $b : [])
              };
              if ($truthy(block)) {
                element = $send(self, 'build', [], (TMP_5 = function(){var self = TMP_5.$$s || this, TMP_6, TMP_7, TMP_9, TMP_10, TMP_11, saved_waiting_on_resources = nil, $writer = nil, buffer = nil, buffer_s = nil;
                  if (self.buffer == null) self.buffer = nil;

                
                  saved_waiting_on_resources = nil;
                  
                  $writer = [nil];
                  $send(self, 'waiting_on_resources=', Opal.to_a($writer));
                  $writer[$rb_minus($writer["length"], 1)];;
                  $send(self, 'run_child_block', [name['$nil?']()], block.$to_proc());
                  if ($truthy(name)) {
                    
                    buffer = self.buffer.$dup();
                    return $send($send(Opal.const_get_relative($nesting, 'ReactWrapper'), 'create_element', [name].concat(Opal.to_a(args)), (TMP_6 = function(){var self = TMP_6.$$s || this;

                    return buffer}, TMP_6.$$s = self, TMP_6.$$arity = 0, TMP_6)), 'tap', [], (TMP_7 = function(element){var self = TMP_7.$$s || this, $a, TMP_8;
if (element == null) element = nil;
                    
                      
                      $writer = [($truthy($a = saved_waiting_on_resources) ? $a : $send(buffer, 'detect', [], (TMP_8 = function(e){var self = TMP_8.$$s || this;
if (e == null) e = nil;
                      if ($truthy(e['$respond_to?']("waiting_on_resources"))) {
                          return e.$waiting_on_resources()
                          } else {
                          return nil
                        }}, TMP_8.$$s = self, TMP_8.$$arity = 1, TMP_8))['$!']()['$!']())];
                      $send(element, 'waiting_on_resources=', Opal.to_a($writer));
                      $writer[$rb_minus($writer["length"], 1)];;
                      if ($truthy(buffer.$last()['$is_a?'](Opal.const_get_relative($nesting, 'String')))) {
                        return ($truthy($a = element.$waiting_on_resources()) ? $a : (($writer = [self.$waiting_on_resources()]), $send(element, 'waiting_on_resources=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]))
                        } else {
                        return nil
                      };}, TMP_7.$$s = self, TMP_7.$$arity = 1, TMP_7));
                  } else if ($truthy(self.buffer.$last()['$is_a?'](Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Element')))) {
                    return $send(self.buffer.$last(), 'tap', [], (TMP_9 = function(element){var self = TMP_9.$$s || this, $a;
if (element == null) element = nil;
                    return ($truthy($a = element.$waiting_on_resources()) ? $a : (($writer = [saved_waiting_on_resources]), $send(element, 'waiting_on_resources=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]))}, TMP_9.$$s = self, TMP_9.$$arity = 1, TMP_9))
                    } else {
                    
                    buffer_s = self.buffer.$last().$to_s();
                    return $send($send(Opal.const_get_relative($nesting, 'RenderingContext'), 'render', ["span"], (TMP_10 = function(){var self = TMP_10.$$s || this;

                    return buffer_s}, TMP_10.$$s = self, TMP_10.$$arity = 0, TMP_10)), 'tap', [], (TMP_11 = function(element){var self = TMP_11.$$s || this;
if (element == null) element = nil;
                    
                      $writer = [saved_waiting_on_resources];
                      $send(element, 'waiting_on_resources=', Opal.to_a($writer));
                      return $writer[$rb_minus($writer["length"], 1)];}, TMP_11.$$s = self, TMP_11.$$arity = 1, TMP_11));
                  };}, TMP_5.$$s = self, TMP_5.$$arity = 0, TMP_5))
              } else if ($truthy(name['$is_a?'](Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Element')))) {
                element = name
                } else {
                
                element = $send(Opal.const_get_relative($nesting, 'ReactWrapper'), 'create_element', [name].concat(Opal.to_a(args)));
                
                $writer = [self.$waiting_on_resources()];
                $send(element, 'waiting_on_resources=', Opal.to_a($writer));
                $writer[$rb_minus($writer["length"], 1)];;
              };
              self.buffer['$<<'](element);
              
              $writer = [nil];
              $send(self, 'waiting_on_resources=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;
              return element;
              } finally {
                (function() {if ($truthy(was_outer_most)) {
                  return (self.not_outer_most = (self.buffer = nil))
                  } else {
                  return nil
                }; return nil; })()
              }; })()
            }, TMP_render_4.$$arity = -2);
            
            Opal.defn(self, '$build', TMP_build_12 = function $$build() {
              var self = this, $iter = TMP_build_12.$$p, $yield = $iter || nil, current = nil, return_val = nil;
              if (self.buffer == null) self.buffer = nil;

              if ($iter) TMP_build_12.$$p = null;
              
              current = self.buffer;
              self.buffer = [];
              return_val = Opal.yield1($yield, self.buffer);
              self.buffer = current;
              return return_val;
            }, TMP_build_12.$$arity = 0);
            
            Opal.defn(self, '$delete', TMP_delete_13 = function(element) {
              var self = this;
              if (self.buffer == null) self.buffer = nil;

              
              self.buffer.$delete(element);
              return element;
            }, TMP_delete_13.$$arity = 1);
            Opal.alias(self, "as_node", "delete");
            
            Opal.defn(self, '$rendered?', TMP_rendered$q_14 = function(element) {
              var self = this;
              if (self.buffer == null) self.buffer = nil;

              return self.buffer['$include?'](element)
            }, TMP_rendered$q_14.$$arity = 1);
            
            Opal.defn(self, '$replace', TMP_replace_15 = function $$replace(e1, e2) {
              var self = this, $writer = nil;
              if (self.buffer == null) self.buffer = nil;

              
              $writer = [self.buffer.$index(e1), e2];
              $send(self.buffer, '[]=', Opal.to_a($writer));
              return $writer[$rb_minus($writer["length"], 1)];
            }, TMP_replace_15.$$arity = 2);
            
            Opal.defn(self, '$remove_nodes_from_args', TMP_remove_nodes_from_args_17 = function $$remove_nodes_from_args(args) {
              var $a, TMP_16, self = this;

              if ($truthy(($truthy($a = args['$[]'](0)) ? args['$[]'](0)['$is_a?'](Opal.const_get_relative($nesting, 'Hash')) : $a))) {
                return $send(args['$[]'](0), 'each', [], (TMP_16 = function(key, value){var self = TMP_16.$$s || this;
if (key == null) key = nil;if (value == null) value = nil;
                
                  try {
                    if ($truthy(value['$is_a?'](Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Element')))) {
                      return value.$delete()
                      } else {
                      return nil
                    }
                  } catch ($err) {
                    if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exception')])) {
                      try {
                        return nil
                      } finally { Opal.pop_exception() }
                    } else { throw $err; }
                  };}, TMP_16.$$s = self, TMP_16.$$arity = 2, TMP_16))
                } else {
                return nil
              }
            }, TMP_remove_nodes_from_args_17.$$arity = 1);
            
            Opal.defn(self, '$run_child_block', TMP_run_child_block_18 = function $$run_child_block(is_outer_scope) {
              var $a, TMP_19, $b, self = this, $iter = TMP_run_child_block_18.$$p, $yield = $iter || nil, result = nil;
              if (self.buffer == null) self.buffer = nil;

              if ($iter) TMP_run_child_block_18.$$p = null;
              
              result = Opal.yieldX($yield, []);
              if ($truthy(($truthy($a = result['$respond_to?']("acts_as_string?")) ? result['$acts_as_string?']() : $a))) {
                $send(Opal.const_get_relative($nesting, 'RenderingContext'), 'render', ["span"], (TMP_19 = function(){var self = TMP_19.$$s || this;

                return result.$to_s()}, TMP_19.$$s = self, TMP_19.$$arity = 0, TMP_19))
              } else if ($truthy(($truthy($a = result['$is_a?'](Opal.const_get_relative($nesting, 'String'))) ? $a : ($truthy($b = result['$is_a?'](Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Element'))) ? self.buffer['$empty?']() : $b)))) {
                self.buffer['$<<'](result)};
              if ($truthy(($truthy($a = is_outer_scope) ? self.buffer['$!=']([result]) : $a))) {
                return self.$raise_render_error(result)
                } else {
                return nil
              };
            }, TMP_run_child_block_18.$$arity = 1);
            
            Opal.defn(self, '$raise_render_error', TMP_raise_render_error_20 = function $$raise_render_error(result) {
              var self = this;
              if (self.buffer == null) self.buffer = nil;

              
              if (self.buffer.$count()['$=='](1)) {
                self.$improper_render("A different element was returned than was generated within the DSL.", "Possibly improper use of Element#delete.")};
              if ($truthy($rb_gt(self.buffer.$count(), 1))) {
                self.$improper_render("" + "Instead " + (self.buffer.$count()) + " elements were generated.", "Do you want to wrap your elements in a div?")};
              if ($truthy(result.$try("hyper_component?"))) {
                self.$improper_render("" + "Instead the component " + (result) + " was returned.", "" + "Did you mean " + (result) + "()?")};
              return self.$improper_render("" + "Instead the " + (result.$class()) + " " + (result) + " was returned.", "You may need to convert this to a string.");
            }, TMP_raise_render_error_20.$$arity = 1);
            return (Opal.defn(self, '$improper_render', TMP_improper_render_21 = function $$improper_render(message, solution) {
              var self = this;

              return self.$raise("" + "a component's render method must generate and return exactly 1 element or a string.\n" + ("" + "    " + (message) + "  " + (solution)))
            }, TMP_improper_render_21.$$arity = 2), nil) && 'improper_render';
          })(Opal.get_singleton_class(self), $nesting);
        })($nesting[0], null, $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting);
  return (function($base, $super, $parent_nesting) {
    function $Object(){};
    var self = $Object = $klass($base, $super, 'Object', $Object);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Object_22, TMP_Object_para_25, TMP_Object_br_28;

    
    $send(["span", "td", "th"], 'each', [], (TMP_Object_22 = function(tag){var self = TMP_Object_22.$$s || this, TMP_23;
if (tag == null) tag = nil;
    return $send(self, 'define_method', [tag], (TMP_23 = function($a_rest){var self = TMP_23.$$s || this, block, args, $b, TMP_24;

        block = TMP_23.$$p || nil;
        if (block) TMP_23.$$p = null;
        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 0] = arguments[$arg_idx];
        }
      
        args.$unshift(tag);
        if ($truthy(($truthy($b = self['$respond_to?']("hyper_component?")) ? self['$hyper_component?']() : $b))) {
          return $send(self, 'send', Opal.to_a(args), block.$to_proc())};
        return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext'), 'render', Opal.to_a(args), (TMP_24 = function(){var self = TMP_24.$$s || this;

        return self.$to_s()}, TMP_24.$$s = self, TMP_24.$$arity = 0, TMP_24));}, TMP_23.$$s = self, TMP_23.$$arity = -1, TMP_23))}, TMP_Object_22.$$s = self, TMP_Object_22.$$arity = 1, TMP_Object_22));
    
    Opal.defn(self, '$para', TMP_Object_para_25 = function $$para($a_rest) {
      var $b, TMP_26, self = this, args, $iter = TMP_Object_para_25.$$p, block = $iter || nil;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      if ($iter) TMP_Object_para_25.$$p = null;
      
      args.$unshift("p");
      if ($truthy(($truthy($b = self['$respond_to?']("hyper_component?")) ? self['$hyper_component?']() : $b))) {
        return $send(self, 'send', Opal.to_a(args), block.$to_proc())};
      return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext'), 'render', Opal.to_a(args), (TMP_26 = function(){var self = TMP_26.$$s || this;

      return self.$to_s()}, TMP_26.$$s = self, TMP_26.$$arity = 0, TMP_26));
    }, TMP_Object_para_25.$$arity = -1);
    return (Opal.defn(self, '$br', TMP_Object_br_28 = function $$br() {
      var $a, TMP_27, self = this;

      
      if ($truthy(($truthy($a = self['$respond_to?']("hyper_component?")) ? self['$hyper_component?']() : $a))) {
        return self.$send("br")};
      return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext'), 'render', ["span"], (TMP_27 = function(){var self = TMP_27.$$s || this;

      
        Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext').$render(self.$to_s());
        return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext').$render("br");}, TMP_27.$$s = self, TMP_27.$$arity = 0, TMP_27));
    }, TMP_Object_br_28.$$arity = 0), nil) && 'br';
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/component/children"] = function(Opal) {
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $truthy = Opal.truthy;

  Opal.add_stubs(['$include', '$each', '$to_proc', '$lambda', '$render', '$to_enum', '$length', '$>', '$new', '$call', '$<<', '$alias_method']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Component, self = $Component = $module($base, 'Component');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $super, $parent_nesting) {
        function $Children(){};
        var self = $Children = $klass($base, $super, 'Children', $Children);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Children_initialize_1, TMP_Children_render_2, TMP_Children_to_proc_4, TMP_Children_each_5, TMP_Children_length_7;

        def.children = def.length = nil;
        
        self.$include(Opal.const_get_relative($nesting, 'Enumerable'));
        
        Opal.defn(self, '$initialize', TMP_Children_initialize_1 = function $$initialize(children) {
          var self = this;

          return (self.children = children)
        }, TMP_Children_initialize_1.$$arity = 1);
        
        Opal.defn(self, '$render', TMP_Children_render_2 = function $$render() {
          var self = this;

          return $send(self, 'each', [], "render".$to_proc())
        }, TMP_Children_render_2.$$arity = 0);
        
        Opal.defn(self, '$to_proc', TMP_Children_to_proc_4 = function $$to_proc() {
          var TMP_3, self = this;

          return $send(self, 'lambda', [], (TMP_3 = function(){var self = TMP_3.$$s || this;

          return self.$render()}, TMP_3.$$s = self, TMP_3.$$arity = 0, TMP_3))
        }, TMP_Children_to_proc_4.$$arity = 0);
        
        Opal.defn(self, '$each', TMP_Children_each_5 = function $$each() {
          var TMP_6, self = this, $iter = TMP_Children_each_5.$$p, block = $iter || nil, collection = nil, element = nil;

          if ($iter) TMP_Children_each_5.$$p = null;
          
          if ((block !== nil)) {
            } else {
            return $send(self, 'to_enum', ["each"], (TMP_6 = function(){var self = TMP_6.$$s || this;

            return self.$length()}, TMP_6.$$s = self, TMP_6.$$arity = 0, TMP_6))
          };
          if ($truthy($rb_gt(self.$length(), 0))) {
            } else {
            return []
          };
          collection = [];
          
          React.Children.forEach(self.children, function(context){
            ((element = Opal.const_get_relative($nesting, 'Element').$new(context)), block.$call(element), collection['$<<'](element))
          })
        ;
          return collection;
        }, TMP_Children_each_5.$$arity = 0);
        
        Opal.defn(self, '$length', TMP_Children_length_7 = function $$length() {
          var $a, self = this;

          return (self.length = ($truthy($a = self.length) ? $a : React.Children.count(self.children)))
        }, TMP_Children_length_7.$$arity = 0);
        return self.$alias_method("size", "length");
      })($nesting[0], null, $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/component/instance_methods"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$require', '$new', '$include?', '$param_accessor_style', '$raise', '$[]', '$dom_node', '$==', '$=~', '$pluralize', '$set_or_replace_state_or_prop', '$to_proc', '$private', '$lambda', '$instance_eval', '$callbacks?', '$class', '$RescueWrapper', '$call', '$after_error_args=', '$-', '$__hyperstack_component_run_post_render_hooks', '$__hyperstack_component_rescue_wrapper', '$__hyperstack_router_wrapper', '$shallow_to_n']);
  
  self.$require("hyperstack/component/children");
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Component, self = $Component = $module($base, 'Component');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $parent_nesting) {
          var $InstanceMethods, self = $InstanceMethods = $module($base, 'InstanceMethods');

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_InstanceMethods_children_1, TMP_InstanceMethods_params_2, TMP_InstanceMethods_props_3, TMP_InstanceMethods_dom_node_4, TMP_InstanceMethods_jq_node_5, TMP_InstanceMethods_mounted$q_6, TMP_InstanceMethods_pluralize_7, TMP_InstanceMethods_force_update$B_8, TMP_InstanceMethods_set_state_9, TMP_InstanceMethods_set_state$B_10, TMP_InstanceMethods___hyperstack_router_wrapper_11, TMP_InstanceMethods___hyperstack_component_rescue_wrapper_13, TMP_InstanceMethods___hyperstack_component_select_wrappers_14, TMP_InstanceMethods_set_or_replace_state_or_prop_15;

          
          
          Opal.defn(self, '$children', TMP_InstanceMethods_children_1 = function $$children() {
            var self = this;
            if (self.__hyperstack_component_native == null) self.__hyperstack_component_native = nil;

            return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Children').$new(self.__hyperstack_component_native.props.children)
          }, TMP_InstanceMethods_children_1.$$arity = 0);
          
          Opal.defn(self, '$params', TMP_InstanceMethods_params_2 = function $$params() {
            var self = this;
            if (self.__hyperstack_component_params_wrapper == null) self.__hyperstack_component_params_wrapper = nil;

            
            if ($truthy(["hyperstack", "accessors"]['$include?'](self.__hyperstack_component_params_wrapper.$param_accessor_style()))) {
              self.$raise("" + "params are now directly accessible via instance variables.\n" + "  to access the legacy behavior add `param_accessor_style = :legacy` " + "to your component class\n" + "  to access both behaviors add `param_accessor_style = :both` " + "to your component class")};
            return self.__hyperstack_component_params_wrapper;
          }, TMP_InstanceMethods_params_2.$$arity = 0);
          
          Opal.defn(self, '$props', TMP_InstanceMethods_props_3 = function $$props() {
            var self = this;
            if (self.__hyperstack_component_native == null) self.__hyperstack_component_native = nil;

            return Opal.const_get_relative($nesting, 'Hash').$new(self.__hyperstack_component_native.props)
          }, TMP_InstanceMethods_props_3.$$arity = 0);
          
          Opal.defn(self, '$dom_node', TMP_InstanceMethods_dom_node_4 = function $$dom_node() {
            var self = this;

            return ReactDOM.findDOMNode(self.__hyperstack_component_native)
          }, TMP_InstanceMethods_dom_node_4.$$arity = 0);
          
          Opal.defn(self, '$jq_node', TMP_InstanceMethods_jq_node_5 = function $$jq_node() {
            var self = this;

            return Opal.const_get_qualified('::', 'Element')['$[]'](self.$dom_node())
          }, TMP_InstanceMethods_jq_node_5.$$arity = 0);
          
          Opal.defn(self, '$mounted?', TMP_InstanceMethods_mounted$q_6 = function() {
            var self = this;

            return (self.__hyperstack_component_is_mounted === undefined) ? false : self.__hyperstack_component_is_mounted
          }, TMP_InstanceMethods_mounted$q_6.$$arity = 0);
          
          Opal.defn(self, '$pluralize', TMP_InstanceMethods_pluralize_7 = function $$pluralize(count, singular, plural) {
            var $a, self = this, word = nil;

            if (plural == null) {
              plural = nil;
            }
            
            word = (function() {if ($truthy(($truthy($a = count['$=='](1)) ? $a : count['$=~'](/^1(\.0+)?$/)))) {
              return singular
              } else {
              return ($truthy($a = plural) ? $a : singular.$pluralize())
            }; return nil; })();
            return "" + (($truthy($a = count) ? $a : 0)) + " " + (word);
          }, TMP_InstanceMethods_pluralize_7.$$arity = -3);
          
          Opal.defn(self, '$force_update!', TMP_InstanceMethods_force_update$B_8 = function() {
            var self = this;

            
            self.__hyperstack_component_native.forceUpdate();
            return self;
          }, TMP_InstanceMethods_force_update$B_8.$$arity = 0);
          
          Opal.defn(self, '$set_state', TMP_InstanceMethods_set_state_9 = function $$set_state(state) {
            var self = this, $iter = TMP_InstanceMethods_set_state_9.$$p, block = $iter || nil;

            if ($iter) TMP_InstanceMethods_set_state_9.$$p = null;
            return $send(self, 'set_or_replace_state_or_prop', [state, "setState"], block.$to_proc())
          }, TMP_InstanceMethods_set_state_9.$$arity = 1);
          
          Opal.defn(self, '$set_state!', TMP_InstanceMethods_set_state$B_10 = function(state) {
            var self = this, $iter = TMP_InstanceMethods_set_state$B_10.$$p, block = $iter || nil;

            if ($iter) TMP_InstanceMethods_set_state$B_10.$$p = null;
            
            $send(self, 'set_or_replace_state_or_prop', [state, "setState"], block.$to_proc());
            return self.__hyperstack_component_native.forceUpdate();
          }, TMP_InstanceMethods_set_state$B_10.$$arity = 1);
          self.$private();
          
          Opal.defn(self, '$__hyperstack_router_wrapper', TMP_InstanceMethods___hyperstack_router_wrapper_11 = function $$__hyperstack_router_wrapper() {
            var TMP_12, self = this, $iter = TMP_InstanceMethods___hyperstack_router_wrapper_11.$$p, block = $iter || nil;

            if ($iter) TMP_InstanceMethods___hyperstack_router_wrapper_11.$$p = null;
            return $send(self, 'lambda', [], (TMP_12 = function(){var self = TMP_12.$$s || this;

            return $send(self, 'instance_eval', [], block.$to_proc())}, TMP_12.$$s = self, TMP_12.$$arity = 0, TMP_12))
          }, TMP_InstanceMethods___hyperstack_router_wrapper_11.$$arity = 0);
          
          Opal.defn(self, '$__hyperstack_component_rescue_wrapper', TMP_InstanceMethods___hyperstack_component_rescue_wrapper_13 = function $$__hyperstack_component_rescue_wrapper(child) {
            var self = this;

            if ($truthy(self.$class()['$callbacks?']("__hyperstack_component_rescue_hook"))) {
              return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component').$RescueWrapper($hash2(["child", "children_elements"], {"child": self, "children_elements": child}))
              } else {
              return child.$call()
            }
          }, TMP_InstanceMethods___hyperstack_component_rescue_wrapper_13.$$arity = 1);
          
          Opal.defn(self, '$__hyperstack_component_select_wrappers', TMP_InstanceMethods___hyperstack_component_select_wrappers_14 = function $$__hyperstack_component_select_wrappers() {
            var self = this, $iter = TMP_InstanceMethods___hyperstack_component_select_wrappers_14.$$p, block = $iter || nil, $writer = nil;

            if ($iter) TMP_InstanceMethods___hyperstack_component_select_wrappers_14.$$p = null;
            
            
            $writer = [nil];
            $send(Opal.const_get_relative($nesting, 'RescueWrapper'), 'after_error_args=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];;
            return self.$__hyperstack_component_run_post_render_hooks(self.$__hyperstack_component_rescue_wrapper($send(self, '__hyperstack_router_wrapper', [], block.$to_proc())));
          }, TMP_InstanceMethods___hyperstack_component_select_wrappers_14.$$arity = 0);
          
          Opal.defn(self, '$set_or_replace_state_or_prop', TMP_InstanceMethods_set_or_replace_state_or_prop_15 = function $$set_or_replace_state_or_prop(state_or_prop, method) {
            var self = this, $iter = TMP_InstanceMethods_set_or_replace_state_or_prop_15.$$p, block = $iter || nil;
            if (self.__hyperstack_component_native == null) self.__hyperstack_component_native = nil;

            if ($iter) TMP_InstanceMethods_set_or_replace_state_or_prop_15.$$p = null;
            
            if ($truthy(self.__hyperstack_component_native)) {
              } else {
              self.$raise("No native ReactComponent associated")
            };
            var state_prop_n = state_or_prop.$shallow_to_n();
            if ($truthy(block)) {
              
              if (self.__hyperstack_component_native.__opalInstanceInitializedState === true) {
                self.__hyperstack_component_native[method](state_prop_n, function(){
                  block.$call();
                });
              } else {
                for (var sp in state_prop_n) {
                  if (state_prop_n.hasOwnProperty(sp)) {
                    self.__hyperstack_component_native.state[sp] = state_prop_n[sp];
                  }
                }
              }
            
              } else {
              
              if (self.__hyperstack_component_native.__opalInstanceInitializedState === true) {
                self.__hyperstack_component_native[method](state_prop_n);
              } else {
                for (var sp in state_prop_n) {
                  if (state_prop_n.hasOwnProperty(sp)) {
                    self.__hyperstack_component_native.state[sp] = state_prop_n[sp];
                  }
                }
              }
            
            };
          }, TMP_InstanceMethods_set_or_replace_state_or_prop_15.$$arity = 2);
        })($nesting[0], $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/component/class_methods"] = function(Opal) {
  function $rb_le(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);
  }
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send, $truthy = Opal.truthy, $range = Opal.range, $hash2 = Opal.hash2, $hash = Opal.hash;

  Opal.add_stubs(['$create_element', '$to_proc', '$render', '$deprecation_warning', '$select', '$mounted_components', '$<=', '$class', '$param_accessor_style', '$props_wrapper', '$==', '$[]', '$<<', '$each', '$before_new_params', '$included', '$is_a?', '$type', '$define_method', '$__hyperstack_component_select_wrappers', '$instance_eval', '$__hyperstack_component_after_render_hook', '$on', '$instance_exec', '$empty?', '$__hyperstack_component_rescue_hook', '$!', '$detect', '$before_mount', '$before_update', '$after_mount', '$after_update', '$any?', '$respond_to?', '$haml_class_name', '$superclass', '$copy', '$validator', '$new', '$validate', '$>', '$count', '$+', '$name', '$join', '$default_props', '$build', '$first', '$delete', '$merge!', '$[]=', '$-', '$key?', '$optional', '$requires', '$all_other_params', '$props', '$=~', '$gsub', '$include?', '$event_camelize', '$event', '$call', '$arity', '$last', '$pop', '$state', '$singleton_class', '$__send__', '$mutate', '$native_mixins', '$static_call_backs', '$split', '$to_n', '$add_item_to_tree', '$Native', '$create_native_react_class', '$reverse', '$import_native_component', '$eval_native_react_component', '$raise', '$message', '$!=', '$length', '$inject', '$class_eval']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Component, self = $Component = $module($base, 'Component');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $parent_nesting) {
          var $ClassMethods, self = $ClassMethods = $module($base, 'ClassMethods');

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ClassMethods_create_element_1, TMP_ClassMethods_insert_element_2, TMP_ClassMethods_deprecation_warning_3, TMP_ClassMethods_hyper_component$q_4, TMP_ClassMethods_allow_deprecated_render_definition$q_5, TMP_ClassMethods_mounted_components_7, TMP_ClassMethods_param_accessor_style_8, TMP_ClassMethods_backtrace_9, TMP_ClassMethods_append_backtrace_11, TMP_ClassMethods_before_receive_props_12, TMP_ClassMethods_render_13, TMP_ClassMethods_on_19, TMP_ClassMethods_rescues_22, TMP_ClassMethods_before_render_25, TMP_ClassMethods_after_render_26, TMP_ClassMethods_method_missing_27, TMP_ClassMethods_validator_28, TMP_ClassMethods_prop_types_29, TMP_ClassMethods_default_props_30, TMP_ClassMethods_params_31, TMP_ClassMethods_props_wrapper_32, TMP_ClassMethods_param_33, TMP_ClassMethods_collect_other_params_as_35, TMP_ClassMethods_fires_37, TMP_ClassMethods_define_state_38, TMP_ClassMethods_export_state_41, TMP_ClassMethods_native_mixin_45, TMP_ClassMethods_native_mixins_46, TMP_ClassMethods_static_call_back_47, TMP_ClassMethods_static_call_backs_48, TMP_ClassMethods_export_component_49, TMP_ClassMethods_imports_51, TMP_ClassMethods_add_item_to_tree_53, TMP_ClassMethods_to_n_54;

          
          
          Opal.defn(self, '$create_element', TMP_ClassMethods_create_element_1 = function $$create_element($a_rest) {
            var self = this, params, $iter = TMP_ClassMethods_create_element_1.$$p, children = $iter || nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            params = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              params[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($iter) TMP_ClassMethods_create_element_1.$$p = null;
            return $send(Opal.const_get_relative($nesting, 'ReactWrapper'), 'create_element', [self].concat(Opal.to_a(params)), children.$to_proc())
          }, TMP_ClassMethods_create_element_1.$$arity = -1);
          
          Opal.defn(self, '$insert_element', TMP_ClassMethods_insert_element_2 = function $$insert_element($a_rest) {
            var self = this, params, $iter = TMP_ClassMethods_insert_element_2.$$p, children = $iter || nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            params = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              params[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($iter) TMP_ClassMethods_insert_element_2.$$p = null;
            return $send(Opal.const_get_relative($nesting, 'RenderingContext'), 'render', [self].concat(Opal.to_a(params)), children.$to_proc())
          }, TMP_ClassMethods_insert_element_2.$$arity = -1);
          
          Opal.defn(self, '$deprecation_warning', TMP_ClassMethods_deprecation_warning_3 = function $$deprecation_warning(message) {
            var self = this;

            return Opal.const_get_relative($nesting, 'Hyperstack').$deprecation_warning(self, message)
          }, TMP_ClassMethods_deprecation_warning_3.$$arity = 1);
          
          Opal.defn(self, '$hyper_component?', TMP_ClassMethods_hyper_component$q_4 = function() {
            var self = this;

            return true
          }, TMP_ClassMethods_hyper_component$q_4.$$arity = 0);
          
          Opal.defn(self, '$allow_deprecated_render_definition?', TMP_ClassMethods_allow_deprecated_render_definition$q_5 = function() {
            var self = this;

            return false
          }, TMP_ClassMethods_allow_deprecated_render_definition$q_5.$$arity = 0);
          
          Opal.defn(self, '$mounted_components', TMP_ClassMethods_mounted_components_7 = function $$mounted_components() {
            var TMP_6, self = this;

            return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component').$mounted_components(), 'select', [], (TMP_6 = function(c){var self = TMP_6.$$s || this;
if (c == null) c = nil;
            return $rb_le(c.$class(), self)}, TMP_6.$$s = self, TMP_6.$$arity = 1, TMP_6))
          }, TMP_ClassMethods_mounted_components_7.$$arity = 0);
          
          Opal.defn(self, '$param_accessor_style', TMP_ClassMethods_param_accessor_style_8 = function $$param_accessor_style($a_rest) {
            var self = this, args;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            return $send(self.$props_wrapper(), 'param_accessor_style', Opal.to_a(args))
          }, TMP_ClassMethods_param_accessor_style_8.$$arity = -1);
          
          Opal.defn(self, '$backtrace', TMP_ClassMethods_backtrace_9 = function $$backtrace($a_rest) {
            var $b, self = this, args;
            if (self.__hyperstack_component_dont_catch_exceptions == null) self.__hyperstack_component_dont_catch_exceptions = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            
            self.__hyperstack_component_dont_catch_exceptions = args['$[]'](0)['$==']("none");
            return (self.__hyperstack_component_backtrace_off = ($truthy($b = self.__hyperstack_component_dont_catch_exceptions) ? $b : args['$[]'](0)['$==']("off")));
          }, TMP_ClassMethods_backtrace_9.$$arity = -1);
          
          Opal.defn(self, '$append_backtrace', TMP_ClassMethods_append_backtrace_11 = function $$append_backtrace(message_array, backtrace) {
            var TMP_10, self = this;

            
            message_array['$<<']("" + "    " + (backtrace['$[]'](0)));
            return $send(backtrace['$[]']($range(1, -1, false)), 'each', [], (TMP_10 = function(line){var self = TMP_10.$$s || this;
if (line == null) line = nil;
            return message_array['$<<'](line)}, TMP_10.$$s = self, TMP_10.$$arity = 1, TMP_10));
          }, TMP_ClassMethods_append_backtrace_11.$$arity = 2);
          
          Opal.defn(self, '$before_receive_props', TMP_ClassMethods_before_receive_props_12 = function $$before_receive_props($a_rest) {
            var self = this, args, $iter = TMP_ClassMethods_before_receive_props_12.$$p, block = $iter || nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($iter) TMP_ClassMethods_before_receive_props_12.$$p = null;
            
            self.$deprecation_warning("'before_receive_props' is deprecated. Use the 'before_new_params' macro instead.");
            return $send(self, 'before_new_params', Opal.to_a(args), block.$to_proc());
          }, TMP_ClassMethods_before_receive_props_12.$$arity = -1);
          
          Opal.defn(self, '$render', TMP_ClassMethods_render_13 = function $$render(container, params) {
            var TMP_14, TMP_17, self = this, $iter = TMP_ClassMethods_render_13.$$p, block = $iter || nil;

            if (container == null) {
              container = nil;
            }
            if (params == null) {
              params = $hash2([], {});
            }
            if ($iter) TMP_ClassMethods_render_13.$$p = null;
            
            Opal.const_get_relative($nesting, 'Tags').$included(self);
            if ($truthy(container)) {
              
              if ($truthy(container['$is_a?'](Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Element')))) {
                container = container.$type()};
              return $send(self, 'define_method', ["__hyperstack_component_render"], (TMP_14 = function(){var self = TMP_14.$$s || this, TMP_15;

              return $send(self, '__hyperstack_component_select_wrappers', [], (TMP_15 = function(){var self = TMP_15.$$s || this, TMP_16;

                return $send(Opal.const_get_relative($nesting, 'RenderingContext'), 'render', [container, params], (TMP_16 = function(){var self = TMP_16.$$s || this;

                  if ($truthy(block)) {
                      return $send(self, 'instance_eval', [], block.$to_proc())
                      } else {
                      return nil
                    }}, TMP_16.$$s = self, TMP_16.$$arity = 0, TMP_16))}, TMP_15.$$s = self, TMP_15.$$arity = 0, TMP_15))}, TMP_14.$$s = self, TMP_14.$$arity = 0, TMP_14));
              } else {
              return $send(self, 'define_method', ["__hyperstack_component_render"], (TMP_17 = function(){var self = TMP_17.$$s || this, TMP_18;

              return $send(self, '__hyperstack_component_select_wrappers', [], (TMP_18 = function(){var self = TMP_18.$$s || this;

                return $send(self, 'instance_eval', [], block.$to_proc())}, TMP_18.$$s = self, TMP_18.$$arity = 0, TMP_18))}, TMP_17.$$s = self, TMP_17.$$arity = 0, TMP_17))
            };
          }, TMP_ClassMethods_render_13.$$arity = -1);
          
          Opal.defn(self, '$on', TMP_ClassMethods_on_19 = function $$on($a_rest) {
            var TMP_20, self = this, args, $iter = TMP_ClassMethods_on_19.$$p, block = $iter || nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($iter) TMP_ClassMethods_on_19.$$p = null;
            return $send(self, '__hyperstack_component_after_render_hook', [], (TMP_20 = function(element){var self = TMP_20.$$s || this, TMP_21;
if (element == null) element = nil;
            return $send(element, 'on', Opal.to_a(args), (TMP_21 = function($a_rest){var self = TMP_21.$$s || this, aargs;

                var $args_len = arguments.length, $rest_len = $args_len - 0;
                if ($rest_len < 0) { $rest_len = 0; }
                aargs = new Array($rest_len);
                for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                  aargs[$arg_idx - 0] = arguments[$arg_idx];
                }
              return $send(self, 'instance_exec', Opal.to_a(aargs), block.$to_proc())}, TMP_21.$$s = self, TMP_21.$$arity = -1, TMP_21))}, TMP_20.$$s = self, TMP_20.$$arity = 1, TMP_20))
          }, TMP_ClassMethods_on_19.$$arity = -1);
          
          Opal.defn(self, '$rescues', TMP_ClassMethods_rescues_22 = function $$rescues($a_rest) {
            var TMP_23, self = this, klasses, $iter = TMP_ClassMethods_rescues_22.$$p, block = $iter || nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            klasses = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              klasses[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($iter) TMP_ClassMethods_rescues_22.$$p = null;
            
            if ($truthy(klasses['$empty?']())) {
              klasses = [Opal.const_get_relative($nesting, 'StandardError')]};
            return $send(self, '__hyperstack_component_rescue_hook', [], (TMP_23 = function(found, $a_rest){var self = TMP_23.$$s || this, args, $b, TMP_24;

              var $args_len = arguments.length, $rest_len = $args_len - 1;
              if ($rest_len < 0) { $rest_len = 0; }
              args = new Array($rest_len);
              for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
                args[$arg_idx - 1] = arguments[$arg_idx];
              }if (found == null) found = nil;
            
              if ($truthy(($truthy($b = found) ? $b : $send(klasses, 'detect', [], (TMP_24 = function(klass){var self = TMP_24.$$s || this;
if (klass == null) klass = nil;
              return args['$[]'](0)['$is_a?'](klass)}, TMP_24.$$s = self, TMP_24.$$arity = 1, TMP_24))['$!']()))) {
                return [found].concat(Opal.to_a(args));};
              $send(self, 'instance_exec', Opal.to_a(args), block.$to_proc());
              return [true].concat(Opal.to_a(args));}, TMP_23.$$s = self, TMP_23.$$arity = -2, TMP_23));
          }, TMP_ClassMethods_rescues_22.$$arity = -1);
          
          Opal.defn(self, '$before_render', TMP_ClassMethods_before_render_25 = function $$before_render($a_rest) {
            var self = this, args, $iter = TMP_ClassMethods_before_render_25.$$p, block = $iter || nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($iter) TMP_ClassMethods_before_render_25.$$p = null;
            
            $send(self, 'before_mount', Opal.to_a(args), block.$to_proc());
            return $send(self, 'before_update', Opal.to_a(args), block.$to_proc());
          }, TMP_ClassMethods_before_render_25.$$arity = -1);
          
          Opal.defn(self, '$after_render', TMP_ClassMethods_after_render_26 = function $$after_render($a_rest) {
            var self = this, args, $iter = TMP_ClassMethods_after_render_26.$$p, block = $iter || nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($iter) TMP_ClassMethods_after_render_26.$$p = null;
            
            $send(self, 'after_mount', Opal.to_a(args), block.$to_proc());
            return $send(self, 'after_update', Opal.to_a(args), block.$to_proc());
          }, TMP_ClassMethods_after_render_26.$$arity = -1);
          
          Opal.defn(self, '$method_missing', TMP_ClassMethods_method_missing_27 = function $$method_missing(name, $a_rest) {
            var $b, self = this, args, $iter = TMP_ClassMethods_method_missing_27.$$p, children = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 1;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 1] = arguments[$arg_idx];
            }
            if ($iter) TMP_ClassMethods_method_missing_27.$$p = null;
            // Prepare super implicit arguments
            for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
              $zuper[$zuper_i] = arguments[$zuper_i];
            }
            if ($truthy(($truthy($b = args['$any?']()) ? $b : Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Element')['$respond_to?']("haml_class_name")['$!']()))) {
              return $send(self, Opal.find_super_dispatcher(self, 'method_missing', TMP_ClassMethods_method_missing_27, false), $zuper, $iter)
              } else {
              return $send(Opal.const_get_relative($nesting, 'RenderingContext'), 'render', [self, $hash2(["class"], {"class": Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Element').$haml_class_name(name)})], children.$to_proc())
            }
          }, TMP_ClassMethods_method_missing_27.$$arity = -2);
          
          Opal.defn(self, '$validator', TMP_ClassMethods_validator_28 = function $$validator() {
            var self = this;
            if (self.__hyperstack_component_validator == null) self.__hyperstack_component_validator = nil;

            
            if ($truthy(self.__hyperstack_component_validator)) {
              return self.__hyperstack_component_validator};
            if ($truthy(self.$superclass()['$respond_to?']("validator"))) {
              return (self.__hyperstack_component_validator = self.$superclass().$validator().$copy(self.$props_wrapper()))
              } else {
              return (self.__hyperstack_component_validator = Opal.const_get_relative($nesting, 'Validator').$new(self.$props_wrapper()))
            };
          }, TMP_ClassMethods_validator_28.$$arity = 0);
          
          Opal.defn(self, '$prop_types', TMP_ClassMethods_prop_types_29 = function $$prop_types() {
            var self = this;

            if ($truthy(self.$validator())) {
              return $hash2(["_componentValidator"], {"_componentValidator": 
                function(props, propName, componentName) {
                  var errors = self.$validator().$validate(Opal.const_get_relative($nesting, 'Hash').$new(props));
                  return (function() {if ($truthy($rb_gt((errors).$count(), 0))) {
                return new Error($rb_plus("" + "In component `" + (self.$name()) + "`\n", (errors).$join("\n")))
                } else {
                return undefined
              }; return nil; })();
                }
              })
              } else {
              return $hash2([], {})
            }
          }, TMP_ClassMethods_prop_types_29.$$arity = 0);
          
          Opal.defn(self, '$default_props', TMP_ClassMethods_default_props_30 = function $$default_props() {
            var self = this;

            return self.$validator().$default_props()
          }, TMP_ClassMethods_default_props_30.$$arity = 0);
          
          Opal.defn(self, '$params', TMP_ClassMethods_params_31 = function $$params() {
            var self = this, $iter = TMP_ClassMethods_params_31.$$p, block = $iter || nil;

            if ($iter) TMP_ClassMethods_params_31.$$p = null;
            return $send(self.$validator(), 'build', [], block.$to_proc())
          }, TMP_ClassMethods_params_31.$$arity = 0);
          
          Opal.defn(self, '$props_wrapper', TMP_ClassMethods_props_wrapper_32 = function $$props_wrapper() {
            var $a, self = this;
            if (self.__hyperstack_component_props_wrapper == null) self.__hyperstack_component_props_wrapper = nil;

            
            if ($truthy(self.__hyperstack_component_props_wrapper)) {
              return self.__hyperstack_component_props_wrapper};
            if ($truthy(self.$superclass()['$respond_to?']("props_wrapper"))) {
              return (self.__hyperstack_component_props_wrapper = Opal.const_get_relative($nesting, 'Class').$new(self.$superclass().$props_wrapper()))
              } else {
              return (self.__hyperstack_component_props_wrapper = ($truthy($a = self.__hyperstack_component_props_wrapper) ? $a : Opal.const_get_relative($nesting, 'Class').$new(Opal.const_get_relative($nesting, 'PropsWrapper'))))
            };
          }, TMP_ClassMethods_props_wrapper_32.$$arity = 0);
          
          Opal.defn(self, '$param', TMP_ClassMethods_param_33 = function $$param($a_rest) {
            var $b, self = this, args, options = nil, name = nil, default$ = nil, $writer = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            
            if ($truthy(args['$[]'](0)['$is_a?'](Opal.const_get_relative($nesting, 'Hash')))) {
              
              options = args['$[]'](0);
              name = options.$first()['$[]'](0);
              default$ = options.$first()['$[]'](1);
              options.$delete(name);
              options['$merge!']($hash2(["default"], {"default": default$}));
              } else {
              
              name = args['$[]'](0);
              options = ($truthy($b = args['$[]'](1)) ? $b : $hash2([], {}));
            };
            if (options['$[]']("type")['$=='](Opal.const_get_relative($nesting, 'Proc'))) {
              
              ($truthy($b = options['$[]']("default")) ? $b : (($writer = ["default", nil]), $send(options, '[]=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]));
              if ($truthy(options['$key?']("allow_nil"))) {
                } else {
                
                $writer = ["allow_nil", true];
                $send(options, '[]=', Opal.to_a($writer));
                $writer[$rb_minus($writer["length"], 1)];
              };};
            if (name['$==']("class")) {
              
              name = "className";
              ($truthy($b = options['$[]']("alias")) ? $b : (($writer = ["alias", "Class"]), $send(options, '[]=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]));};
            if ($truthy(options['$[]']("default"))) {
              return self.$validator().$optional(name, options)
              } else {
              return self.$validator().$requires(name, options)
            };
          }, TMP_ClassMethods_param_33.$$arity = -1);
          
          Opal.defn(self, '$collect_other_params_as', TMP_ClassMethods_collect_other_params_as_35 = function $$collect_other_params_as(name) {
            var TMP_34, self = this;

            return $send(self.$validator(), 'all_other_params', [name], (TMP_34 = function(){var self = TMP_34.$$s || this;

            return self.$props()}, TMP_34.$$s = self, TMP_34.$$arity = 0, TMP_34))
          }, TMP_ClassMethods_collect_other_params_as_35.$$arity = 1);
          Opal.alias(self, "other_params", "collect_other_params_as");
          Opal.alias(self, "others", "collect_other_params_as");
          Opal.alias(self, "other", "collect_other_params_as");
          Opal.alias(self, "opts", "collect_other_params_as");
          
          Opal.defn(self, '$fires', TMP_ClassMethods_fires_37 = function $$fires(name, opts) {
            var $a, TMP_36, self = this, aka = nil;

            if (opts == null) {
              opts = $hash2([], {});
            }
            
            aka = ($truthy($a = opts['$[]']("alias")) ? $a : "" + (name) + "!");
            name = (function() {if ($truthy(name['$=~'](/^<(.+)>$/))) {
              return name.$gsub(/^<(.+)>$/, "\\1")
            } else if ($truthy(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Event'), 'BUILT_IN_EVENTS')['$include?']("" + "on" + (name.$event_camelize())))) {
              return "" + "on" + (name.$event_camelize())
              } else {
              return "" + "on_" + (name)
            }; return nil; })();
            self.$validator().$event(name);
            return $send(self, 'define_method', [aka], (TMP_36 = function($b_rest){var self = TMP_36.$$s || this, args, $c;

              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              args = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                args[$arg_idx - 0] = arguments[$arg_idx];
              }
            return ($c = self.$props()['$[]'](name), ($c === nil || $c == null) ? nil : $send($c, 'call', Opal.to_a(args)))}, TMP_36.$$s = self, TMP_36.$$arity = -1, TMP_36));
          }, TMP_ClassMethods_fires_37.$$arity = -2);
          Opal.alias(self, "triggers", "fires");
          
          Opal.defn(self, '$define_state', TMP_ClassMethods_define_state_38 = function $$define_state($a_rest) {
            var $b, TMP_39, TMP_40, self = this, states, $iter = TMP_ClassMethods_define_state_38.$$p, block = $iter || nil, default_initial_value = nil, states_hash = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            states = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              states[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($iter) TMP_ClassMethods_define_state_38.$$p = null;
            
            self.$deprecation_warning("'define_state' is deprecated. Use the 'state' macro to declare states.");
            default_initial_value = (function() {if ($truthy(($truthy($b = block) ? block.$arity()['$=='](0) : $b))) {
              return Opal.yieldX(block, []);
              } else {
              return nil
            }; return nil; })();
            states_hash = (function() {if ($truthy(states.$last()['$is_a?'](Opal.const_get_relative($nesting, 'Hash')))) {
              return states.$pop()
              } else {
              return $hash2([], {})
            }; return nil; })();
            $send(states, 'each', [], (TMP_39 = function(name){var self = TMP_39.$$s || this;
if (name == null) name = nil;
            return self.$state($hash(name, default_initial_value))}, TMP_39.$$s = self, TMP_39.$$arity = 1, TMP_39));
            return $send(states_hash, 'each', [], (TMP_40 = function(name, value){var self = TMP_40.$$s || this;
if (name == null) name = nil;if (value == null) value = nil;
            return self.$state($hash(name, value))}, TMP_40.$$s = self, TMP_40.$$arity = 2, TMP_40));
          }, TMP_ClassMethods_define_state_38.$$arity = -1);
          
          Opal.defn(self, '$export_state', TMP_ClassMethods_export_state_41 = function $$export_state($a_rest) {
            var $b, TMP_42, TMP_43, self = this, states, $iter = TMP_ClassMethods_export_state_41.$$p, block = $iter || nil, default_initial_value = nil, states_hash = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            states = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              states[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($iter) TMP_ClassMethods_export_state_41.$$p = null;
            
            self.$deprecation_warning("'export_state' is deprecated. Use the 'state' macro to declare states.");
            default_initial_value = (function() {if ($truthy(($truthy($b = block) ? block.$arity()['$=='](0) : $b))) {
              return Opal.yieldX(block, []);
              } else {
              return nil
            }; return nil; })();
            states_hash = (function() {if ($truthy(states.$last()['$is_a?'](Opal.const_get_relative($nesting, 'Hash')))) {
              return states.$pop()
              } else {
              return $hash2([], {})
            }; return nil; })();
            $send(states, 'each', [], (TMP_42 = function(name){var self = TMP_42.$$s || this, $writer = nil;
if (name == null) name = nil;
            
              $writer = [name, default_initial_value];
              $send(states_hash, '[]=', Opal.to_a($writer));
              return $writer[$rb_minus($writer["length"], 1)];}, TMP_42.$$s = self, TMP_42.$$arity = 1, TMP_42));
            return $send(states_hash, 'each', [], (TMP_43 = function(name, value){var self = TMP_43.$$s || this, TMP_44;
if (name == null) name = nil;if (value == null) value = nil;
            
              self.$state($hash(name, value, "scope", "class", "reader", true));
              return $send(self.$singleton_class(), 'define_method', ["" + (name) + "!"], (TMP_44 = function($a_rest){var self = TMP_44.$$s || this, args;

                var $args_len = arguments.length, $rest_len = $args_len - 0;
                if ($rest_len < 0) { $rest_len = 0; }
                args = new Array($rest_len);
                for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                  args[$arg_idx - 0] = arguments[$arg_idx];
                }
              return $send(self.$mutate(), '__send__', [name].concat(Opal.to_a(args)))}, TMP_44.$$s = self, TMP_44.$$arity = -1, TMP_44));}, TMP_43.$$s = self, TMP_43.$$arity = 2, TMP_43));
          }, TMP_ClassMethods_export_state_41.$$arity = -1);
          
          Opal.defn(self, '$native_mixin', TMP_ClassMethods_native_mixin_45 = function $$native_mixin(item) {
            var self = this;

            return self.$native_mixins()['$<<'](item)
          }, TMP_ClassMethods_native_mixin_45.$$arity = 1);
          
          Opal.defn(self, '$native_mixins', TMP_ClassMethods_native_mixins_46 = function $$native_mixins() {
            var $a, self = this;
            if (self.__hyperstack_component_native_mixins == null) self.__hyperstack_component_native_mixins = nil;

            return (self.__hyperstack_component_native_mixins = ($truthy($a = self.__hyperstack_component_native_mixins) ? $a : []))
          }, TMP_ClassMethods_native_mixins_46.$$arity = 0);
          
          Opal.defn(self, '$static_call_back', TMP_ClassMethods_static_call_back_47 = function $$static_call_back(name) {
            var self = this, $iter = TMP_ClassMethods_static_call_back_47.$$p, block = $iter || nil, $writer = nil;

            if ($iter) TMP_ClassMethods_static_call_back_47.$$p = null;
            
            $writer = [name, block];
            $send(self.$static_call_backs(), '[]=', Opal.to_a($writer));
            return $writer[$rb_minus($writer["length"], 1)];
          }, TMP_ClassMethods_static_call_back_47.$$arity = 1);
          
          Opal.defn(self, '$static_call_backs', TMP_ClassMethods_static_call_backs_48 = function $$static_call_backs() {
            var $a, self = this;
            if (self.__hyperstack_component_static_call_backs == null) self.__hyperstack_component_static_call_backs = nil;

            return (self.__hyperstack_component_static_call_backs = ($truthy($a = self.__hyperstack_component_static_call_backs) ? $a : $hash2([], {})))
          }, TMP_ClassMethods_static_call_backs_48.$$arity = 0);
          
          Opal.defn(self, '$export_component', TMP_ClassMethods_export_component_49 = function $$export_component(opts) {
            var $a, self = this, export_name = nil, first_name = nil, $writer = nil;

            if (opts == null) {
              opts = $hash2([], {});
            }
            
            export_name = ($truthy($a = opts['$[]']("as")) ? $a : self.$name()).$split("::");
            first_name = export_name.$first();
            
            $writer = [first_name, self.$add_item_to_tree(self.$Native(Opal.global)['$[]'](first_name), $rb_plus([Opal.const_get_relative($nesting, 'ReactWrapper').$create_native_react_class(self)], export_name['$[]']($range(1, -1, false)).$reverse())).$to_n()];
            $send(self.$Native(Opal.global), '[]=', Opal.to_a($writer));
            return $writer[$rb_minus($writer["length"], 1)];;
          }, TMP_ClassMethods_export_component_49.$$arity = -1);
          
          Opal.defn(self, '$imports', TMP_ClassMethods_imports_51 = function $$imports(component_name) {
            var TMP_50, self = this, e = nil;

            return (function() { try {
            try {
              
              Opal.const_get_relative($nesting, 'ReactWrapper').$import_native_component(self, Opal.const_get_relative($nesting, 'ReactWrapper').$eval_native_react_component(component_name));
              return $send(self, 'define_method', ["render"], (TMP_50 = function(){var self = TMP_50.$$s || this;

              return nil}, TMP_50.$$s = self, TMP_50.$$arity = 0, TMP_50));
            } catch ($err) {
              if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exception')])) {e = $err;
                try {
                  return self.$raise("" + (self) + " cannot import '" + (component_name) + "': " + (e.$message()) + ".")
                } finally { Opal.pop_exception() }
              } else { throw $err; }
            }
            } finally {
              self
            }; })()
          }, TMP_ClassMethods_imports_51.$$arity = 1);
          
          Opal.defn(self, '$add_item_to_tree', TMP_ClassMethods_add_item_to_tree_53 = function $$add_item_to_tree(current_tree, new_item) {
            var $a, TMP_52, self = this, $writer = nil;

            if ($truthy(($truthy($a = self.$Native(current_tree).$class()['$!='](Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Native'), 'Object'))) ? $a : new_item.$length()['$=='](1)))) {
              return $send(new_item, 'inject', [], (TMP_52 = function(a, e){var self = TMP_52.$$s || this;
if (a == null) a = nil;if (e == null) e = nil;
              return $hash(e, a)}, TMP_52.$$s = self, TMP_52.$$arity = 2, TMP_52))
              } else {
              
              
              $writer = [new_item.$last(), self.$add_item_to_tree(self.$Native(current_tree)['$[]'](new_item.$last()), new_item['$[]']($range(0, -2, false)))];
              $send(self.$Native(current_tree), '[]=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;
              return current_tree;
            }
          }, TMP_ClassMethods_add_item_to_tree_53.$$arity = 2);
          
          Opal.defn(self, '$to_n', TMP_ClassMethods_to_n_54 = function $$to_n() {
            var self = this;

            return Opal.const_get_relative($nesting, 'ReactWrapper').$class_eval("@@component_classes")['$[]'](self)
          }, TMP_ClassMethods_to_n_54.$$arity = 0);
        })($nesting[0], $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/component/props_wrapper"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $range = Opal.range, $send = Opal.send;

  Opal.add_stubs(['$require', '$attr_reader', '$naming_convention', '$===', '$fix_suffix', '$camelize', '$=~', '$+', '$[]', '$respond_to?', '$superclass', '$param_accessor_style', '$dup', '$param_definitions', '$new', '$instance_var_name_for', '$lambda', '$instance_variable_set', '$fetch_from_cache', '$==', '$[]=', '$-', '$include?', '$define_method', '$to_sym', '$props', '$call', '$to_proc', '$class', '$each_value', '$instance_exec', '$initialize', '$private', '$cache', '$equal?', '$tap', '$convert_param', '$_react_param_conversion', '$is_a?', '$collect', '$component', '$instance_variable_get']);
  
  self.$require("active_support/core_ext/string");
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Component, self = $Component = $module($base, 'Component');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $super, $parent_nesting) {
          function $PropsWrapper(){};
          var self = $PropsWrapper = $klass($base, $super, 'PropsWrapper', $PropsWrapper);

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_PropsWrapper_param_accessor_style_12, TMP_PropsWrapper_initialize_14, TMP_PropsWrapper_reload_15, TMP_PropsWrapper_$$_16, TMP_PropsWrapper_fetch_from_cache_18, TMP_PropsWrapper_convert_param_20, TMP_PropsWrapper_cache_22, TMP_PropsWrapper_props_23, TMP_PropsWrapper_value_for_24;

          def.component = def.cache = nil;
          
          self.$attr_reader("component");
          (function(self, $parent_nesting) {
            var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_instance_var_name_for_1, TMP_fix_suffix_2, TMP_param_accessor_style_3, TMP_param_definitions_4, TMP_define_param_8, TMP_define_all_others_10;

            
            
            Opal.defn(self, '$instance_var_name_for', TMP_instance_var_name_for_1 = function $$instance_var_name_for(name) {
              var self = this, $case = nil;

              return (function() {$case = Opal.const_get_relative($nesting, 'Hyperstack').$naming_convention();
              if ("camelize_params"['$===']($case)) {return self.$fix_suffix(name.$camelize())}
              else if ("prefix_params"['$===']($case)) {return "" + "_" + (name)}
              else {return name}})()
            }, TMP_instance_var_name_for_1.$$arity = 1);
            
            Opal.defn(self, '$fix_suffix', TMP_fix_suffix_2 = function $$fix_suffix(name) {
              var self = this;

              
              if ($truthy(name)) {
                } else {
                return nil
              };
              if ($truthy(name['$=~'](/\?$/))) {
                return $rb_plus(name['$[]']($range(0, -2, false)), "_q")
              } else if ($truthy(name['$=~'](/\!$/))) {
                return $rb_plus(name['$[]']($range(0, -2, false)), "_b")
                } else {
                return name
              };
            }, TMP_fix_suffix_2.$$arity = 1);
            
            Opal.defn(self, '$param_accessor_style', TMP_param_accessor_style_3 = function $$param_accessor_style(style) {
              var $a, self = this;
              if (self.param_accessor_style == null) self.param_accessor_style = nil;

              if (style == null) {
                style = nil;
              }
              
              if ($truthy(style)) {
                self.param_accessor_style = style};
              return (self.param_accessor_style = ($truthy($a = self.param_accessor_style) ? $a : (function() {if ($truthy(self.$superclass()['$respond_to?']("param_accessor_style"))) {
                return self.$superclass().$param_accessor_style()
                } else {
                return "hyperstack"
              }; return nil; })()));
            }, TMP_param_accessor_style_3.$$arity = -1);
            
            Opal.defn(self, '$param_definitions', TMP_param_definitions_4 = function $$param_definitions() {
              var $a, self = this;
              if (self.param_definitions == null) self.param_definitions = nil;

              return (self.param_definitions = ($truthy($a = self.param_definitions) ? $a : (function() {if ($truthy(self.$superclass()['$respond_to?']("param_definitions"))) {
                return self.$superclass().$param_definitions().$dup()
                } else {
                return Opal.const_get_relative($nesting, 'Hash').$new()
              }; return nil; })()))
            }, TMP_param_definitions_4.$$arity = 0);
            
            Opal.defn(self, '$define_param', TMP_define_param_8 = function $$define_param(name, param_type, aka) {
              var $a, TMP_5, TMP_6, TMP_7, self = this, meth_name = nil, var_name = nil, $writer = nil;

              if (aka == null) {
                aka = nil;
              }
              
              meth_name = ($truthy($a = aka) ? $a : name);
              var_name = ($truthy($a = self.$fix_suffix(aka)) ? $a : self.$instance_var_name_for(name));
              
              $writer = [name, $send(self, 'lambda', [], (TMP_5 = function(props){var self = TMP_5.$$s || this, val = nil;
                if (self.component == null) self.component = nil;
if (props == null) props = nil;
              
                self.component.$instance_variable_set("" + "@" + (var_name), (val = self.$fetch_from_cache(name, param_type, props)));
                if (self.$param_accessor_style()['$==']("accessors")) {
                  } else {
                  return nil;
                };
                return self.component["" + "$" + (meth_name)] = function() { return val };}, TMP_5.$$s = self, TMP_5.$$arity = 1, TMP_5))];
              $send(self.$param_definitions(), '[]=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;
              if ($truthy(["hyperstack", "accessors"]['$include?'](self.$param_accessor_style()))) {
                return nil};
              if (param_type['$=='](Opal.const_get_relative($nesting, 'Proc'))) {
                return $send(self, 'define_method', [meth_name.$to_sym()], (TMP_6 = function($b_rest){var self = TMP_6.$$s || this, block, args;

                  block = TMP_6.$$p || nil;
                  if (block) TMP_6.$$p = null;
                  var $args_len = arguments.length, $rest_len = $args_len - 0;
                  if ($rest_len < 0) { $rest_len = 0; }
                  args = new Array($rest_len);
                  for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                    args[$arg_idx - 0] = arguments[$arg_idx];
                  }
                if ($truthy(self.$props()['$[]'](name))) {
                    return $send(self.$props()['$[]'](name), 'call', Opal.to_a(args), block.$to_proc())
                    } else {
                    return nil
                  }}, TMP_6.$$s = self, TMP_6.$$arity = -1, TMP_6))
                } else {
                return $send(self, 'define_method', [meth_name.$to_sym()], (TMP_7 = function(){var self = TMP_7.$$s || this;

                return self.$fetch_from_cache(name, param_type, self.$props())}, TMP_7.$$s = self, TMP_7.$$arity = 0, TMP_7))
              };
            }, TMP_define_param_8.$$arity = -3);
            return (Opal.defn(self, '$define_all_others', TMP_define_all_others_10 = function $$define_all_others(name) {
              var TMP_9, TMP_11, self = this, $iter = TMP_define_all_others_10.$$p, $yield = $iter || nil, var_name = nil, $writer = nil;

              if ($iter) TMP_define_all_others_10.$$p = null;
              
              var_name = self.$instance_var_name_for(name);
              
              $writer = [name, $send(self, 'lambda', [], (TMP_9 = function(props){var self = TMP_9.$$s || this, val = nil;
                if (self.component == null) self.component = nil;
if (props == null) props = nil;
              
                self.component.$instance_variable_set("" + "@" + (var_name), (val = Opal.yield1($yield, props)));
                if (self.$param_accessor_style()['$==']("accessors")) {
                  } else {
                  return nil;
                };
                return self.component["" + "$" + (name)] = function() { return val };}, TMP_9.$$s = self, TMP_9.$$arity = 1, TMP_9))];
              $send(self.$param_definitions(), '[]=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;
              return $send(self, 'define_method', [name.$to_sym()], (TMP_11 = function(){var self = TMP_11.$$s || this, $a;
                if (self._all_others_cache == null) self._all_others_cache = nil;

              return (self._all_others_cache = ($truthy($a = self._all_others_cache) ? $a : Opal.yield1($yield, self.$props())))}, TMP_11.$$s = self, TMP_11.$$arity = 0, TMP_11));
            }, TMP_define_all_others_10.$$arity = 1), nil) && 'define_all_others';
          })(Opal.get_singleton_class(self), $nesting);
          
          Opal.defn(self, '$param_accessor_style', TMP_PropsWrapper_param_accessor_style_12 = function $$param_accessor_style() {
            var self = this;

            return self.$class().$param_accessor_style()
          }, TMP_PropsWrapper_param_accessor_style_12.$$arity = 0);
          
          Opal.defn(self, '$initialize', TMP_PropsWrapper_initialize_14 = function $$initialize(component, incoming) {
            var TMP_13, self = this;

            if (incoming == null) {
              incoming = nil;
            }
            
            self.component = component;
            if (self.$param_accessor_style()['$==']("legacy")) {
              return nil};
            return $send(self.$class().$param_definitions(), 'each_value', [], (TMP_13 = function(initializer){var self = TMP_13.$$s || this, $a;
if (initializer == null) initializer = nil;
            return $send(self, 'instance_exec', [($truthy($a = incoming) ? $a : self.$props())], initializer.$to_proc())}, TMP_13.$$s = self, TMP_13.$$arity = 1, TMP_13));
          }, TMP_PropsWrapper_initialize_14.$$arity = -2);
          
          Opal.defn(self, '$reload', TMP_PropsWrapper_reload_15 = function $$reload(next_props) {
            var self = this;

            
            self._all_others_cache = nil;
            return self.$initialize(self.component, next_props);
          }, TMP_PropsWrapper_reload_15.$$arity = 1);
          
          Opal.defn(self, '$[]', TMP_PropsWrapper_$$_16 = function(prop) {
            var self = this;

            return self.$props()['$[]'](prop)
          }, TMP_PropsWrapper_$$_16.$$arity = 1);
          self.$private();
          
          Opal.defn(self, '$fetch_from_cache', TMP_PropsWrapper_fetch_from_cache_18 = function $$fetch_from_cache(name, param_type, props) {
            var $a, $b, TMP_17, self = this, last = nil, cached_value = nil;

            
            $b = self.$cache()['$[]'](name), $a = Opal.to_ary($b), (last = ($a[0] == null ? nil : $a[0])), (cached_value = ($a[1] == null ? nil : $a[1])), $b;
            if ($truthy(last['$equal?'](props['$[]'](name)))) {
              return cached_value};
            return $send(self.$convert_param(name, param_type, props), 'tap', [], (TMP_17 = function(value){var self = TMP_17.$$s || this, $writer = nil;
if (value == null) value = nil;
            
              $writer = [name, [props['$[]'](name), value]];
              $send(self.$cache(), '[]=', Opal.to_a($writer));
              return $writer[$rb_minus($writer["length"], 1)];}, TMP_17.$$s = self, TMP_17.$$arity = 1, TMP_17));
          }, TMP_PropsWrapper_fetch_from_cache_18.$$arity = 3);
          
          Opal.defn(self, '$convert_param', TMP_PropsWrapper_convert_param_20 = function $$convert_param(name, param_type, props) {
            var $a, TMP_19, self = this;

            if ($truthy(param_type['$respond_to?']("_react_param_conversion"))) {
              return param_type.$_react_param_conversion(props['$[]'](name), nil)
            } else if ($truthy(($truthy($a = param_type['$is_a?'](Opal.const_get_relative($nesting, 'Array'))) ? param_type['$[]'](0)['$respond_to?']("_react_param_conversion") : $a))) {
              return $send(props['$[]'](name), 'collect', [], (TMP_19 = function(param){var self = TMP_19.$$s || this;
if (param == null) param = nil;
              return param_type['$[]'](0).$_react_param_conversion(param, nil)}, TMP_19.$$s = self, TMP_19.$$arity = 1, TMP_19))
              } else {
              return props['$[]'](name)
            }
          }, TMP_PropsWrapper_convert_param_20.$$arity = 3);
          
          Opal.defn(self, '$cache', TMP_PropsWrapper_cache_22 = function $$cache() {
            var $a, TMP_21, self = this;

            return (self.cache = ($truthy($a = self.cache) ? $a : $send(Opal.const_get_relative($nesting, 'Hash'), 'new', [], (TMP_21 = function(h, k){var self = TMP_21.$$s || this, $writer = nil;
if (h == null) h = nil;if (k == null) k = nil;
            
              $writer = [k, []];
              $send(h, '[]=', Opal.to_a($writer));
              return $writer[$rb_minus($writer["length"], 1)];}, TMP_21.$$s = self, TMP_21.$$arity = 2, TMP_21))))
          }, TMP_PropsWrapper_cache_22.$$arity = 0);
          
          Opal.defn(self, '$props', TMP_PropsWrapper_props_23 = function $$props() {
            var self = this;

            return self.$component().$props()
          }, TMP_PropsWrapper_props_23.$$arity = 0);
          return (Opal.defn(self, '$value_for', TMP_PropsWrapper_value_for_24 = function $$value_for(name) {
            var self = this;

            if ($truthy(self['$[]'](name))) {
              return self['$[]'](name).$instance_variable_get("@value")
              } else {
              return nil
            }
          }, TMP_PropsWrapper_value_for_24.$$arity = 1), nil) && 'value_for';
        })($nesting[0], null, $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/component"] = function(Opal) {
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send, $truthy = Opal.truthy, $hash2 = Opal.hash2, $hash = Opal.hash;

  Opal.add_stubs(['$require', '$include', '$class_eval', '$class_attribute', '$define_callback', '$add_after_error_hook', '$extend', '$respond_to?', '$!', '$<', '$allow_deprecated_render_definition?', '$deprecation_warning', '$new', '$to_a', '$mounted_components', '$each', '$include?', '$force_update!', '$name', '$class', '$event_camelize', '$to_s', '$call', '$[]', '$params', '$props_wrapper', '$on_opal_client?', '$load_context', '$observing', '$<<', '$run_callback', '$props', '$quiet_test', '$reload', '$unmount', '$remove', '$delete', '$set_state', '$==', '$method_defined?', '$raise', '$first', '$render', '$waiting_on_resources']);
  
  self.$require("hyperstack/ext/component/string");
  self.$require("hyperstack/ext/component/hash");
  self.$require("active_support/core_ext/class/attribute");
  self.$require("hyperstack/internal/auto_unmount");
  self.$require("hyperstack/internal/component/rendering_context");
  self.$require("hyperstack/internal/component");
  self.$require("hyperstack/internal/component/instance_methods");
  self.$require("hyperstack/internal/component/class_methods");
  self.$require("hyperstack/internal/component/props_wrapper");
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Component, self = $Component = $module($base, 'Component');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Component_included_3, TMP_Component_mounted_components_4, TMP_Component_force_update$B_6, TMP_Component_deprecation_warning_7, TMP_Component_deprecation_warning_8, TMP_Component_initialize_9, TMP_Component_emit_10, TMP_Component_component_will_mount_12, TMP_Component_component_did_mount_14, TMP_Component_component_will_receive_props_16, TMP_Component_component_will_update_18, TMP_Component_component_did_update_20, TMP_Component_component_will_unmount_22, TMP_Component_component_did_catch_24, TMP_Component_mutations_25, TMP_Component_update_react_js_state_26, TMP_Component_render_27, TMP_Component_waiting_on_resources_28, TMP_Component___hyperstack_component_run_post_render_hooks_30, TMP_Component__render_wrapper_33;

      
      Opal.defs(self, '$included', TMP_Component_included_3 = function $$included(base) {
        var TMP_1, $a, self = this;

        
        base.$include(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'State'), 'Observer'));
        base.$include(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'InstanceMethods'));
        base.$include(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'AutoUnmount'));
        base.$include(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'Tags'));
        base.$include(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'ShouldComponentUpdate'));
        $send(base, 'class_eval', [], (TMP_1 = function(){var self = TMP_1.$$s || this, TMP_2;

        
          self.$class_attribute("initial_state");
          self.$define_callback("before_mount");
          self.$define_callback("after_mount");
          self.$define_callback("before_new_params");
          self.$define_callback("before_update");
          self.$define_callback("after_update");
          self.$define_callback("__hyperstack_component_after_render_hook");
          self.$define_callback("__hyperstack_component_rescue_hook");
          return $send(self, 'define_callback', ["after_error"], (TMP_2 = function(){var self = TMP_2.$$s || this;

          return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'ReactWrapper').$add_after_error_hook(base)}, TMP_2.$$s = self, TMP_2.$$arity = 0, TMP_2));}, TMP_1.$$s = self, TMP_1.$$arity = 0, TMP_1));
        base.$extend(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'ClassMethods'));
        if ($truthy(Opal.__hyperstack_component_original_defn)) {
          return nil
          } else {
          
          
         Opal.__hyperstack_component_original_defn = Opal.defn
         Opal.defn = function(klass, name, fn) {
           (function() {if ($truthy(($truthy($a = (klass)['$respond_to?']("hyper_component?")) ? $rb_lt(klass, Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'NativeLibrary'))['$!']() : $a))) {
            if ($truthy(($truthy($a = name == '$render') ? (klass)['$allow_deprecated_render_definition?']()['$!']() : $a))) {
              return Opal.const_get_relative($nesting, 'Hyperstack').$deprecation_warning(klass, "Do not directly define the render method. Use the render macro instead.")
            } else if ($truthy(name == '$__hyperstack_component_render')) {
              return name = '$render'
              } else {
              return nil
            }
            } else {
            return nil
          }; return nil; })()
           Opal.__hyperstack_component_original_defn(klass, name, fn)
           }
         ;
          return nil;
        };
      }, TMP_Component_included_3.$$arity = 1);
      Opal.defs(self, '$mounted_components', TMP_Component_mounted_components_4 = function $$mounted_components() {
        var $a, self = this;
        if (self.__hyperstack_component_mounted_components == null) self.__hyperstack_component_mounted_components = nil;

        return (self.__hyperstack_component_mounted_components = ($truthy($a = self.__hyperstack_component_mounted_components) ? $a : Opal.const_get_relative($nesting, 'Set').$new()))
      }, TMP_Component_mounted_components_4.$$arity = 0);
      Opal.defs(self, '$force_update!', TMP_Component_force_update$B_6 = function() {
        var TMP_5, self = this, components = nil;

        
        components = self.$mounted_components().$to_a();
        return $send(components, 'each', [], (TMP_5 = function(comp){var self = TMP_5.$$s || this;
if (comp == null) comp = nil;
        
          if ($truthy(self.$mounted_components()['$include?'](comp))) {
            } else {
            return nil;
          };
          return comp['$force_update!']();}, TMP_5.$$s = self, TMP_5.$$arity = 1, TMP_5));
      }, TMP_Component_force_update$B_6.$$arity = 0);
      Opal.defs(self, '$deprecation_warning', TMP_Component_deprecation_warning_7 = function $$deprecation_warning(message) {
        var self = this;

        return Opal.const_get_relative($nesting, 'Hyperstack').$deprecation_warning(self.$name(), message)
      }, TMP_Component_deprecation_warning_7.$$arity = 1);
      
      Opal.defn(self, '$deprecation_warning', TMP_Component_deprecation_warning_8 = function $$deprecation_warning(message) {
        var self = this;

        return Opal.const_get_relative($nesting, 'Hyperstack').$deprecation_warning(self.$class().$name(), message)
      }, TMP_Component_deprecation_warning_8.$$arity = 1);
      
      Opal.defn(self, '$initialize', TMP_Component_initialize_9 = function $$initialize(native_element) {
        var self = this;

        return (self.__hyperstack_component_native = native_element)
      }, TMP_Component_initialize_9.$$arity = 1);
      
      Opal.defn(self, '$emit', TMP_Component_emit_10 = function $$emit(event_name, $a_rest) {
        var self = this, args, built_in_event_name = nil;

        var $args_len = arguments.length, $rest_len = $args_len - 1;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 1] = arguments[$arg_idx];
        }
        if ($truthy(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Event'), 'BUILT_IN_EVENTS')['$include?']((built_in_event_name = "" + "on" + (event_name.$to_s().$event_camelize()))))) {
          return $send(self.$params()['$[]'](built_in_event_name), 'call', Opal.to_a(args))
          } else {
          return $send(self.$params()['$[]']("" + "on_" + (event_name)), 'call', Opal.to_a(args))
        }
      }, TMP_Component_emit_10.$$arity = -2);
      
      Opal.defn(self, '$component_will_mount', TMP_Component_component_will_mount_12 = function $$component_will_mount() {
        var TMP_11, self = this;

        
        self.__hyperstack_component_params_wrapper = self.$class().$props_wrapper().$new(self);
        if ($truthy(Opal.const_get_relative($nesting, 'IsomorphicHelpers')['$on_opal_client?']())) {
          Opal.const_get_relative($nesting, 'IsomorphicHelpers').$load_context(true)};
        return $send(self, 'observing', [$hash2(["immediate_update"], {"immediate_update": true})], (TMP_11 = function(){var self = TMP_11.$$s || this;

        
          Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component').$mounted_components()['$<<'](self);
          return self.$run_callback("before_mount", self.$props());}, TMP_11.$$s = self, TMP_11.$$arity = 0, TMP_11));
      }, TMP_Component_component_will_mount_12.$$arity = 0);
      
      Opal.defn(self, '$component_did_mount', TMP_Component_component_did_mount_14 = function $$component_did_mount() {
        var TMP_13, self = this;

        return $send(self, 'observing', [$hash2(["update_objects"], {"update_objects": true})], (TMP_13 = function(){var self = TMP_13.$$s || this;

        
          self.$run_callback("after_mount");
          return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext').$quiet_test(self);}, TMP_13.$$s = self, TMP_13.$$arity = 0, TMP_13))
      }, TMP_Component_component_did_mount_14.$$arity = 0);
      
      Opal.defn(self, '$component_will_receive_props', TMP_Component_component_will_receive_props_16 = function $$component_will_receive_props(next_props) {
        var TMP_15, self = this;

        
        $send(self, 'observing', [$hash2(["immediate_update"], {"immediate_update": true})], (TMP_15 = function(){var self = TMP_15.$$s || this;

        return self.$run_callback("before_new_params", next_props)}, TMP_15.$$s = self, TMP_15.$$arity = 0, TMP_15));
        return (self.__hyperstack_component_receiving_props = true);
      }, TMP_Component_component_will_receive_props_16.$$arity = 1);
      
      Opal.defn(self, '$component_will_update', TMP_Component_component_will_update_18 = function $$component_will_update(next_props, next_state) {
        var TMP_17, self = this;
        if (self.__hyperstack_component_receiving_props == null) self.__hyperstack_component_receiving_props = nil;
        if (self.__hyperstack_component_params_wrapper == null) self.__hyperstack_component_params_wrapper = nil;

        
        $send(self, 'observing', [], (TMP_17 = function(){var self = TMP_17.$$s || this;

        return self.$run_callback("before_update", next_props, next_state)}, TMP_17.$$s = self, TMP_17.$$arity = 0, TMP_17));
        if ($truthy(self.__hyperstack_component_receiving_props)) {
          self.__hyperstack_component_params_wrapper.$reload(next_props)};
        return (self.__hyperstack_component_receiving_props = false);
      }, TMP_Component_component_will_update_18.$$arity = 2);
      
      Opal.defn(self, '$component_did_update', TMP_Component_component_did_update_20 = function $$component_did_update(prev_props, prev_state) {
        var TMP_19, self = this;

        return $send(self, 'observing', [$hash2(["update_objects"], {"update_objects": true})], (TMP_19 = function(){var self = TMP_19.$$s || this;

        
          self.$run_callback("after_update", prev_props, prev_state);
          return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext').$quiet_test(self);}, TMP_19.$$s = self, TMP_19.$$arity = 0, TMP_19))
      }, TMP_Component_component_did_update_20.$$arity = 2);
      
      Opal.defn(self, '$component_will_unmount', TMP_Component_component_will_unmount_22 = function $$component_will_unmount() {
        var TMP_21, self = this;

        return $send(self, 'observing', [], (TMP_21 = function(){var self = TMP_21.$$s || this;

        
          self.$unmount();
          self.$remove();
          return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component').$mounted_components().$delete(self);}, TMP_21.$$s = self, TMP_21.$$arity = 0, TMP_21))
      }, TMP_Component_component_will_unmount_22.$$arity = 0);
      
      Opal.defn(self, '$component_did_catch', TMP_Component_component_did_catch_24 = function $$component_did_catch(error, info) {
        var TMP_23, self = this;

        return $send(self, 'observing', [], (TMP_23 = function(){var self = TMP_23.$$s || this;

        return self.$run_callback("after_error", error, info)}, TMP_23.$$s = self, TMP_23.$$arity = 0, TMP_23))
      }, TMP_Component_component_did_catch_24.$$arity = 2);
      
      Opal.defn(self, '$mutations', TMP_Component_mutations_25 = function $$mutations(_objects) {
        var self = this;

        return self.$set_state($hash2(["***_state_updated_at-***"], {"***_state_updated_at-***": Date.now() + Math.random()}))
      }, TMP_Component_mutations_25.$$arity = 1);
      
      Opal.defn(self, '$update_react_js_state', TMP_Component_update_react_js_state_26 = function $$update_react_js_state(object, name, value) {
        var self = this;

        if ($truthy(object)) {
          
          if (object['$=='](self)) {
            } else {
            name = "" + (object.$class()) + "." + (name)
          };
          return self.$set_state($hash("***_state_updated_at-***", Date.now() + Math.random(), name, value));
          } else {
          return self.$set_state($hash(name, value))
        }
      }, TMP_Component_update_react_js_state_26.$$arity = 3);
      if ($truthy(self['$method_defined?']("render"))) {
        } else {
        
        Opal.defn(self, '$render', TMP_Component_render_27 = function $$render() {
          var self = this;

          return self.$raise("no render defined")
        }, TMP_Component_render_27.$$arity = 0)
      };
      
      Opal.defn(self, '$waiting_on_resources', TMP_Component_waiting_on_resources_28 = function $$waiting_on_resources() {
        var self = this;
        if (self.__hyperstack_component_waiting_on_resources == null) self.__hyperstack_component_waiting_on_resources = nil;

        return self.__hyperstack_component_waiting_on_resources
      }, TMP_Component_waiting_on_resources_28.$$arity = 0);
      
      Opal.defn(self, '$__hyperstack_component_run_post_render_hooks', TMP_Component___hyperstack_component_run_post_render_hooks_30 = function $$__hyperstack_component_run_post_render_hooks(element) {
        var TMP_29, self = this;

        return $send(self, 'run_callback', ["__hyperstack_component_after_render_hook", element], (TMP_29 = function($a_rest){var self = TMP_29.$$s || this, args;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
        return args}, TMP_29.$$s = self, TMP_29.$$arity = -1, TMP_29)).$first()
      }, TMP_Component___hyperstack_component_run_post_render_hooks_30.$$arity = 1);
      
      Opal.defn(self, '$_render_wrapper', TMP_Component__render_wrapper_33 = function $$_render_wrapper() {
        var TMP_31, self = this;

        return $send(self, 'observing', [$hash2(["rendering"], {"rendering": true})], (TMP_31 = function(){var self = TMP_31.$$s || this, TMP_32, element = nil;

        
          element = $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext'), 'render', [nil], (TMP_32 = function(){var self = TMP_32.$$s || this, $a;

          return ($truthy($a = self.$render()) ? $a : "")}, TMP_32.$$s = self, TMP_32.$$arity = 0, TMP_32));
          if ($truthy(element['$respond_to?']("waiting_on_resources"))) {
            self.__hyperstack_component_waiting_on_resources = element.$waiting_on_resources()};
          return element;}, TMP_31.$$s = self, TMP_31.$$arity = 0, TMP_31))
      }, TMP_Component__render_wrapper_33.$$arity = 0);
    })($nesting[0], $nesting)
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/component/should_component_update"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send, $truthy = Opal.truthy;

  Opal.add_stubs(['$observing', '$respond_to?', '$!', '$call_needs_update', '$props_changed?', '$native_state_changed?', '$define_singleton_method', '$needs_update?', '$new', '$!=']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Component, self = $Component = $module($base, 'Component');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $parent_nesting) {
          var $ShouldComponentUpdate, self = $ShouldComponentUpdate = $module($base, 'ShouldComponentUpdate');

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ShouldComponentUpdate_should_component_update$q_2, TMP_ShouldComponentUpdate_call_needs_update_5, TMP_ShouldComponentUpdate_native_state_changed$q_6, TMP_ShouldComponentUpdate_props_changed$q_7;

          
          
          Opal.defn(self, '$should_component_update?', TMP_ShouldComponentUpdate_should_component_update$q_2 = function(next_props, next_state) {
            var TMP_1, self = this;

            return $send(self, 'observing', [], (TMP_1 = function(){var self = TMP_1.$$s || this, $a;

            if ($truthy(self['$respond_to?']("needs_update?"))) {
                return self.$call_needs_update(next_props, next_state)['$!']()['$!']()
                } else {
                return ($truthy($a = self['$props_changed?'](next_props)) ? $a : self['$native_state_changed?'](next_state))
              }}, TMP_1.$$s = self, TMP_1.$$arity = 0, TMP_1))
          }, TMP_ShouldComponentUpdate_should_component_update$q_2.$$arity = 2);
          
          Opal.defn(self, '$call_needs_update', TMP_ShouldComponentUpdate_call_needs_update_5 = function $$call_needs_update(next_params, next_state) {
            var TMP_3, TMP_4, self = this, component = nil;

            
            component = self;
            $send(next_params, 'define_singleton_method', ["changed?"], (TMP_3 = function(){var self = TMP_3.$$s || this;

            return component['$props_changed?'](self)}, TMP_3.$$s = self, TMP_3.$$arity = 0, TMP_3));
            $send(next_state, 'define_singleton_method', ["changed?"], (TMP_4 = function(){var self = TMP_4.$$s || this;

            return component['$native_state_changed?'](next_state)}, TMP_4.$$s = self, TMP_4.$$arity = 0, TMP_4));
            return self['$needs_update?'](next_params, next_state);
          }, TMP_ShouldComponentUpdate_call_needs_update_5.$$arity = 2);
          
          Opal.defn(self, '$native_state_changed?', TMP_ShouldComponentUpdate_native_state_changed$q_6 = function(next_state_hash) {
            var self = this, state_hash = nil;
            if (self.__hyperstack_component_native == null) self.__hyperstack_component_native = nil;

            
            state_hash = Opal.const_get_relative($nesting, 'Hash').$new(self.__hyperstack_component_native.state);
            return next_state_hash['$!='](state_hash);
          }, TMP_ShouldComponentUpdate_native_state_changed$q_6.$$arity = 1);
          
          Opal.defn(self, '$props_changed?', TMP_ShouldComponentUpdate_props_changed$q_7 = function(next_props) {
            var self = this, props = nil;
            if (self.__hyperstack_component_native == null) self.__hyperstack_component_native = nil;

            
            props = Opal.const_get_relative($nesting, 'Hash').$new(self.__hyperstack_component_native.props);
            return next_props['$!='](props);
          }, TMP_ShouldComponentUpdate_props_changed$q_7.$$arity = 1);
        })($nesting[0], $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/component/tags"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send, $truthy = Opal.truthy, $klass = Opal.klass;

  Opal.add_stubs(['$+', '$each', '$define_method', '$upcase', '$render', '$to_proc', '$const_set', '$downcase', '$=~', '$include?', '$create_element', '$find_component', '$find_name_and_parent', '$new', '$extend', '$private', '$name', '$split', '$>', '$length', '$last', '$[]', '$inject', '$const_get', '$lookup_const', '$!', '$method_defined?', '$raise', '$_reactrb_import_component_class', '$reverse', '$to_s', '$class', '$detect', '$const_defined?', '$respond_to?']);
  
  (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Component, self = $Component = $module($base, 'Component');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $parent_nesting) {
          var $Tags, self = $Tags = $module($base, 'Tags');

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Tags_1, TMP_Tags_html_tag_class_for_3, TMP_Tags_method_missing_4, TMP_Tags_find_component_10, TMP_Tags_lookup_const_13;

          
          Opal.const_set($nesting[0], 'HTML_TAGS', $rb_plus(["a", "abbr", "address", "area", "article", "aside", "audio", "b", "base", "bdi", "bdo", "big", "blockquote", "body", "br", "button", "canvas", "caption", "cite", "code", "col", "colgroup", "data", "datalist", "dd", "del", "details", "dfn", "dialog", "div", "dl", "dt", "em", "embed", "fieldset", "figcaption", "figure", "footer", "form", "h1", "h2", "h3", "h4", "h5", "h6", "head", "header", "hr", "html", "i", "iframe", "img", "input", "ins", "kbd", "keygen", "label", "legend", "li", "link", "main", "map", "mark", "menu", "menuitem", "meta", "meter", "nav", "noscript", "object", "ol", "optgroup", "option", "output", "p", "param", "picture", "pre", "progress", "q", "rp", "rt", "ruby", "s", "samp", "script", "section", "select", "small", "source", "span", "strong", "style", "sub", "summary", "sup", "table", "tbody", "td", "textarea", "tfoot", "th", "thead", "time", "title", "tr", "track", "u", "ul", "var", "video", "wbr"], ["circle", "clipPath", "defs", "ellipse", "g", "line", "linearGradient", "mask", "path", "pattern", "polygon", "polyline", "radialGradient", "rect", "stop", "svg", "text", "tspan"]));
          $send(Opal.const_get_relative($nesting, 'HTML_TAGS'), 'each', [], (TMP_Tags_1 = function(tag){var self = TMP_Tags_1.$$s || this, TMP_2;
if (tag == null) tag = nil;
          
            $send(self, 'define_method', [tag.$upcase()], (TMP_2 = function($a_rest){var self = TMP_2.$$s || this, children, params;

              children = TMP_2.$$p || nil;
              if (children) TMP_2.$$p = null;
              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              params = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                params[$arg_idx - 0] = arguments[$arg_idx];
              }
            return $send(Opal.const_get_relative($nesting, 'RenderingContext'), 'render', [tag].concat(Opal.to_a(params)), children.$to_proc())}, TMP_2.$$s = self, TMP_2.$$arity = -1, TMP_2));
            return self.$const_set(tag.$upcase(), tag);}, TMP_Tags_1.$$s = self, TMP_Tags_1.$$arity = 1, TMP_Tags_1));
          Opal.defs(self, '$html_tag_class_for', TMP_Tags_html_tag_class_for_3 = function $$html_tag_class_for(tag) {
            var $a, self = this, downcased_tag = nil;

            
            downcased_tag = tag.$downcase();
            if ($truthy(($truthy($a = tag['$=~'](/^[A-Z]+$/)) ? Opal.const_get_relative($nesting, 'HTML_TAGS')['$include?'](downcased_tag) : $a))) {
              return Opal.const_get_relative($nesting, 'Object').$const_set(tag, Opal.const_get_relative($nesting, 'ReactWrapper').$create_element(downcased_tag))
              } else {
              return nil
            };
          }, TMP_Tags_html_tag_class_for_3.$$arity = 1);
          
          Opal.defn(self, '$method_missing', TMP_Tags_method_missing_4 = function $$method_missing(name, $a_rest) {
            var self = this, params, $iter = TMP_Tags_method_missing_4.$$p, children = $iter || nil, component = nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 1;
            if ($rest_len < 0) { $rest_len = 0; }
            params = new Array($rest_len);
            for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
              params[$arg_idx - 1] = arguments[$arg_idx];
            }
            if ($iter) TMP_Tags_method_missing_4.$$p = null;
            // Prepare super implicit arguments
            for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
              $zuper[$zuper_i] = arguments[$zuper_i];
            }
            
            component = self.$find_component(name);
            if ($truthy(component)) {
              return $send(Opal.const_get_relative($nesting, 'RenderingContext'), 'render', [component].concat(Opal.to_a(params)), children.$to_proc())};
            return $send(self, Opal.find_super_dispatcher(self, 'method_missing', TMP_Tags_method_missing_4, false), $zuper, $iter);
          }, TMP_Tags_method_missing_4.$$arity = -2);
          (function(self, $parent_nesting) {
            var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_included_7, TMP_find_name_and_parent_9;

            
            
            Opal.defn(self, '$included', TMP_included_7 = function $$included(component) {
              var $a, $b, TMP_5, self = this, name = nil, parent = nil, tag_names_module = nil;

              
              $b = self.$find_name_and_parent(component), $a = Opal.to_ary($b), (name = ($a[0] == null ? nil : $a[0])), (parent = ($a[1] == null ? nil : $a[1])), $b;
              tag_names_module = $send(Opal.const_get_relative($nesting, 'Module'), 'new', [], (TMP_5 = function(){var self = TMP_5.$$s || this, TMP_6;

              return $send(self, 'define_method', [name], (TMP_6 = function($c_rest){var self = TMP_6.$$s || this, children, params;

                  children = TMP_6.$$p || nil;
                  if (children) TMP_6.$$p = null;
                  var $args_len = arguments.length, $rest_len = $args_len - 0;
                  if ($rest_len < 0) { $rest_len = 0; }
                  params = new Array($rest_len);
                  for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                    params[$arg_idx - 0] = arguments[$arg_idx];
                  }
                return $send(Opal.const_get_relative($nesting, 'RenderingContext'), 'render', [component].concat(Opal.to_a(params)), children.$to_proc())}, TMP_6.$$s = self, TMP_6.$$arity = -1, TMP_6))}, TMP_5.$$s = self, TMP_5.$$arity = 0, TMP_5));
              return parent.$extend(tag_names_module);
            }, TMP_included_7.$$arity = 1);
            self.$private();
            return (Opal.defn(self, '$find_name_and_parent', TMP_find_name_and_parent_9 = function $$find_name_and_parent(component) {
              var $a, TMP_8, self = this, split_name = nil;

              
              split_name = ($truthy($a = component.$name()) ? component.$name().$split("::") : $a);
              if ($truthy(($truthy($a = split_name) ? $rb_gt(split_name.$length(), 1) : $a))) {
                return [split_name.$last(), $send(split_name, 'inject', [[Opal.const_get_relative($nesting, 'Module')]], (TMP_8 = function(a, e){var self = TMP_8.$$s || this;
if (a == null) a = nil;if (e == null) e = nil;
                return $rb_plus(a, [a.$last().$const_get(e)])}, TMP_8.$$s = self, TMP_8.$$arity = 2, TMP_8))['$[]'](-2)]
                } else {
                return nil
              };
            }, TMP_find_name_and_parent_9.$$arity = 1), nil) && 'find_name_and_parent';
          })(Opal.get_singleton_class(self), $nesting);
          self.$private();
          
          Opal.defn(self, '$find_component', TMP_Tags_find_component_10 = function $$find_component(name) {
            var $a, self = this, component = nil;

            
            component = self.$lookup_const(name);
            if ($truthy(($truthy($a = component) ? component['$method_defined?']("render")['$!']() : $a))) {
              self.$raise("" + (name) + " does not appear to be a react component.")};
            return ($truthy($a = component) ? $a : Opal.const_get_relative($nesting, 'Object').$_reactrb_import_component_class(name));
          }, TMP_Tags_find_component_10.$$arity = 1);
          
          Opal.defn(self, '$lookup_const', TMP_Tags_lookup_const_13 = function $$lookup_const(name) {
            var TMP_11, TMP_12, self = this, scopes = nil, scope = nil;

            
            if ($truthy(name['$=~'](/^[A-Z]/))) {
              } else {
              return nil
            };
            scopes = $send(self.$class().$name().$to_s().$split("::"), 'inject', [[Opal.const_get_relative($nesting, 'Module')]], (TMP_11 = function(nesting, next_const){var self = TMP_11.$$s || this;
if (nesting == null) nesting = nil;if (next_const == null) next_const = nil;
            return $rb_plus(nesting, [nesting.$last().$const_get(next_const)])}, TMP_11.$$s = self, TMP_11.$$arity = 2, TMP_11)).$reverse();
            scope = $send(scopes, 'detect', [], (TMP_12 = function(s){var self = TMP_12.$$s || this;
if (s == null) s = nil;
            return s['$const_defined?'](name)}, TMP_12.$$s = self, TMP_12.$$arity = 1, TMP_12));
            if ($truthy(scope)) {
              return scope.$const_get(name)
              } else {
              return nil
            };
          }, TMP_Tags_lookup_const_13.$$arity = 1);
        })($nesting[0], $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting);
  if ($truthy(Opal.const_get_relative($nesting, 'Object')['$respond_to?']("_reactrb_import_component_class"))) {
    return nil
    } else {
    return (function($base, $super, $parent_nesting) {
      function $Object(){};
      var self = $Object = $klass($base, $super, 'Object', $Object);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Object__reactrb_import_component_class_14;

      return Opal.defs(self, '$_reactrb_import_component_class', TMP_Object__reactrb_import_component_class_14 = function $$_reactrb_import_component_class(_name) {
        var self = this;

        return nil
      }, TMP_Object__reactrb_import_component_class_14.$$arity = 1)
    })($nesting[0], null, $nesting)
  };
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/component/event"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass;

  Opal.add_stubs(['$include', '$alias_native']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Component, self = $Component = $module($base, 'Component');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $super, $parent_nesting) {
        function $Event(){};
        var self = $Event = $klass($base, $super, 'Event', $Event);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Event_initialize_1;

        
        self.$include(Opal.const_get_relative($nesting, 'Native'));
        self.$alias_native("bubbles", "bubbles");
        self.$alias_native("cancelable", "cancelable");
        self.$alias_native("current_target", "currentTarget");
        self.$alias_native("default_prevented", "defaultPrevented");
        self.$alias_native("event_phase", "eventPhase");
        self.$alias_native("is_trusted?", "isTrusted");
        self.$alias_native("native_event", "nativeEvent");
        self.$alias_native("target", "target");
        self.$alias_native("timestamp", "timeStamp");
        self.$alias_native("event_type", "type");
        self.$alias_native("prevent_default", "preventDefault");
        self.$alias_native("stop_propagation", "stopPropagation");
        self.$alias_native("clipboard_data", "clipboardData");
        self.$alias_native("alt_key", "altKey");
        self.$alias_native("char_code", "charCode");
        self.$alias_native("ctrl_key", "ctrlKey");
        self.$alias_native("get_modifier_state", "getModifierState");
        self.$alias_native("key", "key");
        self.$alias_native("key_code", "keyCode");
        self.$alias_native("locale", "locale");
        self.$alias_native("location", "location");
        self.$alias_native("meta_key", "metaKey");
        self.$alias_native("repeat", "repeat");
        self.$alias_native("shift_key", "shiftKey");
        self.$alias_native("which", "which");
        self.$alias_native("related_target", "relatedTarget");
        self.$alias_native("button", "button");
        self.$alias_native("buttons", "buttons");
        self.$alias_native("client_x", "clientX");
        self.$alias_native("client_y", "clientY");
        self.$alias_native("get_modifier_state", "getModifierState");
        self.$alias_native("page_x", "pageX");
        self.$alias_native("page_y", "pageY");
        self.$alias_native("screen_x", "screen_x");
        self.$alias_native("screen_y", "screen_y");
        self.$alias_native("changed_touches", "changedTouches");
        self.$alias_native("target_touches", "targetTouches");
        self.$alias_native("touches", "touches");
        self.$alias_native("detail", "detail");
        self.$alias_native("view", "view");
        self.$alias_native("delta_mode", "deltaMode");
        self.$alias_native("delta_x", "deltaX");
        self.$alias_native("delta_y", "deltaY");
        self.$alias_native("delta_z", "deltaZ");
        Opal.const_set($nesting[0], 'BUILT_IN_EVENTS', ["onCopy", "onCut", "onPaste", "onKeyDown", "onKeyPress", "onKeyUp", "onFocus", "onBlur", "onChange", "onInput", "onSubmit", "onClick", "onContextMenu", "onDoubleClick", "onDrag", "onDragEnd", "onDragEnter", "onDragExit", "onDragLeave", "onDragOver", "onDragStart", "onDrop", "onMouseDown", "onMouseEnter", "onMouseLeave", "onMouseMove", "onMouseOut", "onMouseOver", "onMouseUp", "onSelect", "onTouchCancel", "onTouchEnd", "onTouchMove", "onTouchStart", "onScroll", "onWheel"]);
        return (Opal.defn(self, '$initialize', TMP_Event_initialize_1 = function $$initialize(native_event) {
          var self = this;

          return (self["native"] = native_event)
        }, TMP_Event_initialize_1.$$arity = 1), nil) && 'initialize';
      })($nesting[0], null, $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/ext/component/object"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $truthy = Opal.truthy;

  Opal.add_stubs(['$_reactrb_tag_original_const_missing', '$html_tag_class_for', '$raise', '$object_id']);
  return (function($base, $super, $parent_nesting) {
    function $Object(){};
    var self = $Object = $klass($base, $super, 'Object', $Object);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Object_to_key_2;

    
    (function($base, $super, $parent_nesting) {
      function $Object(){};
      var self = $Object = $klass($base, $super, 'Object', $Object);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return (function(self, $parent_nesting) {
        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_const_missing_1;

        
        Opal.alias(self, "_reactrb_tag_original_const_missing", "const_missing");
        return (Opal.defn(self, '$const_missing', TMP_const_missing_1 = function $$const_missing(const_name) {
          var $a, self = this, e = nil;

          try {
            return self.$_reactrb_tag_original_const_missing(const_name)
          } catch ($err) {
            if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'StandardError')])) {e = $err;
              try {
                return ($truthy($a = Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'Tags').$html_tag_class_for(const_name)) ? $a : self.$raise(e))
              } finally { Opal.pop_exception() }
            } else { throw $err; }
          }
        }, TMP_const_missing_1.$$arity = 1), nil) && 'const_missing';
      })(Opal.get_singleton_class(self), $nesting)
    })($nesting[0], null, $nesting);
    return (Opal.defn(self, '$to_key', TMP_Object_to_key_2 = function $$to_key() {
      var self = this;

      return self.$object_id()
    }, TMP_Object_to_key_2.$$arity = 0), nil) && 'to_key';
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/ext/component/number"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  return (function($base, $super, $parent_nesting) {
    function $Number(){};
    var self = $Number = $klass($base, $super, 'Number', $Number);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Number_to_key_1;

    return (Opal.defn(self, '$to_key', TMP_Number_to_key_1 = function $$to_key() {
      var self = this;

      return self
    }, TMP_Number_to_key_1.$$arity = 0), nil) && 'to_key'
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/ext/component/boolean"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  return (function($base, $super, $parent_nesting) {
    function $Boolean(){};
    var self = $Boolean = $klass($base, $super, 'Boolean', $Boolean);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Boolean_to_key_1;

    return (Opal.defn(self, '$to_key', TMP_Boolean_to_key_1 = function $$to_key() {
      var self = this;

      return self
    }, TMP_Boolean_to_key_1.$$arity = 0), nil) && 'to_key'
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/component/isomorphic_helpers"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $range = Opal.range, $send = Opal.send, $klass = Opal.klass, $hash2 = Opal.hash2;

  Opal.add_stubs(['$require', '$extend', '$!=', '$!', '$unique_id', '$on_opal_server?', '$log', '$new', '$is_a?', '$==', '$production?', '$env', '$+', '$[]', '$class', '$on_opal_client?', '$join', '$collect', '$prerender_footer_blocks', '$call', '$attr_reader', '$[]=', '$-', '$run', '$each', '$before_first_mount_blocks', '$send_to_opal', '$eval', '$length', '$load!', '$tr', '$<<', '$first', '$send_to_server', '$to_json', '$parse', '$controller', '$context', '$register_before_first_mount_block', '$to_proc', '$register_prerender_footer_block', '$send', '$result']);
  
  self.$require("hyperstack/internal/component");
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Component, self = $Component = $module($base, 'Component');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $IsomorphicHelpers, self = $IsomorphicHelpers = $module($base, 'IsomorphicHelpers');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_IsomorphicHelpers_included_1, TMP_IsomorphicHelpers_load_context_2, TMP_IsomorphicHelpers_context_3, TMP_IsomorphicHelpers_log_4, TMP_IsomorphicHelpers_on_opal_server$q_5, TMP_IsomorphicHelpers_on_opal_client$q_6, TMP_IsomorphicHelpers_log_7, TMP_IsomorphicHelpers_on_opal_server$q_8, TMP_IsomorphicHelpers_on_opal_client$q_9, TMP_IsomorphicHelpers_prerender_footers_11;

        
        Opal.defs(self, '$included', TMP_IsomorphicHelpers_included_1 = function $$included(base) {
          var self = this;

          return base.$extend(Opal.const_get_relative($nesting, 'ClassMethods'))
        }, TMP_IsomorphicHelpers_included_1.$$arity = 1);
        if ($truthy(Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$!=']("opal"))) {
          nil
          } else {
          Opal.defs(self, '$load_context', TMP_IsomorphicHelpers_load_context_2 = function $$load_context(unique_id, name) {
            var $a, $b, self = this, message = nil;
            if (self.context == null) self.context = nil;

            if (unique_id == null) {
              unique_id = nil;
            }
            if (name == null) {
              name = nil;
            }
            
            if ($truthy(($truthy($a = ($truthy($b = unique_id['$!']()) ? $b : self.context['$!']())) ? $a : self.context.$unique_id()['$!='](unique_id)))) {
              
              if ($truthy(self['$on_opal_server?']())) {
                
                try {
                  console.history = []
                } catch ($err) {
                  if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'StandardError')])) {
                    try {
                      nil
                    } finally { Opal.pop_exception() }
                  } else { throw $err; }
                };
                message = "" + "************************ React Prerendering Context Initialized " + (name) + " ***********************";
                } else {
                message = "************************ React Browser Context Initialized ****************************"
              };
              self.$log(message);
              self.context = Opal.const_get_relative($nesting, 'Context').$new(unique_id);};
            return self.context;
          }, TMP_IsomorphicHelpers_load_context_2.$$arity = -1)
        };
        Opal.defs(self, '$context', TMP_IsomorphicHelpers_context_3 = function $$context() {
          var self = this;
          if (self.context == null) self.context = nil;

          return self.context
        }, TMP_IsomorphicHelpers_context_3.$$arity = 0);
        Opal.defs(self, '$log', TMP_IsomorphicHelpers_log_4 = function $$log(message, message_type) {
          var $a, $b, self = this, style = nil;

          if (message_type == null) {
            message_type = "info";
          }
          
          if ($truthy(message['$is_a?'](Opal.const_get_relative($nesting, 'Array')))) {
            } else {
            message = [message]
          };
          if ($truthy(($truthy($a = ($truthy($b = message_type['$==']("info")) ? $b : message_type['$==']("warning"))) ? Opal.const_get_relative($nesting, 'Hyperstack').$env()['$production?']() : $a))) {
            return nil};
          if (message_type['$==']("info")) {
            
            if ($truthy(self['$on_opal_server?']())) {
              style = "background: #00FFFF; color: red"
              } else {
              style = "background: #222; color: #bada55"
            };
            message = $rb_plus([$rb_plus("%c", message['$[]'](0)), style], message['$[]']($range(1, -1, false)));
            return console.log.apply(console, message);
          } else if (message_type['$==']("warning")) {
            return console.warn.apply(console, message)
            } else {
            return console.error.apply(console, message)
          };
        }, TMP_IsomorphicHelpers_log_4.$$arity = -2);
        if ($truthy(Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$!=']("opal"))) {
          nil
          } else {
          
          Opal.defs(self, '$on_opal_server?', TMP_IsomorphicHelpers_on_opal_server$q_5 = function() {
            var self = this;

            return typeof Opal.global.document === 'undefined'
          }, TMP_IsomorphicHelpers_on_opal_server$q_5.$$arity = 0);
          Opal.defs(self, '$on_opal_client?', TMP_IsomorphicHelpers_on_opal_client$q_6 = function() {
            var self = this;

            return self['$on_opal_server?']()['$!']()
          }, TMP_IsomorphicHelpers_on_opal_client$q_6.$$arity = 0);
        };
        
        Opal.defn(self, '$log', TMP_IsomorphicHelpers_log_7 = function $$log($a_rest) {
          var self = this, args;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          return $send(Opal.const_get_relative($nesting, 'IsomorphicHelpers'), 'log', Opal.to_a(args))
        }, TMP_IsomorphicHelpers_log_7.$$arity = -1);
        
        Opal.defn(self, '$on_opal_server?', TMP_IsomorphicHelpers_on_opal_server$q_8 = function() {
          var self = this;

          return self.$class()['$on_opal_server?']()
        }, TMP_IsomorphicHelpers_on_opal_server$q_8.$$arity = 0);
        
        Opal.defn(self, '$on_opal_client?', TMP_IsomorphicHelpers_on_opal_client$q_9 = function() {
          var self = this;

          return self.$class()['$on_opal_client?']()
        }, TMP_IsomorphicHelpers_on_opal_client$q_9.$$arity = 0);
        Opal.defs(self, '$prerender_footers', TMP_IsomorphicHelpers_prerender_footers_11 = function $$prerender_footers(controller) {
          var TMP_10, self = this, footer = nil;

          if (controller == null) {
            controller = nil;
          }
          
          footer = $send(Opal.const_get_relative($nesting, 'Context').$prerender_footer_blocks(), 'collect', [], (TMP_10 = function(block){var self = TMP_10.$$s || this;
if (block == null) block = nil;
          return block.$call(controller)}, TMP_10.$$s = self, TMP_10.$$arity = 1, TMP_10)).$join("\n");
          if ($truthy(Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$!=']("opal"))) {
            nil};
          return footer;
        }, TMP_IsomorphicHelpers_prerender_footers_11.$$arity = -1);
        (function($base, $super, $parent_nesting) {
          function $Context(){};
          var self = $Context = $klass($base, $super, 'Context', $Context);

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Context_define_isomorphic_method_12, TMP_Context_before_first_mount_blocks_13, TMP_Context_prerender_footer_blocks_14, TMP_Context_initialize_16, TMP_Context_load_opal_context_17, TMP_Context_eval_18, TMP_Context_send_to_opal_20, TMP_Context_register_before_first_mount_block_21, TMP_Context_register_prerender_footer_block_22;

          def.unique_id = def.cname = def.ctx = nil;
          
          self.$attr_reader("controller");
          self.$attr_reader("unique_id");
          Opal.defs(self, '$define_isomorphic_method', TMP_Context_define_isomorphic_method_12 = function $$define_isomorphic_method(method_name) {
            var $a, $b, self = this, $iter = TMP_Context_define_isomorphic_method_12.$$p, block = $iter || nil, $writer = nil;

            if ($iter) TMP_Context_define_isomorphic_method_12.$$p = null;
            
            (Opal.class_variable_set($Context, '@@ctx_methods', ($truthy($a = (($b = $Context.$$cvars['@@ctx_methods']) == null ? nil : $b)) ? $a : $hash2([], {}))));
            
            $writer = [method_name, block];
            $send((($a = $Context.$$cvars['@@ctx_methods']) == null ? nil : $a), '[]=', Opal.to_a($writer));
            return $writer[$rb_minus($writer["length"], 1)];;
          }, TMP_Context_define_isomorphic_method_12.$$arity = 1);
          Opal.defs(self, '$before_first_mount_blocks', TMP_Context_before_first_mount_blocks_13 = function $$before_first_mount_blocks() {
            var $a, self = this;
            if (self.before_first_mount_blocks == null) self.before_first_mount_blocks = nil;

            return (self.before_first_mount_blocks = ($truthy($a = self.before_first_mount_blocks) ? $a : []))
          }, TMP_Context_before_first_mount_blocks_13.$$arity = 0);
          Opal.defs(self, '$prerender_footer_blocks', TMP_Context_prerender_footer_blocks_14 = function $$prerender_footer_blocks() {
            var $a, self = this;
            if (self.prerender_footer_blocks == null) self.prerender_footer_blocks = nil;

            return (self.prerender_footer_blocks = ($truthy($a = self.prerender_footer_blocks) ? $a : []))
          }, TMP_Context_prerender_footer_blocks_14.$$arity = 0);
          
          Opal.defn(self, '$initialize', TMP_Context_initialize_16 = function $$initialize(unique_id, ctx, controller, cname) {
            var TMP_15, self = this;

            if (ctx == null) {
              ctx = nil;
            }
            if (controller == null) {
              controller = nil;
            }
            if (cname == null) {
              cname = nil;
            }
            
            self.unique_id = unique_id;
            self.cname = cname;
            if ($truthy(Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$!=']("opal"))) {
              nil};
            Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Application'), 'Boot').$run($hash2(["context"], {"context": self}));
            return $send(self.$class().$before_first_mount_blocks(), 'each', [], (TMP_15 = function(block){var self = TMP_15.$$s || this;
if (block == null) block = nil;
            return block.$call(self)}, TMP_15.$$s = self, TMP_15.$$arity = 1, TMP_15));
          }, TMP_Context_initialize_16.$$arity = -2);
          
          Opal.defn(self, '$load_opal_context', TMP_Context_load_opal_context_17 = function $$load_opal_context() {
            var self = this;

            return self.$send_to_opal("load_context", self.unique_id, self.cname)
          }, TMP_Context_load_opal_context_17.$$arity = 0);
          
          Opal.defn(self, '$eval', TMP_Context_eval_18 = function(js) {
            var self = this;

            if ($truthy(self.ctx)) {
              return self.ctx.$eval(js)
              } else {
              return nil
            }
          }, TMP_Context_eval_18.$$arity = 1);
          
          Opal.defn(self, '$send_to_opal', TMP_Context_send_to_opal_20 = function $$send_to_opal(method_name, $a_rest) {
            var TMP_19, self = this, args, method_args = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 1;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 1] = arguments[$arg_idx];
            }
            
            if ($truthy(self.ctx)) {
              } else {
              return nil
            };
            if (args.$length()['$=='](0)) {
              args = [1]};
            Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'Rails'), 'ComponentLoader').$new(self.ctx)['$load!']();
            method_args = $send(args, 'collect', [], (TMP_19 = function(arg){var self = TMP_19.$$s || this, quarg = nil;
if (arg == null) arg = nil;
            
              quarg = ("" + (arg)).$tr("\"", "'");
              return "" + "\"" + (quarg) + "\"";}, TMP_19.$$s = self, TMP_19.$$arity = 1, TMP_19)).$join(", ");
            return self.ctx.$eval("" + "Opal.Hyperstack.$const_get('Component').$const_get('IsomorphicHelpers').$" + (method_name) + "(" + (method_args) + ")");
          }, TMP_Context_send_to_opal_20.$$arity = -2);
          Opal.defs(self, '$register_before_first_mount_block', TMP_Context_register_before_first_mount_block_21 = function $$register_before_first_mount_block() {
            var self = this, $iter = TMP_Context_register_before_first_mount_block_21.$$p, block = $iter || nil;

            if ($iter) TMP_Context_register_before_first_mount_block_21.$$p = null;
            return self.$before_first_mount_blocks()['$<<'](block)
          }, TMP_Context_register_before_first_mount_block_21.$$arity = 0);
          return Opal.defs(self, '$register_prerender_footer_block', TMP_Context_register_prerender_footer_block_22 = function $$register_prerender_footer_block() {
            var self = this, $iter = TMP_Context_register_prerender_footer_block_22.$$p, block = $iter || nil;

            if ($iter) TMP_Context_register_prerender_footer_block_22.$$p = null;
            return self.$prerender_footer_blocks()['$<<'](block)
          }, TMP_Context_register_prerender_footer_block_22.$$arity = 0);
        })($nesting[0], null, $nesting);
        (function($base, $super, $parent_nesting) {
          function $IsomorphicProcCall(){};
          var self = $IsomorphicProcCall = $klass($base, $super, 'IsomorphicProcCall', $IsomorphicProcCall);

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_IsomorphicProcCall_result_23, TMP_IsomorphicProcCall_initialize_24, TMP_IsomorphicProcCall_when_on_client_25, TMP_IsomorphicProcCall_send_to_server_26, TMP_IsomorphicProcCall_when_on_server_27;

          def.result = def.name = nil;
          
          self.$attr_reader("context");
          
          Opal.defn(self, '$result', TMP_IsomorphicProcCall_result_23 = function $$result() {
            var self = this;

            if ($truthy(self.result)) {
              return self.result.$first()
              } else {
              return nil
            }
          }, TMP_IsomorphicProcCall_result_23.$$arity = 0);
          
          Opal.defn(self, '$initialize', TMP_IsomorphicProcCall_initialize_24 = function $$initialize(name, block, context, $a_rest) {
            var $b, self = this, args;

            var $args_len = arguments.length, $rest_len = $args_len - 3;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 3; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 3] = arguments[$arg_idx];
            }
            
            self.name = name;
            self.context = context;
            $send(block, 'call', [self].concat(Opal.to_a(args)));
            return (self.result = ($truthy($b = self.result) ? $b : $send(self, 'send_to_server', Opal.to_a(args))));
          }, TMP_IsomorphicProcCall_initialize_24.$$arity = -4);
          
          Opal.defn(self, '$when_on_client', TMP_IsomorphicProcCall_when_on_client_25 = function $$when_on_client() {
            var self = this, $iter = TMP_IsomorphicProcCall_when_on_client_25.$$p, block = $iter || nil;

            if ($iter) TMP_IsomorphicProcCall_when_on_client_25.$$p = null;
            if ($truthy(Opal.const_get_relative($nesting, 'IsomorphicHelpers')['$on_opal_client?']())) {
              return (self.result = [block.$call()])
              } else {
              return nil
            }
          }, TMP_IsomorphicProcCall_when_on_client_25.$$arity = 0);
          
          Opal.defn(self, '$send_to_server', TMP_IsomorphicProcCall_send_to_server_26 = function $$send_to_server($a_rest) {
            var self = this, args, method_string = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($truthy(Opal.const_get_relative($nesting, 'IsomorphicHelpers')['$on_opal_server?']())) {
              
              method_string = $rb_plus($rb_plus($rb_plus($rb_plus("ServerSideIsomorphicMethod.", self.name), "("), args.$to_json()), ")");
              return (self.result = [Opal.const_get_relative($nesting, 'JSON').$parse(eval(method_string))]);
              } else {
              return nil
            }
          }, TMP_IsomorphicProcCall_send_to_server_26.$$arity = -1);
          return (Opal.defn(self, '$when_on_server', TMP_IsomorphicProcCall_when_on_server_27 = function $$when_on_server() {
            var $a, self = this, $iter = TMP_IsomorphicProcCall_when_on_server_27.$$p, block = $iter || nil;

            if ($iter) TMP_IsomorphicProcCall_when_on_server_27.$$p = null;
            if ($truthy(($truthy($a = Opal.const_get_relative($nesting, 'IsomorphicHelpers')['$on_opal_client?']()) ? $a : Opal.const_get_relative($nesting, 'IsomorphicHelpers')['$on_opal_server?']()))) {
              return nil
              } else {
              return (self.result = [block.$call().$to_json()])
            }
          }, TMP_IsomorphicProcCall_when_on_server_27.$$arity = 0), nil) && 'when_on_server';
        })($nesting[0], null, $nesting);
        (function($base, $parent_nesting) {
          var $ClassMethods, self = $ClassMethods = $module($base, 'ClassMethods');

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ClassMethods_on_opal_server$q_28, TMP_ClassMethods_on_opal_client$q_29, TMP_ClassMethods_log_30, TMP_ClassMethods_controller_31, TMP_ClassMethods_before_first_mount_32, TMP_ClassMethods_prerender_footer_33, TMP_ClassMethods_isomorphic_method_34;

          
          
          Opal.defn(self, '$on_opal_server?', TMP_ClassMethods_on_opal_server$q_28 = function() {
            var self = this;

            return Opal.const_get_relative($nesting, 'IsomorphicHelpers')['$on_opal_server?']()
          }, TMP_ClassMethods_on_opal_server$q_28.$$arity = 0);
          
          Opal.defn(self, '$on_opal_client?', TMP_ClassMethods_on_opal_client$q_29 = function() {
            var self = this;

            return Opal.const_get_relative($nesting, 'IsomorphicHelpers')['$on_opal_client?']()
          }, TMP_ClassMethods_on_opal_client$q_29.$$arity = 0);
          
          Opal.defn(self, '$log', TMP_ClassMethods_log_30 = function $$log($a_rest) {
            var self = this, args;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            return $send(Opal.const_get_relative($nesting, 'IsomorphicHelpers'), 'log', Opal.to_a(args))
          }, TMP_ClassMethods_log_30.$$arity = -1);
          
          Opal.defn(self, '$controller', TMP_ClassMethods_controller_31 = function $$controller() {
            var self = this;

            return Opal.const_get_relative($nesting, 'IsomorphicHelpers').$context().$controller()
          }, TMP_ClassMethods_controller_31.$$arity = 0);
          
          Opal.defn(self, '$before_first_mount', TMP_ClassMethods_before_first_mount_32 = function $$before_first_mount() {
            var self = this, $iter = TMP_ClassMethods_before_first_mount_32.$$p, block = $iter || nil;

            if ($iter) TMP_ClassMethods_before_first_mount_32.$$p = null;
            return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'IsomorphicHelpers'), 'Context'), 'register_before_first_mount_block', [], block.$to_proc())
          }, TMP_ClassMethods_before_first_mount_32.$$arity = 0);
          
          Opal.defn(self, '$prerender_footer', TMP_ClassMethods_prerender_footer_33 = function $$prerender_footer() {
            var self = this, $iter = TMP_ClassMethods_prerender_footer_33.$$p, block = $iter || nil;

            if ($iter) TMP_ClassMethods_prerender_footer_33.$$p = null;
            return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'IsomorphicHelpers'), 'Context'), 'register_prerender_footer_block', [], block.$to_proc())
          }, TMP_ClassMethods_prerender_footer_33.$$arity = 0);
          if ($truthy(Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$!=']("opal"))) {
            nil
            } else {
            
            self.$require("json");
            
            Opal.defn(self, '$isomorphic_method', TMP_ClassMethods_isomorphic_method_34 = function $$isomorphic_method(name) {
              var TMP_35, self = this, $iter = TMP_ClassMethods_isomorphic_method_34.$$p, block = $iter || nil;

              if ($iter) TMP_ClassMethods_isomorphic_method_34.$$p = null;
              return $send(self.$class(), 'send', ["define_method", name], (TMP_35 = function($a_rest){var self = TMP_35.$$s || this, args;

                var $args_len = arguments.length, $rest_len = $args_len - 0;
                if ($rest_len < 0) { $rest_len = 0; }
                args = new Array($rest_len);
                for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                  args[$arg_idx - 0] = arguments[$arg_idx];
                }
              return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'IsomorphicHelpers'), 'IsomorphicProcCall'), 'new', [name, block, self].concat(Opal.to_a(args))).$result()}, TMP_35.$$s = self, TMP_35.$$arity = -1, TMP_35))
            }, TMP_ClassMethods_isomorphic_method_34.$$arity = 1);
          };
        })($nesting[0], $nesting);
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/component/react_api"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send, $truthy = Opal.truthy;

  Opal.add_stubs(['$require', '$+', '$create_element', '$to_proc', '$raise', '$to_n', '$kind_of?', '$!', '$build']);
  
  self.$require("native");
  self.$require("active_support/core_ext/object/try");
  self.$require("hyperstack/internal/component/tags");
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Component, self = $Component = $module($base, 'Component');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $ReactAPI, self = $ReactAPI = $module($base, 'ReactAPI');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ReactAPI_html_tag$q_1, TMP_ReactAPI_html_attr$q_2, TMP_ReactAPI_create_element_3, TMP_ReactAPI_render_4, TMP_ReactAPI_is_valid_element_5, TMP_ReactAPI_is_valid_element$q_6, TMP_ReactAPI_render_to_string_8, TMP_ReactAPI_render_to_static_markup_10, TMP_ReactAPI_unmount_component_at_node_11;

        
        Opal.const_set($nesting[0], 'ATTRIBUTES', $rb_plus(["accept", "acceptCharset", "accessKey", "action", "allowFullScreen", "allowTransparency", "alt", "async", "autoComplete", "autoPlay", "cellPadding", "cellSpacing", "charSet", "checked", "classID", "className", "cols", "colSpan", "content", "contentEditable", "contextMenu", "controls", "coords", "crossOrigin", "data", "dateTime", "defer", "dir", "disabled", "download", "draggable", "encType", "form", "formAction", "formEncType", "formMethod", "formNoValidate", "formTarget", "frameBorder", "height", "hidden", "href", "hrefLang", "htmlFor", "httpEquiv", "icon", "id", "label", "lang", "list", "loop", "manifest", "marginHeight", "marginWidth", "max", "maxLength", "media", "mediaGroup", "method", "min", "multiple", "muted", "name", "noValidate", "open", "pattern", "placeholder", "poster", "preload", "radioGroup", "readOnly", "rel", "required", "role", "rows", "rowSpan", "sandbox", "scope", "scrolling", "seamless", "selected", "shape", "size", "sizes", "span", "spellCheck", "src", "srcDoc", "srcSet", "start", "step", "style", "tabIndex", "target", "title", "type", "useMap", "value", "width", "wmode", "dangerouslySetInnerHTML"], ["clipPath", "cx", "cy", "d", "dx", "dy", "fill", "fillOpacity", "fontFamily", "fontSize", "fx", "fy", "gradientTransform", "gradientUnits", "markerEnd", "markerMid", "markerStart", "offset", "opacity", "patternContentUnits", "patternUnits", "points", "preserveAspectRatio", "r", "rx", "ry", "spreadMethod", "stopColor", "stopOpacity", "stroke", "strokeDasharray", "strokeLinecap", "strokeOpacity", "strokeWidth", "textAnchor", "transform", "version", "viewBox", "x1", "x2", "x", "xlinkActuate", "xlinkArcrole", "xlinkHref", "xlinkRole", "xlinkShow", "xlinkTitle", "xlinkType", "xmlBase", "xmlLang", "xmlSpace", "y1", "y2", "y"]));
        Opal.const_set($nesting[0], 'HASH_ATTRIBUTES', ["data", "aria"]);
        Opal.const_set($nesting[0], 'HTML_TAGS', Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'Tags'), 'HTML_TAGS'));
        Opal.defs(self, '$html_tag?', TMP_ReactAPI_html_tag$q_1 = function(name) {
          var self = this, tags = nil;

          
          tags = Opal.const_get_relative($nesting, 'HTML_TAGS');
          
          for(var i = 0; i < tags.length; i++) {
            if(tags[i] === name)
              return true;
          }
          return false;
        ;
        }, TMP_ReactAPI_html_tag$q_1.$$arity = 1);
        Opal.defs(self, '$html_attr?', TMP_ReactAPI_html_attr$q_2 = function(name) {
          var self = this, attrs = nil;

          
          attrs = Opal.const_get_relative($nesting, 'ATTRIBUTES');
          
          for(var i = 0; i < attrs.length; i++) {
            if(attrs[i] === name)
              return true;
          }
          return false;
        ;
        }, TMP_ReactAPI_html_attr$q_2.$$arity = 1);
        Opal.defs(self, '$create_element', TMP_ReactAPI_create_element_3 = function $$create_element(type, $a_rest) {
          var self = this, properties, $iter = TMP_ReactAPI_create_element_3.$$p, block = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 1;
          if ($rest_len < 0) { $rest_len = 0; }
          properties = new Array($rest_len);
          for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
            properties[$arg_idx - 1] = arguments[$arg_idx];
          }
          if ($iter) TMP_ReactAPI_create_element_3.$$p = null;
          return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'ReactWrapper'), 'create_element', [type].concat(Opal.to_a(properties)), block.$to_proc())
        }, TMP_ReactAPI_create_element_3.$$arity = -2);
        Opal.defs(self, '$render', TMP_ReactAPI_render_4 = function $$render(element, container) {
          var self = this, $iter = TMP_ReactAPI_render_4.$$p, $yield = $iter || nil, cb = nil, native$ = nil;

          if ($iter) TMP_ReactAPI_render_4.$$p = null;
          
          if ($truthy(typeof ReactDOM === 'undefined')) {
            self.$raise("ReactDOM.render is not defined.  In React >= v15 you must import it with ReactDOM")};
          container = container.$$class ? container[0] : container;
          if (($yield !== nil)) {
            
            cb = 
            function(){
              setTimeout(function(){
                Opal.yieldX($yield, [])
              }, 0)
            }
          ;
            native$ = ReactDOM.render(element.$to_n(), container, cb);
            } else {
            native$ = ReactDOM.render(element.$to_n(), container)
          };
          if ($truthy(native$ !== null)) {
            } else {
            return nil
          };
          if ($truthy(native$.__opalInstance !== undefined && native$.__opalInstance !== null)) {
            return native$.__opalInstance
          } else if ($truthy(ReactDOM.findDOMNode !== undefined && native$.nodeType === undefined)) {
            return ReactDOM.findDOMNode(native$)
            } else {
            return native$
          };
        }, TMP_ReactAPI_render_4.$$arity = 2);
        Opal.defs(self, '$is_valid_element', TMP_ReactAPI_is_valid_element_5 = function $$is_valid_element(element) {
          var $a, self = this;

          
           console.error("Warning: `is_valid_element` is deprecated in favor of `is_valid_element?`."); ;
          return ($truthy($a = element['$kind_of?'](Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Element'))) ? React.isValidElement(element.$to_n()) : $a);
        }, TMP_ReactAPI_is_valid_element_5.$$arity = 1);
        Opal.defs(self, '$is_valid_element?', TMP_ReactAPI_is_valid_element$q_6 = function(element) {
          var $a, self = this;

          return ($truthy($a = element['$kind_of?'](Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'Element'))) ? React.isValidElement(element.$to_n()) : $a)
        }, TMP_ReactAPI_is_valid_element$q_6.$$arity = 1);
        Opal.defs(self, '$render_to_string', TMP_ReactAPI_render_to_string_8 = function $$render_to_string(element) {
          var TMP_7, self = this;

          
           console.error("Warning: `Hyperstack::Component::ReactAPI.render_to_string` is deprecated in favor of `React::Server.render_to_string`."); ;
          if ($truthy((typeof ReactDOMServer === 'undefined')['$!']())) {
            return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext'), 'build', [], (TMP_7 = function(){var self = TMP_7.$$s || this;

            return ReactDOMServer.renderToString(element.$to_n())}, TMP_7.$$s = self, TMP_7.$$arity = 0, TMP_7))
            } else {
            return self.$raise("renderToString is not defined.  In React >= v15 you must import it with ReactDOMServer")
          };
        }, TMP_ReactAPI_render_to_string_8.$$arity = 1);
        Opal.defs(self, '$render_to_static_markup', TMP_ReactAPI_render_to_static_markup_10 = function $$render_to_static_markup(element) {
          var TMP_9, self = this;

          
           console.error("Warning: `Hyperstack::Component::ReactAPI.render_to_static_markup` is deprecated in favor of `React::Server.render_to_static_markup`."); ;
          if ($truthy((typeof ReactDOMServer === 'undefined')['$!']())) {
            return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext'), 'build', [], (TMP_9 = function(){var self = TMP_9.$$s || this;

            return ReactDOMServer.renderToStaticMarkup(element.$to_n())}, TMP_9.$$s = self, TMP_9.$$arity = 0, TMP_9))
            } else {
            return self.$raise("renderToStaticMarkup is not defined.  In React >= v15 you must import it with ReactDOMServer")
          };
        }, TMP_ReactAPI_render_to_static_markup_10.$$arity = 1);
        Opal.defs(self, '$unmount_component_at_node', TMP_ReactAPI_unmount_component_at_node_11 = function $$unmount_component_at_node(node) {
          var self = this;

          if ($truthy((typeof ReactDOM === 'undefined')['$!']())) {
            return ReactDOM.unmountComponentAtNode(node.$$class ? node[0] : node)
            } else {
            return self.$raise("unmountComponentAtNode is not defined.  In React >= v15 you must import it with ReactDOM")
          }
        }, TMP_ReactAPI_unmount_component_at_node_11.$$arity = 1);
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/component/top_level_rails_component"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$include', '$export_component', '$param', '$backtrace', '$top_level_render', '$start_with?', '$<<', '$const_get', '$each', '$search_path', '$class', '$name', '$!=', '$method_defined?', '$render', '$raise', '$join', '$search_path=', '$-', '$!', '$include?', '$add_to_react_search_path']);
  
  (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Component, self = $Component = $module($base, 'Component');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $super, $parent_nesting) {
          function $TopLevelRailsComponent(){};
          var self = $TopLevelRailsComponent = $klass($base, $super, 'TopLevelRailsComponent', $TopLevelRailsComponent);

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_TopLevelRailsComponent_search_path_1, TMP_TopLevelRailsComponent_allow_deprecated_render_definition$q_2, TMP_TopLevelRailsComponent_render_3, TMP_TopLevelRailsComponent_top_level_render_6;

          def.ComponentName = def.RenderParams = def.Controller = nil;
          
          self.$include(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'));
          Opal.defs(self, '$search_path', TMP_TopLevelRailsComponent_search_path_1 = function $$search_path() {
            var $a, self = this;
            if (self.search_path == null) self.search_path = nil;

            return (self.search_path = ($truthy($a = self.search_path) ? $a : [Opal.const_get_relative($nesting, 'Object')]))
          }, TMP_TopLevelRailsComponent_search_path_1.$$arity = 0);
          self.$export_component();
          self.$param("component_name");
          self.$param("controller");
          self.$param("render_params");
          self.$backtrace("off");
          Opal.defs(self, '$allow_deprecated_render_definition?', TMP_TopLevelRailsComponent_allow_deprecated_render_definition$q_2 = function() {
            var self = this;

            return true
          }, TMP_TopLevelRailsComponent_allow_deprecated_render_definition$q_2.$$arity = 0);
          
          Opal.defn(self, '$render', TMP_TopLevelRailsComponent_render_3 = function $$render() {
            var self = this;

            return self.$top_level_render()
          }, TMP_TopLevelRailsComponent_render_3.$$arity = 0);
          return (Opal.defn(self, '$top_level_render', TMP_TopLevelRailsComponent_top_level_render_6 = function $$top_level_render() {
            var TMP_4, TMP_5, $a, self = this, paths_searched = nil, component = nil;

            
            paths_searched = [];
            component = nil;
            if ($truthy(self.ComponentName['$start_with?']("::"))) {
              
              paths_searched['$<<'](self.ComponentName);
              component = (function() { try {
                return Opal.const_get_relative($nesting, 'Object').$const_get(self.ComponentName)
              } catch ($err) {
                if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'NameError')])) {
                  try {
                    return nil
                  } finally { Opal.pop_exception() }
                } else { throw $err; }
              }})();
              } else {
              
              (function(){var $brk = Opal.new_brk(); try {return $send(self.$class().$search_path(), 'each', [], (TMP_4 = function(scope){var self = TMP_4.$$s || this;
                if (self.Controller == null) self.Controller = nil;
                if (self.ComponentName == null) self.ComponentName = nil;
if (scope == null) scope = nil;
              
                paths_searched['$<<']("" + (scope.$name()) + "::" + (self.Controller) + "::" + (self.ComponentName));
                component = (function() { try {
                  return scope.$const_get(self.Controller, false).$const_get(self.ComponentName, false)
                } catch ($err) {
                  if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'NameError')])) {
                    try {
                      return nil
                    } finally { Opal.pop_exception() }
                  } else { throw $err; }
                }})();
                if ($truthy(component['$!='](nil))) {
                  
                  Opal.brk(nil, $brk)
                  } else {
                  return nil
                };}, TMP_4.$$s = self, TMP_4.$$brk = $brk, TMP_4.$$arity = 1, TMP_4))
              } catch (err) { if (err === $brk) { return err.$v } else { throw err } }})();
              if ($truthy(component)) {
                } else {
                (function(){var $brk = Opal.new_brk(); try {return $send(self.$class().$search_path(), 'each', [], (TMP_5 = function(scope){var self = TMP_5.$$s || this;
                  if (self.ComponentName == null) self.ComponentName = nil;
if (scope == null) scope = nil;
                
                  paths_searched['$<<']("" + (scope.$name()) + "::" + (self.ComponentName));
                  component = (function() { try {
                    return scope.$const_get(self.ComponentName, false)
                  } catch ($err) {
                    if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'NameError')])) {
                      try {
                        return nil
                      } finally { Opal.pop_exception() }
                    } else { throw $err; }
                  }})();
                  if ($truthy(component['$!='](nil))) {
                    
                    Opal.brk(nil, $brk)
                    } else {
                    return nil
                  };}, TMP_5.$$s = self, TMP_5.$$brk = $brk, TMP_5.$$arity = 1, TMP_5))
                } catch (err) { if (err === $brk) { return err.$v } else { throw err } }})()
              };
            };
            if ($truthy(($truthy($a = component) ? component['$method_defined?']("render") : $a))) {
              return Opal.const_get_relative($nesting, 'RenderingContext').$render(component, self.RenderParams)};
            return self.$raise("" + "Could not find component class '" + (self.ComponentName) + "' for @Controller '" + (self.Controller) + "' in any component directory. Tried [" + (paths_searched.$join(", ")) + "]");
          }, TMP_TopLevelRailsComponent_top_level_render_6.$$arity = 0), nil) && 'top_level_render';
        })($nesting[0], null, $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting);
  (function($base, $super, $parent_nesting) {
    function $Module(){};
    var self = $Module = $klass($base, $super, 'Module', $Module);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Module_add_to_react_search_path_7;

    return (Opal.defn(self, '$add_to_react_search_path', TMP_Module_add_to_react_search_path_7 = function $$add_to_react_search_path(replace_search_path) {
      var self = this, $writer = nil;

      if (replace_search_path == null) {
        replace_search_path = nil;
      }
      if ($truthy(replace_search_path)) {
        
        $writer = [[self]];
        $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'TopLevelRailsComponent'), 'search_path=', Opal.to_a($writer));
        return $writer[$rb_minus($writer["length"], 1)];
      } else if ($truthy(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'TopLevelRailsComponent').$search_path()['$include?'](self)['$!']())) {
        return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'TopLevelRailsComponent').$search_path()['$<<'](self)
        } else {
        return nil
      }
    }, TMP_Module_add_to_react_search_path_7.$$arity = -1), nil) && 'add_to_react_search_path'
  })($nesting[0], null, $nesting);
  return (function($base, $parent_nesting) {
    var $Components, self = $Components = $module($base, 'Components');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    self.$add_to_react_search_path()
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/component/while_loading"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$WhileLoadingWrapper', '$!', '$on_opal_client?']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Component, self = $Component = $module($base, 'Component');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $WhileLoading, self = $WhileLoading = $module($base, 'WhileLoading');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_WhileLoading___hyperstack_component_rescue_wrapper_1, TMP_WhileLoading_resources_loading$q_2, TMP_WhileLoading_resources_loaded$q_3;

        
        
        Opal.defn(self, '$__hyperstack_component_rescue_wrapper', TMP_WhileLoading___hyperstack_component_rescue_wrapper_1 = function $$__hyperstack_component_rescue_wrapper(child) {
          var self = this;

          return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component').$WhileLoadingWrapper($hash2(["child", "children_elements"], {"child": self, "children_elements": child}))
        }, TMP_WhileLoading___hyperstack_component_rescue_wrapper_1.$$arity = 1);
        
        Opal.defn(self, '$resources_loading?', TMP_WhileLoading_resources_loading$q_2 = function() {
          var self = this;
          if (self.__hyperstack_while_loading_waiting_on_resources == null) self.__hyperstack_while_loading_waiting_on_resources = nil;

          return self.__hyperstack_while_loading_waiting_on_resources
        }, TMP_WhileLoading_resources_loading$q_2.$$arity = 0);
        
        Opal.defn(self, '$resources_loaded?', TMP_WhileLoading_resources_loaded$q_3 = function() {
          var self = this;
          if (self.__hyperstack_while_loading_waiting_on_resources == null) self.__hyperstack_while_loading_waiting_on_resources = nil;

          return self.__hyperstack_while_loading_waiting_on_resources['$!']()
        }, TMP_WhileLoading_resources_loaded$q_3.$$arity = 0);
        if ($truthy(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'IsomorphicHelpers')['$on_opal_client?']())) {
          
          function onError(event) {
            if (event.message.startsWith('Uncaught NotQuiet: ')) event.preventDefault();
          }

          window.addEventListener('error', onError);
         };
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/component/rescue_wrapper"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$include', '$param', '$render', '$call', '$attr_accessor', '$RescueMetaWrapper', '$after_error', '$after_error_args', '$run_callback', '$after_error_args=', '$-', '$raise', '$force_update!']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Component, self = $Component = $module($base, 'Component');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        
        (function($base, $super, $parent_nesting) {
          function $RescueMetaWrapper(){};
          var self = $RescueMetaWrapper = $klass($base, $super, 'RescueMetaWrapper', $RescueMetaWrapper);

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_RescueMetaWrapper_1;

          
          self.$include(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'));
          self.$param("children_elements");
          return $send(self, 'render', [], (TMP_RescueMetaWrapper_1 = function(){var self = TMP_RescueMetaWrapper_1.$$s || this;
            if (self.ChildrenElements == null) self.ChildrenElements = nil;

          return self.ChildrenElements.$call()}, TMP_RescueMetaWrapper_1.$$s = self, TMP_RescueMetaWrapper_1.$$arity = 0, TMP_RescueMetaWrapper_1));
        })($nesting[0], null, $nesting);
        (function($base, $super, $parent_nesting) {
          function $RescueWrapper(){};
          var self = $RescueWrapper = $klass($base, $super, 'RescueWrapper', $RescueWrapper);

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_RescueWrapper_2, TMP_RescueWrapper_3;

          
          (function(self, $parent_nesting) {
            var def = self.$$proto, $nesting = [self].concat($parent_nesting);

            return self.$attr_accessor("after_error_args")
          })(Opal.get_singleton_class(self), $nesting);
          self.$include(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'));
          self.$param("child");
          self.$param("children_elements");
          $send(self, 'render', [], (TMP_RescueWrapper_2 = function(){var self = TMP_RescueWrapper_2.$$s || this;
            if (self.ChildrenElements == null) self.ChildrenElements = nil;

          return self.$RescueMetaWrapper($hash2(["children_elements"], {"children_elements": self.ChildrenElements}))}, TMP_RescueWrapper_2.$$s = self, TMP_RescueWrapper_2.$$arity = 0, TMP_RescueWrapper_2));
          return $send(self, 'after_error', [], (TMP_RescueWrapper_3 = function(error, info){var self = TMP_RescueWrapper_3.$$s || this, $a, $b, TMP_4, args = nil, found = nil, $writer = nil;
            if (self.Child == null) self.Child = nil;
if (error == null) error = nil;if (info == null) info = nil;
          
            args = ($truthy($a = Opal.const_get_relative($nesting, 'RescueWrapper').$after_error_args()) ? $a : [error, info]);
            $b = $send(self.Child, 'run_callback', ["__hyperstack_component_rescue_hook", found].concat(Opal.to_a(args)), (TMP_4 = function(a){var self = TMP_4.$$s || this;
if (a == null) a = nil;
            return a}, TMP_4.$$s = self, TMP_4.$$arity = 1, TMP_4)), $a = Opal.to_ary($b), (found = ($a[0] == null ? nil : $a[0])), $b;
            if ($truthy(found)) {
              } else {
              
              
              $writer = [args];
              $send(Opal.const_get_relative($nesting, 'RescueWrapper'), 'after_error_args=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;
              self.$raise(error);
            };
            return self.Child['$force_update!']();}, TMP_RescueWrapper_3.$$s = self, TMP_RescueWrapper_3.$$arity = 2, TMP_RescueWrapper_3));
        })($nesting[0], null, $nesting);
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/component/while_loading_wrapper"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $truthy = Opal.truthy, $hash2 = Opal.hash2;

  Opal.add_stubs(['$render', '$!', '$quiet?', '$raise_if_not_quiet=', '$-', '$instance_eval', '$mutate', '$RescueMetaWrapper', '$before_mount', '$rescues', '$class', '$instance_variable_set']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Component, self = $Component = $module($base, 'Component');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $super, $parent_nesting) {
          function $WhileLoadingWrapper(){};
          var self = $WhileLoadingWrapper = $klass($base, $super, 'WhileLoadingWrapper', $WhileLoadingWrapper);

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_WhileLoadingWrapper_1, TMP_WhileLoadingWrapper_3;

          
          $send(self, 'render', [], (TMP_WhileLoadingWrapper_1 = function(){var self = TMP_WhileLoadingWrapper_1.$$s || this, $a, TMP_2, $writer = nil;
            if (self.waiting_on_resources == null) self.waiting_on_resources = nil;
            if (self.Child == null) self.Child = nil;
            if (self.ChildrenElements == null) self.ChildrenElements = nil;

          
            if ($truthy(($truthy($a = self.waiting_on_resources) ? self['$quiet?']()['$!']() : $a))) {
              
              $writer = [false];
              $send(Opal.const_get_relative($nesting, 'RenderingContext'), 'raise_if_not_quiet=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];
              } else {
              
              self.waiting_on_resources = false;
              $send(self.Child, 'instance_eval', [], (TMP_2 = function(){var self = TMP_2.$$s || this;
                if (self.__hyperstack_while_loading_waiting_on_resources == null) self.__hyperstack_while_loading_waiting_on_resources = nil;

              
                if ($truthy(self.__hyperstack_while_loading_waiting_on_resources)) {
                  self.$mutate()};
                return (self.__hyperstack_while_loading_waiting_on_resources = false);}, TMP_2.$$s = self, TMP_2.$$arity = 0, TMP_2));
              
              $writer = [true];
              $send(Opal.const_get_relative($nesting, 'RenderingContext'), 'raise_if_not_quiet=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;
            };
            return self.$RescueMetaWrapper($hash2(["children_elements"], {"children_elements": self.ChildrenElements}));}, TMP_WhileLoadingWrapper_1.$$s = self, TMP_WhileLoadingWrapper_1.$$arity = 0, TMP_WhileLoadingWrapper_1));
          return $send(self, 'before_mount', [], (TMP_WhileLoadingWrapper_3 = function(){var self = TMP_WhileLoadingWrapper_3.$$s || this, TMP_4, wrapper = nil;
            if (self.Child == null) self.Child = nil;

          
            wrapper = self;
            return $send(self.Child.$class(), 'rescues', [Opal.const_get_qualified(Opal.const_get_relative($nesting, 'RenderingContext'), 'NotQuiet')], (TMP_4 = function(){var self = TMP_4.$$s || this;

            
              wrapper.$instance_variable_set("@waiting_on_resources", true);
              return (self.__hyperstack_while_loading_waiting_on_resources = true);}, TMP_4.$$s = self, TMP_4.$$arity = 0, TMP_4));}, TMP_WhileLoadingWrapper_3.$$s = self, TMP_WhileLoadingWrapper_3.$$arity = 0, TMP_WhileLoadingWrapper_3));
        })($nesting[0], Opal.const_get_relative($nesting, 'RescueWrapper'), $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/component/version"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module;

  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Component, self = $Component = $module($base, 'Component');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      Opal.const_set($nesting[0], 'VERSION', "1.0.alpha1.4")
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-component"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $hash2 = Opal.hash2;

  Opal.add_stubs(['$require', '$import', '$js_import', '$==']);
  
  self.$require("hyperstack/internal/component");
  Opal.const_get_relative($nesting, 'Hyperstack').$import("hyper-state");
  Opal.const_get_relative($nesting, 'Hyperstack').$js_import("react/react-source-browser", $hash2(["client_only", "defines"], {"client_only": true, "defines": ["ReactDOM", "React"]}));
  Opal.const_get_relative($nesting, 'Hyperstack').$js_import("react/react-source-server", $hash2(["server_only", "defines"], {"server_only": true, "defines": "React"}));
  Opal.const_get_relative($nesting, 'Hyperstack').$import("browser/delay", $hash2(["client_only"], {"client_only": true}));
  Opal.const_get_relative($nesting, 'Hyperstack').$js_import("react_ujs", $hash2(["defines"], {"defines": "ReactRailsUJS"}));
  Opal.const_get_relative($nesting, 'Hyperstack').$import("hyper-component");
  Opal.const_get_relative($nesting, 'Hyperstack').$import("hyperstack/component/auto-import");
  if (Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$==']("opal")) {
    
    self.$require("hyperstack/internal/callbacks");
    self.$require("hyperstack/internal/auto_unmount");
    self.$require("native");
    self.$require("hyperstack/state/observer");
    self.$require("hyperstack/internal/component/validator");
    self.$require("hyperstack/component/element");
    self.$require("hyperstack/internal/component/react_wrapper");
    self.$require("hyperstack/component");
    self.$require("hyperstack/internal/component/should_component_update");
    self.$require("hyperstack/internal/component/tags");
    self.$require("hyperstack/component/event");
    self.$require("hyperstack/internal/component/rendering_context");
    self.$require("hyperstack/ext/component/object");
    self.$require("hyperstack/ext/component/number");
    self.$require("hyperstack/ext/component/boolean");
    self.$require("hyperstack/component/isomorphic_helpers");
    self.$require("hyperstack/component/react_api");
    self.$require("hyperstack/internal/component/top_level_rails_component");
    self.$require("hyperstack/component/while_loading");
    self.$require("hyperstack/internal/component/rescue_wrapper");
    self.$require("hyperstack/internal/component/while_loading_wrapper");
    return self.$require("hyperstack/component/version");
    } else {
    return nil
  };
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/version"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass;

  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Operation(){};
      var self = $Operation = $klass($base, $super, 'Operation', $Operation);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return Opal.const_set($nesting[0], 'VERSION', "1.0.alpha1.4")
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["date"] = function(Opal) {
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  function $rb_times(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs * rhs : lhs['$*'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $send = Opal.send, $truthy = Opal.truthy;

  Opal.add_stubs(['$include', '$<=>', '$nonzero?', '$d', '$zero?', '$new', '$class', '$-@', '$+@', '$===', '$coerce', '$==', '$>', '$+', '$allocate', '$join', '$compact', '$map', '$to_proc', '$downcase', '$wrap', '$raise', '$clone', '$jd', '$>>', '$wday', '$-', '$to_s', '$alias_method', '$to_i', '$<', '$*', '$reverse', '$step', '$abs', '$each']);
  return (function($base, $super, $parent_nesting) {
    function $Date(){};
    var self = $Date = $klass($base, $super, 'Date', $Date);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Date_initialize_17, TMP_Date_$_18, TMP_Date_$_19, TMP_Date_$lt_20, TMP_Date_$lt$eq_21, TMP_Date_$gt_22, TMP_Date_$gt$eq_23, TMP_Date_$lt$eq$gt_24, TMP_Date_$gt$gt_25, TMP_Date_$lt$lt_26, TMP_Date_clone_27, TMP_Date_day_28, TMP_Date_friday$q_29, TMP_Date_jd_30, TMP_Date_julian$q_31, TMP_Date_monday$q_32, TMP_Date_month_33, TMP_Date_next_34, TMP_Date_next_day_35, TMP_Date_next_month_36, TMP_Date_prev_day_37, TMP_Date_prev_month_38, TMP_Date_saturday$q_39, TMP_Date_strftime_40, TMP_Date_sunday$q_41, TMP_Date_thursday$q_42, TMP_Date_to_s_43, TMP_Date_tuesday$q_44, TMP_Date_step_45, TMP_Date_upto_49, TMP_Date_downto_50, TMP_Date_wday_51, TMP_Date_wednesday$q_52, TMP_Date_year_53, TMP_Date_cwday_54, TMP_Date_cweek_55;

    def.date = nil;
    
    self.$include(Opal.const_get_relative($nesting, 'Comparable'));
    (function($base, $super, $parent_nesting) {
      function $Infinity(){};
      var self = $Infinity = $klass($base, $super, 'Infinity', $Infinity);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Infinity_initialize_1, TMP_Infinity_d_2, TMP_Infinity_zero$q_3, TMP_Infinity_finite$q_4, TMP_Infinity_infinite$q_5, TMP_Infinity_nan$q_6, TMP_Infinity_abs_7, TMP_Infinity_$$_8, TMP_Infinity_$$_9, TMP_Infinity_$lt$eq$gt_10, TMP_Infinity_coerce_11, TMP_Infinity_to_f_12;

      def.d = nil;
      
      self.$include(Opal.const_get_relative($nesting, 'Comparable'));
      
      Opal.defn(self, '$initialize', TMP_Infinity_initialize_1 = function $$initialize(d) {
        var self = this;

        if (d == null) {
          d = 1;
        }
        return (self.d = d['$<=>'](0))
      }, TMP_Infinity_initialize_1.$$arity = -1);
      
      Opal.defn(self, '$d', TMP_Infinity_d_2 = function $$d() {
        var self = this;

        return self.d
      }, TMP_Infinity_d_2.$$arity = 0);
      
      Opal.defn(self, '$zero?', TMP_Infinity_zero$q_3 = function() {
        var self = this;

        return false
      }, TMP_Infinity_zero$q_3.$$arity = 0);
      
      Opal.defn(self, '$finite?', TMP_Infinity_finite$q_4 = function() {
        var self = this;

        return false
      }, TMP_Infinity_finite$q_4.$$arity = 0);
      
      Opal.defn(self, '$infinite?', TMP_Infinity_infinite$q_5 = function() {
        var self = this;

        return self.$d()['$nonzero?']()
      }, TMP_Infinity_infinite$q_5.$$arity = 0);
      
      Opal.defn(self, '$nan?', TMP_Infinity_nan$q_6 = function() {
        var self = this;

        return self.$d()['$zero?']()
      }, TMP_Infinity_nan$q_6.$$arity = 0);
      
      Opal.defn(self, '$abs', TMP_Infinity_abs_7 = function $$abs() {
        var self = this;

        return self.$class().$new()
      }, TMP_Infinity_abs_7.$$arity = 0);
      
      Opal.defn(self, '$-@', TMP_Infinity_$$_8 = function() {
        var self = this;

        return self.$class().$new(self.$d()['$-@']())
      }, TMP_Infinity_$$_8.$$arity = 0);
      
      Opal.defn(self, '$+@', TMP_Infinity_$$_9 = function() {
        var self = this;

        return self.$class().$new(self.$d()['$+@']())
      }, TMP_Infinity_$$_9.$$arity = 0);
      
      Opal.defn(self, '$<=>', TMP_Infinity_$lt$eq$gt_10 = function(other) {
        var $a, $b, self = this, $case = nil, l = nil, r = nil;

        
        $case = other;
        if (Opal.const_get_relative($nesting, 'Infinity')['$===']($case)) {return self.$d()['$<=>'](other.$d())}
        else if (Opal.const_get_relative($nesting, 'Numeric')['$===']($case)) {return self.$d()}
        else {
        try {
          
          $b = other.$coerce(self), $a = Opal.to_ary($b), (l = ($a[0] == null ? nil : $a[0])), (r = ($a[1] == null ? nil : $a[1])), $b;
          return l['$<=>'](r);
        } catch ($err) {
          if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'NoMethodError')])) {
            try {
              nil
            } finally { Opal.pop_exception() }
          } else { throw $err; }
        };};
        return nil;
      }, TMP_Infinity_$lt$eq$gt_10.$$arity = 1);
      
      Opal.defn(self, '$coerce', TMP_Infinity_coerce_11 = function $$coerce(other) {
        var self = this, $iter = TMP_Infinity_coerce_11.$$p, $yield = $iter || nil, $case = nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

        if ($iter) TMP_Infinity_coerce_11.$$p = null;
        // Prepare super implicit arguments
        for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
          $zuper[$zuper_i] = arguments[$zuper_i];
        }
        return (function() {$case = other;
        if (Opal.const_get_relative($nesting, 'Numeric')['$===']($case)) {return [self.$d()['$-@'](), self.$d()]}
        else {return $send(self, Opal.find_super_dispatcher(self, 'coerce', TMP_Infinity_coerce_11, false), $zuper, $iter)}})()
      }, TMP_Infinity_coerce_11.$$arity = 1);
      return (Opal.defn(self, '$to_f', TMP_Infinity_to_f_12 = function $$to_f() {
        var self = this;

        
        if (self.d['$=='](0)) {
          return 0};
        if ($truthy($rb_gt(self.d, 0))) {
          return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Float'), 'INFINITY')
          } else {
          return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Float'), 'INFINITY')['$-@']()
        };
      }, TMP_Infinity_to_f_12.$$arity = 0), nil) && 'to_f';
    })($nesting[0], Opal.const_get_relative($nesting, 'Numeric'), $nesting);
    Opal.const_set($nesting[0], 'JULIAN', Opal.const_get_relative($nesting, 'Infinity').$new());
    Opal.const_set($nesting[0], 'GREGORIAN', Opal.const_get_relative($nesting, 'Infinity').$new()['$-@']());
    Opal.const_set($nesting[0], 'ITALY', 2299161);
    Opal.const_set($nesting[0], 'ENGLAND', 2361222);
    Opal.const_set($nesting[0], 'MONTHNAMES', $rb_plus([nil], ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]));
    Opal.const_set($nesting[0], 'ABBR_MONTHNAMES', ["jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec"]);
    Opal.const_set($nesting[0], 'DAYNAMES', ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]);
    Opal.const_set($nesting[0], 'ABBR_DAYNAMES', ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]);
    (function(self, $parent_nesting) {
      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_wrap_13, TMP_parse_14, TMP_today_15, TMP_gregorian_leap$q_16;

      
      Opal.alias(self, "civil", "new");
      
      Opal.defn(self, '$wrap', TMP_wrap_13 = function $$wrap(native$) {
        var self = this, instance = nil;

        
        instance = self.$allocate();
        instance.date = native$;
        return instance;
      }, TMP_wrap_13.$$arity = 1);
      
      Opal.defn(self, '$parse', TMP_parse_14 = function $$parse(string, comp) {
        var self = this;

        if (comp == null) {
          comp = true;
        }
        
        
        var current_date = new Date();

        var current_day = current_date.getDate(),
            current_month = current_date.getMonth(),
            current_year = current_date.getFullYear(),
            current_wday = current_date.getDay(),
            full_month_name_regexp = Opal.const_get_relative($nesting, 'MONTHNAMES').$compact().$join("|");

        function match1(match) { return match[1]; }
        function match2(match) { return match[2]; }
        function match3(match) { return match[3]; }
        function match4(match) { return match[4]; }

        // Converts passed short year (0..99)
        // to a 4-digits year in the range (1969..2068)
        function fromShortYear(fn) {
          return function(match) {
            var short_year = fn(match);

            if (short_year >= 69) {
              short_year += 1900;
            } else {
              short_year += 2000;
            }
            return short_year;
          }
        }

        // Converts month abbr (nov) to a month number
        function fromMonthAbbr(fn) {
          return function(match) {
            var abbr = fn(match).toLowerCase();
            return Opal.const_get_relative($nesting, 'ABBR_MONTHNAMES').indexOf(abbr) + 1;
          }
        }

        function toInt(fn) {
          return function(match) {
            var value = fn(match);
            return parseInt(value, 10);
          }
        }

        // Depending on the 'comp' value appends 20xx to a passed year
        function to2000(fn) {
          return function(match) {
            var value = fn(match);
            if (comp) {
              return value + 2000;
            } else {
              return value;
            }
          }
        }

        // Converts passed week day name to a day number
        function fromDayName(fn) {
          return function(match) {
            var dayname = fn(match),
                wday = $send(Opal.const_get_relative($nesting, 'DAYNAMES'), 'map', [], "downcase".$to_proc()).indexOf((dayname).$downcase());

            return current_day - current_wday + wday;
          }
        }

        // Converts passed month name to a month number
        function fromFullMonthName(fn) {
          return function(match) {
            var month_name = fn(match);
            return $send(Opal.const_get_relative($nesting, 'MONTHNAMES').$compact(), 'map', [], "downcase".$to_proc()).indexOf((month_name).$downcase()) + 1;
          }
        }

        var rules = [
          {
            // DD as month day number
            regexp: /^(\d{2})$/,
            year: current_year,
            month: current_month,
            day: toInt(match1)
          },
          {
            // DDD as year day number
            regexp: /^(\d{3})$/,
            year: current_year,
            month: 0,
            day: toInt(match1)
          },
          {
            // MMDD as month and day
            regexp: /^(\d{2})(\d{2})$/,
            year: current_year,
            month: toInt(match1),
            day: toInt(match2)
          },
          {
            // YYDDD as year and day number in 1969--2068
            regexp: /^(\d{2})(\d{3})$/,
            year: fromShortYear(toInt(match1)),
            month: 0,
            day: toInt(match2)
          },
          {
            // YYMMDD as year, month and day in 1969--2068
            regexp: /^(\d{2})(\d{2})(\d{2})$/,
            year: fromShortYear(toInt(match1)),
            month: toInt(match2),
            day: toInt(match3)
          },
          {
            // YYYYDDD as year and day number
            regexp: /^(\d{4})(\d{3})$/,
            year: toInt(match1),
            month: 0,
            day: toInt(match2)
          },
          {
            // YYYYMMDD as year, month and day number
            regexp: /^(\d{4})(\d{2})(\d{2})$/,
            year: toInt(match1),
            month: toInt(match2),
            day: toInt(match3)
          },
          {
            // mmm YYYY
            regexp: /^([a-z]{3})[\s\.\/\-](\d{3,4})$/,
            year: toInt(match2),
            month: fromMonthAbbr(match1),
            day: 1
          },
          {
            // DD mmm YYYY
            regexp: /^(\d{1,2})[\s\.\/\-]([a-z]{3})[\s\.\/\-](\d{3,4})$/i,
            year: toInt(match3),
            month: fromMonthAbbr(match2),
            day: toInt(match1)
          },
          {
            // mmm DD YYYY
            regexp: /^([a-z]{3})[\s\.\/\-](\d{1,2})[\s\.\/\-](\d{3,4})$/i,
            year: toInt(match3),
            month: fromMonthAbbr(match1),
            day: toInt(match2)
          },
          {
            // YYYY mmm DD
            regexp: /^(\d{3,4})[\s\.\/\-]([a-z]{3})[\s\.\/\-](\d{1,2})$/i,
            year: toInt(match1),
            month: fromMonthAbbr(match2),
            day: toInt(match3)
          },
          {
            // YYYY-MM-DD YYYY/MM/DD YYYY.MM.DD
            regexp: /^(\-?\d{3,4})[\s\.\/\-](\d{1,2})[\s\.\/\-](\d{1,2})$/,
            year: toInt(match1),
            month: toInt(match2),
            day: toInt(match3)
          },
          {
            // YY-MM-DD
            regexp: /^(\d{2})[\s\.\/\-](\d{1,2})[\s\.\/\-](\d{1,2})$/,
            year: to2000(toInt(match1)),
            month: toInt(match2),
            day: toInt(match3)
          },
          {
            // DD-MM-YYYY
            regexp: /^(\d{1,2})[\s\.\/\-](\d{1,2})[\s\.\/\-](\-?\d{3,4})$/,
            year: toInt(match3),
            month: toInt(match2),
            day: toInt(match1)
          },
          {
            // ddd
            regexp: new RegExp("^(" + Opal.const_get_relative($nesting, 'DAYNAMES').$join("|") + ")$", 'i'),
            year: current_year,
            month: current_month,
            day: fromDayName(match1)
          },
          {
            // monthname daynumber YYYY
            regexp: new RegExp("^(" + full_month_name_regexp + ")[\\s\\.\\/\\-](\\d{1,2})(th|nd|rd)[\\s\\.\\/\\-](\\-?\\d{3,4})$", "i"),
            year: toInt(match4),
            month: fromFullMonthName(match1),
            day: toInt(match2)
          },
          {
            // monthname daynumber
            regexp: new RegExp("^(" + full_month_name_regexp + ")[\\s\\.\\/\\-](\\d{1,2})(th|nd|rd)", "i"),
            year: current_year,
            month: fromFullMonthName(match1),
            day: toInt(match2)
          },
          {
            // daynumber monthname YYYY
            regexp: new RegExp("^(\\d{1,2})(th|nd|rd)[\\s\\.\\/\\-](" + full_month_name_regexp + ")[\\s\\.\\/\\-](\\-?\\d{3,4})$", "i"),
            year: toInt(match4),
            month: fromFullMonthName(match3),
            day: toInt(match1)
          },
          {
            // YYYY monthname daynumber
            regexp: new RegExp("^(\\-?\\d{3,4})[\\s\\.\\/\\-](" + full_month_name_regexp + ")[\\s\\.\\/\\-](\\d{1,2})(th|nd|rd)$", "i"),
            year: toInt(match1),
            month: fromFullMonthName(match2),
            day: toInt(match3)
          }
        ]

        var rule, i, match;

        for (i = 0; i < rules.length; i++) {
          rule = rules[i];
          match = rule.regexp.exec(string);
          if (match) {
            var year = rule.year;
            if (typeof(year) === 'function') {
              year = year(match);
            }

            var month = rule.month;
            if (typeof(month) === 'function') {
              month = month(match) - 1
            }

            var day = rule.day;
            if (typeof(day) === 'function') {
              day = day(match);
            }

            var result = new Date(year, month, day);

            // an edge case, JS can't handle 'new Date(1)', minimal year is 1970
            if (year >= 0 && year <= 1970) {
              result.setFullYear(year);
            }

            return self.$wrap(result);
          }
        }
      ;
        return self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "invalid date");
      }, TMP_parse_14.$$arity = -2);
      
      Opal.defn(self, '$today', TMP_today_15 = function $$today() {
        var self = this;

        return self.$wrap(new Date())
      }, TMP_today_15.$$arity = 0);
      return (Opal.defn(self, '$gregorian_leap?', TMP_gregorian_leap$q_16 = function(year) {
        var self = this;

        return (new Date(year, 1, 29).getMonth()-1) === 0
      }, TMP_gregorian_leap$q_16.$$arity = 1), nil) && 'gregorian_leap?';
    })(Opal.get_singleton_class(self), $nesting);
    
    Opal.defn(self, '$initialize', TMP_Date_initialize_17 = function $$initialize(year, month, day, start) {
      var self = this;

      if (year == null) {
        year = -4712;
      }
      if (month == null) {
        month = 1;
      }
      if (day == null) {
        day = 1;
      }
      if (start == null) {
        start = Opal.const_get_relative($nesting, 'ITALY');
      }
      return (self.date = new Date(year, month - 1, day))
    }, TMP_Date_initialize_17.$$arity = -1);
    
    Opal.defn(self, '$-', TMP_Date_$_18 = function(date) {
      var self = this;

      
      if (date.$$is_number) {
        var result = self.$clone();
        result.date.setDate(self.date.getDate() - date);
        return result;
      }
      else if (date.date) {
        return Math.round((self.date - date.date) / (1000 * 60 * 60 * 24));
      }
      else {
        self.$raise(Opal.const_get_relative($nesting, 'TypeError'));
      }
    
    }, TMP_Date_$_18.$$arity = 1);
    
    Opal.defn(self, '$+', TMP_Date_$_19 = function(date) {
      var self = this;

      
      if (date.$$is_number) {
        var result = self.$clone();
        result.date.setDate(self.date.getDate() + date);
        return result;
      }
      else {
        self.$raise(Opal.const_get_relative($nesting, 'TypeError'));
      }
    
    }, TMP_Date_$_19.$$arity = 1);
    
    Opal.defn(self, '$<', TMP_Date_$lt_20 = function(other) {
      var self = this;

      
      var a = self.date, b = other.date;
      a.setHours(0, 0, 0, 0);
      b.setHours(0, 0, 0, 0);
      return a < b;
    
    }, TMP_Date_$lt_20.$$arity = 1);
    
    Opal.defn(self, '$<=', TMP_Date_$lt$eq_21 = function(other) {
      var self = this;

      
      var a = self.date, b = other.date;
      a.setHours(0, 0, 0, 0);
      b.setHours(0, 0, 0, 0);
      return a <= b;
    
    }, TMP_Date_$lt$eq_21.$$arity = 1);
    
    Opal.defn(self, '$>', TMP_Date_$gt_22 = function(other) {
      var self = this;

      
      var a = self.date, b = other.date;
      a.setHours(0, 0, 0, 0);
      b.setHours(0, 0, 0, 0);
      return a > b;
    
    }, TMP_Date_$gt_22.$$arity = 1);
    
    Opal.defn(self, '$>=', TMP_Date_$gt$eq_23 = function(other) {
      var self = this;

      
      var a = self.date, b = other.date;
      a.setHours(0, 0, 0, 0);
      b.setHours(0, 0, 0, 0);
      return a >= b;
    
    }, TMP_Date_$gt$eq_23.$$arity = 1);
    
    Opal.defn(self, '$<=>', TMP_Date_$lt$eq$gt_24 = function(other) {
      var self = this;

      
      if (other.$$is_number) {
        return self.$jd()['$<=>'](other)
      }

      if (Opal.const_get_relative($nesting, 'Date')['$==='](other)) {
        var a = self.date, b = other.date;
        a.setHours(0, 0, 0, 0);
        b.setHours(0, 0, 0, 0);

        if (a < b) {
          return -1;
        }
        else if (a > b) {
          return 1;
        }
        else {
          return 0;
        }
      } else {
        return nil;
      }
    
    }, TMP_Date_$lt$eq$gt_24.$$arity = 1);
    
    Opal.defn(self, '$>>', TMP_Date_$gt$gt_25 = function(n) {
      var self = this;

      
      if (!n.$$is_number) {
        self.$raise(Opal.const_get_relative($nesting, 'TypeError'));
      }

      var result = self.$clone(), date = result.date, cur = date.getDate();
      date.setDate(1);
      date.setMonth(date.getMonth() + n);
      date.setDate(Math.min(cur, days_in_month(date.getFullYear(), date.getMonth())));
      return result;
    
    }, TMP_Date_$gt$gt_25.$$arity = 1);
    
    Opal.defn(self, '$<<', TMP_Date_$lt$lt_26 = function(n) {
      var self = this;

      
      if (!n.$$is_number) {
        self.$raise(Opal.const_get_relative($nesting, 'TypeError'));
      }

      return self['$>>'](-n);
    
    }, TMP_Date_$lt$lt_26.$$arity = 1);
    Opal.alias(self, "eql?", "==");
    
    Opal.defn(self, '$clone', TMP_Date_clone_27 = function $$clone() {
      var self = this;

      return Opal.const_get_relative($nesting, 'Date').$wrap(new Date(self.date.getTime()))
    }, TMP_Date_clone_27.$$arity = 0);
    
    Opal.defn(self, '$day', TMP_Date_day_28 = function $$day() {
      var self = this;

      return self.date.getDate()
    }, TMP_Date_day_28.$$arity = 0);
    
    Opal.defn(self, '$friday?', TMP_Date_friday$q_29 = function() {
      var self = this;

      return self.$wday()['$=='](5)
    }, TMP_Date_friday$q_29.$$arity = 0);
    
    Opal.defn(self, '$jd', TMP_Date_jd_30 = function $$jd() {
      var self = this;

      
    //Adapted from http://www.physics.sfasu.edu/astro/javascript/julianday.html

    var mm = self.date.getMonth() + 1,
        dd = self.date.getDate(),
        yy = self.date.getFullYear(),
        hr = 12, mn = 0, sc = 0,
        ggg, s, a, j1, jd;

    hr = hr + (mn / 60) + (sc/3600);

    ggg = 1;
    if (yy <= 1585) {
      ggg = 0;
    }

    jd = -1 * Math.floor(7 * (Math.floor((mm + 9) / 12) + yy) / 4);

    s = 1;
    if ((mm - 9) < 0) {
      s =- 1;
    }

    a = Math.abs(mm - 9);
    j1 = Math.floor(yy + s * Math.floor(a / 7));
    j1 = -1 * Math.floor((Math.floor(j1 / 100) + 1) * 3 / 4);

    jd = jd + Math.floor(275 * mm / 9) + dd + (ggg * j1);
    jd = jd + 1721027 + 2 * ggg + 367 * yy - 0.5;
    jd = jd + (hr / 24);

    return jd;
    
    }, TMP_Date_jd_30.$$arity = 0);
    
    Opal.defn(self, '$julian?', TMP_Date_julian$q_31 = function() {
      var self = this;

      return self.date < new Date(1582, 10 - 1, 15, 12)
    }, TMP_Date_julian$q_31.$$arity = 0);
    
    Opal.defn(self, '$monday?', TMP_Date_monday$q_32 = function() {
      var self = this;

      return self.$wday()['$=='](1)
    }, TMP_Date_monday$q_32.$$arity = 0);
    
    Opal.defn(self, '$month', TMP_Date_month_33 = function $$month() {
      var self = this;

      return self.date.getMonth() + 1
    }, TMP_Date_month_33.$$arity = 0);
    
    Opal.defn(self, '$next', TMP_Date_next_34 = function $$next() {
      var self = this;

      return $rb_plus(self, 1)
    }, TMP_Date_next_34.$$arity = 0);
    
    Opal.defn(self, '$next_day', TMP_Date_next_day_35 = function $$next_day(n) {
      var self = this;

      if (n == null) {
        n = 1;
      }
      return $rb_plus(self, n)
    }, TMP_Date_next_day_35.$$arity = -1);
    
    Opal.defn(self, '$next_month', TMP_Date_next_month_36 = function $$next_month() {
      var self = this;

      
      var result = self.$clone(), date = result.date, cur = date.getDate();
      date.setDate(1);
      date.setMonth(date.getMonth() + 1);
      date.setDate(Math.min(cur, days_in_month(date.getFullYear(), date.getMonth())));
      return result;
    
    }, TMP_Date_next_month_36.$$arity = 0);
    
    Opal.defn(self, '$prev_day', TMP_Date_prev_day_37 = function $$prev_day(n) {
      var self = this;

      if (n == null) {
        n = 1;
      }
      return $rb_minus(self, n)
    }, TMP_Date_prev_day_37.$$arity = -1);
    
    Opal.defn(self, '$prev_month', TMP_Date_prev_month_38 = function $$prev_month() {
      var self = this;

      
      var result = self.$clone(), date = result.date, cur = date.getDate();
      date.setDate(1);
      date.setMonth(date.getMonth() - 1);
      date.setDate(Math.min(cur, days_in_month(date.getFullYear(), date.getMonth())));
      return result;
    
    }, TMP_Date_prev_month_38.$$arity = 0);
    
    Opal.defn(self, '$saturday?', TMP_Date_saturday$q_39 = function() {
      var self = this;

      return self.$wday()['$=='](6)
    }, TMP_Date_saturday$q_39.$$arity = 0);
    
    Opal.defn(self, '$strftime', TMP_Date_strftime_40 = function $$strftime(format) {
      var self = this;

      if (format == null) {
        format = "";
      }
      
      if (format == '') {
        return self.$to_s();
      }

      return self.date.$strftime(format);
    
    }, TMP_Date_strftime_40.$$arity = -1);
    self.$alias_method("succ", "next");
    
    Opal.defn(self, '$sunday?', TMP_Date_sunday$q_41 = function() {
      var self = this;

      return self.$wday()['$=='](0)
    }, TMP_Date_sunday$q_41.$$arity = 0);
    
    Opal.defn(self, '$thursday?', TMP_Date_thursday$q_42 = function() {
      var self = this;

      return self.$wday()['$=='](4)
    }, TMP_Date_thursday$q_42.$$arity = 0);
    
    Opal.defn(self, '$to_s', TMP_Date_to_s_43 = function $$to_s() {
      var self = this;

      
      var d = self.date, year = d.getFullYear(), month = d.getMonth() + 1, day = d.getDate();
      if (month < 10) { month = '0' + month; }
      if (day < 10) { day = '0' + day; }
      return year + '-' + month + '-' + day;
    
    }, TMP_Date_to_s_43.$$arity = 0);
    
    Opal.defn(self, '$tuesday?', TMP_Date_tuesday$q_44 = function() {
      var self = this;

      return self.$wday()['$=='](2)
    }, TMP_Date_tuesday$q_44.$$arity = 0);
    
    Opal.defn(self, '$step', TMP_Date_step_45 = function $$step(limit, step) {
      var TMP_46, TMP_47, TMP_48, self = this, $iter = TMP_Date_step_45.$$p, block = $iter || nil, steps_count = nil, steps = nil, result = nil;

      if (step == null) {
        step = 1;
      }
      if ($iter) TMP_Date_step_45.$$p = null;
      
      steps_count = $rb_minus(limit, self).$to_i();
      if ($truthy($rb_lt($rb_times(steps_count, step), 0))) {
        steps = []
      } else if ($truthy($rb_lt(steps_count, 0))) {
        steps = $send(Opal.Range.$new(0, steps_count['$-@'](), false).$step(step.$abs()), 'map', [], (TMP_46 = function(i){var self = TMP_46.$$s || this;
if (i == null) i = nil;
        return i['$-@']()}, TMP_46.$$s = self, TMP_46.$$arity = 1, TMP_46)).$reverse()
        } else {
        steps = Opal.Range.$new(0, steps_count, false).$step(step.$abs())
      };
      result = $send(steps, 'map', [], (TMP_47 = function(i){var self = TMP_47.$$s || this;
if (i == null) i = nil;
      return $rb_plus(self, i)}, TMP_47.$$s = self, TMP_47.$$arity = 1, TMP_47));
      if ((block !== nil)) {
        
        $send(result, 'each', [], (TMP_48 = function(i){var self = TMP_48.$$s || this;
if (i == null) i = nil;
        return Opal.yield1(block, i);}, TMP_48.$$s = self, TMP_48.$$arity = 1, TMP_48));
        return self;
        } else {
        return result
      };
    }, TMP_Date_step_45.$$arity = -2);
    
    Opal.defn(self, '$upto', TMP_Date_upto_49 = function $$upto(max) {
      var self = this, $iter = TMP_Date_upto_49.$$p, block = $iter || nil;

      if ($iter) TMP_Date_upto_49.$$p = null;
      return $send(self, 'step', [max, 1], block.$to_proc())
    }, TMP_Date_upto_49.$$arity = 1);
    
    Opal.defn(self, '$downto', TMP_Date_downto_50 = function $$downto(min) {
      var self = this, $iter = TMP_Date_downto_50.$$p, block = $iter || nil;

      if ($iter) TMP_Date_downto_50.$$p = null;
      return $send(self, 'step', [min, -1], block.$to_proc())
    }, TMP_Date_downto_50.$$arity = 1);
    
    Opal.defn(self, '$wday', TMP_Date_wday_51 = function $$wday() {
      var self = this;

      return self.date.getDay()
    }, TMP_Date_wday_51.$$arity = 0);
    
    Opal.defn(self, '$wednesday?', TMP_Date_wednesday$q_52 = function() {
      var self = this;

      return self.$wday()['$=='](3)
    }, TMP_Date_wednesday$q_52.$$arity = 0);
    
    Opal.defn(self, '$year', TMP_Date_year_53 = function $$year() {
      var self = this;

      return self.date.getFullYear()
    }, TMP_Date_year_53.$$arity = 0);
    
    Opal.defn(self, '$cwday', TMP_Date_cwday_54 = function $$cwday() {
      var self = this;

      return self.date.getDay() || 7;
    }, TMP_Date_cwday_54.$$arity = 0);
    
    Opal.defn(self, '$cweek', TMP_Date_cweek_55 = function $$cweek() {
      var self = this;

      
      var d = new Date(self.date);
      d.setHours(0,0,0);
      d.setDate(d.getDate()+4-(d.getDay()||7));
      return Math.ceil((((d-new Date(d.getFullYear(),0,1))/8.64e7)+1)/7);
    
    }, TMP_Date_cweek_55.$$arity = 0);
    
    function days_in_month(year, month) {
      var leap = ((year % 4 === 0 && year % 100 !== 0) || year % 400 === 0);
      return [31, (leap ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month]
    }
  ;
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["time"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  Opal.add_stubs(['$strftime']);
  return (function($base, $super, $parent_nesting) {
    function $Time(){};
    var self = $Time = $klass($base, $super, 'Time', $Time);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Time_parse_1, TMP_Time_iso8601_2;

    
    Opal.defs(self, '$parse', TMP_Time_parse_1 = function $$parse(str) {
      var self = this;

      return new Date(Date.parse(str))
    }, TMP_Time_parse_1.$$arity = 1);
    return (Opal.defn(self, '$iso8601', TMP_Time_iso8601_2 = function $$iso8601() {
      var self = this;

      return self.$strftime("%FT%T%z")
    }, TMP_Time_iso8601_2.$$arity = 0), nil) && 'iso8601';
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["js"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy;

  Opal.add_stubs(['$insert', '$<<', '$global', '$extend']);
  return (function($base, $parent_nesting) {
    var $JS, self = $JS = $module($base, 'JS');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_JS_delete_1, TMP_JS_global_2, TMP_JS_in_3, TMP_JS_instanceof_4, TMP_JS_new_5, TMP_JS_new_6, TMP_JS_typeof_7, TMP_JS_void_8, TMP_JS_call_9;

    
    
    Opal.defn(self, '$delete', TMP_JS_delete_1 = function(object, property) {
      var self = this;

      return delete object[property]
    }, TMP_JS_delete_1.$$arity = 2);
    
    Opal.defn(self, '$global', TMP_JS_global_2 = function $$global() {
      var self = this;

      return Opal.global
    }, TMP_JS_global_2.$$arity = 0);
    
    Opal.defn(self, '$in', TMP_JS_in_3 = function(property, object) {
      var self = this;

      return property in object
    }, TMP_JS_in_3.$$arity = 2);
    
    Opal.defn(self, '$instanceof', TMP_JS_instanceof_4 = function(value, func) {
      var self = this;

      return value instanceof func
    }, TMP_JS_instanceof_4.$$arity = 2);
    if ($truthy(typeof Function.prototype.bind == 'function')) {
      
      Opal.defn(self, '$new', TMP_JS_new_5 = function(func, $a_rest) {
        var self = this, args, $iter = TMP_JS_new_5.$$p, block = $iter || nil;

        var $args_len = arguments.length, $rest_len = $args_len - 1;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 1] = arguments[$arg_idx];
        }
        if ($iter) TMP_JS_new_5.$$p = null;
        
        args.$insert(0, this);
        if ($truthy(block)) {
          args['$<<'](block)};
        return new (func.bind.apply(func, args))();
      }, TMP_JS_new_5.$$arity = -2)
      } else {
      
      Opal.defn(self, '$new', TMP_JS_new_6 = function(func, $a_rest) {
        var self = this, args, $iter = TMP_JS_new_6.$$p, block = $iter || nil, f = nil;

        var $args_len = arguments.length, $rest_len = $args_len - 1;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 1] = arguments[$arg_idx];
        }
        if ($iter) TMP_JS_new_6.$$p = null;
        
        if ($truthy(block)) {
          args['$<<'](block)};
        f = function(){return func.apply(this, args)};
        f["prototype"] = func["prototype"];
        return new f();
      }, TMP_JS_new_6.$$arity = -2)
    };
    
    Opal.defn(self, '$typeof', TMP_JS_typeof_7 = function(value) {
      var self = this;

      return typeof value
    }, TMP_JS_typeof_7.$$arity = 1);
    
    Opal.defn(self, '$void', TMP_JS_void_8 = function(expr) {
      var self = this;

      return void expr
    }, TMP_JS_void_8.$$arity = 1);
    
    Opal.defn(self, '$call', TMP_JS_call_9 = function $$call(func, $a_rest) {
      var self = this, args, $iter = TMP_JS_call_9.$$p, block = $iter || nil, g = nil;

      var $args_len = arguments.length, $rest_len = $args_len - 1;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 1] = arguments[$arg_idx];
      }
      if ($iter) TMP_JS_call_9.$$p = null;
      
      g = self.$global();
      if ($truthy(block)) {
        args['$<<'](block)};
      return g[func].apply(g, args);
    }, TMP_JS_call_9.$$arity = -2);
    Opal.alias(self, "method_missing", "call");
    self.$extend(self);
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["bigdecimal/kernel"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module;

  Opal.add_stubs(['$new']);
  return (function($base, $parent_nesting) {
    var $Kernel, self = $Kernel = $module($base, 'Kernel');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Kernel_BigDecimal_1;

    
    Opal.defn(self, '$BigDecimal', TMP_Kernel_BigDecimal_1 = function $$BigDecimal(initial, digits) {
      var self = this;

      if (digits == null) {
        digits = 0;
      }
      return Opal.const_get_relative($nesting, 'BigDecimal').$new(initial, digits)
    }, TMP_Kernel_BigDecimal_1.$$arity = -2)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["bigdecimal/bignumber"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  return (function($base, $super, $parent_nesting) {
    function $BigDecimal(){};
    var self = $BigDecimal = $klass($base, $super, 'BigDecimal', $BigDecimal);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    
    var define = function (f) { Opal.const_set(self, 'BigNumber', f()); };
    define.amd = true;

    /* jshint ignore:start */
    /* bignumber.js v2.1.4 https://github.com/MikeMcl/bignumber.js/LICENCE */
    !function(e){"use strict";function n(e){function E(e,n){var t,r,i,o,u,s,f=this;if(!(f instanceof E))return j&&L(26,"constructor call without new",e),new E(e,n);if(null!=n&&H(n,2,64,M,"base")){if(n=0|n,s=e+"",10==n)return f=new E(e instanceof E?e:s),U(f,P+f.e+1,k);if((o="number"==typeof e)&&0*e!=0||!new RegExp("^-?"+(t="["+N.slice(0,n)+"]+")+"(?:\\."+t+")?$",37>n?"i":"").test(s))return h(f,s,o,n);o?(f.s=0>1/e?(s=s.slice(1),-1):1,j&&s.replace(/^0\.0*|\./,"").length>15&&L(M,v,e),o=!1):f.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1,s=D(s,10,n,f.s)}else{if(e instanceof E)return f.s=e.s,f.e=e.e,f.c=(e=e.c)?e.slice():e,void(M=0);if((o="number"==typeof e)&&0*e==0){if(f.s=0>1/e?(e=-e,-1):1,e===~~e){for(r=0,i=e;i>=10;i/=10,r++);return f.e=r,f.c=[e],void(M=0)}s=e+""}else{if(!g.test(s=e+""))return h(f,s,o);f.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1}}for((r=s.indexOf("."))>-1&&(s=s.replace(".","")),(i=s.search(/e/i))>0?(0>r&&(r=i),r+=+s.slice(i+1),s=s.substring(0,i)):0>r&&(r=s.length),i=0;48===s.charCodeAt(i);i++);for(u=s.length;48===s.charCodeAt(--u););if(s=s.slice(i,u+1))if(u=s.length,o&&j&&u>15&&L(M,v,f.s*e),r=r-i-1,r>z)f.c=f.e=null;else if(G>r)f.c=[f.e=0];else{if(f.e=r,f.c=[],i=(r+1)%O,0>r&&(i+=O),u>i){for(i&&f.c.push(+s.slice(0,i)),u-=O;u>i;)f.c.push(+s.slice(i,i+=O));s=s.slice(i),i=O-s.length}else i-=u;for(;i--;s+="0");f.c.push(+s)}else f.c=[f.e=0];M=0}function D(e,n,t,i){var o,u,f,c,a,h,g,p=e.indexOf("."),d=P,m=k;for(37>t&&(e=e.toLowerCase()),p>=0&&(f=J,J=0,e=e.replace(".",""),g=new E(t),a=g.pow(e.length-p),J=f,g.c=s(l(r(a.c),a.e),10,n),g.e=g.c.length),h=s(e,t,n),u=f=h.length;0==h[--f];h.pop());if(!h[0])return"0";if(0>p?--u:(a.c=h,a.e=u,a.s=i,a=C(a,g,d,m,n),h=a.c,c=a.r,u=a.e),o=u+d+1,p=h[o],f=n/2,c=c||0>o||null!=h[o+1],c=4>m?(null!=p||c)&&(0==m||m==(a.s<0?3:2)):p>f||p==f&&(4==m||c||6==m&&1&h[o-1]||m==(a.s<0?8:7)),1>o||!h[0])e=c?l("1",-d):"0";else{if(h.length=o,c)for(--n;++h[--o]>n;)h[o]=0,o||(++u,h.unshift(1));for(f=h.length;!h[--f];);for(p=0,e="";f>=p;e+=N.charAt(h[p++]));e=l(e,u)}return e}function F(e,n,t,i){var o,u,s,c,a;if(t=null!=t&&H(t,0,8,i,w)?0|t:k,!e.c)return e.toString();if(o=e.c[0],s=e.e,null==n)a=r(e.c),a=19==i||24==i&&B>=s?f(a,s):l(a,s);else if(e=U(new E(e),n,t),u=e.e,a=r(e.c),c=a.length,19==i||24==i&&(u>=n||B>=u)){for(;n>c;a+="0",c++);a=f(a,u)}else if(n-=s,a=l(a,u),u+1>c){if(--n>0)for(a+=".";n--;a+="0");}else if(n+=u-c,n>0)for(u+1==c&&(a+=".");n--;a+="0");return e.s<0&&o?"-"+a:a}function _(e,n){var t,r,i=0;for(u(e[0])&&(e=e[0]),t=new E(e[0]);++i<e.length;){if(r=new E(e[i]),!r.s){t=r;break}n.call(t,r)&&(t=r)}return t}function x(e,n,t,r,i){return(n>e||e>t||e!=c(e))&&L(r,(i||"decimal places")+(n>e||e>t?" out of range":" not an integer"),e),!0}function I(e,n,t){for(var r=1,i=n.length;!n[--i];n.pop());for(i=n[0];i>=10;i/=10,r++);return(t=r+t*O-1)>z?e.c=e.e=null:G>t?e.c=[e.e=0]:(e.e=t,e.c=n),e}function L(e,n,t){var r=new Error(["new BigNumber","cmp","config","div","divToInt","eq","gt","gte","lt","lte","minus","mod","plus","precision","random","round","shift","times","toDigits","toExponential","toFixed","toFormat","toFraction","pow","toPrecision","toString","BigNumber"][e]+"() "+n+": "+t);throw r.name="BigNumber Error",M=0,r}function U(e,n,t,r){var i,o,u,s,f,l,c,a=e.c,h=S;if(a){e:{for(i=1,s=a[0];s>=10;s/=10,i++);if(o=n-i,0>o)o+=O,u=n,f=a[l=0],c=f/h[i-u-1]%10|0;else if(l=p((o+1)/O),l>=a.length){if(!r)break e;for(;a.length<=l;a.push(0));f=c=0,i=1,o%=O,u=o-O+1}else{for(f=s=a[l],i=1;s>=10;s/=10,i++);o%=O,u=o-O+i,c=0>u?0:f/h[i-u-1]%10|0}if(r=r||0>n||null!=a[l+1]||(0>u?f:f%h[i-u-1]),r=4>t?(c||r)&&(0==t||t==(e.s<0?3:2)):c>5||5==c&&(4==t||r||6==t&&(o>0?u>0?f/h[i-u]:0:a[l-1])%10&1||t==(e.s<0?8:7)),1>n||!a[0])return a.length=0,r?(n-=e.e+1,a[0]=h[(O-n%O)%O],e.e=-n||0):a[0]=e.e=0,e;if(0==o?(a.length=l,s=1,l--):(a.length=l+1,s=h[O-o],a[l]=u>0?d(f/h[i-u]%h[u])*s:0),r)for(;;){if(0==l){for(o=1,u=a[0];u>=10;u/=10,o++);for(u=a[0]+=s,s=1;u>=10;u/=10,s++);o!=s&&(e.e++,a[0]==b&&(a[0]=1));break}if(a[l]+=s,a[l]!=b)break;a[l--]=0,s=1}for(o=a.length;0===a[--o];a.pop());}e.e>z?e.c=e.e=null:e.e<G&&(e.c=[e.e=0])}return e}var C,M=0,T=E.prototype,q=new E(1),P=20,k=4,B=-7,$=21,G=-1e7,z=1e7,j=!0,H=x,V=!1,W=1,J=100,X={decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:" ",fractionGroupSize:0};return E.another=n,E.ROUND_UP=0,E.ROUND_DOWN=1,E.ROUND_CEIL=2,E.ROUND_FLOOR=3,E.ROUND_HALF_UP=4,E.ROUND_HALF_DOWN=5,E.ROUND_HALF_EVEN=6,E.ROUND_HALF_CEIL=7,E.ROUND_HALF_FLOOR=8,E.EUCLID=9,E.config=function(){var e,n,t=0,r={},i=arguments,s=i[0],f=s&&"object"==typeof s?function(){return s.hasOwnProperty(n)?null!=(e=s[n]):void 0}:function(){return i.length>t?null!=(e=i[t++]):void 0};return f(n="DECIMAL_PLACES")&&H(e,0,A,2,n)&&(P=0|e),r[n]=P,f(n="ROUNDING_MODE")&&H(e,0,8,2,n)&&(k=0|e),r[n]=k,f(n="EXPONENTIAL_AT")&&(u(e)?H(e[0],-A,0,2,n)&&H(e[1],0,A,2,n)&&(B=0|e[0],$=0|e[1]):H(e,-A,A,2,n)&&(B=-($=0|(0>e?-e:e)))),r[n]=[B,$],f(n="RANGE")&&(u(e)?H(e[0],-A,-1,2,n)&&H(e[1],1,A,2,n)&&(G=0|e[0],z=0|e[1]):H(e,-A,A,2,n)&&(0|e?G=-(z=0|(0>e?-e:e)):j&&L(2,n+" cannot be zero",e))),r[n]=[G,z],f(n="ERRORS")&&(e===!!e||1===e||0===e?(M=0,H=(j=!!e)?x:o):j&&L(2,n+m,e)),r[n]=j,f(n="CRYPTO")&&(e===!!e||1===e||0===e?(V=!(!e||!a),e&&!V&&j&&L(2,"crypto unavailable",a)):j&&L(2,n+m,e)),r[n]=V,f(n="MODULO_MODE")&&H(e,0,9,2,n)&&(W=0|e),r[n]=W,f(n="POW_PRECISION")&&H(e,0,A,2,n)&&(J=0|e),r[n]=J,f(n="FORMAT")&&("object"==typeof e?X=e:j&&L(2,n+" not an object",e)),r[n]=X,r},E.max=function(){return _(arguments,T.lt)},E.min=function(){return _(arguments,T.gt)},E.random=function(){var e=9007199254740992,n=Math.random()*e&2097151?function(){return d(Math.random()*e)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(e){var t,r,i,o,u,s=0,f=[],l=new E(q);if(e=null!=e&&H(e,0,A,14)?0|e:P,o=p(e/O),V)if(a&&a.getRandomValues){for(t=a.getRandomValues(new Uint32Array(o*=2));o>s;)u=131072*t[s]+(t[s+1]>>>11),u>=9e15?(r=a.getRandomValues(new Uint32Array(2)),t[s]=r[0],t[s+1]=r[1]):(f.push(u%1e14),s+=2);s=o/2}else if(a&&a.randomBytes){for(t=a.randomBytes(o*=7);o>s;)u=281474976710656*(31&t[s])+1099511627776*t[s+1]+4294967296*t[s+2]+16777216*t[s+3]+(t[s+4]<<16)+(t[s+5]<<8)+t[s+6],u>=9e15?a.randomBytes(7).copy(t,s):(f.push(u%1e14),s+=7);s=o/7}else j&&L(14,"crypto unavailable",a);if(!s)for(;o>s;)u=n(),9e15>u&&(f[s++]=u%1e14);for(o=f[--s],e%=O,o&&e&&(u=S[O-e],f[s]=d(o/u)*u);0===f[s];f.pop(),s--);if(0>s)f=[i=0];else{for(i=-1;0===f[0];f.shift(),i-=O);for(s=1,u=f[0];u>=10;u/=10,s++);O>s&&(i-=O-s)}return l.e=i,l.c=f,l}}(),C=function(){function e(e,n,t){var r,i,o,u,s=0,f=e.length,l=n%R,c=n/R|0;for(e=e.slice();f--;)o=e[f]%R,u=e[f]/R|0,r=c*o+u*l,i=l*o+r%R*R+s,s=(i/t|0)+(r/R|0)+c*u,e[f]=i%t;return s&&e.unshift(s),e}function n(e,n,t,r){var i,o;if(t!=r)o=t>r?1:-1;else for(i=o=0;t>i;i++)if(e[i]!=n[i]){o=e[i]>n[i]?1:-1;break}return o}function r(e,n,t,r){for(var i=0;t--;)e[t]-=i,i=e[t]<n[t]?1:0,e[t]=i*r+e[t]-n[t];for(;!e[0]&&e.length>1;e.shift());}return function(i,o,u,s,f){var l,c,a,h,g,p,m,w,v,N,y,S,R,A,D,F,_,x=i.s==o.s?1:-1,I=i.c,L=o.c;if(!(I&&I[0]&&L&&L[0]))return new E(i.s&&o.s&&(I?!L||I[0]!=L[0]:L)?I&&0==I[0]||!L?0*x:x/0:NaN);for(w=new E(x),v=w.c=[],c=i.e-o.e,x=u+c+1,f||(f=b,c=t(i.e/O)-t(o.e/O),x=x/O|0),a=0;L[a]==(I[a]||0);a++);if(L[a]>(I[a]||0)&&c--,0>x)v.push(1),h=!0;else{for(A=I.length,F=L.length,a=0,x+=2,g=d(f/(L[0]+1)),g>1&&(L=e(L,g,f),I=e(I,g,f),F=L.length,A=I.length),R=F,N=I.slice(0,F),y=N.length;F>y;N[y++]=0);_=L.slice(),_.unshift(0),D=L[0],L[1]>=f/2&&D++;do{if(g=0,l=n(L,N,F,y),0>l){if(S=N[0],F!=y&&(S=S*f+(N[1]||0)),g=d(S/D),g>1)for(g>=f&&(g=f-1),p=e(L,g,f),m=p.length,y=N.length;1==n(p,N,m,y);)g--,r(p,m>F?_:L,m,f),m=p.length,l=1;else 0==g&&(l=g=1),p=L.slice(),m=p.length;if(y>m&&p.unshift(0),r(N,p,y,f),y=N.length,-1==l)for(;n(L,N,F,y)<1;)g++,r(N,y>F?_:L,y,f),y=N.length}else 0===l&&(g++,N=[0]);v[a++]=g,N[0]?N[y++]=I[R]||0:(N=[I[R]],y=1)}while((R++<A||null!=N[0])&&x--);h=null!=N[0],v[0]||v.shift()}if(f==b){for(a=1,x=v[0];x>=10;x/=10,a++);U(w,u+(w.e=a+c*O-1)+1,s,h)}else w.e=c,w.r=+h;return w}}(),h=function(){var e=/^(-?)0([xbo])(?=\w[\w.]*$)/i,n=/^([^.]+)\.$/,t=/^\.([^.]+)$/,r=/^-?(Infinity|NaN)$/,i=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(o,u,s,f){var l,c=s?u:u.replace(i,"");if(r.test(c))o.s=isNaN(c)?null:0>c?-1:1;else{if(!s&&(c=c.replace(e,function(e,n,t){return l="x"==(t=t.toLowerCase())?16:"b"==t?2:8,f&&f!=l?e:n}),f&&(l=f,c=c.replace(n,"$1").replace(t,"0.$1")),u!=c))return new E(c,l);j&&L(M,"not a"+(f?" base "+f:"")+" number",u),o.s=null}o.c=o.e=null,M=0}}(),T.absoluteValue=T.abs=function(){var e=new E(this);return e.s<0&&(e.s=1),e},T.ceil=function(){return U(new E(this),this.e+1,2)},T.comparedTo=T.cmp=function(e,n){return M=1,i(this,new E(e,n))},T.decimalPlaces=T.dp=function(){var e,n,r=this.c;if(!r)return null;if(e=((n=r.length-1)-t(this.e/O))*O,n=r[n])for(;n%10==0;n/=10,e--);return 0>e&&(e=0),e},T.dividedBy=T.div=function(e,n){return M=3,C(this,new E(e,n),P,k)},T.dividedToIntegerBy=T.divToInt=function(e,n){return M=4,C(this,new E(e,n),0,1)},T.equals=T.eq=function(e,n){return M=5,0===i(this,new E(e,n))},T.floor=function(){return U(new E(this),this.e+1,3)},T.greaterThan=T.gt=function(e,n){return M=6,i(this,new E(e,n))>0},T.greaterThanOrEqualTo=T.gte=function(e,n){return M=7,1===(n=i(this,new E(e,n)))||0===n},T.isFinite=function(){return!!this.c},T.isInteger=T.isInt=function(){return!!this.c&&t(this.e/O)>this.c.length-2},T.isNaN=function(){return!this.s},T.isNegative=T.isNeg=function(){return this.s<0},T.isZero=function(){return!!this.c&&0==this.c[0]},T.lessThan=T.lt=function(e,n){return M=8,i(this,new E(e,n))<0},T.lessThanOrEqualTo=T.lte=function(e,n){return M=9,-1===(n=i(this,new E(e,n)))||0===n},T.minus=T.sub=function(e,n){var r,i,o,u,s=this,f=s.s;if(M=10,e=new E(e,n),n=e.s,!f||!n)return new E(NaN);if(f!=n)return e.s=-n,s.plus(e);var l=s.e/O,c=e.e/O,a=s.c,h=e.c;if(!l||!c){if(!a||!h)return a?(e.s=-n,e):new E(h?s:NaN);if(!a[0]||!h[0])return h[0]?(e.s=-n,e):new E(a[0]?s:3==k?-0:0)}if(l=t(l),c=t(c),a=a.slice(),f=l-c){for((u=0>f)?(f=-f,o=a):(c=l,o=h),o.reverse(),n=f;n--;o.push(0));o.reverse()}else for(i=(u=(f=a.length)<(n=h.length))?f:n,f=n=0;i>n;n++)if(a[n]!=h[n]){u=a[n]<h[n];break}if(u&&(o=a,a=h,h=o,e.s=-e.s),n=(i=h.length)-(r=a.length),n>0)for(;n--;a[r++]=0);for(n=b-1;i>f;){if(a[--i]<h[i]){for(r=i;r&&!a[--r];a[r]=n);--a[r],a[i]+=b}a[i]-=h[i]}for(;0==a[0];a.shift(),--c);return a[0]?I(e,a,c):(e.s=3==k?-1:1,e.c=[e.e=0],e)},T.modulo=T.mod=function(e,n){var t,r,i=this;return M=11,e=new E(e,n),!i.c||!e.s||e.c&&!e.c[0]?new E(NaN):!e.c||i.c&&!i.c[0]?new E(i):(9==W?(r=e.s,e.s=1,t=C(i,e,0,3),e.s=r,t.s*=r):t=C(i,e,0,W),i.minus(t.times(e)))},T.negated=T.neg=function(){var e=new E(this);return e.s=-e.s||null,e},T.plus=T.add=function(e,n){var r,i=this,o=i.s;if(M=12,e=new E(e,n),n=e.s,!o||!n)return new E(NaN);if(o!=n)return e.s=-n,i.minus(e);var u=i.e/O,s=e.e/O,f=i.c,l=e.c;if(!u||!s){if(!f||!l)return new E(o/0);if(!f[0]||!l[0])return l[0]?e:new E(f[0]?i:0*o)}if(u=t(u),s=t(s),f=f.slice(),o=u-s){for(o>0?(s=u,r=l):(o=-o,r=f),r.reverse();o--;r.push(0));r.reverse()}for(o=f.length,n=l.length,0>o-n&&(r=l,l=f,f=r,n=o),o=0;n;)o=(f[--n]=f[n]+l[n]+o)/b|0,f[n]%=b;return o&&(f.unshift(o),++s),I(e,f,s)},T.precision=T.sd=function(e){var n,t,r=this,i=r.c;if(null!=e&&e!==!!e&&1!==e&&0!==e&&(j&&L(13,"argument"+m,e),e!=!!e&&(e=null)),!i)return null;if(t=i.length-1,n=t*O+1,t=i[t]){for(;t%10==0;t/=10,n--);for(t=i[0];t>=10;t/=10,n++);}return e&&r.e+1>n&&(n=r.e+1),n},T.round=function(e,n){var t=new E(this);return(null==e||H(e,0,A,15))&&U(t,~~e+this.e+1,null!=n&&H(n,0,8,15,w)?0|n:k),t},T.shift=function(e){var n=this;return H(e,-y,y,16,"argument")?n.times("1e"+c(e)):new E(n.c&&n.c[0]&&(-y>e||e>y)?n.s*(0>e?0:1/0):n)},T.squareRoot=T.sqrt=function(){var e,n,i,o,u,s=this,f=s.c,l=s.s,c=s.e,a=P+4,h=new E("0.5");if(1!==l||!f||!f[0])return new E(!l||0>l&&(!f||f[0])?NaN:f?s:1/0);if(l=Math.sqrt(+s),0==l||l==1/0?(n=r(f),(n.length+c)%2==0&&(n+="0"),l=Math.sqrt(n),c=t((c+1)/2)-(0>c||c%2),l==1/0?n="1e"+c:(n=l.toExponential(),n=n.slice(0,n.indexOf("e")+1)+c),i=new E(n)):i=new E(l+""),i.c[0])for(c=i.e,l=c+a,3>l&&(l=0);;)if(u=i,i=h.times(u.plus(C(s,u,a,1))),r(u.c).slice(0,l)===(n=r(i.c)).slice(0,l)){if(i.e<c&&--l,n=n.slice(l-3,l+1),"9999"!=n&&(o||"4999"!=n)){(!+n||!+n.slice(1)&&"5"==n.charAt(0))&&(U(i,i.e+P+2,1),e=!i.times(i).eq(s));break}if(!o&&(U(u,u.e+P+2,0),u.times(u).eq(s))){i=u;break}a+=4,l+=4,o=1}return U(i,i.e+P+1,k,e)},T.times=T.mul=function(e,n){var r,i,o,u,s,f,l,c,a,h,g,p,d,m,w,v=this,N=v.c,y=(M=17,e=new E(e,n)).c;if(!(N&&y&&N[0]&&y[0]))return!v.s||!e.s||N&&!N[0]&&!y||y&&!y[0]&&!N?e.c=e.e=e.s=null:(e.s*=v.s,N&&y?(e.c=[0],e.e=0):e.c=e.e=null),e;for(i=t(v.e/O)+t(e.e/O),e.s*=v.s,l=N.length,h=y.length,h>l&&(d=N,N=y,y=d,o=l,l=h,h=o),o=l+h,d=[];o--;d.push(0));for(m=b,w=R,o=h;--o>=0;){for(r=0,g=y[o]%w,p=y[o]/w|0,s=l,u=o+s;u>o;)c=N[--s]%w,a=N[s]/w|0,f=p*c+a*g,c=g*c+f%w*w+d[u]+r,r=(c/m|0)+(f/w|0)+p*a,d[u--]=c%m;d[u]=r}return r?++i:d.shift(),I(e,d,i)},T.toDigits=function(e,n){var t=new E(this);return e=null!=e&&H(e,1,A,18,"precision")?0|e:null,n=null!=n&&H(n,0,8,18,w)?0|n:k,e?U(t,e,n):t},T.toExponential=function(e,n){return F(this,null!=e&&H(e,0,A,19)?~~e+1:null,n,19)},T.toFixed=function(e,n){return F(this,null!=e&&H(e,0,A,20)?~~e+this.e+1:null,n,20)},T.toFormat=function(e,n){var t=F(this,null!=e&&H(e,0,A,21)?~~e+this.e+1:null,n,21);if(this.c){var r,i=t.split("."),o=+X.groupSize,u=+X.secondaryGroupSize,s=X.groupSeparator,f=i[0],l=i[1],c=this.s<0,a=c?f.slice(1):f,h=a.length;if(u&&(r=o,o=u,u=r,h-=r),o>0&&h>0){for(r=h%o||o,f=a.substr(0,r);h>r;r+=o)f+=s+a.substr(r,o);u>0&&(f+=s+a.slice(r)),c&&(f="-"+f)}t=l?f+X.decimalSeparator+((u=+X.fractionGroupSize)?l.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+X.fractionGroupSeparator):l):f}return t},T.toFraction=function(e){var n,t,i,o,u,s,f,l,c,a=j,h=this,g=h.c,p=new E(q),d=t=new E(q),m=f=new E(q);if(null!=e&&(j=!1,s=new E(e),j=a,(!(a=s.isInt())||s.lt(q))&&(j&&L(22,"max denominator "+(a?"out of range":"not an integer"),e),e=!a&&s.c&&U(s,s.e+1,1).gte(q)?s:null)),!g)return h.toString();for(c=r(g),o=p.e=c.length-h.e-1,p.c[0]=S[(u=o%O)<0?O+u:u],e=!e||s.cmp(p)>0?o>0?p:d:s,u=z,z=1/0,s=new E(c),f.c[0]=0;l=C(s,p,0,1),i=t.plus(l.times(m)),1!=i.cmp(e);)t=m,m=i,d=f.plus(l.times(i=d)),f=i,p=s.minus(l.times(i=p)),s=i;return i=C(e.minus(t),m,0,1),f=f.plus(i.times(d)),t=t.plus(i.times(m)),f.s=d.s=h.s,o*=2,n=C(d,m,o,k).minus(h).abs().cmp(C(f,t,o,k).minus(h).abs())<1?[d.toString(),m.toString()]:[f.toString(),t.toString()],z=u,n},T.toNumber=function(){return+this},T.toPower=T.pow=function(e){var n,t,r=d(0>e?-e:+e),i=this;if(!H(e,-y,y,23,"exponent")&&(!isFinite(e)||r>y&&(e/=0)||parseFloat(e)!=e&&!(e=NaN)))return new E(Math.pow(+i,e));for(n=J?p(J/O+2):0,t=new E(q);;){if(r%2){if(t=t.times(i),!t.c)break;n&&t.c.length>n&&(t.c.length=n)}if(r=d(r/2),!r)break;i=i.times(i),n&&i.c&&i.c.length>n&&(i.c.length=n)}return 0>e&&(t=q.div(t)),n?U(t,J,k):t},T.toPrecision=function(e,n){return F(this,null!=e&&H(e,1,A,24,"precision")?0|e:null,n,24)},T.toString=function(e){var n,t=this,i=t.s,o=t.e;return null===o?i?(n="Infinity",0>i&&(n="-"+n)):n="NaN":(n=r(t.c),n=null!=e&&H(e,2,64,25,"base")?D(l(n,o),0|e,10,i):B>=o||o>=$?f(n,o):l(n,o),0>i&&t.c[0]&&(n="-"+n)),n},T.truncated=T.trunc=function(){return U(new E(this),this.e+1,1)},T.valueOf=T.toJSON=function(){var e,n=this,t=n.e;return null===t?n.toString():(e=r(n.c),e=B>=t||t>=$?f(e,t):l(e,t),n.s<0?"-"+e:e)},null!=e&&E.config(e),E}function t(e){var n=0|e;return e>0||e===n?n:n-1}function r(e){for(var n,t,r=1,i=e.length,o=e[0]+"";i>r;){for(n=e[r++]+"",t=O-n.length;t--;n="0"+n);o+=n}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function i(e,n){var t,r,i=e.c,o=n.c,u=e.s,s=n.s,f=e.e,l=n.e;if(!u||!s)return null;if(t=i&&!i[0],r=o&&!o[0],t||r)return t?r?0:-s:u;if(u!=s)return u;if(t=0>u,r=f==l,!i||!o)return r?0:!i^t?1:-1;if(!r)return f>l^t?1:-1;for(s=(f=i.length)<(l=o.length)?f:l,u=0;s>u;u++)if(i[u]!=o[u])return i[u]>o[u]^t?1:-1;return f==l?0:f>l^t?1:-1}function o(e,n,t){return(e=c(e))>=n&&t>=e}function u(e){return"[object Array]"==Object.prototype.toString.call(e)}function s(e,n,t){for(var r,i,o=[0],u=0,s=e.length;s>u;){for(i=o.length;i--;o[i]*=n);for(o[r=0]+=N.indexOf(e.charAt(u++));r<o.length;r++)o[r]>t-1&&(null==o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/t|0,o[r]%=t)}return o.reverse()}function f(e,n){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(0>n?"e":"e+")+n}function l(e,n){var t,r;if(0>n){for(r="0.";++n;r+="0");e=r+e}else if(t=e.length,++n>t){for(r="0",n-=t;--n;r+="0");e+=r}else t>n&&(e=e.slice(0,n)+"."+e.slice(n));return e}function c(e){return e=parseFloat(e),0>e?p(e):d(e)}var a,h,g=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,p=Math.ceil,d=Math.floor,m=" not a boolean or binary digit",w="rounding mode",v="number type has more than 15 significant digits",N="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",b=1e14,O=14,y=9007199254740991,S=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],R=1e7,A=1e9;if("undefined"!=typeof crypto&&(a=crypto),"function"==typeof define&&define.amd)define(function(){return n()});else if("undefined"!=typeof module&&module.exports){if(module.exports=n(),!a)try{a=require("crypto")}catch(E){}}else e||(e="undefined"!=typeof self?self:Function("return this")()),e.BigNumber=n()}(this);
    /* jshint ignore:end */
  
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["bigdecimal"] = function(Opal) {
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  function $rb_ge(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);
  }
  function $rb_divide(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs / rhs : lhs['$/'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$require', '$===', '$attr_reader', '$new', '$class', '$bignumber', '$nan?', '$==', '$raise', '$<', '$coerce', '$>', '$mode', '$>=', '$/', '$zero?', '$infinite?', '$finite?']);
  
  (function($base, $super, $parent_nesting) {
    function $BigDecimal(){};
    var self = $BigDecimal = $klass($base, $super, 'BigDecimal', $BigDecimal);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    return nil
  })($nesting[0], Opal.const_get_relative($nesting, 'Numeric'), $nesting);
  self.$require("js");
  self.$require("bigdecimal/kernel");
  self.$require("bigdecimal/bignumber.js");
  return (function($base, $super, $parent_nesting) {
    function $BigDecimal(){};
    var self = $BigDecimal = $klass($base, $super, 'BigDecimal', $BigDecimal);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_BigDecimal_limit_1, TMP_BigDecimal_mode_2, TMP_BigDecimal_initialize_3, TMP_BigDecimal_$eq$eq_4, TMP_BigDecimal_$lt$eq$gt_5, TMP_BigDecimal_$lt_6, TMP_BigDecimal_$lt$eq_7, TMP_BigDecimal_$gt_8, TMP_BigDecimal_$gt$eq_9, TMP_BigDecimal_abs_10, TMP_BigDecimal_add_11, TMP_BigDecimal_ceil_12, TMP_BigDecimal_coerce_13, TMP_BigDecimal_div_14, TMP_BigDecimal_finite$q_15, TMP_BigDecimal_infinite$q_16, TMP_BigDecimal_minus_17, TMP_BigDecimal_mult_18, TMP_BigDecimal_nan$q_19, TMP_BigDecimal_quo_20, TMP_BigDecimal_sign_21, TMP_BigDecimal_sub_22, TMP_BigDecimal_to_f_23, TMP_BigDecimal_to_s_24, TMP_BigDecimal_zero$q_25;

    
    Opal.const_set($nesting[0], 'ROUND_MODE', 256);
    Opal.const_set($nesting[0], 'ROUND_UP', 0);
    Opal.const_set($nesting[0], 'ROUND_DOWN', 1);
    Opal.const_set($nesting[0], 'ROUND_CEILING', 2);
    Opal.const_set($nesting[0], 'ROUND_FLOOR', 3);
    Opal.const_set($nesting[0], 'ROUND_HALF_UP', 4);
    Opal.const_set($nesting[0], 'ROUND_HALF_DOWN', 5);
    Opal.const_set($nesting[0], 'ROUND_HALF_EVEN', 6);
    Opal.const_set($nesting[0], 'SIGN_NaN', 0);
    Opal.const_set($nesting[0], 'SIGN_POSITIVE_ZERO', 1);
    Opal.const_set($nesting[0], 'SIGN_NEGATIVE_ZERO', -1);
    Opal.const_set($nesting[0], 'SIGN_POSITIVE_FINITE', 2);
    Opal.const_set($nesting[0], 'SIGN_NEGATIVE_FINITE', -2);
    Opal.const_set($nesting[0], 'SIGN_POSITIVE_INFINITE', 3);
    Opal.const_set($nesting[0], 'SIGN_NEGATIVE_INFINITE', -3);
    Opal.defs(self, '$limit', TMP_BigDecimal_limit_1 = function $$limit(digits) {
      var self = this;
      if (self.digits == null) self.digits = nil;

      if (digits == null) {
        digits = nil;
      }
      
      if ($truthy(digits)) {
        self.digits = digits};
      return self.digits;
    }, TMP_BigDecimal_limit_1.$$arity = -1);
    Opal.defs(self, '$mode', TMP_BigDecimal_mode_2 = function $$mode(mode, value) {
      var $a, self = this, $case = nil;
      if (self.round_mode == null) self.round_mode = nil;

      if (value == null) {
        value = nil;
      }
      return (function() {$case = mode;
      if (Opal.const_get_relative($nesting, 'ROUND_MODE')['$===']($case)) {
      if ($truthy(value)) {
        self.round_mode = value};
      return ($truthy($a = self.round_mode) ? $a : Opal.const_get_relative($nesting, 'ROUND_HALF_UP'));}
      else { return nil }})()
    }, TMP_BigDecimal_mode_2.$$arity = -2);
    self.$attr_reader("bignumber");
    
    Opal.defn(self, '$initialize', TMP_BigDecimal_initialize_3 = function $$initialize(initial, digits) {
      var self = this;

      if (digits == null) {
        digits = 0;
      }
      return (self.bignumber = Opal.const_get_relative($nesting, 'JS').$new(Opal.const_get_relative($nesting, 'BigNumber'), initial))
    }, TMP_BigDecimal_initialize_3.$$arity = -2);
    
    Opal.defn(self, '$==', TMP_BigDecimal_$eq$eq_4 = function(other) {
      var self = this, $case = nil;

      return (function() {$case = other;
      if (self.$class()['$===']($case)) {return self.$bignumber().equals(other.$bignumber())}
      else if (Opal.const_get_relative($nesting, 'Number')['$===']($case)) {return self.$bignumber().equals(other)}
      else {return false}})()
    }, TMP_BigDecimal_$eq$eq_4.$$arity = 1);
    Opal.alias(self, "===", "==");
    
    Opal.defn(self, '$<=>', TMP_BigDecimal_$lt$eq$gt_5 = function(other) {
      var self = this, $case = nil, result = nil;

      
      $case = other;
      if (self.$class()['$===']($case)) {result = self.$bignumber().comparedTo(other.$bignumber())}
      else if (Opal.const_get_relative($nesting, 'Number')['$===']($case)) {result = self.$bignumber().comparedTo(other)}
      else {result = nil};
      return result === null ? nil : result;
    }, TMP_BigDecimal_$lt$eq$gt_5.$$arity = 1);
    
    Opal.defn(self, '$<', TMP_BigDecimal_$lt_6 = function(other) {
      var $a, $b, self = this, $iter = TMP_BigDecimal_$lt_6.$$p, $yield = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

      if ($iter) TMP_BigDecimal_$lt_6.$$p = null;
      // Prepare super implicit arguments
      for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
        $zuper[$zuper_i] = arguments[$zuper_i];
      }
      
      if ($truthy(($truthy($a = self['$nan?']()) ? $a : ($truthy($b = other) ? other['$nan?']() : $b)))) {
        return false};
      return $send(self, Opal.find_super_dispatcher(self, '<', TMP_BigDecimal_$lt_6, false), $zuper, $iter);
    }, TMP_BigDecimal_$lt_6.$$arity = 1);
    
    Opal.defn(self, '$<=', TMP_BigDecimal_$lt$eq_7 = function(other) {
      var $a, $b, self = this, $iter = TMP_BigDecimal_$lt$eq_7.$$p, $yield = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

      if ($iter) TMP_BigDecimal_$lt$eq_7.$$p = null;
      // Prepare super implicit arguments
      for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
        $zuper[$zuper_i] = arguments[$zuper_i];
      }
      
      if ($truthy(($truthy($a = self['$nan?']()) ? $a : ($truthy($b = other) ? other['$nan?']() : $b)))) {
        return false};
      return $send(self, Opal.find_super_dispatcher(self, '<=', TMP_BigDecimal_$lt$eq_7, false), $zuper, $iter);
    }, TMP_BigDecimal_$lt$eq_7.$$arity = 1);
    
    Opal.defn(self, '$>', TMP_BigDecimal_$gt_8 = function(other) {
      var $a, $b, self = this, $iter = TMP_BigDecimal_$gt_8.$$p, $yield = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

      if ($iter) TMP_BigDecimal_$gt_8.$$p = null;
      // Prepare super implicit arguments
      for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
        $zuper[$zuper_i] = arguments[$zuper_i];
      }
      
      if ($truthy(($truthy($a = self['$nan?']()) ? $a : ($truthy($b = other) ? other['$nan?']() : $b)))) {
        return false};
      return $send(self, Opal.find_super_dispatcher(self, '>', TMP_BigDecimal_$gt_8, false), $zuper, $iter);
    }, TMP_BigDecimal_$gt_8.$$arity = 1);
    
    Opal.defn(self, '$>=', TMP_BigDecimal_$gt$eq_9 = function(other) {
      var $a, $b, self = this, $iter = TMP_BigDecimal_$gt$eq_9.$$p, $yield = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

      if ($iter) TMP_BigDecimal_$gt$eq_9.$$p = null;
      // Prepare super implicit arguments
      for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
        $zuper[$zuper_i] = arguments[$zuper_i];
      }
      
      if ($truthy(($truthy($a = self['$nan?']()) ? $a : ($truthy($b = other) ? other['$nan?']() : $b)))) {
        return false};
      return $send(self, Opal.find_super_dispatcher(self, '>=', TMP_BigDecimal_$gt$eq_9, false), $zuper, $iter);
    }, TMP_BigDecimal_$gt$eq_9.$$arity = 1);
    
    Opal.defn(self, '$abs', TMP_BigDecimal_abs_10 = function $$abs() {
      var self = this;

      return self.$class().$new(self.$bignumber().abs())
    }, TMP_BigDecimal_abs_10.$$arity = 0);
    
    Opal.defn(self, '$add', TMP_BigDecimal_add_11 = function $$add(other, digits) {
      var $a, $b, self = this, _ = nil, result = nil;

      if (digits == null) {
        digits = 0;
      }
      
      if (digits['$=='](nil)) {
        self.$raise(Opal.const_get_relative($nesting, 'TypeError'), "wrong argument type nil (expected Fixnum)")};
      if ($truthy($rb_lt(digits, 0))) {
        self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "argument must be positive")};
      $b = self.$coerce(other), $a = Opal.to_ary($b), (other = ($a[0] == null ? nil : $a[0])), (_ = ($a[1] == null ? nil : $a[1])), $b;
      result = self.$bignumber().plus(other.$bignumber());
      if ($truthy($rb_gt(digits, 0))) {
        result = result.toDigits(digits, self.$class().$mode(Opal.const_get_relative($nesting, 'ROUND_MODE')))};
      return self.$class().$new(result);
    }, TMP_BigDecimal_add_11.$$arity = -2);
    Opal.alias(self, "+", "add");
    
    Opal.defn(self, '$ceil', TMP_BigDecimal_ceil_12 = function $$ceil(n) {
      var self = this;

      if (n == null) {
        n = nil;
      }
      
      if ($truthy(self.$bignumber().isFinite())) {
        } else {
        self.$raise(Opal.const_get_relative($nesting, 'FloatDomainError'), "Computation results to 'Infinity'")
      };
      if (n['$=='](nil)) {
        return self.$bignumber().round(0, Opal.const_get_relative($nesting, 'ROUND_CEILING')).toNumber()
      } else if ($truthy($rb_ge(n, 0))) {
        return self.$class().$new(self.$bignumber().round(n, Opal.const_get_relative($nesting, 'ROUND_CEILING')))
        } else {
        return self.$class().$new(self.$bignumber().round(0, Opal.const_get_relative($nesting, 'ROUND_CEILING')))
      };
    }, TMP_BigDecimal_ceil_12.$$arity = -1);
    
    Opal.defn(self, '$coerce', TMP_BigDecimal_coerce_13 = function $$coerce(other) {
      var self = this, $case = nil;

      return (function() {$case = other;
      if (self.$class()['$===']($case)) {return [other, self]}
      else if (Opal.const_get_relative($nesting, 'Number')['$===']($case)) {return [self.$class().$new(other), self]}
      else {return self.$raise(Opal.const_get_relative($nesting, 'TypeError'), "" + (other.$class()) + " can't be coerced into " + (self.$class()))}})()
    }, TMP_BigDecimal_coerce_13.$$arity = 1);
    
    Opal.defn(self, '$div', TMP_BigDecimal_div_14 = function $$div(other, digits) {
      var $a, $b, self = this, _ = nil;

      if (digits == null) {
        digits = nil;
      }
      
      if (digits['$=='](0)) {
        return $rb_divide(self, other)};
      $b = self.$coerce(other), $a = Opal.to_ary($b), (other = ($a[0] == null ? nil : $a[0])), (_ = ($a[1] == null ? nil : $a[1])), $b;
      if ($truthy(($truthy($a = self['$nan?']()) ? $a : other['$nan?']()))) {
        self.$raise(Opal.const_get_relative($nesting, 'FloatDomainError'), "Computation results to 'NaN'(Not a Number)")};
      if (digits['$=='](nil)) {
        
        if ($truthy(other['$zero?']())) {
          self.$raise(Opal.const_get_relative($nesting, 'ZeroDivisionError'), "divided by 0")};
        if ($truthy(self['$infinite?']())) {
          self.$raise(Opal.const_get_relative($nesting, 'FloatDomainError'), "Computation results to 'Infinity'")};
        return self.$class().$new(self.$bignumber().dividedToIntegerBy(other.$bignumber()));};
      return self.$class().$new(self.$bignumber().dividedBy(other.$bignumber()).round(digits, self.$class().$mode(Opal.const_get_relative($nesting, 'ROUND_MODE'))));
    }, TMP_BigDecimal_div_14.$$arity = -2);
    
    Opal.defn(self, '$finite?', TMP_BigDecimal_finite$q_15 = function() {
      var self = this;

      return self.$bignumber().isFinite()
    }, TMP_BigDecimal_finite$q_15.$$arity = 0);
    
    Opal.defn(self, '$infinite?', TMP_BigDecimal_infinite$q_16 = function() {
      var $a, self = this;

      
      if ($truthy(($truthy($a = self['$finite?']()) ? $a : self['$nan?']()))) {
        return nil};
      if ($truthy(self.$bignumber().isNegative())) {
        return -1
        } else {
        return 1
      };
    }, TMP_BigDecimal_infinite$q_16.$$arity = 0);
    
    Opal.defn(self, '$minus', TMP_BigDecimal_minus_17 = function $$minus(other) {
      var $a, $b, self = this, _ = nil;

      
      $b = self.$coerce(other), $a = Opal.to_ary($b), (other = ($a[0] == null ? nil : $a[0])), (_ = ($a[1] == null ? nil : $a[1])), $b;
      return self.$class().$new(self.$bignumber().minus(other.$bignumber()));
    }, TMP_BigDecimal_minus_17.$$arity = 1);
    Opal.alias(self, "-", "minus");
    
    Opal.defn(self, '$mult', TMP_BigDecimal_mult_18 = function $$mult(other, digits) {
      var $a, $b, self = this, _ = nil;

      if (digits == null) {
        digits = nil;
      }
      
      $b = self.$coerce(other), $a = Opal.to_ary($b), (other = ($a[0] == null ? nil : $a[0])), (_ = ($a[1] == null ? nil : $a[1])), $b;
      if (digits['$=='](nil)) {
        return self.$class().$new(self.$bignumber().times(other.$bignumber()))};
      return self.$class().$new(self.$bignumber().times(other.$bignumber()).round(digits, self.$class().$mode(Opal.const_get_relative($nesting, 'ROUND_MODE'))));
    }, TMP_BigDecimal_mult_18.$$arity = -2);
    Opal.alias(self, "*", "mult");
    
    Opal.defn(self, '$nan?', TMP_BigDecimal_nan$q_19 = function() {
      var self = this;

      return self.$bignumber().isNaN()
    }, TMP_BigDecimal_nan$q_19.$$arity = 0);
    
    Opal.defn(self, '$quo', TMP_BigDecimal_quo_20 = function $$quo(other) {
      var $a, $b, self = this, _ = nil;

      
      $b = self.$coerce(other), $a = Opal.to_ary($b), (other = ($a[0] == null ? nil : $a[0])), (_ = ($a[1] == null ? nil : $a[1])), $b;
      return self.$class().$new(self.$bignumber().dividedBy(other.$bignumber()));
    }, TMP_BigDecimal_quo_20.$$arity = 1);
    Opal.alias(self, "/", "quo");
    
    Opal.defn(self, '$sign', TMP_BigDecimal_sign_21 = function $$sign() {
      var self = this;

      
      if ($truthy(self.$bignumber().isNaN())) {
        return Opal.const_get_relative($nesting, 'SIGN_NaN')};
      if ($truthy(self.$bignumber().isZero())) {
        return (function() {if ($truthy(self.$bignumber().isNegative())) {
          return Opal.const_get_relative($nesting, 'SIGN_NEGATIVE_ZERO')
          } else {
          return Opal.const_get_relative($nesting, 'SIGN_POSITIVE_ZERO')
        }; return nil; })()
        } else {
        return nil
      };
    }, TMP_BigDecimal_sign_21.$$arity = 0);
    
    Opal.defn(self, '$sub', TMP_BigDecimal_sub_22 = function $$sub(other, precision) {
      var $a, $b, self = this, _ = nil;

      
      $b = self.$coerce(other), $a = Opal.to_ary($b), (other = ($a[0] == null ? nil : $a[0])), (_ = ($a[1] == null ? nil : $a[1])), $b;
      return self.$class().$new(self.$bignumber().minus(other.$bignumber()));
    }, TMP_BigDecimal_sub_22.$$arity = 2);
    
    Opal.defn(self, '$to_f', TMP_BigDecimal_to_f_23 = function $$to_f() {
      var self = this;

      return self.$bignumber().toNumber()
    }, TMP_BigDecimal_to_f_23.$$arity = 0);
    
    Opal.defn(self, '$to_s', TMP_BigDecimal_to_s_24 = function $$to_s(s) {
      var self = this;

      if (s == null) {
        s = "";
      }
      return self.$bignumber().toString()
    }, TMP_BigDecimal_to_s_24.$$arity = -1);
    return (Opal.defn(self, '$zero?', TMP_BigDecimal_zero$q_25 = function() {
      var self = this;

      return self.$bignumber().isZero()
    }, TMP_BigDecimal_zero$q_25.$$arity = 0), nil) && 'zero?';
  })($nesting[0], null, $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/version"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module;

  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    Opal.const_set($nesting[0], 'VERSION', "0.9.0")
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/exception"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send;

  Opal.add_stubs(['$attr_accessor', '$errors=', '$-', '$join', '$message_list', '$errors']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $ValidationException(){};
      var self = $ValidationException = $klass($base, $super, 'ValidationException', $ValidationException);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ValidationException_initialize_1, TMP_ValidationException_to_s_2;

      
      self.$attr_accessor("errors");
      
      Opal.defn(self, '$initialize', TMP_ValidationException_initialize_1 = function $$initialize(errors) {
        var self = this, $writer = nil;

        
        $writer = [errors];
        $send(self, 'errors=', Opal.to_a($writer));
        return $writer[$rb_minus($writer["length"], 1)];
      }, TMP_ValidationException_initialize_1.$$arity = 1);
      return (Opal.defn(self, '$to_s', TMP_ValidationException_to_s_2 = function $$to_s() {
        var self = this;

        return "" + (self.$errors().$message_list().$join("; "))
      }, TMP_ValidationException_to_s_2.$$arity = 0), nil) && 'to_s';
    })($nesting[0], Opal.const_get_qualified('::', 'StandardError'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/errors"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$tap', '$new', '$merge!', '$[]', '$titleize', '$downcase', '$to_s', '$==', '$end_with?', '$message', '$error_message_creator', '$Array', '$each', '$symbolic', '$[]=', '$-', '$concat', '$message_list', '$map', '$flatten', '$compact']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    
    (function($base, $super, $parent_nesting) {
      function $DefaultErrorMessageCreator(){};
      var self = $DefaultErrorMessageCreator = $klass($base, $super, 'DefaultErrorMessageCreator', $DefaultErrorMessageCreator);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_DefaultErrorMessageCreator_1, TMP_DefaultErrorMessageCreator_message_2, TMP_DefaultErrorMessageCreator_titleize_3;

      
      Opal.const_set($nesting[0], 'MESSAGES', $send(Opal.const_get_relative($nesting, 'Hash').$new("is invalid"), 'tap', [], (TMP_DefaultErrorMessageCreator_1 = function(h){var self = TMP_DefaultErrorMessageCreator_1.$$s || this;
if (h == null) h = nil;
      return h['$merge!']($hash2(["nils", "required", "string", "integer", "boolean", "hash", "array", "model", "date", "before", "after", "empty", "max_length", "min_length", "matches", "in", "class", "min", "max", "new_records"], {"nils": "can't be nil", "required": "is required", "string": "isn't a string", "integer": "isn't an integer", "boolean": "isn't a boolean", "hash": "isn't a hash", "array": "isn't an array", "model": "isn't the right class", "date": "date doesn't exist", "before": "isn't before given date", "after": "isn't after given date", "empty": "can't be blank", "max_length": "is too long", "min_length": "is too short", "matches": "isn't in the right format", "in": "isn't an option", "class": "isn't the right class", "min": "is too small", "max": "is too big", "new_records": "isn't a saved model"}))}, TMP_DefaultErrorMessageCreator_1.$$s = self, TMP_DefaultErrorMessageCreator_1.$$arity = 1, TMP_DefaultErrorMessageCreator_1)));
      
      Opal.defn(self, '$message', TMP_DefaultErrorMessageCreator_message_2 = function $$message(key, error_symbol, options) {
        var $a, self = this;

        if (options == null) {
          options = $hash2([], {});
        }
        if ($truthy(options['$[]']("index"))) {
          return "" + (self.$titleize(($truthy($a = key) ? $a : "array"))) + "[" + (options['$[]']("index")) + "] " + (Opal.const_get_relative($nesting, 'MESSAGES')['$[]'](error_symbol))
          } else {
          return "" + (self.$titleize(key)) + " " + (Opal.const_get_relative($nesting, 'MESSAGES')['$[]'](error_symbol))
        }
      }, TMP_DefaultErrorMessageCreator_message_2.$$arity = -3);
      return (Opal.defn(self, '$titleize', TMP_DefaultErrorMessageCreator_titleize_3 = function $$titleize(key) {
        var self = this;

        
        key = key.$to_s().$downcase();
        if (key['$==']("id")) {
          return "ID"
        } else if ($truthy(key['$end_with?']("_id"))) {
          return "" + (key.$titleize()) + " ID"
          } else {
          return key.$titleize()
        };
      }, TMP_DefaultErrorMessageCreator_titleize_3.$$arity = 1), nil) && 'titleize';
    })($nesting[0], null, $nesting);
    (function($base, $super, $parent_nesting) {
      function $ErrorAtom(){};
      var self = $ErrorAtom = $klass($base, $super, 'ErrorAtom', $ErrorAtom);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ErrorAtom_initialize_4, TMP_ErrorAtom_symbolic_5, TMP_ErrorAtom_message_6, TMP_ErrorAtom_message_list_7;

      def.symbol = def.message = def.key = def.index = nil;
      
      
      Opal.defn(self, '$initialize', TMP_ErrorAtom_initialize_4 = function $$initialize(key, error_symbol, options) {
        var self = this;

        if (options == null) {
          options = $hash2([], {});
        }
        
        self.key = key;
        self.symbol = error_symbol;
        self.message = options['$[]']("message");
        return (self.index = options['$[]']("index"));
      }, TMP_ErrorAtom_initialize_4.$$arity = -3);
      
      Opal.defn(self, '$symbolic', TMP_ErrorAtom_symbolic_5 = function $$symbolic() {
        var self = this;

        return self.symbol
      }, TMP_ErrorAtom_symbolic_5.$$arity = 0);
      
      Opal.defn(self, '$message', TMP_ErrorAtom_message_6 = function $$message() {
        var $a, self = this;

        return (self.message = ($truthy($a = self.message) ? $a : Opal.const_get_relative($nesting, 'Mutations').$error_message_creator().$message(self.key, self.symbol, $hash2(["index"], {"index": self.index}))))
      }, TMP_ErrorAtom_message_6.$$arity = 0);
      return (Opal.defn(self, '$message_list', TMP_ErrorAtom_message_list_7 = function $$message_list() {
        var self = this;

        return self.$Array(self.$message())
      }, TMP_ErrorAtom_message_list_7.$$arity = 0), nil) && 'message_list';
    })($nesting[0], null, $nesting);
    (function($base, $super, $parent_nesting) {
      function $ErrorHash(){};
      var self = $ErrorHash = $klass($base, $super, 'ErrorHash', $ErrorHash);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ErrorHash_symbolic_10, TMP_ErrorHash_message_13, TMP_ErrorHash_message_list_15;

      
      
      Opal.defn(self, '$symbolic', TMP_ErrorHash_symbolic_10 = function $$symbolic() {
        var TMP_8, self = this;

        return $send(Opal.const_get_relative($nesting, 'HashWithIndifferentAccess').$new(), 'tap', [], (TMP_8 = function(hash){var self = TMP_8.$$s || this, TMP_9;
if (hash == null) hash = nil;
        return $send(self, 'each', [], (TMP_9 = function(k, v){var self = TMP_9.$$s || this, $writer = nil;
if (k == null) k = nil;if (v == null) v = nil;
          
            $writer = [k, v.$symbolic()];
            $send(hash, '[]=', Opal.to_a($writer));
            return $writer[$rb_minus($writer["length"], 1)];}, TMP_9.$$s = self, TMP_9.$$arity = 2, TMP_9))}, TMP_8.$$s = self, TMP_8.$$arity = 1, TMP_8))
      }, TMP_ErrorHash_symbolic_10.$$arity = 0);
      
      Opal.defn(self, '$message', TMP_ErrorHash_message_13 = function $$message() {
        var TMP_11, self = this;

        return $send(Opal.const_get_relative($nesting, 'HashWithIndifferentAccess').$new(), 'tap', [], (TMP_11 = function(hash){var self = TMP_11.$$s || this, TMP_12;
if (hash == null) hash = nil;
        return $send(self, 'each', [], (TMP_12 = function(k, v){var self = TMP_12.$$s || this, $writer = nil;
if (k == null) k = nil;if (v == null) v = nil;
          
            $writer = [k, v.$message()];
            $send(hash, '[]=', Opal.to_a($writer));
            return $writer[$rb_minus($writer["length"], 1)];}, TMP_12.$$s = self, TMP_12.$$arity = 2, TMP_12))}, TMP_11.$$s = self, TMP_11.$$arity = 1, TMP_11))
      }, TMP_ErrorHash_message_13.$$arity = 0);
      return (Opal.defn(self, '$message_list', TMP_ErrorHash_message_list_15 = function $$message_list() {
        var TMP_14, self = this, list = nil;

        
        list = [];
        $send(self, 'each', [], (TMP_14 = function(k, v){var self = TMP_14.$$s || this;
if (k == null) k = nil;if (v == null) v = nil;
        return list.$concat(v.$message_list())}, TMP_14.$$s = self, TMP_14.$$arity = 2, TMP_14));
        return list;
      }, TMP_ErrorHash_message_list_15.$$arity = 0), nil) && 'message_list';
    })($nesting[0], Opal.const_get_relative($nesting, 'Hash'), $nesting);
    (function($base, $super, $parent_nesting) {
      function $ErrorArray(){};
      var self = $ErrorArray = $klass($base, $super, 'ErrorArray', $ErrorArray);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ErrorArray_symbolic_17, TMP_ErrorArray_message_19, TMP_ErrorArray_message_list_21;

      
      
      Opal.defn(self, '$symbolic', TMP_ErrorArray_symbolic_17 = function $$symbolic() {
        var TMP_16, self = this;

        return $send(self, 'map', [], (TMP_16 = function(e){var self = TMP_16.$$s || this, $a;
if (e == null) e = nil;
        return ($truthy($a = e) ? e.$symbolic() : $a)}, TMP_16.$$s = self, TMP_16.$$arity = 1, TMP_16))
      }, TMP_ErrorArray_symbolic_17.$$arity = 0);
      
      Opal.defn(self, '$message', TMP_ErrorArray_message_19 = function $$message() {
        var TMP_18, self = this;

        return $send(self, 'map', [], (TMP_18 = function(e){var self = TMP_18.$$s || this, $a;
if (e == null) e = nil;
        return ($truthy($a = e) ? e.$message() : $a)}, TMP_18.$$s = self, TMP_18.$$arity = 1, TMP_18))
      }, TMP_ErrorArray_message_19.$$arity = 0);
      return (Opal.defn(self, '$message_list', TMP_ErrorArray_message_list_21 = function $$message_list() {
        var TMP_20, self = this;

        return $send(self.$compact(), 'map', [], (TMP_20 = function(e){var self = TMP_20.$$s || this;
if (e == null) e = nil;
        return e.$message_list()}, TMP_20.$$s = self, TMP_20.$$arity = 1, TMP_20)).$flatten()
      }, TMP_ErrorArray_message_list_21.$$arity = 0), nil) && 'message_list';
    })($nesting[0], Opal.const_get_relative($nesting, 'Array'), $nesting);
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/input_filter"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $hash2 = Opal.hash2, $send = Opal.send;

  Opal.add_stubs(['$attr_accessor', '$merge', '$default_options', '$class', '$options=', '$-', '$has_key?', '$options', '$[]', '$!']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $InputFilter(){};
      var self = $InputFilter = $klass($base, $super, 'InputFilter', $InputFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_InputFilter_default_options_1, TMP_InputFilter_initialize_2, TMP_InputFilter_filter_3, TMP_InputFilter_has_default$q_4, TMP_InputFilter_default_5, TMP_InputFilter_discard_nils$q_6, TMP_InputFilter_discard_empty$q_7, TMP_InputFilter_discard_invalid$q_8;

      
      Opal.defs(self, '$default_options', TMP_InputFilter_default_options_1 = function $$default_options() {
        var $a, self = this;
        if (self.default_options == null) self.default_options = nil;

        return (self.default_options = ($truthy($a = self.default_options) ? $a : $hash2([], {})))
      }, TMP_InputFilter_default_options_1.$$arity = 0);
      self.$attr_accessor("options");
      
      Opal.defn(self, '$initialize', TMP_InputFilter_initialize_2 = function $$initialize(opts) {
        var $a, self = this, $writer = nil;

        if (opts == null) {
          opts = $hash2([], {});
        }
        
        $writer = [($truthy($a = self.$class().$default_options()) ? $a : $hash2([], {})).$merge(opts)];
        $send(self, 'options=', Opal.to_a($writer));
        return $writer[$rb_minus($writer["length"], 1)];
      }, TMP_InputFilter_initialize_2.$$arity = -1);
      
      Opal.defn(self, '$filter', TMP_InputFilter_filter_3 = function $$filter(data) {
        var self = this;

        return [data, nil]
      }, TMP_InputFilter_filter_3.$$arity = 1);
      
      Opal.defn(self, '$has_default?', TMP_InputFilter_has_default$q_4 = function() {
        var self = this;

        return self.$options()['$has_key?']("default")
      }, TMP_InputFilter_has_default$q_4.$$arity = 0);
      
      Opal.defn(self, '$default', TMP_InputFilter_default_5 = function() {
        var self = this;

        return self.$options()['$[]']("default")
      }, TMP_InputFilter_default_5.$$arity = 0);
      
      Opal.defn(self, '$discard_nils?', TMP_InputFilter_discard_nils$q_6 = function() {
        var self = this;

        return self.$options()['$[]']("nils")['$!']()
      }, TMP_InputFilter_discard_nils$q_6.$$arity = 0);
      
      Opal.defn(self, '$discard_empty?', TMP_InputFilter_discard_empty$q_7 = function() {
        var self = this;

        return self.$options()['$[]']("discard_empty")
      }, TMP_InputFilter_discard_empty$q_7.$$arity = 0);
      return (Opal.defn(self, '$discard_invalid?', TMP_InputFilter_discard_invalid$q_8 = function() {
        var self = this;

        return self.$options()['$[]']("discard_invalid")
      }, TMP_InputFilter_discard_invalid$q_8.$$arity = 0), nil) && 'discard_invalid?';
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/hash_filter"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $truthy = Opal.truthy, $hash2 = Opal.hash2;

  Opal.add_stubs(['$define_method', '$[]', '$to_sym', '$new', '$to_proc', '$[]=', '$-', '$attr_accessor', '$instance_eval', '$each_pair', '$optional_inputs', '$required_inputs', '$keys', '$nil?', '$options', '$respond_to?', '$is_a?', '$with_indifferent_access', '$to_hash', '$each', '$==', '$has_key?', '$filter', '$!', '$discard_invalid?', '$delete', '$discard_empty?', '$discard_nils?', '$has_default?', '$default', '$any?']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $HashFilter(){};
      var self = $HashFilter = $klass($base, $super, 'HashFilter', $HashFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_HashFilter_register_additional_filter_2, TMP_HashFilter_initialize_3, TMP_HashFilter_dup_6, TMP_HashFilter_required_7, TMP_HashFilter_optional_8, TMP_HashFilter_required_keys_9, TMP_HashFilter_optional_keys_10, TMP_HashFilter_hash_11, TMP_HashFilter_model_12, TMP_HashFilter_array_13, TMP_HashFilter_filter_17;

      def.required_inputs = def.optional_inputs = def.current_inputs = nil;
      
      Opal.defs(self, '$register_additional_filter', TMP_HashFilter_register_additional_filter_2 = function $$register_additional_filter(type_class, type_name) {
        var TMP_1, self = this;

        return $send(self, 'define_method', [type_name], (TMP_1 = function($a_rest){var self = TMP_1.$$s || this, block, args, $b, name = nil, options = nil, $writer = nil;
          if (self.current_inputs == null) self.current_inputs = nil;

          block = TMP_1.$$p || nil;
          if (block) TMP_1.$$p = null;
          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
        
          name = args['$[]'](0);
          options = ($truthy($b = args['$[]'](1)) ? $b : $hash2([], {}));
          
          $writer = [name.$to_sym(), $send(type_class, 'new', [options], block.$to_proc())];
          $send(self.current_inputs, '[]=', Opal.to_a($writer));
          return $writer[$rb_minus($writer["length"], 1)];;}, TMP_1.$$s = self, TMP_1.$$arity = -1, TMP_1))
      }, TMP_HashFilter_register_additional_filter_2.$$arity = 2);
      self.default_options = $hash2(["nils"], {"nils": false});
      self.$attr_accessor("optional_inputs");
      self.$attr_accessor("required_inputs");
      
      Opal.defn(self, '$initialize', TMP_HashFilter_initialize_3 = function $$initialize(opts) {
        var self = this, $iter = TMP_HashFilter_initialize_3.$$p, block = $iter || nil;

        if (opts == null) {
          opts = $hash2([], {});
        }
        if ($iter) TMP_HashFilter_initialize_3.$$p = null;
        
        $send(self, Opal.find_super_dispatcher(self, 'initialize', TMP_HashFilter_initialize_3, false), [opts], null);
        self.optional_inputs = $hash2([], {});
        self.required_inputs = $hash2([], {});
        self.current_inputs = self.required_inputs;
        if ((block !== nil)) {
          return $send(self, 'instance_eval', [], block.$to_proc())
          } else {
          return nil
        };
      }, TMP_HashFilter_initialize_3.$$arity = -1);
      
      Opal.defn(self, '$dup', TMP_HashFilter_dup_6 = function $$dup() {
        var TMP_4, TMP_5, self = this, dupped = nil;

        
        dupped = Opal.const_get_relative($nesting, 'HashFilter').$new();
        $send(self.optional_inputs, 'each_pair', [], (TMP_4 = function(k, v){var self = TMP_4.$$s || this, $writer = nil;
if (k == null) k = nil;if (v == null) v = nil;
        
          $writer = [k, v];
          $send(dupped.$optional_inputs(), '[]=', Opal.to_a($writer));
          return $writer[$rb_minus($writer["length"], 1)];}, TMP_4.$$s = self, TMP_4.$$arity = 2, TMP_4));
        $send(self.required_inputs, 'each_pair', [], (TMP_5 = function(k, v){var self = TMP_5.$$s || this, $writer = nil;
if (k == null) k = nil;if (v == null) v = nil;
        
          $writer = [k, v];
          $send(dupped.$required_inputs(), '[]=', Opal.to_a($writer));
          return $writer[$rb_minus($writer["length"], 1)];}, TMP_5.$$s = self, TMP_5.$$arity = 2, TMP_5));
        return dupped;
      }, TMP_HashFilter_dup_6.$$arity = 0);
      
      Opal.defn(self, '$required', TMP_HashFilter_required_7 = function $$required() {
        var self = this, $iter = TMP_HashFilter_required_7.$$p, block = $iter || nil;

        if ($iter) TMP_HashFilter_required_7.$$p = null;
        
        self.current_inputs = self.required_inputs;
        return $send(self, 'instance_eval', [], block.$to_proc());
      }, TMP_HashFilter_required_7.$$arity = 0);
      
      Opal.defn(self, '$optional', TMP_HashFilter_optional_8 = function $$optional() {
        var self = this, $iter = TMP_HashFilter_optional_8.$$p, block = $iter || nil;

        if ($iter) TMP_HashFilter_optional_8.$$p = null;
        
        self.current_inputs = self.optional_inputs;
        return $send(self, 'instance_eval', [], block.$to_proc());
      }, TMP_HashFilter_optional_8.$$arity = 0);
      
      Opal.defn(self, '$required_keys', TMP_HashFilter_required_keys_9 = function $$required_keys() {
        var self = this;

        return self.required_inputs.$keys()
      }, TMP_HashFilter_required_keys_9.$$arity = 0);
      
      Opal.defn(self, '$optional_keys', TMP_HashFilter_optional_keys_10 = function $$optional_keys() {
        var self = this;

        return self.optional_inputs.$keys()
      }, TMP_HashFilter_optional_keys_10.$$arity = 0);
      
      Opal.defn(self, '$hash', TMP_HashFilter_hash_11 = function $$hash(name, options) {
        var self = this, $iter = TMP_HashFilter_hash_11.$$p, block = $iter || nil, $writer = nil;

        if (options == null) {
          options = $hash2([], {});
        }
        if ($iter) TMP_HashFilter_hash_11.$$p = null;
        
        $writer = [name.$to_sym(), $send(Opal.const_get_relative($nesting, 'HashFilter'), 'new', [options], block.$to_proc())];
        $send(self.current_inputs, '[]=', Opal.to_a($writer));
        return $writer[$rb_minus($writer["length"], 1)];
      }, TMP_HashFilter_hash_11.$$arity = -2);
      
      Opal.defn(self, '$model', TMP_HashFilter_model_12 = function $$model(name, options) {
        var self = this, $writer = nil;

        if (options == null) {
          options = $hash2([], {});
        }
        
        $writer = [name.$to_sym(), Opal.const_get_relative($nesting, 'ModelFilter').$new(name.$to_sym(), options)];
        $send(self.current_inputs, '[]=', Opal.to_a($writer));
        return $writer[$rb_minus($writer["length"], 1)];
      }, TMP_HashFilter_model_12.$$arity = -2);
      
      Opal.defn(self, '$array', TMP_HashFilter_array_13 = function $$array(name, options) {
        var self = this, $iter = TMP_HashFilter_array_13.$$p, block = $iter || nil, name_sym = nil, $writer = nil;

        if (options == null) {
          options = $hash2([], {});
        }
        if ($iter) TMP_HashFilter_array_13.$$p = null;
        
        name_sym = name.$to_sym();
        
        $writer = [name.$to_sym(), $send(Opal.const_get_relative($nesting, 'ArrayFilter'), 'new', [name_sym, options], block.$to_proc())];
        $send(self.current_inputs, '[]=', Opal.to_a($writer));
        return $writer[$rb_minus($writer["length"], 1)];;
      }, TMP_HashFilter_array_13.$$arity = -2);
      return (Opal.defn(self, '$filter', TMP_HashFilter_filter_17 = function $$filter(data) {
        var TMP_14, TMP_16, self = this, errors = nil, filtered_data = nil, wildcard_filterer = nil, filtered_keys = nil;

        
        if ($truthy(data['$nil?']())) {
          
          if ($truthy(self.$options()['$[]']("nils"))) {
            return [nil, nil]};
          return [nil, "nils"];};
        if ($truthy(data['$respond_to?']("to_hash"))) {
          } else {
          return [data, "hash"]
        };
        if ($truthy(data['$is_a?'](Opal.const_get_relative($nesting, 'HashWithIndifferentAccess')))) {
          } else {
          data = data.$to_hash().$with_indifferent_access()
        };
        errors = Opal.const_get_relative($nesting, 'ErrorHash').$new();
        filtered_data = Opal.const_get_relative($nesting, 'HashWithIndifferentAccess').$new();
        wildcard_filterer = nil;
        $send([[self.required_inputs, true], [self.optional_inputs, false]], 'each', [], (TMP_14 = function($a){var self = TMP_14.$$s || this, $a_args, inputs, is_required, TMP_15;

          if ($a == null) {
            $a = nil;
          }
          $a = Opal.to_ary($a);
          $a_args = Opal.slice.call($a, 0, $a.length);
          inputs = $a_args.splice(0,1)[0];
          if (inputs == null) {
            inputs = nil;
          }
          is_required = $a_args.splice(0,1)[0];
          if (is_required == null) {
            is_required = nil;
          }
        return $send(inputs, 'each_pair', [], (TMP_15 = function(key, filterer){var self = TMP_15.$$s || this, $a, $b, data_element = nil, sub_data = nil, sub_error = nil, $writer = nil, error_key = nil;
if (key == null) key = nil;if (filterer == null) filterer = nil;
          
            if (key['$==']("*")) {
              
              wildcard_filterer = filterer;
              return nil;;};
            data_element = data['$[]'](key);
            if ($truthy(data['$has_key?'](key))) {
              
              $b = filterer.$filter(data_element), $a = Opal.to_ary($b), (sub_data = ($a[0] == null ? nil : $a[0])), (sub_error = ($a[1] == null ? nil : $a[1])), $b;
              if ($truthy(sub_error['$nil?']())) {
                
                $writer = [key, sub_data];
                $send(filtered_data, '[]=', Opal.to_a($writer));
                $writer[$rb_minus($writer["length"], 1)];
              } else if ($truthy(($truthy($a = is_required['$!']()) ? filterer['$discard_invalid?']() : $a))) {
                data.$delete(key)
              } else if ($truthy(($truthy($a = ($truthy($b = is_required['$!']()) ? sub_error['$==']("empty") : $b)) ? filterer['$discard_empty?']() : $a))) {
                data.$delete(key)
              } else if ($truthy(($truthy($a = ($truthy($b = is_required['$!']()) ? sub_error['$==']("nils") : $b)) ? filterer['$discard_nils?']() : $a))) {
                data.$delete(key)
                } else {
                
                error_key = ($truthy($a = filterer.$options()['$[]']("error_key")) ? $a : key);
                if ($truthy(sub_error['$is_a?'](Opal.const_get_relative($nesting, 'Symbol')))) {
                  sub_error = Opal.const_get_relative($nesting, 'ErrorAtom').$new(error_key, sub_error)};
                
                $writer = [key, sub_error];
                $send(errors, '[]=', Opal.to_a($writer));
                $writer[$rb_minus($writer["length"], 1)];;
              };};
            if ($truthy(data['$has_key?'](key)['$!']())) {
              if ($truthy(filterer['$has_default?']())) {
                
                $writer = [key, filterer.$default()];
                $send(filtered_data, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];
              } else if ($truthy(is_required)) {
                
                error_key = ($truthy($a = filterer.$options()['$[]']("error_key")) ? $a : key);
                
                $writer = [key, Opal.const_get_relative($nesting, 'ErrorAtom').$new(error_key, "required")];
                $send(errors, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];;
                } else {
                return nil
              }
              } else {
              return nil
            };}, TMP_15.$$s = self, TMP_15.$$arity = 2, TMP_15))}, TMP_14.$$s = self, TMP_14.$$arity = 1, TMP_14.$$has_top_level_mlhs_arg = true, TMP_14));
        if ($truthy(wildcard_filterer)) {
          
          filtered_keys = $rb_minus(data.$keys(), filtered_data.$keys());
          $send(filtered_keys, 'each', [], (TMP_16 = function(key){var self = TMP_16.$$s || this, $a, $b, data_element = nil, sub_data = nil, sub_error = nil, $writer = nil;
if (key == null) key = nil;
          
            data_element = data['$[]'](key);
            $b = wildcard_filterer.$filter(data_element), $a = Opal.to_ary($b), (sub_data = ($a[0] == null ? nil : $a[0])), (sub_error = ($a[1] == null ? nil : $a[1])), $b;
            if ($truthy(sub_error['$nil?']())) {
              
              $writer = [key, sub_data];
              $send(filtered_data, '[]=', Opal.to_a($writer));
              return $writer[$rb_minus($writer["length"], 1)];
            } else if ($truthy(wildcard_filterer['$discard_invalid?']())) {
              return data.$delete(key)
            } else if ($truthy((($a = sub_error['$==']("empty")) ? wildcard_filterer['$discard_empty?']() : sub_error['$==']("empty")))) {
              return data.$delete(key)
            } else if ($truthy((($a = sub_error['$==']("nils")) ? wildcard_filterer['$discard_nils?']() : sub_error['$==']("nils")))) {
              return data.$delete(key)
              } else {
              
              if ($truthy(sub_error['$is_a?'](Opal.const_get_relative($nesting, 'Symbol')))) {
                sub_error = Opal.const_get_relative($nesting, 'ErrorAtom').$new(key, sub_error)};
              
              $writer = [key, sub_error];
              $send(errors, '[]=', Opal.to_a($writer));
              return $writer[$rb_minus($writer["length"], 1)];;
            };}, TMP_16.$$s = self, TMP_16.$$arity = 1, TMP_16));};
        if ($truthy(errors['$any?']())) {
          return [data, errors]
          } else {
          return [filtered_data, nil]
        };
      }, TMP_HashFilter_filter_17.$$arity = 1), nil) && 'filter';
    })($nesting[0], Opal.const_get_relative($nesting, 'InputFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/array_filter"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $truthy = Opal.truthy, $hash2 = Opal.hash2;

  Opal.add_stubs(['$define_method', '$[]', '$new', '$to_proc', '$instance_eval', '$options', '$raise', '$to_sym', '$is_a?', '$constantize', '$[]=', '$-', '$cache_constants?', '$to_s', '$initialize_constants!', '$nil?', '$!', '$==', '$Array', '$<', '$length', '$>', '$each_with_index', '$filter_element', '$<<', '$discard_invalid?', '$filter']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $ArrayFilter(){};
      var self = $ArrayFilter = $klass($base, $super, 'ArrayFilter', $ArrayFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ArrayFilter_register_additional_filter_2, TMP_ArrayFilter_initialize_3, TMP_ArrayFilter_hash_4, TMP_ArrayFilter_model_5, TMP_ArrayFilter_array_6, TMP_ArrayFilter_initialize_constants$B_7, TMP_ArrayFilter_filter_9, TMP_ArrayFilter_filter_element_10;

      def.element_filter = def.initialize_constants = nil;
      
      Opal.defs(self, '$register_additional_filter', TMP_ArrayFilter_register_additional_filter_2 = function $$register_additional_filter(type_class, type_name) {
        var TMP_1, self = this;

        return $send(self, 'define_method', [type_name], (TMP_1 = function($a_rest){var self = TMP_1.$$s || this, block, args, $b, options = nil;

          block = TMP_1.$$p || nil;
          if (block) TMP_1.$$p = null;
          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
        
          options = ($truthy($b = args['$[]'](0)) ? $b : $hash2([], {}));
          return (self.element_filter = $send(type_class, 'new', [options], block.$to_proc()));}, TMP_1.$$s = self, TMP_1.$$arity = -1, TMP_1))
      }, TMP_ArrayFilter_register_additional_filter_2.$$arity = 2);
      self.default_options = $hash2(["nils", "class", "arrayize", "min_length", "max_length"], {"nils": false, "class": nil, "arrayize": false, "min_length": nil, "max_length": nil});
      
      Opal.defn(self, '$initialize', TMP_ArrayFilter_initialize_3 = function $$initialize(name, opts) {
        var $a, self = this, $iter = TMP_ArrayFilter_initialize_3.$$p, block = $iter || nil;

        if (opts == null) {
          opts = $hash2([], {});
        }
        if ($iter) TMP_ArrayFilter_initialize_3.$$p = null;
        
        $send(self, Opal.find_super_dispatcher(self, 'initialize', TMP_ArrayFilter_initialize_3, false), [opts], null);
        self.name = name;
        self.element_filter = nil;
        if ((block !== nil)) {
          $send(self, 'instance_eval', [], block.$to_proc())};
        if ($truthy(($truthy($a = self.element_filter) ? self.$options()['$[]']("class") : $a))) {
          return self.$raise(Opal.const_get_relative($nesting, 'ArgumentError').$new("Can't supply both a class and a filter"))
          } else {
          return nil
        };
      }, TMP_ArrayFilter_initialize_3.$$arity = -2);
      
      Opal.defn(self, '$hash', TMP_ArrayFilter_hash_4 = function $$hash(options) {
        var self = this, $iter = TMP_ArrayFilter_hash_4.$$p, block = $iter || nil;

        if (options == null) {
          options = $hash2([], {});
        }
        if ($iter) TMP_ArrayFilter_hash_4.$$p = null;
        return (self.element_filter = $send(Opal.const_get_relative($nesting, 'HashFilter'), 'new', [options], block.$to_proc()))
      }, TMP_ArrayFilter_hash_4.$$arity = -1);
      
      Opal.defn(self, '$model', TMP_ArrayFilter_model_5 = function $$model(name, options) {
        var self = this;

        if (options == null) {
          options = $hash2([], {});
        }
        return (self.element_filter = Opal.const_get_relative($nesting, 'ModelFilter').$new(name.$to_sym(), options))
      }, TMP_ArrayFilter_model_5.$$arity = -2);
      
      Opal.defn(self, '$array', TMP_ArrayFilter_array_6 = function $$array(options) {
        var self = this, $iter = TMP_ArrayFilter_array_6.$$p, block = $iter || nil;

        if (options == null) {
          options = $hash2([], {});
        }
        if ($iter) TMP_ArrayFilter_array_6.$$p = null;
        return (self.element_filter = $send(Opal.const_get_relative($nesting, 'ArrayFilter'), 'new', [nil, options], block.$to_proc()))
      }, TMP_ArrayFilter_array_6.$$arity = -1);
      
      Opal.defn(self, '$initialize_constants!', TMP_ArrayFilter_initialize_constants$B_7 = function() {
        var $a, self = this, $writer = nil;

        
        self.initialize_constants = ($truthy($a = self.initialize_constants) ? $a : ((function() {if ($truthy(self.$options()['$[]']("class"))) {
          if ($truthy(self.$options()['$[]']("class")['$is_a?'](Opal.const_get_relative($nesting, 'String')))) {
            
            $writer = ["class", self.$options()['$[]']("class").$constantize()];
            $send(self.$options(), '[]=', Opal.to_a($writer));
            return $writer[$rb_minus($writer["length"], 1)];
            } else {
            return nil
          }
          } else {
          return nil
        }; return nil; })(), true));
        if ($truthy(Opal.const_get_relative($nesting, 'Mutations')['$cache_constants?']())) {
          return nil
        } else if ($truthy(self.$options()['$[]']("class"))) {
          
          $writer = ["class", self.$options()['$[]']("class").$to_s().$constantize()];
          $send(self.$options(), '[]=', Opal.to_a($writer));
          return $writer[$rb_minus($writer["length"], 1)];
          } else {
          return nil
        };
      }, TMP_ArrayFilter_initialize_constants$B_7.$$arity = 0);
      
      Opal.defn(self, '$filter', TMP_ArrayFilter_filter_9 = function $$filter(data) {
        var $a, TMP_8, $b, self = this, errors = nil, filtered_data = nil, found_error = nil;

        
        self['$initialize_constants!']();
        if ($truthy(data['$nil?']())) {
          
          if ($truthy(self.$options()['$[]']("nils"))) {
            return [nil, nil]};
          return [nil, "nils"];};
        if ($truthy(($truthy($a = data['$is_a?'](Opal.const_get_relative($nesting, 'Array'))['$!']()) ? self.$options()['$[]']("arrayize") : $a))) {
          
          if (data['$==']("")) {
            return [[], nil]};
          data = self.$Array(data);};
        if ($truthy(data['$is_a?'](Opal.const_get_relative($nesting, 'Array')))) {
          
          errors = Opal.const_get_relative($nesting, 'ErrorArray').$new();
          filtered_data = [];
          found_error = false;
          if ($truthy(($truthy($a = self.$options()['$[]']("min_length")) ? $rb_lt(data.$length(), self.$options()['$[]']("min_length")) : $a))) {
            return [data, "min_length"]};
          if ($truthy(($truthy($a = self.$options()['$[]']("max_length")) ? $rb_gt(data.$length(), self.$options()['$[]']("max_length")) : $a))) {
            return [data, "max_length"]};
          $send(data, 'each_with_index', [], (TMP_8 = function(el, i){var self = TMP_8.$$s || this, $b, $c, el_filtered = nil, el_error = nil;
            if (self.name == null) self.name = nil;
if (el == null) el = nil;if (i == null) i = nil;
          
            $c = self.$filter_element(el), $b = Opal.to_ary($c), (el_filtered = ($b[0] == null ? nil : $b[0])), (el_error = ($b[1] == null ? nil : $b[1])), $c;
            if ($truthy(el_error['$is_a?'](Opal.const_get_relative($nesting, 'Symbol')))) {
              el_error = Opal.const_get_relative($nesting, 'ErrorAtom').$new(self.name, el_error, $hash2(["index"], {"index": i}))};
            errors['$<<'](el_error);
            if ($truthy(el_error)) {
              return (found_error = true)
              } else {
              return filtered_data['$<<'](el_filtered)
            };}, TMP_8.$$s = self, TMP_8.$$arity = 2, TMP_8));
          if ($truthy(($truthy($a = found_error) ? ($truthy($b = self.element_filter) ? self.element_filter['$discard_invalid?']() : $b)['$!']() : $a))) {
            return [data, errors]
            } else {
            return [filtered_data, nil]
          };
          } else {
          return [data, "array"]
        };
      }, TMP_ArrayFilter_filter_9.$$arity = 1);
      return (Opal.defn(self, '$filter_element', TMP_ArrayFilter_filter_element_10 = function $$filter_element(data) {
        var $a, $b, self = this, el_errors = nil;

        
        if ($truthy(self.element_filter)) {
          
          $b = self.element_filter.$filter(data), $a = Opal.to_ary($b), (data = ($a[0] == null ? nil : $a[0])), (el_errors = ($a[1] == null ? nil : $a[1])), $b;
          if ($truthy(el_errors)) {
            return [data, el_errors]};
        } else if ($truthy(self.$options()['$[]']("class"))) {
          if ($truthy(data['$is_a?'](self.$options()['$[]']("class"))['$!']())) {
            return [data, "class"]}};
        return [data, nil];
      }, TMP_ArrayFilter_filter_element_10.$$arity = 1), nil) && 'filter_element';
    })($nesting[0], Opal.const_get_relative($nesting, 'InputFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/additional_filter"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass;

  Opal.add_stubs(['$require', '$underscore', '$[]', '$name', '$register_additional_filter']);
  
  self.$require("mutations/hash_filter");
  self.$require("mutations/array_filter");
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $AdditionalFilter(){};
      var self = $AdditionalFilter = $klass($base, $super, 'AdditionalFilter', $AdditionalFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_AdditionalFilter_inherited_1;

      return Opal.defs(self, '$inherited', TMP_AdditionalFilter_inherited_1 = function $$inherited(subclass) {
        var self = this, type_name = nil;

        
        type_name = subclass.$name()['$[]'](/^Mutations::([a-zA-Z]*)Filter$/, 1).$underscore();
        Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Mutations'), 'HashFilter').$register_additional_filter(subclass, type_name);
        return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Mutations'), 'ArrayFilter').$register_additional_filter(subclass, type_name);
      }, TMP_AdditionalFilter_inherited_1.$$arity = 1)
    })($nesting[0], Opal.const_get_relative($nesting, 'InputFilter'), $nesting)
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/string_filter"] = function(Opal) {
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$[]', '$options', '$==', '$nil?', '$!', '$any?', '$is_a?', '$to_s', '$gsub', '$strip', '$<', '$length', '$>', '$include?', '$!~']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $StringFilter(){};
      var self = $StringFilter = $klass($base, $super, 'StringFilter', $StringFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_StringFilter_filter_2;

      
      self.default_options = $hash2(["strip", "strict", "nils", "empty_is_nil", "empty", "min_length", "max_length", "matches", "in", "discard_empty", "allow_control_characters"], {"strip": true, "strict": false, "nils": false, "empty_is_nil": false, "empty": false, "min_length": nil, "max_length": nil, "matches": nil, "in": nil, "discard_empty": false, "allow_control_characters": false});
      return (Opal.defn(self, '$filter', TMP_StringFilter_filter_2 = function $$filter(data) {
        var $a, TMP_1, self = this;

        
        if ($truthy(($truthy($a = self.$options()['$[]']("empty_is_nil")) ? data['$==']("") : $a))) {
          data = nil};
        if ($truthy(data['$nil?']())) {
          
          if ($truthy(self.$options()['$[]']("nils"))) {
            return [nil, nil]};
          return [nil, "nils"];};
        if ($truthy(($truthy($a = self.$options()['$[]']("strict")['$!']()) ? $send([Opal.const_get_relative($nesting, 'TrueClass'), Opal.const_get_relative($nesting, 'FalseClass'), Opal.const_get_relative($nesting, 'Integer'), Opal.const_get_relative($nesting, 'Float'), Opal.const_get_relative($nesting, 'BigDecimal'), Opal.const_get_relative($nesting, 'Symbol')], 'any?', [], (TMP_1 = function(klass){var self = TMP_1.$$s || this;
if (klass == null) klass = nil;
        return data['$is_a?'](klass)}, TMP_1.$$s = self, TMP_1.$$arity = 1, TMP_1)) : $a))) {
          data = data.$to_s()};
        if ($truthy(data['$is_a?'](Opal.const_get_relative($nesting, 'String')))) {
          } else {
          return [data, "string"]
        };
        if ($truthy(self.$options()['$[]']("allow_control_characters"))) {
          } else {
          data = data.$gsub(/[^[:print:]\t\r\n]+/, " ")
        };
        if ($truthy(self.$options()['$[]']("strip"))) {
          data = data.$strip()};
        if (data['$==']("")) {
          if ($truthy(self.$options()['$[]']("empty"))) {
            return [data, nil]
            } else {
            return [data, "empty"]
          }};
        if ($truthy(($truthy($a = self.$options()['$[]']("min_length")) ? $rb_lt(data.$length(), self.$options()['$[]']("min_length")) : $a))) {
          return [data, "min_length"]};
        if ($truthy(($truthy($a = self.$options()['$[]']("max_length")) ? $rb_gt(data.$length(), self.$options()['$[]']("max_length")) : $a))) {
          return [data, "max_length"]};
        if ($truthy(($truthy($a = self.$options()['$[]']("in")) ? self.$options()['$[]']("in")['$include?'](data)['$!']() : $a))) {
          return [data, "in"]};
        if ($truthy(($truthy($a = self.$options()['$[]']("matches")) ? self.$options()['$[]']("matches")['$!~'](data) : $a))) {
          return [data, "matches"]};
        return [data, nil];
      }, TMP_StringFilter_filter_2.$$arity = 1), nil) && 'filter';
    })($nesting[0], Opal.const_get_relative($nesting, 'AdditionalFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/integer_filter"] = function(Opal) {
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$[]', '$options', '$==', '$nil?', '$!', '$is_a?', '$=~', '$to_i', '$<', '$>', '$include?']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $IntegerFilter(){};
      var self = $IntegerFilter = $klass($base, $super, 'IntegerFilter', $IntegerFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_IntegerFilter_filter_1;

      
      self.default_options = $hash2(["nils", "empty_is_nil", "min", "max", "in"], {"nils": false, "empty_is_nil": false, "min": nil, "max": nil, "in": nil});
      return (Opal.defn(self, '$filter', TMP_IntegerFilter_filter_1 = function $$filter(data) {
        var $a, self = this;

        
        if ($truthy(($truthy($a = self.$options()['$[]']("empty_is_nil")) ? data['$==']("") : $a))) {
          data = nil};
        if ($truthy(data['$nil?']())) {
          
          if ($truthy(self.$options()['$[]']("nils"))) {
            return [nil, nil]};
          return [nil, "nils"];};
        if (data['$==']("")) {
          return [data, "empty"]};
        if ($truthy(data['$is_a?'](Opal.const_get_relative($nesting, 'Integer'))['$!']())) {
          if ($truthy(($truthy($a = data['$is_a?'](Opal.const_get_relative($nesting, 'String'))) ? data['$=~'](/^-?\d/) : $a))) {
            data = data.$to_i()
            } else {
            return [data, "integer"]
          }};
        if ($truthy(($truthy($a = self.$options()['$[]']("min")) ? $rb_lt(data, self.$options()['$[]']("min")) : $a))) {
          return [data, "min"]};
        if ($truthy(($truthy($a = self.$options()['$[]']("max")) ? $rb_gt(data, self.$options()['$[]']("max")) : $a))) {
          return [data, "max"]};
        if ($truthy(($truthy($a = self.$options()['$[]']("in")) ? self.$options()['$[]']("in")['$include?'](data)['$!']() : $a))) {
          return [data, "in"]};
        return [data, nil];
      }, TMP_IntegerFilter_filter_1.$$arity = 1), nil) && 'filter';
    })($nesting[0], Opal.const_get_relative($nesting, 'AdditionalFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/float_filter"] = function(Opal) {
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$nil?', '$[]', '$options', '$==', '$!', '$is_a?', '$=~', '$to_f', '$<', '$>']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $FloatFilter(){};
      var self = $FloatFilter = $klass($base, $super, 'FloatFilter', $FloatFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_FloatFilter_filter_1;

      
      self.default_options = $hash2(["nils", "min", "max"], {"nils": false, "min": nil, "max": nil});
      return (Opal.defn(self, '$filter', TMP_FloatFilter_filter_1 = function $$filter(data) {
        var $a, self = this;

        
        if ($truthy(data['$nil?']())) {
          
          if ($truthy(self.$options()['$[]']("nils"))) {
            return [nil, nil]};
          return [nil, "nils"];};
        if (data['$==']("")) {
          return [data, "empty"]};
        if ($truthy(data['$is_a?'](Opal.const_get_relative($nesting, 'Float'))['$!']())) {
          if ($truthy(($truthy($a = data['$is_a?'](Opal.const_get_relative($nesting, 'String'))) ? data['$=~'](/^[-+]?\d*\.?\d+/) : $a))) {
            data = data.$to_f()
          } else if ($truthy(data['$is_a?'](Opal.const_get_relative($nesting, 'Integer')))) {
            data = data.$to_f()
            } else {
            return [data, "float"]
          }};
        if ($truthy(($truthy($a = self.$options()['$[]']("min")) ? $rb_lt(data, self.$options()['$[]']("min")) : $a))) {
          return [data, "min"]};
        if ($truthy(($truthy($a = self.$options()['$[]']("max")) ? $rb_gt(data, self.$options()['$[]']("max")) : $a))) {
          return [data, "max"]};
        return [data, nil];
      }, TMP_FloatFilter_filter_1.$$arity = 1), nil) && 'filter';
    })($nesting[0], Opal.const_get_relative($nesting, 'AdditionalFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/boolean_filter"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$nil?', '$[]', '$options', '$==', '$is_a?', '$to_s', '$downcase']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $BooleanFilter(){};
      var self = $BooleanFilter = $klass($base, $super, 'BooleanFilter', $BooleanFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_BooleanFilter_filter_1;

      
      self.default_options = $hash2(["nils"], {"nils": false});
      Opal.const_set($nesting[0], 'BOOL_MAP', $hash2(["true", "1", "false", "0"], {"true": true, "1": true, "false": false, "0": false}));
      return (Opal.defn(self, '$filter', TMP_BooleanFilter_filter_1 = function $$filter(data) {
        var $a, self = this, res = nil;

        
        if ($truthy(data['$nil?']())) {
          
          if ($truthy(self.$options()['$[]']("nils"))) {
            return [nil, nil]};
          return [nil, "nils"];};
        if (data['$==']("")) {
          return [data, "empty"]};
        if ($truthy(($truthy($a = data['$=='](true)) ? $a : data['$=='](false)))) {
          return [data, nil]};
        if ($truthy(data['$is_a?'](Opal.const_get_relative($nesting, 'Integer')))) {
          data = data.$to_s()};
        if ($truthy(data['$is_a?'](Opal.const_get_relative($nesting, 'String')))) {
          
          res = Opal.const_get_relative($nesting, 'BOOL_MAP')['$[]'](data.$downcase());
          if ($truthy(res['$nil?']())) {
            } else {
            return [res, nil]
          };
          return [data, "boolean"];
          } else {
          return [data, "boolean"]
        };
      }, TMP_BooleanFilter_filter_1.$$arity = 1), nil) && 'filter';
    })($nesting[0], Opal.const_get_relative($nesting, 'AdditionalFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/duck_filter"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$nil?', '$[]', '$options', '$each', '$Array', '$respond_to?']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $DuckFilter(){};
      var self = $DuckFilter = $klass($base, $super, 'DuckFilter', $DuckFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_DuckFilter_filter_2;

      
      self.default_options = $hash2(["nils", "methods"], {"nils": false, "methods": nil});
      return (Opal.defn(self, '$filter', TMP_DuckFilter_filter_2 = function $$filter(data) {try {

        var TMP_1, self = this;

        
        if ($truthy(data['$nil?']())) {
          
          if ($truthy(self.$options()['$[]']("nils"))) {
            return [nil, nil]};
          return [nil, "nils"];};
        $send(self.$Array(self.$options()['$[]']("methods")), 'each', [], (TMP_1 = function(method){var self = TMP_1.$$s || this;
if (method == null) method = nil;
        if ($truthy(data['$respond_to?'](method))) {
            return nil
            } else {
            Opal.ret([data, "duck"])
          }}, TMP_1.$$s = self, TMP_1.$$arity = 1, TMP_1));
        return [data, nil];
        } catch ($returner) { if ($returner === Opal.returner) { return $returner.$v } throw $returner; }
      }, TMP_DuckFilter_filter_2.$$arity = 1), nil) && 'filter';
    })($nesting[0], Opal.const_get_relative($nesting, 'AdditionalFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/date_filter"] = function(Opal) {
  function $rb_le(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);
  }
  function $rb_ge(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$[]', '$options', '$==', '$nil?', '$is_a?', '$strptime', '$parse', '$respond_to?', '$to_date', '$<=', '$>=']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $DateFilter(){};
      var self = $DateFilter = $klass($base, $super, 'DateFilter', $DateFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_DateFilter_filter_1;

      
      self.default_options = $hash2(["nils", "empty_is_nil", "format", "after", "before"], {"nils": false, "empty_is_nil": false, "format": nil, "after": nil, "before": nil});
      return (Opal.defn(self, '$filter', TMP_DateFilter_filter_1 = function $$filter(data) {
        var $a, self = this, actual_date = nil;

        
        if ($truthy(($truthy($a = self.$options()['$[]']("empty_is_nil")) ? data['$==']("") : $a))) {
          data = nil};
        if ($truthy(data['$nil?']())) {
          
          if ($truthy(self.$options()['$[]']("nils"))) {
            return [nil, nil]};
          return [nil, "nils"];};
        if (""['$=='](data)) {
          return [data, "empty"]};
        if ($truthy(data['$is_a?'](Opal.const_get_relative($nesting, 'Date')))) {
          actual_date = data
        } else if ($truthy(data['$is_a?'](Opal.const_get_relative($nesting, 'String')))) {
          
          try {
            actual_date = (function() {if ($truthy(self.$options()['$[]']("format"))) {
              return Opal.const_get_relative($nesting, 'Date').$strptime(data, self.$options()['$[]']("format"))
              } else {
              return Opal.const_get_relative($nesting, 'Date').$parse(data)
            }; return nil; })()
          } catch ($err) {
            if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'ArgumentError')])) {
              try {
                return [nil, "date"]
              } finally { Opal.pop_exception() }
            } else { throw $err; }
          };
        } else if ($truthy(data['$respond_to?']("to_date"))) {
          actual_date = data.$to_date()
          } else {
          return [nil, "date"]
        };
        if ($truthy(self.$options()['$[]']("after"))) {
          if ($truthy($rb_le(actual_date, self.$options()['$[]']("after")))) {
            return [nil, "after"]}};
        if ($truthy(self.$options()['$[]']("before"))) {
          if ($truthy($rb_ge(actual_date, self.$options()['$[]']("before")))) {
            return [nil, "before"]}};
        return [actual_date, nil];
      }, TMP_DateFilter_filter_1.$$arity = 1), nil) && 'filter';
    })($nesting[0], Opal.const_get_relative($nesting, 'AdditionalFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/time_filter"] = function(Opal) {
  function $rb_le(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);
  }
  function $rb_ge(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs >= rhs : lhs['$>='](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$nil?', '$[]', '$options', '$==', '$is_a?', '$strptime', '$parse', '$respond_to?', '$to_time', '$<=', '$>=']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $TimeFilter(){};
      var self = $TimeFilter = $klass($base, $super, 'TimeFilter', $TimeFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_TimeFilter_filter_1;

      
      self.default_options = $hash2(["nils", "format", "after", "before"], {"nils": false, "format": nil, "after": nil, "before": nil});
      return (Opal.defn(self, '$filter', TMP_TimeFilter_filter_1 = function $$filter(data) {
        var self = this, actual_time = nil;

        
        if ($truthy(data['$nil?']())) {
          
          if ($truthy(self.$options()['$[]']("nils"))) {
            return [nil, nil]};
          return [nil, "nils"];};
        if (""['$=='](data)) {
          return [data, "empty"]};
        if ($truthy(data['$is_a?'](Opal.const_get_relative($nesting, 'Time')))) {
          actual_time = data
        } else if ($truthy(data['$is_a?'](Opal.const_get_relative($nesting, 'String')))) {
          
          try {
            actual_time = (function() {if ($truthy(self.$options()['$[]']("format"))) {
              return Opal.const_get_relative($nesting, 'Time').$strptime(data, self.$options()['$[]']("format"))
              } else {
              return Opal.const_get_relative($nesting, 'Time').$parse(data)
            }; return nil; })()
          } catch ($err) {
            if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'ArgumentError')])) {
              try {
                return [nil, "time"]
              } finally { Opal.pop_exception() }
            } else { throw $err; }
          };
        } else if ($truthy(data['$respond_to?']("to_time"))) {
          actual_time = data.$to_time()
          } else {
          return [nil, "time"]
        };
        if ($truthy(self.$options()['$[]']("after"))) {
          if ($truthy($rb_le(actual_time, self.$options()['$[]']("after")))) {
            return [nil, "after"]}};
        if ($truthy(self.$options()['$[]']("before"))) {
          if ($truthy($rb_ge(actual_time, self.$options()['$[]']("before")))) {
            return [nil, "before"]}};
        return [actual_time, nil];
      }, TMP_TimeFilter_filter_1.$$arity = 1), nil) && 'filter';
    })($nesting[0], Opal.const_get_relative($nesting, 'AdditionalFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/file_filter"] = function(Opal) {
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$nil?', '$[]', '$options', '$==', '$concat', '$each', '$respond_to?', '$is_a?', '$>', '$size']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $FileFilter(){};
      var self = $FileFilter = $klass($base, $super, 'FileFilter', $FileFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_FileFilter_filter_2;

      
      self.default_options = $hash2(["nils", "upload", "size"], {"nils": false, "upload": false, "size": nil});
      return (Opal.defn(self, '$filter', TMP_FileFilter_filter_2 = function $$filter(data) {try {

        var TMP_1, self = this, methods = nil;

        
        if ($truthy(data['$nil?']())) {
          
          if ($truthy(self.$options()['$[]']("nils"))) {
            return [nil, nil]};
          return [nil, "nils"];};
        if (data['$==']("")) {
          return [data, "empty"]};
        methods = ["read", "size"];
        if ($truthy(self.$options()['$[]']("upload"))) {
          methods.$concat(["original_filename", "content_type"])};
        $send(methods, 'each', [], (TMP_1 = function(method){var self = TMP_1.$$s || this;
if (method == null) method = nil;
        if ($truthy(data['$respond_to?'](method))) {
            return nil
            } else {
            Opal.ret([data, "file"])
          }}, TMP_1.$$s = self, TMP_1.$$arity = 1, TMP_1));
        if ($truthy(self.$options()['$[]']("size")['$is_a?'](Opal.const_get_relative($nesting, 'Integer')))) {
          if ($truthy($rb_gt(data.$size(), self.$options()['$[]']("size")))) {
            return [data, "size"]}};
        return [data, nil];
        } catch ($returner) { if ($returner === Opal.returner) { return $returner.$v } throw $returner; }
      }, TMP_FileFilter_filter_2.$$arity = 1), nil) && 'filter';
    })($nesting[0], Opal.const_get_relative($nesting, 'AdditionalFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/model_filter"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $send = Opal.send, $truthy = Opal.truthy;

  Opal.add_stubs(['$[]', '$options', '$camelize', '$to_s', '$is_a?', '$constantize', '$[]=', '$-', '$cache_constants?', '$initialize_constants!', '$nil?', '$run', '$success?', '$result', '$errors', '$!', '$respond_to?', '$new_record?']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $ModelFilter(){};
      var self = $ModelFilter = $klass($base, $super, 'ModelFilter', $ModelFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ModelFilter_initialize_1, TMP_ModelFilter_initialize_constants$B_2, TMP_ModelFilter_filter_3;

      def.initialize_constants = def.name = nil;
      
      self.default_options = $hash2(["nils", "class", "builder", "new_records"], {"nils": false, "class": nil, "builder": nil, "new_records": false});
      
      Opal.defn(self, '$initialize', TMP_ModelFilter_initialize_1 = function $$initialize(name, opts) {
        var self = this, $iter = TMP_ModelFilter_initialize_1.$$p, $yield = $iter || nil;

        if (opts == null) {
          opts = $hash2([], {});
        }
        if ($iter) TMP_ModelFilter_initialize_1.$$p = null;
        
        $send(self, Opal.find_super_dispatcher(self, 'initialize', TMP_ModelFilter_initialize_1, false), [opts], null);
        return (self.name = name);
      }, TMP_ModelFilter_initialize_1.$$arity = -2);
      
      Opal.defn(self, '$initialize_constants!', TMP_ModelFilter_initialize_constants$B_2 = function() {
        var $a, $b, self = this, class_const = nil, $writer = nil;

        
        self.initialize_constants = ($truthy($a = self.initialize_constants) ? $a : ((class_const = ($truthy($b = self.$options()['$[]']("class")) ? $b : self.name.$to_s().$camelize())), (function() {if ($truthy(class_const['$is_a?'](Opal.const_get_relative($nesting, 'String')))) {
          return (class_const = class_const.$constantize())
          } else {
          return nil
        }; return nil; })(), (($writer = ["class", class_const]), $send(self.$options(), '[]=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]), (function() {if ($truthy(self.$options()['$[]']("builder"))) {
          if ($truthy(self.$options()['$[]']("builder")['$is_a?'](Opal.const_get_relative($nesting, 'String')))) {
            
            $writer = ["builder", self.$options()['$[]']("builder").$constantize()];
            $send(self.$options(), '[]=', Opal.to_a($writer));
            return $writer[$rb_minus($writer["length"], 1)];
            } else {
            return nil
          }
          } else {
          return nil
        }; return nil; })(), true));
        if ($truthy(Opal.const_get_relative($nesting, 'Mutations')['$cache_constants?']())) {
          return nil
          } else {
          
          if ($truthy(self.$options()['$[]']("class"))) {
            
            $writer = ["class", self.$options()['$[]']("class").$to_s().$constantize()];
            $send(self.$options(), '[]=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];};
          if ($truthy(self.$options()['$[]']("builder"))) {
            
            $writer = ["builder", self.$options()['$[]']("builder").$to_s().$constantize()];
            $send(self.$options(), '[]=', Opal.to_a($writer));
            return $writer[$rb_minus($writer["length"], 1)];
            } else {
            return nil
          };
        };
      }, TMP_ModelFilter_initialize_constants$B_2.$$arity = 0);
      return (Opal.defn(self, '$filter', TMP_ModelFilter_filter_3 = function $$filter(data) {
        var $a, $b, self = this, ret = nil;

        
        self['$initialize_constants!']();
        if ($truthy(data['$nil?']())) {
          
          if ($truthy(self.$options()['$[]']("nils"))) {
            return [nil, nil]};
          return [nil, "nils"];};
        if ($truthy(($truthy($a = data['$is_a?'](Opal.const_get_relative($nesting, 'Hash'))) ? self.$options()['$[]']("builder") : $a))) {
          
          ret = self.$options()['$[]']("builder").$run(data);
          if ($truthy(ret['$success?']())) {
            data = ret.$result()
            } else {
            return [data, ret.$errors()]
          };};
        if ($truthy(data['$is_a?'](self.$options()['$[]']("class")))) {
          
          if ($truthy(($truthy($a = self.$options()['$[]']("new_records")['$!']()) ? ($truthy($b = data['$respond_to?']("new_record?")) ? data['$new_record?']() : $b) : $a))) {
            return [data, "new_records"]};
          return [data, nil];};
        return [data, "model"];
      }, TMP_ModelFilter_filter_3.$$arity = 1), nil) && 'filter';
    })($nesting[0], Opal.const_get_relative($nesting, 'InputFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/symbol_filter"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$nil?', '$[]', '$options', '$===', '$to_sym', '$!', '$include?']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $SymbolFilter(){};
      var self = $SymbolFilter = $klass($base, $super, 'SymbolFilter', $SymbolFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_SymbolFilter_filter_1;

      
      self.default_options = $hash2(["nils", "in"], {"nils": false, "in": nil});
      return (Opal.defn(self, '$filter', TMP_SymbolFilter_filter_1 = function $$filter(data) {
        var $a, self = this, $case = nil;

        
        if ($truthy(data['$nil?']())) {
          
          if ($truthy(self.$options()['$[]']("nils"))) {
            return [nil, nil]};
          return [nil, "nils"];};
        $case = data;
        if (Opal.const_get_relative($nesting, 'Symbol')['$===']($case)) {nil}
        else if (Opal.const_get_relative($nesting, 'String')['$===']($case)) {data = data.$to_sym()}
        else {return [nil, "symbol"]};
        if ($truthy(($truthy($a = self.$options()['$[]']("in")) ? self.$options()['$[]']("in")['$include?'](data)['$!']() : $a))) {
          return [data, "in"]};
        return [data, nil];
      }, TMP_SymbolFilter_filter_1.$$arity = 1), nil) && 'filter';
    })($nesting[0], Opal.const_get_relative($nesting, 'AdditionalFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/outcome"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass;

  Opal.add_stubs(['$attr_reader']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Outcome(){};
      var self = $Outcome = $klass($base, $super, 'Outcome', $Outcome);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Outcome_initialize_1, TMP_Outcome_success$q_2;

      def.success = nil;
      
      self.$attr_reader("result", "errors", "inputs");
      
      Opal.defn(self, '$initialize', TMP_Outcome_initialize_1 = function $$initialize(is_success, result, errors, inputs) {
        var $a, self = this;

        return $a = [is_success, result, errors, inputs], (self.success = $a[0]), (self.result = $a[1]), (self.errors = $a[2]), (self.inputs = $a[3]), $a
      }, TMP_Outcome_initialize_1.$$arity = 4);
      return (Opal.defn(self, '$success?', TMP_Outcome_success$q_2 = function() {
        var self = this;

        return self.success
      }, TMP_Outcome_success$q_2.$$arity = 0), nil) && 'success?';
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations/command"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $truthy = Opal.truthy, $hash2 = Opal.hash2;

  Opal.add_stubs(['$send', '$input_filters', '$to_proc', '$each', '$define_method', '$[]', '$has_key?', '$[]=', '$-', '$private', '$create_attr_methods', '$run', '$new', '$run!', '$validation_outcome', '$==', '$superclass', '$dup', '$inject', '$with_indifferent_access', '$respond_to?', '$raise', '$merge!', '$filter', '$has_errors?', '$validate', '$class', '$!', '$nil?', '$execute', '$success?', '$result', '$errors', '$protected', '$attr_reader', '$is_a?', '$tap', '$split', '$to_s', '$pop', '$to_sym', '$any?']);
  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Command(){};
      var self = $Command = $klass($base, $super, 'Command', $Command);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Command_initialize_13, TMP_Command_input_filters_14, TMP_Command_has_errors$q_15, TMP_Command_run_16, TMP_Command_run$B_17, TMP_Command_validation_outcome_18, TMP_Command_validate_19, TMP_Command_execute_20, TMP_Command_add_error_23, TMP_Command_merge_errors_24;

      def.raw_inputs = def.errors = def.inputs = nil;
      
      (function(self, $parent_nesting) {
        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_create_attr_methods_1, TMP_required_6, TMP_optional_7, TMP_run_8, TMP_run$B_9, TMP_validate_10, TMP_input_filters_11;

        
        
        Opal.defn(self, '$create_attr_methods', TMP_create_attr_methods_1 = function $$create_attr_methods(meth) {
          var TMP_2, self = this, $iter = TMP_create_attr_methods_1.$$p, block = $iter || nil, keys = nil;

          if ($iter) TMP_create_attr_methods_1.$$p = null;
          
          $send(self.$input_filters(), 'send', [meth], block.$to_proc());
          keys = self.$input_filters().$send("" + (meth) + "_keys");
          return $send(keys, 'each', [], (TMP_2 = function(key){var self = TMP_2.$$s || this, TMP_3, TMP_4, TMP_5;
if (key == null) key = nil;
          
            $send(self, 'define_method', [key], (TMP_3 = function(){var self = TMP_3.$$s || this;
              if (self.inputs == null) self.inputs = nil;

            return self.inputs['$[]'](key)}, TMP_3.$$s = self, TMP_3.$$arity = 0, TMP_3));
            $send(self, 'define_method', ["" + (key) + "_present?"], (TMP_4 = function(){var self = TMP_4.$$s || this;
              if (self.inputs == null) self.inputs = nil;

            return self.inputs['$has_key?'](key)}, TMP_4.$$s = self, TMP_4.$$arity = 0, TMP_4));
            return $send(self, 'define_method', ["" + (key) + "="], (TMP_5 = function(v){var self = TMP_5.$$s || this, $writer = nil;
              if (self.inputs == null) self.inputs = nil;
if (v == null) v = nil;
            
              $writer = [key, v];
              $send(self.inputs, '[]=', Opal.to_a($writer));
              return $writer[$rb_minus($writer["length"], 1)];}, TMP_5.$$s = self, TMP_5.$$arity = 1, TMP_5));}, TMP_2.$$s = self, TMP_2.$$arity = 1, TMP_2));
        }, TMP_create_attr_methods_1.$$arity = 1);
        self.$private("create_attr_methods");
        
        Opal.defn(self, '$required', TMP_required_6 = function $$required() {
          var self = this, $iter = TMP_required_6.$$p, block = $iter || nil;

          if ($iter) TMP_required_6.$$p = null;
          return $send(self, 'create_attr_methods', ["required"], block.$to_proc())
        }, TMP_required_6.$$arity = 0);
        
        Opal.defn(self, '$optional', TMP_optional_7 = function $$optional() {
          var self = this, $iter = TMP_optional_7.$$p, block = $iter || nil;

          if ($iter) TMP_optional_7.$$p = null;
          return $send(self, 'create_attr_methods', ["optional"], block.$to_proc())
        }, TMP_optional_7.$$arity = 0);
        
        Opal.defn(self, '$run', TMP_run_8 = function $$run($a_rest) {
          var self = this, args;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          return $send(self, 'new', Opal.to_a(args)).$run()
        }, TMP_run_8.$$arity = -1);
        
        Opal.defn(self, '$run!', TMP_run$B_9 = function($a_rest) {
          var self = this, args;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          return $send(self, 'new', Opal.to_a(args))['$run!']()
        }, TMP_run$B_9.$$arity = -1);
        
        Opal.defn(self, '$validate', TMP_validate_10 = function $$validate($a_rest) {
          var self = this, args;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          return $send(self, 'new', Opal.to_a(args)).$validation_outcome()
        }, TMP_validate_10.$$arity = -1);
        return (Opal.defn(self, '$input_filters', TMP_input_filters_11 = function $$input_filters() {
          var $a, self = this;
          if (self.input_filters == null) self.input_filters = nil;

          return (self.input_filters = ($truthy($a = self.input_filters) ? $a : (function() {if (Opal.const_get_relative($nesting, 'Command')['$=='](self.$superclass())) {
            return Opal.const_get_relative($nesting, 'HashFilter').$new()
            } else {
            return self.$superclass().$input_filters().$dup()
          }; return nil; })()))
        }, TMP_input_filters_11.$$arity = 0), nil) && 'input_filters';
      })(Opal.get_singleton_class(self), $nesting);
      
      Opal.defn(self, '$initialize', TMP_Command_initialize_13 = function $$initialize($a_rest) {
        var TMP_12, $b, $c, self = this, args;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 0] = arguments[$arg_idx];
        }
        
        self.raw_inputs = $send(args, 'inject', [$hash2([], {}).$with_indifferent_access()], (TMP_12 = function(h, arg){var self = TMP_12.$$s || this;
if (h == null) h = nil;if (arg == null) arg = nil;
        
          if ($truthy(arg['$respond_to?']("to_hash"))) {
            } else {
            self.$raise(Opal.const_get_relative($nesting, 'ArgumentError').$new("All arguments must be hashes"))
          };
          return h['$merge!'](arg);}, TMP_12.$$s = self, TMP_12.$$arity = 2, TMP_12));
        $c = self.$input_filters().$filter(self.raw_inputs), $b = Opal.to_ary($c), (self.inputs = ($b[0] == null ? nil : $b[0])), (self.errors = ($b[1] == null ? nil : $b[1])), $c;
        if ($truthy(self['$has_errors?']())) {
          return nil
          } else {
          return self.$validate()
        };
      }, TMP_Command_initialize_13.$$arity = -1);
      
      Opal.defn(self, '$input_filters', TMP_Command_input_filters_14 = function $$input_filters() {
        var self = this;

        return self.$class().$input_filters()
      }, TMP_Command_input_filters_14.$$arity = 0);
      
      Opal.defn(self, '$has_errors?', TMP_Command_has_errors$q_15 = function() {
        var self = this;

        return self.errors['$nil?']()['$!']()
      }, TMP_Command_has_errors$q_15.$$arity = 0);
      
      Opal.defn(self, '$run', TMP_Command_run_16 = function $$run() {
        var self = this;

        
        if ($truthy(self['$has_errors?']())) {
          return self.$validation_outcome()};
        return self.$validation_outcome(self.$execute());
      }, TMP_Command_run_16.$$arity = 0);
      
      Opal.defn(self, '$run!', TMP_Command_run$B_17 = function() {
        var self = this, outcome = nil;

        
        outcome = self.$run();
        if ($truthy(outcome['$success?']())) {
          return outcome.$result()
          } else {
          return self.$raise(Opal.const_get_relative($nesting, 'ValidationException').$new(outcome.$errors()))
        };
      }, TMP_Command_run$B_17.$$arity = 0);
      
      Opal.defn(self, '$validation_outcome', TMP_Command_validation_outcome_18 = function $$validation_outcome(result) {
        var self = this;

        if (result == null) {
          result = nil;
        }
        return Opal.const_get_relative($nesting, 'Outcome').$new(self['$has_errors?']()['$!'](), (function() {if ($truthy(self['$has_errors?']())) {
          return nil
          } else {
          return result
        }; return nil; })(), self.errors, self.inputs)
      }, TMP_Command_validation_outcome_18.$$arity = -1);
      self.$protected();
      self.$attr_reader("inputs", "raw_inputs");
      
      Opal.defn(self, '$validate', TMP_Command_validate_19 = function $$validate() {
        var self = this;

        return nil
      }, TMP_Command_validate_19.$$arity = 0);
      
      Opal.defn(self, '$execute', TMP_Command_execute_20 = function $$execute() {
        var self = this;

        return nil
      }, TMP_Command_execute_20.$$arity = 0);
      
      Opal.defn(self, '$add_error', TMP_Command_add_error_23 = function $$add_error(key, kind, message) {
        var $a, TMP_21, self = this;

        if (message == null) {
          message = nil;
        }
        
        if ($truthy(kind['$is_a?'](Opal.const_get_relative($nesting, 'Symbol')))) {
          } else {
          self.$raise(Opal.const_get_relative($nesting, 'ArgumentError').$new("Invalid kind"))
        };
        self.errors = ($truthy($a = self.errors) ? $a : Opal.const_get_relative($nesting, 'ErrorHash').$new());
        return $send(self.errors, 'tap', [], (TMP_21 = function(errs){var self = TMP_21.$$s || this, TMP_22, path = nil, last = nil, inner = nil, $writer = nil;
if (errs == null) errs = nil;
        
          path = key.$to_s().$split(".");
          last = path.$pop();
          inner = $send(path, 'inject', [errs], (TMP_22 = function(cur_errors, part){var self = TMP_22.$$s || this, $b, $writer = nil;
if (cur_errors == null) cur_errors = nil;if (part == null) part = nil;
          return ($truthy($b = cur_errors['$[]'](part.$to_sym())) ? $b : (($writer = [part.$to_sym(), Opal.const_get_relative($nesting, 'ErrorHash').$new()]), $send(cur_errors, '[]=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]))}, TMP_22.$$s = self, TMP_22.$$arity = 2, TMP_22));
          
          $writer = [last, Opal.const_get_relative($nesting, 'ErrorAtom').$new(key, kind, $hash2(["message"], {"message": message}))];
          $send(inner, '[]=', Opal.to_a($writer));
          return $writer[$rb_minus($writer["length"], 1)];;}, TMP_21.$$s = self, TMP_21.$$arity = 1, TMP_21));
      }, TMP_Command_add_error_23.$$arity = -3);
      return (Opal.defn(self, '$merge_errors', TMP_Command_merge_errors_24 = function $$merge_errors(hash) {
        var $a, self = this;

        if ($truthy(hash['$any?']())) {
          
          self.errors = ($truthy($a = self.errors) ? $a : Opal.const_get_relative($nesting, 'ErrorHash').$new());
          return self.errors['$merge!'](hash);
          } else {
          return nil
        }
      }, TMP_Command_merge_errors_24.$$arity = 1), nil) && 'merge_errors';
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["mutations"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send, $writer = nil;

  Opal.add_stubs(['$require', '$new', '$cache_constants=', '$-']);
  
  self.$require("active_support/core_ext/hash/indifferent_access");
  self.$require("active_support/core_ext/string/inflections");
  self.$require("date");
  self.$require("time");
  self.$require("bigdecimal");
  self.$require("mutations/version");
  self.$require("mutations/exception");
  self.$require("mutations/errors");
  self.$require("mutations/input_filter");
  self.$require("mutations/additional_filter");
  self.$require("mutations/string_filter");
  self.$require("mutations/integer_filter");
  self.$require("mutations/float_filter");
  self.$require("mutations/boolean_filter");
  self.$require("mutations/duck_filter");
  self.$require("mutations/date_filter");
  self.$require("mutations/time_filter");
  self.$require("mutations/file_filter");
  self.$require("mutations/model_filter");
  self.$require("mutations/array_filter");
  self.$require("mutations/hash_filter");
  self.$require("mutations/symbol_filter");
  self.$require("mutations/outcome");
  self.$require("mutations/command");
  (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function(self, $parent_nesting) {
      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_error_message_creator_1, TMP_error_message_creator$eq_2, TMP_cache_constants$eq_3, TMP_cache_constants$q_4;

      
      
      Opal.defn(self, '$error_message_creator', TMP_error_message_creator_1 = function $$error_message_creator() {
        var $a, self = this;
        if (self.error_message_creator == null) self.error_message_creator = nil;

        return (self.error_message_creator = ($truthy($a = self.error_message_creator) ? $a : Opal.const_get_relative($nesting, 'DefaultErrorMessageCreator').$new()))
      }, TMP_error_message_creator_1.$$arity = 0);
      
      Opal.defn(self, '$error_message_creator=', TMP_error_message_creator$eq_2 = function(creator) {
        var self = this;

        return (self.error_message_creator = creator)
      }, TMP_error_message_creator$eq_2.$$arity = 1);
      
      Opal.defn(self, '$cache_constants=', TMP_cache_constants$eq_3 = function(val) {
        var self = this;

        return (self.cache_constants = val)
      }, TMP_cache_constants$eq_3.$$arity = 1);
      return (Opal.defn(self, '$cache_constants?', TMP_cache_constants$q_4 = function() {
        var self = this;
        if (self.cache_constants == null) self.cache_constants = nil;

        return self.cache_constants
      }, TMP_cache_constants$q_4.$$arity = 0), nil) && 'cache_constants?';
    })(Opal.get_singleton_class(self), $nesting)
  })($nesting[0], $nesting);
  
  $writer = [true];
  $send(Opal.const_get_relative($nesting, 'Mutations'), 'cache_constants=', Opal.to_a($writer));
  return $writer[$rb_minus($writer["length"], 1)];;
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/filters/outbound_filter"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $hash2 = Opal.hash2;

  return (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $OutboundFilter(){};
      var self = $OutboundFilter = $klass($base, $super, 'OutboundFilter', $OutboundFilter);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_OutboundFilter_filter_1;

      
      self.default_options = $hash2([], {});
      return (Opal.defn(self, '$filter', TMP_OutboundFilter_filter_1 = function $$filter(data) {
        var self = this;

        return [data, "outbound"]
      }, TMP_OutboundFilter_filter_1.$$arity = 1), nil) && 'filter';
    })($nesting[0], Opal.const_get_relative($nesting, 'AdditionalFilter'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/http"] = function(Opal) {
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$each', '$define_singleton_method', '$send', '$new', '$define_method', '$attr_reader', '$>', '$+', '$-', '$<', '$delete', '$succeed', '$fail', '$promise', '$parse', '$private', '$tap', '$proc', '$ok?', '$resolve', '$reject', '$from_object', '$call']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $HTTP(){};
      var self = $HTTP = $klass($base, $super, 'HTTP', $HTTP);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_HTTP_1, TMP_HTTP_initialize_4, TMP_HTTP_active$q_5, TMP_HTTP_active_requests_6, TMP_HTTP_incr_active_requests_7, TMP_HTTP_decr_active_requests_8, TMP_HTTP_send_9, TMP_HTTP_json_10, TMP_HTTP_ok$q_11, TMP_HTTP_get_header_12, TMP_HTTP_inspect_13, TMP_HTTP_promise_16, TMP_HTTP_succeed_17, TMP_HTTP_fail_18;

      def.handler = def.json = def.body = def.ok = def.xhr = def.url = def.method = def.promise = def.status_code = nil;
      
      Opal.const_set($nesting[0], 'ACTIONS', ["get", "post", "put", "delete", "patch", "head"]);
      $send(Opal.const_get_relative($nesting, 'ACTIONS'), 'each', [], (TMP_HTTP_1 = function(action){var self = TMP_HTTP_1.$$s || this, TMP_2, TMP_3;
if (action == null) action = nil;
      
        $send(self, 'define_singleton_method', [action], (TMP_2 = function(url, options){var self = TMP_2.$$s || this, block;

          block = TMP_2.$$p || nil;
          if (block) TMP_2.$$p = null;
          if (options == null) {
            options = $hash2([], {});
          }if (url == null) url = nil;
        return self.$new().$send(action, url, options, block)}, TMP_2.$$s = self, TMP_2.$$arity = -2, TMP_2));
        return $send(self, 'define_method', [action], (TMP_3 = function(url, options){var self = TMP_3.$$s || this, block;

          block = TMP_3.$$p || nil;
          if (block) TMP_3.$$p = null;
          if (options == null) {
            options = $hash2([], {});
          }if (url == null) url = nil;
        return self.$send(action, url, options, block)}, TMP_3.$$s = self, TMP_3.$$arity = -2, TMP_3));}, TMP_HTTP_1.$$s = self, TMP_HTTP_1.$$arity = 1, TMP_HTTP_1));
      self.$attr_reader("body", "error_message", "method", "status_code", "url", "xhr");
      
      Opal.defn(self, '$initialize', TMP_HTTP_initialize_4 = function $$initialize() {
        var self = this;

        return (self.ok = true)
      }, TMP_HTTP_initialize_4.$$arity = 0);
      Opal.defs(self, '$active?', TMP_HTTP_active$q_5 = function() {
        var self = this, jquery_active_requests = nil;
        if (self.active_requests == null) self.active_requests = nil;

        
        jquery_active_requests = 0;
        
        if (typeof jQuery !== "undefined" && typeof jQuery.active !== "undefined" && jQuery.active !== null) {
          jquery_active_requests = jQuery.active;
        }
      ;
        return $rb_gt($rb_plus(jquery_active_requests, self.active_requests), 0);
      }, TMP_HTTP_active$q_5.$$arity = 0);
      Opal.defs(self, '$active_requests', TMP_HTTP_active_requests_6 = function $$active_requests() {
        var $a, self = this;
        if (self.active_requests == null) self.active_requests = nil;

        
        self.active_requests = ($truthy($a = self.active_requests) ? $a : 0);
        return self.active_requests;
      }, TMP_HTTP_active_requests_6.$$arity = 0);
      Opal.defs(self, '$incr_active_requests', TMP_HTTP_incr_active_requests_7 = function $$incr_active_requests() {
        var $a, self = this;
        if (self.active_requests == null) self.active_requests = nil;

        
        self.active_requests = ($truthy($a = self.active_requests) ? $a : 0);
        return (self.active_requests = $rb_plus(self.active_requests, 1));
      }, TMP_HTTP_incr_active_requests_7.$$arity = 0);
      Opal.defs(self, '$decr_active_requests', TMP_HTTP_decr_active_requests_8 = function $$decr_active_requests() {
        var $a, self = this;
        if (self.active_requests == null) self.active_requests = nil;

        
        self.active_requests = ($truthy($a = self.active_requests) ? $a : 0);
        self.active_requests = $rb_minus(self.active_requests, 1);
        if ($truthy($rb_lt(self.active_requests, 0))) {
          
          console.log("Ooops, Hyperstack::HTTP active_requests out of sync!");
          return (self.active_requests = 0);
          } else {
          return nil
        };
      }, TMP_HTTP_decr_active_requests_8.$$arity = 0);
      
      Opal.defn(self, '$send', TMP_HTTP_send_9 = function $$send(method, url, options, block) {
        var self = this;

        
        self.method = method;
        self.url = url;
        self.payload = options.$delete("payload");
        self.handler = block;
        
        var payload_to_send = null;
        var content_type = null;
        if (typeof(this.payload) === 'string') {
          payload_to_send = this.payload;
        }
        else if (this.payload != nil) {
          payload_to_send = this.payload.$to_json();
          content_type = 'application/json';
        }

        var xhr = new XMLHttpRequest();

        xhr.onreadystatechange = function() {
          if(xhr.readyState === XMLHttpRequest.DONE) {
            self.$class().$decr_active_requests();
            if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {
              return self.$succeed(xhr.responseText, xhr.status, xhr);
            } else {
              return self.$fail(xhr, xhr.status, xhr.statusText);
            }
          }
        }
        xhr.open(this.method.toUpperCase(), this.url);
        if (payload_to_send !== null && content_type !== null) {
          xhr.setRequestHeader("Content-Type", content_type);
        }
        if (options["$has_key?"]("headers")) {
          var headers = options['$[]']("headers");
          var keys = headers.$keys();
          var keys_length = keys.length;
          for (var i=0; i < keys_length; i++) {
            xhr.setRequestHeader( keys[i], headers['$[]'](keys[i]) );
          }
        }
        if (payload_to_send !== null) {
          self.$class().$incr_active_requests();
          xhr.send(payload_to_send);
        } else {
          self.$class().$incr_active_requests();
          xhr.send();
        }
      ;
        if ($truthy(self.handler)) {
          return self
          } else {
          return self.$promise()
        };
      }, TMP_HTTP_send_9.$$arity = 4);
      
      Opal.defn(self, '$json', TMP_HTTP_json_10 = function $$json() {
        var $a, self = this;

        return (self.json = ($truthy($a = self.json) ? $a : Opal.const_get_relative($nesting, 'JSON').$parse(self.body)))
      }, TMP_HTTP_json_10.$$arity = 0);
      
      Opal.defn(self, '$ok?', TMP_HTTP_ok$q_11 = function() {
        var self = this;

        return self.ok
      }, TMP_HTTP_ok$q_11.$$arity = 0);
      
      Opal.defn(self, '$get_header', TMP_HTTP_get_header_12 = function $$get_header(key) {
        var self = this;

        
        var value = self.xhr.getResponseHeader(key);
        return (value === null) ? nil : value;
      
      }, TMP_HTTP_get_header_12.$$arity = 1);
      
      Opal.defn(self, '$inspect', TMP_HTTP_inspect_13 = function $$inspect() {
        var self = this;

        return "" + "#<HTTP @url=" + (self.url) + " @method=" + (self.method) + ">"
      }, TMP_HTTP_inspect_13.$$arity = 0);
      self.$private();
      
      Opal.defn(self, '$promise', TMP_HTTP_promise_16 = function $$promise() {
        var TMP_14, self = this;

        
        if ($truthy(self.promise)) {
          return self.promise};
        return (self.promise = $send(Opal.const_get_relative($nesting, 'Promise').$new(), 'tap', [], (TMP_14 = function(promise){var self = TMP_14.$$s || this, TMP_15;
if (promise == null) promise = nil;
        return (self.handler = $send(self, 'proc', [], (TMP_15 = function(res){var self = TMP_15.$$s || this;
if (res == null) res = nil;
          if ($truthy(res['$ok?']())) {
              return promise.$resolve(res)
              } else {
              return promise.$reject(res)
            }}, TMP_15.$$s = self, TMP_15.$$arity = 1, TMP_15)))}, TMP_14.$$s = self, TMP_14.$$arity = 1, TMP_14)));
      }, TMP_HTTP_promise_16.$$arity = 0);
      
      Opal.defn(self, '$succeed', TMP_HTTP_succeed_17 = function $$succeed(data, status, xhr) {
        var self = this;

        
        
        self.body = data;
        self.xhr  = xhr;
        self.status_code = xhr.status;

        if (typeof(data) === 'object') {
          self.json = Opal.const_get_relative($nesting, 'JSON').$from_object(data);
        }
      ;
        if ($truthy(self.handler)) {
          return self.handler.$call(self)
          } else {
          return nil
        };
      }, TMP_HTTP_succeed_17.$$arity = 3);
      return (Opal.defn(self, '$fail', TMP_HTTP_fail_18 = function $$fail(xhr, status, error) {
        var self = this;

        
        
        self.body = xhr.responseText;
        self.xhr = xhr;
        self.status_code = xhr.status;
      ;
        self.ok = false;
        if ($truthy(self.handler)) {
          return self.handler.$call(self)
          } else {
          return nil
        };
      }, TMP_HTTP_fail_18.$$arity = 3), nil) && 'fail';
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/transport/client_drivers"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$[]', '$opts', '$extend', '$on_opal_client?', '$client_drivers_get_acting_user_id', '$env', '$==', '$each', '$is_a?', '$connect_to', '$name', '$id', '$class', '$raise', '$connect', '$last', '$split', '$new', '$+', '$to_s', '$<<', '$open_channels', '$add_connection', '$gsub', '$lambda', '$get_queued_data', '$then', '$post', '$polling_path', '$action_cable_consumer', '$json', '$complete_connection', '$sync_dispatch', '$parse', '$get', '$include', '$dispatch_from_server', '$constantize', '$!=', '$attr_reader', '$isomorphic_method', '$send_to_server', '$when_on_server', '$acting_user', '$controller', '$when_on_client', '$fail', '$zero?', '$after', '$-', '$[]=', '$every']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Hyperstack_anti_csrf_token_1, TMP_Hyperstack_connect_7, TMP_Hyperstack_connect_session_8, TMP_Hyperstack_action_cable_consumer_9;

    
    Opal.defs(self, '$anti_csrf_token', TMP_Hyperstack_anti_csrf_token_1 = function $$anti_csrf_token() {
      var self = this;

      return Opal.const_get_relative($nesting, 'ClientDrivers').$opts()['$[]']("form_authenticity_token")
    }, TMP_Hyperstack_anti_csrf_token_1.$$arity = 0);
    (function($base, $super, $parent_nesting) {
      function $Application(){};
      var self = $Application = $klass($base, $super, 'Application', $Application);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Application_acting_user_id_2, TMP_Application_acting_user_id_3, TMP_Application_env_4, TMP_Application_production$q_5;

      
      self.$extend(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Component'), 'IsomorphicHelpers'), 'ClassMethods'));
      if ($truthy(self['$on_opal_client?']())) {
        Opal.defs(self, '$acting_user_id', TMP_Application_acting_user_id_2 = function $$acting_user_id() {
          var self = this;

          return Opal.const_get_relative($nesting, 'ClientDrivers').$opts()['$[]']("acting_user_id")
        }, TMP_Application_acting_user_id_2.$$arity = 0)
        } else {
        Opal.defs(self, '$acting_user_id', TMP_Application_acting_user_id_3 = function $$acting_user_id() {
          var self = this;

          return Opal.const_get_relative($nesting, 'ClientDrivers').$client_drivers_get_acting_user_id()
        }, TMP_Application_acting_user_id_3.$$arity = 0)
      };
      Opal.defs(self, '$env', TMP_Application_env_4 = function $$env() {
        var self = this;
        if (self.env == null) self.env = nil;

        
        if ($truthy(self.env)) {
          } else {
          self.env = Opal.const_get_relative($nesting, 'ClientDrivers').$env()
        };
        return self.env;
      }, TMP_Application_env_4.$$arity = 0);
      return Opal.defs(self, '$production?', TMP_Application_production$q_5 = function() {
        var self = this;

        return self.$env()['$==']("production")
      }, TMP_Application_production$q_5.$$arity = 0);
    })($nesting[0], null, $nesting);
    if (Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$==']("opal")) {
      
      Opal.defs(self, '$connect', TMP_Hyperstack_connect_7 = function $$connect($a_rest) {
        var TMP_6, self = this, channels;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        channels = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          channels[$arg_idx - 0] = arguments[$arg_idx];
        }
        return $send(channels, 'each', [], (TMP_6 = function(channel){var self = TMP_6.$$s || this, $a;
if (channel == null) channel = nil;
        if ($truthy(channel['$is_a?'](Opal.const_get_relative($nesting, 'Class')))) {
            return Opal.const_get_relative($nesting, 'IncomingBroadcast').$connect_to(channel.$name())
          } else if ($truthy(($truthy($a = channel['$is_a?'](Opal.const_get_relative($nesting, 'String'))) ? $a : channel['$is_a?'](Opal.const_get_relative($nesting, 'Array'))))) {
            return $send(Opal.const_get_relative($nesting, 'IncomingBroadcast'), 'connect_to', Opal.to_a(channel))
          } else if ($truthy(channel.$id())) {
            return Opal.const_get_relative($nesting, 'IncomingBroadcast').$connect_to(channel.$class().$name(), channel.$id())
            } else {
            return self.$raise("cannot connect to model before it has been saved")
          }}, TMP_6.$$s = self, TMP_6.$$arity = 1, TMP_6))
      }, TMP_Hyperstack_connect_7.$$arity = -1);
      Opal.defs(self, '$connect_session', TMP_Hyperstack_connect_session_8 = function $$connect_session() {
        var self = this;

        return self.$connect(["Hyperstack::Session", Opal.const_get_relative($nesting, 'ClientDrivers').$opts()['$[]']("id").$split("-").$last()])
      }, TMP_Hyperstack_connect_session_8.$$arity = 0);
      Opal.defs(self, '$action_cable_consumer', TMP_Hyperstack_action_cable_consumer_9 = function $$action_cable_consumer() {
        var self = this;

        return Opal.const_get_relative($nesting, 'ClientDrivers').$opts()['$[]']("action_cable_consumer")
      }, TMP_Hyperstack_action_cable_consumer_9.$$arity = 0);
      (function($base, $super, $parent_nesting) {
        function $IncomingBroadcast(){};
        var self = $IncomingBroadcast = $klass($base, $super, 'IncomingBroadcast', $IncomingBroadcast);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_IncomingBroadcast_open_channels_10, TMP_IncomingBroadcast_add_connection_11, TMP_IncomingBroadcast_connect_to_14;

        
        Opal.defs(self, '$open_channels', TMP_IncomingBroadcast_open_channels_10 = function $$open_channels() {
          var $a, self = this;
          if (self.open_channels == null) self.open_channels = nil;

          return (self.open_channels = ($truthy($a = self.open_channels) ? $a : Opal.const_get_relative($nesting, 'Set').$new()))
        }, TMP_IncomingBroadcast_open_channels_10.$$arity = 0);
        Opal.defs(self, '$add_connection', TMP_IncomingBroadcast_add_connection_11 = function $$add_connection(channel_name, id) {
          var self = this, channel_string = nil;

          if (id == null) {
            id = nil;
          }
          
          channel_string = "" + (channel_name) + ((function() {if ($truthy(id)) {
            return $rb_plus("-", id.$to_s())
            } else {
            return nil
          }; return nil; })());
          self.$open_channels()['$<<'](channel_string);
          return channel_string;
        }, TMP_IncomingBroadcast_add_connection_11.$$arity = -2);
        return Opal.defs(self, '$connect_to', TMP_IncomingBroadcast_connect_to_14 = function $$connect_to(channel_name, id) {
          var TMP_12, TMP_13, self = this, channel_string = nil, channel = nil;

          if (id == null) {
            id = nil;
          }
          
          channel_string = self.$add_connection(channel_name, id);
          if (Opal.const_get_relative($nesting, 'ClientDrivers').$opts()['$[]']("transport")['$==']("pusher")) {
            
            channel = "" + (Opal.const_get_relative($nesting, 'ClientDrivers').$opts()['$[]']("channel")) + "-" + (channel_string);
            
            var channel = Opal.const_get_relative($nesting, 'ClientDrivers').$opts()['$[]']("pusher_api").subscribe(channel.$gsub("::", "=="));
            channel.bind('dispatch', Opal.const_get_relative($nesting, 'ClientDrivers').$opts()['$[]']("dispatch"))
            channel.bind('pusher:subscription_succeeded', $send(self, 'lambda', [], (TMP_12 = function(){var self = TMP_12.$$s || this;

            return Opal.const_get_relative($nesting, 'ClientDrivers').$get_queued_data("connect-to-transport", channel_string)}, TMP_12.$$s = self, TMP_12.$$arity = 0, TMP_12)))
          ;
          } else if (Opal.const_get_relative($nesting, 'ClientDrivers').$opts()['$[]']("transport")['$==']("action_cable")) {
            
            channel = "" + (Opal.const_get_relative($nesting, 'ClientDrivers').$opts()['$[]']("channel")) + "-" + (channel_string);
            return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'HTTP').$post(Opal.const_get_relative($nesting, 'ClientDrivers').$polling_path("action-cable-auth", channel), $hash2(["headers"], {"headers": $hash2(["X-CSRF-Token"], {"X-CSRF-Token": Opal.const_get_relative($nesting, 'ClientDrivers').$opts()['$[]']("form_authenticity_token")})})), 'then', [], (TMP_13 = function(response){var self = TMP_13.$$s || this;
if (response == null) response = nil;
            
              var fix_opal_0110 = 'return';
              Opal.const_get_relative($nesting, 'Hyperstack').$action_cable_consumer().subscriptions.create(
                {
                  channel: "Hyperstack::ActionCableChannel",
                  client_id: Opal.const_get_relative($nesting, 'ClientDrivers').$opts()['$[]']("id"),
                  hyperstack_channel: channel_string,
                  authorization: response.$json()['$[]']("authorization"),
                  salt: response.$json()['$[]']("salt")
                },
                {
                  connected: function() {
                    if (Opal.const_get_relative($nesting, 'ClientDrivers').$env()['$==']("development")) { console.log("ActionCable connected to: ", channel_string); }
                    Opal.const_get_relative($nesting, 'ClientDrivers').$complete_connection(channel_string)
                  },
                  received: function(data) {
                    if (Opal.const_get_relative($nesting, 'ClientDrivers').$env()['$==']("development")) { console.log("ActionCable received: ", data); }
                    Opal.const_get_relative($nesting, 'ClientDrivers').$sync_dispatch(Opal.const_get_relative($nesting, 'JSON').$parse(JSON.stringify(data))['$[]']("data"))
                  }
                }
              )
            }, TMP_13.$$s = self, TMP_13.$$arity = 1, TMP_13));
            } else {
            return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'HTTP').$get(Opal.const_get_relative($nesting, 'ClientDrivers').$polling_path("subscribe", channel_string))
          };
        }, TMP_IncomingBroadcast_connect_to_14.$$arity = -2);
      })($nesting[0], null, $nesting);
      } else {
      nil
    };
    (function($base, $super, $parent_nesting) {
      function $ClientDrivers(){};
      var self = $ClientDrivers = $klass($base, $super, 'ClientDrivers', $ClientDrivers);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ClientDrivers_sync_dispatch_15, TMP_ClientDrivers_16, TMP_ClientDrivers_18, TMP_ClientDrivers_complete_connection_23, TMP_ClientDrivers_get_queued_data_26, TMP_ClientDrivers_initialize_client_drivers_on_boot_31, TMP_ClientDrivers_polling_path_32;

      
      self.$include(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'IsomorphicHelpers'));
      Opal.defs(self, '$sync_dispatch', TMP_ClientDrivers_sync_dispatch_15 = function $$sync_dispatch(data) {
        var self = this;

        return data['$[]']("operation").$constantize().$dispatch_from_server(data['$[]']("params"))
      }, TMP_ClientDrivers_sync_dispatch_15.$$arity = 1);
      if ($truthy(Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$!=']("opal"))) {
        nil};
      (function(self, $parent_nesting) {
        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        return self.$attr_reader("opts")
      })(Opal.get_singleton_class(self), $nesting);
      $send(self, 'isomorphic_method', ["client_drivers_get_acting_user_id"], (TMP_ClientDrivers_16 = function(f){var self = TMP_ClientDrivers_16.$$s || this, TMP_17;
if (f == null) f = nil;
      
        if (Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$==']("opal")) {
          f.$send_to_server()
          } else {
          nil
        };
        return $send(f, 'when_on_server', [], (TMP_17 = function(){var self = TMP_17.$$s || this, $a;

        
          return ($truthy($a = self.$controller().$acting_user()) ? self.$controller().$acting_user().$id() : $a);}, TMP_17.$$s = self, TMP_17.$$arity = 0, TMP_17));}, TMP_ClientDrivers_16.$$s = self, TMP_ClientDrivers_16.$$arity = 1, TMP_ClientDrivers_16));
      $send(self, 'isomorphic_method', ["env"], (TMP_ClientDrivers_18 = function(f){var self = TMP_ClientDrivers_18.$$s || this, TMP_19, TMP_20;
if (f == null) f = nil;
      
        $send(f, 'when_on_client', [], (TMP_19 = function(){var self = TMP_19.$$s || this;

        return self.$opts()['$[]']("env")}, TMP_19.$$s = self, TMP_19.$$arity = 0, TMP_19));
        f.$send_to_server();
        return $send(f, 'when_on_server', [], (TMP_20 = function(){var self = TMP_20.$$s || this;

        return Opal.const_get_qualified('::', 'Rails').$env()}, TMP_20.$$s = self, TMP_20.$$arity = 0, TMP_20));}, TMP_ClientDrivers_18.$$s = self, TMP_ClientDrivers_18.$$arity = 1, TMP_ClientDrivers_18));
      Opal.defs(self, '$complete_connection', TMP_ClientDrivers_complete_connection_23 = function $$complete_connection(channel, retries) {
        var TMP_21, self = this;

        if (retries == null) {
          retries = 10;
        }
        return $send(self.$get_queued_data("connect-to-transport", channel), 'fail', [], (TMP_21 = function(){var self = TMP_21.$$s || this, TMP_22;

        if ($truthy(retries['$zero?']())) {
            return nil
            } else {
            return $send(self, 'after', [0.25], (TMP_22 = function(){var self = TMP_22.$$s || this;

            return self.$complete_connection(channel, $rb_minus(retries, 1))}, TMP_22.$$s = self, TMP_22.$$arity = 0, TMP_22))
          }}, TMP_21.$$s = self, TMP_21.$$arity = 0, TMP_21))
      }, TMP_ClientDrivers_complete_connection_23.$$arity = -2);
      Opal.defs(self, '$get_queued_data', TMP_ClientDrivers_get_queued_data_26 = function $$get_queued_data(operation, channel, opts) {
        var TMP_24, self = this;

        if (channel == null) {
          channel = nil;
        }
        if (opts == null) {
          opts = $hash2([], {});
        }
        return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'HTTP').$get(self.$polling_path(operation, channel), opts), 'then', [], (TMP_24 = function(response){var self = TMP_24.$$s || this, TMP_25;
if (response == null) response = nil;
        return $send(response.$json(), 'each', [], (TMP_25 = function(data){var self = TMP_25.$$s || this;
if (data == null) data = nil;
          
            if (Opal.const_get_relative($nesting, 'ClientDrivers').$env()['$==']("development")) {
              console.log("simple_poller received: ", data)};
            return self.$sync_dispatch(data['$[]'](1));}, TMP_25.$$s = self, TMP_25.$$arity = 1, TMP_25))}, TMP_24.$$s = self, TMP_24.$$arity = 1, TMP_24))
      }, TMP_ClientDrivers_get_queued_data_26.$$arity = -2);
      Opal.defs(self, '$initialize_client_drivers_on_boot', TMP_ClientDrivers_initialize_client_drivers_on_boot_31 = function $$initialize_client_drivers_on_boot() {
        var $a, TMP_27, TMP_28, TMP_29, TMP_30, self = this, $writer = nil, h = nil, pusher_api = nil;
        if (self.initialized == null) self.initialized = nil;

        
        if ($truthy(self.initialized)) {
          
          if ($truthy(($truthy($a = self['$on_opal_client?']()) ? Opal.const_get_relative($nesting, 'Hyperstack').$action_cable_consumer() : $a))) {
            $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'HTTP'), 'get', ["" + (window.HyperstackEnginePath) + "/server_up"], (TMP_27 = function(){var self = TMP_27.$$s || this;

            if ($truthy(Opal.const_get_relative($nesting, 'Hyperstack').$action_cable_consumer().connection.disconnected)) {
                return Opal.const_get_relative($nesting, 'Hyperstack').$action_cable_consumer().connection.open()
                } else {
                return nil
              }}, TMP_27.$$s = self, TMP_27.$$arity = 0, TMP_27))};
          return nil;};
        self.initialized = true;
        self.opts = $hash2([], {});
        if ($truthy(self['$on_opal_client?']())) {
          
          self.opts = Opal.const_get_relative($nesting, 'Hash').$new(window.HyperstackOpts);
          if (self.$opts()['$[]']("transport")['$==']("pusher")) {
            
            
            $writer = ["dispatch", $send(self, 'lambda', [], (TMP_28 = function(data){var self = TMP_28.$$s || this;
if (data == null) data = nil;
            return self.$sync_dispatch(Opal.const_get_relative($nesting, 'JSON').$parse(JSON.stringify(data)))}, TMP_28.$$s = self, TMP_28.$$arity = 1, TMP_28))];
            $send(self.$opts(), '[]=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];;
            if ($truthy(($truthy($a = self.$opts()['$[]']("client_logging")) ? window.console && window.console.log : $a))) {
              Pusher.log = function(message) {window.console.log(message);}};
            if ($truthy(self.$opts()['$[]']("pusher_fake_js"))) {
              
              $writer = ["pusher_api", eval(self.$opts()['$[]']("pusher_fake_js"))];
              $send(self.$opts(), '[]=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];
              } else {
              
              h = nil;
              pusher_api = nil;
              
              h = {
                encrypted: self.$opts()['$[]']("encrypted"),
                cluster: self.$opts()['$[]']("cluster"),
                authEndpoint: window.HyperstackEnginePath+'/hyperstack-pusher-auth',
                auth: {headers: {'X-CSRF-Token': self.$opts()['$[]']("form_authenticity_token")}}
              };
              pusher_api = new Pusher(self.$opts()['$[]']("key"), h)
            ;
              
              $writer = ["pusher_api", pusher_api];
              $send(self.$opts(), '[]=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;
            };
            return $send(Opal.const_get_relative($nesting, 'Hyperstack'), 'connect', Opal.to_a(self.$opts()['$[]']("auto_connect")));
          } else if (self.$opts()['$[]']("transport")['$==']("action_cable")) {
            
            
            $writer = ["action_cable_consumer", ActionCable.createConsumer.apply(ActionCable, [].concat(Opal.to_a(self.$opts()['$[]']("action_cable_consumer_url"))))];
            $send(self.$opts(), '[]=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];;
            return $send(Opal.const_get_relative($nesting, 'Hyperstack'), 'connect', Opal.to_a(self.$opts()['$[]']("auto_connect")));
          } else if (self.$opts()['$[]']("transport")['$==']("simple_poller")) {
            
            $send(self.$opts()['$[]']("auto_connect"), 'each', [], (TMP_29 = function(channel){var self = TMP_29.$$s || this;
if (channel == null) channel = nil;
            return $send(Opal.const_get_relative($nesting, 'IncomingBroadcast'), 'add_connection', Opal.to_a(channel))}, TMP_29.$$s = self, TMP_29.$$arity = 1, TMP_29));
            return $send(self, 'every', [self.$opts()['$[]']("seconds_between_poll")], (TMP_30 = function(){var self = TMP_30.$$s || this;

            return self.$get_queued_data("read", nil)}, TMP_30.$$s = self, TMP_30.$$arity = 0, TMP_30));
            } else {
            return nil
          };
          } else {
          return nil
        };
      }, TMP_ClientDrivers_initialize_client_drivers_on_boot_31.$$arity = 0);
      return Opal.defs(self, '$polling_path', TMP_ClientDrivers_polling_path_32 = function $$polling_path(to, id) {
        var self = this, s = nil;

        if (id == null) {
          id = nil;
        }
        
        s = "" + (window.HyperstackEnginePath) + "/hyperstack-" + (to) + "/" + (self.$opts()['$[]']("id"));
        if ($truthy(id)) {
          s = "" + (s) + "/" + (id)};
        return s;
      }, TMP_ClientDrivers_polling_path_32.$$arity = -2);
    })($nesting[0], null, $nesting);
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/exception"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $truthy = Opal.truthy;

  Opal.add_stubs(['$new', '$collect', '$[]', '$attr_accessor', '$+', '$to_s', '$on_error', '$as_json', '$errors', '$is_a?', '$new_from_error_hash']);
  
  (function($base, $parent_nesting) {
    var $Mutations, self = $Mutations = $module($base, 'Mutations');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $ErrorArray(){};
      var self = $ErrorArray = $klass($base, $super, 'ErrorArray', $ErrorArray);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ErrorArray_new_from_error_hash_2;

      return Opal.defs(self, '$new_from_error_hash', TMP_ErrorArray_new_from_error_hash_2 = function $$new_from_error_hash(errors) {
        var TMP_1, self = this;

        return self.$new($send(errors, 'collect', [], (TMP_1 = function(key, values){var self = TMP_1.$$s || this;
if (key == null) key = nil;if (values == null) values = nil;
        return Opal.const_get_relative($nesting, 'ErrorAtom').$new(key, values['$[]']("symbol"), values)}, TMP_1.$$s = self, TMP_1.$$arity = 2, TMP_1)))
      }, TMP_ErrorArray_new_from_error_hash_2.$$arity = 1)
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    
    (function($base, $super, $parent_nesting) {
      function $AccessViolation(){};
      var self = $AccessViolation = $klass($base, $super, 'AccessViolation', $AccessViolation);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_AccessViolation_initialize_3, TMP_AccessViolation___hyperstack_on_error_4;

      
      self.$attr_accessor("details");
      
      Opal.defn(self, '$initialize', TMP_AccessViolation_initialize_3 = function $$initialize(message, details) {
        var self = this, $iter = TMP_AccessViolation_initialize_3.$$p, $yield = $iter || nil;

        if (message == null) {
          message = nil;
        }
        if (details == null) {
          details = nil;
        }
        if ($iter) TMP_AccessViolation_initialize_3.$$p = null;
        
        $send(self, Opal.find_super_dispatcher(self, 'initialize', TMP_AccessViolation_initialize_3, false), ["" + "Hyperstack::AccessViolation" + ((function() {if ($truthy(message)) {
          return $rb_plus(":", message.$to_s())
          } else {
          return nil
        }; return nil; })())], null);
        return (self.details = details);
      }, TMP_AccessViolation_initialize_3.$$arity = -1);
      return (Opal.defn(self, '$__hyperstack_on_error', TMP_AccessViolation___hyperstack_on_error_4 = function $$__hyperstack_on_error(operation, params, fmted_message) {
        var self = this;

        return Opal.const_get_relative($nesting, 'Hyperstack').$on_error(operation, self, params, fmted_message)
      }, TMP_AccessViolation___hyperstack_on_error_4.$$arity = 3), nil) && '__hyperstack_on_error';
    })($nesting[0], Opal.const_get_relative($nesting, 'StandardError'), $nesting);
    (function($base, $super, $parent_nesting) {
      function $Operation(){};
      var self = $Operation = $klass($base, $super, 'Operation', $Operation);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return (function($base, $super, $parent_nesting) {
        function $ValidationException(){};
        var self = $ValidationException = $klass($base, $super, 'ValidationException', $ValidationException);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ValidationException_as_json_5, TMP_ValidationException_initialize_6;

        
        
        Opal.defn(self, '$as_json', TMP_ValidationException_as_json_5 = function $$as_json($a_rest) {
          var self = this;

          return self.$errors().$as_json()
        }, TMP_ValidationException_as_json_5.$$arity = -1);
        return (Opal.defn(self, '$initialize', TMP_ValidationException_initialize_6 = function $$initialize(errors) {
          var self = this, $iter = TMP_ValidationException_initialize_6.$$p, $yield = $iter || nil;

          if ($iter) TMP_ValidationException_initialize_6.$$p = null;
          
          if ($truthy(errors['$is_a?'](Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Mutations'), 'ErrorHash')))) {
            } else {
            errors = Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Mutations'), 'ErrorArray').$new_from_error_hash(errors)
          };
          return $send(self, Opal.find_super_dispatcher(self, 'initialize', TMP_ValidationException_initialize_6, false), [errors], null);
        }, TMP_ValidationException_initialize_6.$$arity = 1), nil) && 'initialize';
      })($nesting[0], Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Mutations'), 'ValidationException'), $nesting)
    })($nesting[0], null, $nesting);
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/promise"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_le(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs <= rhs : lhs['$<='](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass, $hash2 = Opal.hash2, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$resolve', '$new', '$reject', '$attr_reader', '$===', '$value', '$has_key?', '$keys', '$!', '$==', '$realized?', '$<<', '$>>', '$exception?', '$[]', '$resolved?', '$rejected?', '$error', '$include?', '$action', '$raise', '$^', '$call', '$resolve!', '$exception!', '$any?', '$each', '$reject!', '$there_can_be_only_one!', '$then', '$to_proc', '$fail', '$always', '$trace', '$class', '$object_id', '$+', '$inspect', '$act?', '$nil?', '$prev', '$push', '$concat', '$it', '$proc', '$reverse', '$pop', '$<=', '$length', '$shift', '$-', '$wait', '$map', '$reduce', '$try', '$tap', '$all?', '$find']);
  return (function($base, $super, $parent_nesting) {
    function $Promise(){};
    var self = $Promise = $klass($base, $super, 'Promise', $Promise);

    var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Promise_value_1, TMP_Promise_error_2, TMP_Promise_when_3, TMP_Promise_initialize_4, TMP_Promise_value_5, TMP_Promise_act$q_6, TMP_Promise_action_7, TMP_Promise_exception$q_8, TMP_Promise_realized$q_9, TMP_Promise_resolved$q_10, TMP_Promise_rejected$q_11, TMP_Promise_pending$q_12, TMP_Promise_$_13, TMP_Promise_$lt$lt_14, TMP_Promise_$gt$gt_15, TMP_Promise_resolve_16, TMP_Promise_resolve$B_18, TMP_Promise_reject_19, TMP_Promise_reject$B_21, TMP_Promise_exception$B_22, TMP_Promise_then_23, TMP_Promise_then$B_24, TMP_Promise_fail_25, TMP_Promise_fail$B_26, TMP_Promise_always_27, TMP_Promise_always$B_28, TMP_Promise_trace_29, TMP_Promise_trace$B_30, TMP_Promise_there_can_be_only_one$B_31, TMP_Promise_inspect_32;

    def.value = def.action = def.exception = def.realized = def.next = def.delayed = def.error = def.prev = nil;
    
    Opal.defs(self, '$value', TMP_Promise_value_1 = function $$value(value) {
      var self = this;

      return self.$new().$resolve(value)
    }, TMP_Promise_value_1.$$arity = 1);
    Opal.defs(self, '$error', TMP_Promise_error_2 = function $$error(value) {
      var self = this;

      return self.$new().$reject(value)
    }, TMP_Promise_error_2.$$arity = 1);
    Opal.defs(self, '$when', TMP_Promise_when_3 = function $$when($a_rest) {
      var self = this, promises;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      promises = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        promises[$arg_idx - 0] = arguments[$arg_idx];
      }
      return Opal.const_get_relative($nesting, 'When').$new(promises)
    }, TMP_Promise_when_3.$$arity = -1);
    self.$attr_reader("error", "prev", "next");
    
    Opal.defn(self, '$initialize', TMP_Promise_initialize_4 = function $$initialize(action) {
      var self = this;

      if (action == null) {
        action = $hash2([], {});
      }
      
      self.action = action;
      self.realized = false;
      self.exception = false;
      self.value = nil;
      self.error = nil;
      self.delayed = false;
      self.prev = nil;
      return (self.next = []);
    }, TMP_Promise_initialize_4.$$arity = -1);
    
    Opal.defn(self, '$value', TMP_Promise_value_5 = function $$value() {
      var self = this;

      if ($truthy(Opal.const_get_relative($nesting, 'Promise')['$==='](self.value))) {
        return self.value.$value()
        } else {
        return self.value
      }
    }, TMP_Promise_value_5.$$arity = 0);
    
    Opal.defn(self, '$act?', TMP_Promise_act$q_6 = function() {
      var $a, self = this;

      return ($truthy($a = self.action['$has_key?']("success")) ? $a : self.action['$has_key?']("always"))
    }, TMP_Promise_act$q_6.$$arity = 0);
    
    Opal.defn(self, '$action', TMP_Promise_action_7 = function $$action() {
      var self = this;

      return self.action.$keys()
    }, TMP_Promise_action_7.$$arity = 0);
    
    Opal.defn(self, '$exception?', TMP_Promise_exception$q_8 = function() {
      var self = this;

      return self.exception
    }, TMP_Promise_exception$q_8.$$arity = 0);
    
    Opal.defn(self, '$realized?', TMP_Promise_realized$q_9 = function() {
      var self = this;

      return self.realized['$!']()['$!']()
    }, TMP_Promise_realized$q_9.$$arity = 0);
    
    Opal.defn(self, '$resolved?', TMP_Promise_resolved$q_10 = function() {
      var self = this;

      return self.realized['$==']("resolve")
    }, TMP_Promise_resolved$q_10.$$arity = 0);
    
    Opal.defn(self, '$rejected?', TMP_Promise_rejected$q_11 = function() {
      var self = this;

      return self.realized['$==']("reject")
    }, TMP_Promise_rejected$q_11.$$arity = 0);
    
    Opal.defn(self, '$pending?', TMP_Promise_pending$q_12 = function() {
      var self = this;

      return self['$realized?']()['$!']()
    }, TMP_Promise_pending$q_12.$$arity = 0);
    
    Opal.defn(self, '$^', TMP_Promise_$_13 = function(promise) {
      var self = this;

      
      promise['$<<'](self);
      self['$>>'](promise);
      return promise;
    }, TMP_Promise_$_13.$$arity = 1);
    
    Opal.defn(self, '$<<', TMP_Promise_$lt$lt_14 = function(promise) {
      var self = this;

      
      self.prev = promise;
      return self;
    }, TMP_Promise_$lt$lt_14.$$arity = 1);
    
    Opal.defn(self, '$>>', TMP_Promise_$gt$gt_15 = function(promise) {
      var $a, self = this;

      
      self.next['$<<'](promise);
      if ($truthy(self['$exception?']())) {
        promise.$reject(self.delayed['$[]'](0))
      } else if ($truthy(self['$resolved?']())) {
        promise.$resolve((function() {if ($truthy(self.delayed)) {
          return self.delayed['$[]'](0)
          } else {
          return self.$value()
        }; return nil; })())
      } else if ($truthy(self['$rejected?']())) {
        if ($truthy(($truthy($a = self.action['$has_key?']("failure")['$!']()) ? $a : Opal.const_get_relative($nesting, 'Promise')['$===']((function() {if ($truthy(self.delayed)) {
          return self.delayed['$[]'](0)
          } else {
          return self.error
        }; return nil; })())))) {
          promise.$reject((function() {if ($truthy(self.delayed)) {
            return self.delayed['$[]'](0)
            } else {
            return self.$error()
          }; return nil; })())
        } else if ($truthy(promise.$action()['$include?']("always"))) {
          promise.$reject((function() {if ($truthy(self.delayed)) {
            return self.delayed['$[]'](0)
            } else {
            return self.$error()
          }; return nil; })())}};
      return self;
    }, TMP_Promise_$gt$gt_15.$$arity = 1);
    
    Opal.defn(self, '$resolve', TMP_Promise_resolve_16 = function $$resolve(value) {
      var $a, self = this, block = nil, e = nil;

      if (value == null) {
        value = nil;
      }
      
      if ($truthy(self['$realized?']())) {
        self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "the promise has already been realized")};
      if ($truthy(Opal.const_get_relative($nesting, 'Promise')['$==='](value))) {
        return value['$<<'](self.prev)['$^'](self)};
      
      try {
        
        if ($truthy((block = ($truthy($a = self.action['$[]']("success")) ? $a : self.action['$[]']("always"))))) {
          value = block.$call(value)};
        self['$resolve!'](value);
      } catch ($err) {
        if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exception')])) {e = $err;
          try {
            self['$exception!'](e)
          } finally { Opal.pop_exception() }
        } else { throw $err; }
      };;
      return self;
    }, TMP_Promise_resolve_16.$$arity = -1);
    
    Opal.defn(self, '$resolve!', TMP_Promise_resolve$B_18 = function(value) {
      var TMP_17, self = this;

      
      self.realized = "resolve";
      self.value = value;
      if ($truthy(self.next['$any?']())) {
        return $send(self.next, 'each', [], (TMP_17 = function(p){var self = TMP_17.$$s || this;
if (p == null) p = nil;
        return p.$resolve(value)}, TMP_17.$$s = self, TMP_17.$$arity = 1, TMP_17))
        } else {
        return (self.delayed = [value])
      };
    }, TMP_Promise_resolve$B_18.$$arity = 1);
    
    Opal.defn(self, '$reject', TMP_Promise_reject_19 = function $$reject(value) {
      var $a, self = this, block = nil, e = nil;

      if (value == null) {
        value = nil;
      }
      
      if ($truthy(self['$realized?']())) {
        self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "the promise has already been realized")};
      if ($truthy(Opal.const_get_relative($nesting, 'Promise')['$==='](value))) {
        return value['$<<'](self.prev)['$^'](self)};
      
      try {
        
        if ($truthy((block = ($truthy($a = self.action['$[]']("failure")) ? $a : self.action['$[]']("always"))))) {
          value = block.$call(value)};
        if ($truthy(self.action['$has_key?']("always"))) {
          self['$resolve!'](value)
          } else {
          self['$reject!'](value)
        };
      } catch ($err) {
        if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exception')])) {e = $err;
          try {
            self['$exception!'](e)
          } finally { Opal.pop_exception() }
        } else { throw $err; }
      };;
      return self;
    }, TMP_Promise_reject_19.$$arity = -1);
    
    Opal.defn(self, '$reject!', TMP_Promise_reject$B_21 = function(value) {
      var TMP_20, self = this;

      
      self.realized = "reject";
      self.error = value;
      if ($truthy(self.next['$any?']())) {
        return $send(self.next, 'each', [], (TMP_20 = function(p){var self = TMP_20.$$s || this;
if (p == null) p = nil;
        return p.$reject(value)}, TMP_20.$$s = self, TMP_20.$$arity = 1, TMP_20))
        } else {
        return (self.delayed = [value])
      };
    }, TMP_Promise_reject$B_21.$$arity = 1);
    
    Opal.defn(self, '$exception!', TMP_Promise_exception$B_22 = function(error) {
      var self = this;

      
      self.exception = true;
      return self['$reject!'](error);
    }, TMP_Promise_exception$B_22.$$arity = 1);
    
    Opal.defn(self, '$then', TMP_Promise_then_23 = function $$then() {
      var self = this, $iter = TMP_Promise_then_23.$$p, block = $iter || nil;

      if ($iter) TMP_Promise_then_23.$$p = null;
      return self['$^'](Opal.const_get_relative($nesting, 'Promise').$new($hash2(["success"], {"success": block})))
    }, TMP_Promise_then_23.$$arity = 0);
    
    Opal.defn(self, '$then!', TMP_Promise_then$B_24 = function() {
      var self = this, $iter = TMP_Promise_then$B_24.$$p, block = $iter || nil;

      if ($iter) TMP_Promise_then$B_24.$$p = null;
      
      self['$there_can_be_only_one!']();
      return $send(self, 'then', [], block.$to_proc());
    }, TMP_Promise_then$B_24.$$arity = 0);
    Opal.alias(self, "do", "then");
    Opal.alias(self, "do!", "then!");
    
    Opal.defn(self, '$fail', TMP_Promise_fail_25 = function $$fail() {
      var self = this, $iter = TMP_Promise_fail_25.$$p, block = $iter || nil;

      if ($iter) TMP_Promise_fail_25.$$p = null;
      return self['$^'](Opal.const_get_relative($nesting, 'Promise').$new($hash2(["failure"], {"failure": block})))
    }, TMP_Promise_fail_25.$$arity = 0);
    
    Opal.defn(self, '$fail!', TMP_Promise_fail$B_26 = function() {
      var self = this, $iter = TMP_Promise_fail$B_26.$$p, block = $iter || nil;

      if ($iter) TMP_Promise_fail$B_26.$$p = null;
      
      self['$there_can_be_only_one!']();
      return $send(self, 'fail', [], block.$to_proc());
    }, TMP_Promise_fail$B_26.$$arity = 0);
    Opal.alias(self, "rescue", "fail");
    Opal.alias(self, "catch", "fail");
    Opal.alias(self, "rescue!", "fail!");
    Opal.alias(self, "catch!", "fail!");
    
    Opal.defn(self, '$always', TMP_Promise_always_27 = function $$always() {
      var self = this, $iter = TMP_Promise_always_27.$$p, block = $iter || nil;

      if ($iter) TMP_Promise_always_27.$$p = null;
      return self['$^'](Opal.const_get_relative($nesting, 'Promise').$new($hash2(["always"], {"always": block})))
    }, TMP_Promise_always_27.$$arity = 0);
    
    Opal.defn(self, '$always!', TMP_Promise_always$B_28 = function() {
      var self = this, $iter = TMP_Promise_always$B_28.$$p, block = $iter || nil;

      if ($iter) TMP_Promise_always$B_28.$$p = null;
      
      self['$there_can_be_only_one!']();
      return $send(self, 'always', [], block.$to_proc());
    }, TMP_Promise_always$B_28.$$arity = 0);
    Opal.alias(self, "finally", "always");
    Opal.alias(self, "ensure", "always");
    Opal.alias(self, "finally!", "always!");
    Opal.alias(self, "ensure!", "always!");
    
    Opal.defn(self, '$trace', TMP_Promise_trace_29 = function $$trace(depth) {
      var self = this, $iter = TMP_Promise_trace_29.$$p, block = $iter || nil;

      if (depth == null) {
        depth = nil;
      }
      if ($iter) TMP_Promise_trace_29.$$p = null;
      return self['$^'](Opal.const_get_relative($nesting, 'Trace').$new(depth, block))
    }, TMP_Promise_trace_29.$$arity = -1);
    
    Opal.defn(self, '$trace!', TMP_Promise_trace$B_30 = function($a_rest) {
      var self = this, args, $iter = TMP_Promise_trace$B_30.$$p, block = $iter || nil;

      var $args_len = arguments.length, $rest_len = $args_len - 0;
      if ($rest_len < 0) { $rest_len = 0; }
      args = new Array($rest_len);
      for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
        args[$arg_idx - 0] = arguments[$arg_idx];
      }
      if ($iter) TMP_Promise_trace$B_30.$$p = null;
      
      self['$there_can_be_only_one!']();
      return $send(self, 'trace', Opal.to_a(args), block.$to_proc());
    }, TMP_Promise_trace$B_30.$$arity = -1);
    
    Opal.defn(self, '$there_can_be_only_one!', TMP_Promise_there_can_be_only_one$B_31 = function() {
      var self = this;

      if ($truthy(self.next['$any?']())) {
        return self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "a promise has already been chained")
        } else {
        return nil
      }
    }, TMP_Promise_there_can_be_only_one$B_31.$$arity = 0);
    
    Opal.defn(self, '$inspect', TMP_Promise_inspect_32 = function $$inspect() {
      var $a, self = this, result = nil;

      
      result = "" + "#<" + (self.$class()) + "(" + (self.$object_id()) + ")";
      if ($truthy(self.next['$any?']())) {
        result = $rb_plus(result, "" + " >> " + (self.next.$inspect()))};
      if ($truthy(self['$realized?']())) {
        result = $rb_plus(result, "" + ": " + (($truthy($a = self.value) ? $a : self.error).$inspect()) + ">")
        } else {
        result = $rb_plus(result, ">")
      };
      return result;
    }, TMP_Promise_inspect_32.$$arity = 0);
    (function($base, $super, $parent_nesting) {
      function $Trace(){};
      var self = $Trace = $klass($base, $super, 'Trace', $Trace);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Trace_it_33, TMP_Trace_initialize_34;

      
      Opal.defs(self, '$it', TMP_Trace_it_33 = function $$it(promise) {
        var $a, self = this, current = nil, prev = nil;

        
        current = [];
        if ($truthy(($truthy($a = promise['$act?']()) ? $a : promise.$prev()['$nil?']()))) {
          current.$push(promise.$value())};
        if ($truthy((prev = promise.$prev()))) {
          return current.$concat(self.$it(prev))
          } else {
          return current
        };
      }, TMP_Trace_it_33.$$arity = 1);
      return (Opal.defn(self, '$initialize', TMP_Trace_initialize_34 = function $$initialize(depth, block) {
        var TMP_35, self = this, $iter = TMP_Trace_initialize_34.$$p, $yield = $iter || nil;

        if ($iter) TMP_Trace_initialize_34.$$p = null;
        
        self.depth = depth;
        return $send(self, Opal.find_super_dispatcher(self, 'initialize', TMP_Trace_initialize_34, false), [$hash2(["success"], {"success": $send(self, 'proc', [], (TMP_35 = function(){var self = TMP_35.$$s || this, $a, trace = nil;

        
          trace = Opal.const_get_relative($nesting, 'Trace').$it(self).$reverse();
          trace.$pop();
          if ($truthy(($truthy($a = depth) ? $rb_le(depth, trace.$length()) : $a))) {
            trace.$shift($rb_minus(trace.$length(), depth))};
          return $send(block, 'call', Opal.to_a(trace));}, TMP_35.$$s = self, TMP_35.$$arity = 0, TMP_35))})], null);
      }, TMP_Trace_initialize_34.$$arity = 2), nil) && 'initialize';
    })($nesting[0], self, $nesting);
    return (function($base, $super, $parent_nesting) {
      function $When(){};
      var self = $When = $klass($base, $super, 'When', $When);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_When_initialize_36, TMP_When_each_38, TMP_When_collect_40, TMP_When_inject_42, TMP_When_wait_45, TMP_When_$gt$gt_46, TMP_When_try_48;

      def.wait = nil;
      
      
      Opal.defn(self, '$initialize', TMP_When_initialize_36 = function $$initialize(promises) {
        var TMP_37, self = this, $iter = TMP_When_initialize_36.$$p, $yield = $iter || nil;

        if (promises == null) {
          promises = [];
        }
        if ($iter) TMP_When_initialize_36.$$p = null;
        
        $send(self, Opal.find_super_dispatcher(self, 'initialize', TMP_When_initialize_36, false), [], null);
        self.wait = [];
        return $send(promises, 'each', [], (TMP_37 = function(promise){var self = TMP_37.$$s || this;
if (promise == null) promise = nil;
        return self.$wait(promise)}, TMP_37.$$s = self, TMP_37.$$arity = 1, TMP_37));
      }, TMP_When_initialize_36.$$arity = -1);
      
      Opal.defn(self, '$each', TMP_When_each_38 = function $$each() {
        var TMP_39, self = this, $iter = TMP_When_each_38.$$p, block = $iter || nil;

        if ($iter) TMP_When_each_38.$$p = null;
        
        if ($truthy(block)) {
          } else {
          self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "no block given")
        };
        return $send(self, 'then', [], (TMP_39 = function(values){var self = TMP_39.$$s || this;
if (values == null) values = nil;
        return $send(values, 'each', [], block.$to_proc())}, TMP_39.$$s = self, TMP_39.$$arity = 1, TMP_39));
      }, TMP_When_each_38.$$arity = 0);
      
      Opal.defn(self, '$collect', TMP_When_collect_40 = function $$collect() {
        var TMP_41, self = this, $iter = TMP_When_collect_40.$$p, block = $iter || nil;

        if ($iter) TMP_When_collect_40.$$p = null;
        
        if ($truthy(block)) {
          } else {
          self.$raise(Opal.const_get_relative($nesting, 'ArgumentError'), "no block given")
        };
        return $send(self, 'then', [], (TMP_41 = function(values){var self = TMP_41.$$s || this;
if (values == null) values = nil;
        return Opal.const_get_relative($nesting, 'When').$new($send(values, 'map', [], block.$to_proc()))}, TMP_41.$$s = self, TMP_41.$$arity = 1, TMP_41));
      }, TMP_When_collect_40.$$arity = 0);
      
      Opal.defn(self, '$inject', TMP_When_inject_42 = function $$inject($a_rest) {
        var TMP_43, self = this, args, $iter = TMP_When_inject_42.$$p, block = $iter || nil;

        var $args_len = arguments.length, $rest_len = $args_len - 0;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 0] = arguments[$arg_idx];
        }
        if ($iter) TMP_When_inject_42.$$p = null;
        return $send(self, 'then', [], (TMP_43 = function(values){var self = TMP_43.$$s || this;
if (values == null) values = nil;
        return $send(values, 'reduce', Opal.to_a(args), block.$to_proc())}, TMP_43.$$s = self, TMP_43.$$arity = 1, TMP_43))
      }, TMP_When_inject_42.$$arity = -1);
      Opal.alias(self, "map", "collect");
      Opal.alias(self, "reduce", "inject");
      
      Opal.defn(self, '$wait', TMP_When_wait_45 = function $$wait(promise) {
        var TMP_44, self = this;

        
        if ($truthy(Opal.const_get_relative($nesting, 'Promise')['$==='](promise))) {
          } else {
          promise = Opal.const_get_relative($nesting, 'Promise').$value(promise)
        };
        if ($truthy(promise['$act?']())) {
          promise = promise.$then()};
        self.wait['$<<'](promise);
        $send(promise, 'always', [], (TMP_44 = function(){var self = TMP_44.$$s || this;
          if (self.next == null) self.next = nil;

        if ($truthy(self.next['$any?']())) {
            return self.$try()
            } else {
            return nil
          }}, TMP_44.$$s = self, TMP_44.$$arity = 0, TMP_44));
        return self;
      }, TMP_When_wait_45.$$arity = 1);
      Opal.alias(self, "and", "wait");
      
      Opal.defn(self, '$>>', TMP_When_$gt$gt_46 = function($a_rest) {
        var TMP_47, self = this, $iter = TMP_When_$gt$gt_46.$$p, $yield = $iter || nil, $zuper = nil, $zuper_i = nil, $zuper_ii = nil;

        if ($iter) TMP_When_$gt$gt_46.$$p = null;
        // Prepare super implicit arguments
        for($zuper_i = 0, $zuper_ii = arguments.length, $zuper = new Array($zuper_ii); $zuper_i < $zuper_ii; $zuper_i++) {
          $zuper[$zuper_i] = arguments[$zuper_i];
        }
        return $send($send(self, Opal.find_super_dispatcher(self, '>>', TMP_When_$gt$gt_46, false), $zuper, $iter), 'tap', [], (TMP_47 = function(){var self = TMP_47.$$s || this;

        return self.$try()}, TMP_47.$$s = self, TMP_47.$$arity = 0, TMP_47))
      }, TMP_When_$gt$gt_46.$$arity = -1);
      return (Opal.defn(self, '$try', TMP_When_try_48 = function() {
        var self = this, promise = nil;

        if ($truthy($send(self.wait, 'all?', [], "realized?".$to_proc()))) {
          if ($truthy((promise = $send(self.wait, 'find', [], "rejected?".$to_proc())))) {
            return self.$reject(promise.$error())
            } else {
            return self.$resolve($send(self.wait, 'map', [], "value".$to_proc()))
          }
          } else {
          return nil
        }
      }, TMP_When_try_48.$$arity = 0), nil) && 'try';
    })($nesting[0], self, $nesting);
  })($nesting[0], null, $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/railway"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass;

  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Operation(){};
      var self = $Operation = $klass($base, $super, 'Operation', $Operation);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return nil
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/api"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2, $hash = Opal.hash;

  Opal.add_stubs(['$is_a?', '$raise', '$new', '$tap', '$split', '$to_s', '$pop', '$inject', '$[]', '$to_sym', '$[]=', '$-', '$!', '$nil?', '$abort!', '$succeed!', '$_Railway', '$class', '$_run', '$instance_eval', '$process_params', '$process_validations', '$run', '$dispatch', '$result', '$then', '$to_proc', '$fail', '$add_param', '$get_name_and_opts', '$merge', '$each', '$add_validation', '$add_error', '$add_step', '$add_failed', '$add_async', '$add_receiver', '$singleton_class', '$define_singleton_method', '$set_var', '$superclass', '$==', '$instance_variable_get', '$instance_variable_set', '$dup']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Operation(){};
      var self = $Operation = $klass($base, $super, 'Operation', $Operation);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Operation_add_error_3, TMP_Operation_has_errors$q_4, TMP_Operation_params_5, TMP_Operation_abort$B_6, TMP_Operation_succeed$B_7, TMP_Operation_initialize_8;

      def.errors = def.params = nil;
      
      
      Opal.defn(self, '$add_error', TMP_Operation_add_error_3 = function $$add_error(key, kind, message) {
        var $a, TMP_1, self = this;

        if (message == null) {
          message = nil;
        }
        
        if ($truthy(kind['$is_a?'](Opal.const_get_relative($nesting, 'Symbol')))) {
          } else {
          self.$raise(Opal.const_get_relative($nesting, 'ArgumentError').$new("Invalid kind"))
        };
        self.errors = ($truthy($a = self.errors) ? $a : Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Mutations'), 'ErrorHash').$new());
        return $send(self.errors, 'tap', [], (TMP_1 = function(errs){var self = TMP_1.$$s || this, TMP_2, path = nil, last = nil, inner = nil, $writer = nil;
if (errs == null) errs = nil;
        
          path = key.$to_s().$split(".");
          last = path.$pop();
          inner = $send(path, 'inject', [errs], (TMP_2 = function(cur_errors, part){var self = TMP_2.$$s || this, $b, $writer = nil;
if (cur_errors == null) cur_errors = nil;if (part == null) part = nil;
          return ($truthy($b = cur_errors['$[]'](part.$to_sym())) ? $b : (($writer = [part.$to_sym(), Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Mutations'), 'ErrorHash').$new()]), $send(cur_errors, '[]=', Opal.to_a($writer)), $writer[$rb_minus($writer["length"], 1)]))}, TMP_2.$$s = self, TMP_2.$$arity = 2, TMP_2));
          
          $writer = [last, Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Mutations'), 'ErrorAtom').$new(key, kind, $hash2(["message"], {"message": message}))];
          $send(inner, '[]=', Opal.to_a($writer));
          return $writer[$rb_minus($writer["length"], 1)];;}, TMP_1.$$s = self, TMP_1.$$arity = 1, TMP_1));
      }, TMP_Operation_add_error_3.$$arity = -3);
      
      Opal.defn(self, '$has_errors?', TMP_Operation_has_errors$q_4 = function() {
        var self = this;

        return self.errors['$nil?']()['$!']()
      }, TMP_Operation_has_errors$q_4.$$arity = 0);
      
      Opal.defn(self, '$params', TMP_Operation_params_5 = function $$params() {
        var self = this;

        return self.params
      }, TMP_Operation_params_5.$$arity = 0);
      
      Opal.defn(self, '$abort!', TMP_Operation_abort$B_6 = function(arg) {
        var self = this;

        if (arg == null) {
          arg = nil;
        }
        return Opal.const_get_relative($nesting, 'Railway')['$abort!'](arg)
      }, TMP_Operation_abort$B_6.$$arity = -1);
      
      Opal.defn(self, '$succeed!', TMP_Operation_succeed$B_7 = function(arg) {
        var self = this;

        if (arg == null) {
          arg = nil;
        }
        return Opal.const_get_relative($nesting, 'Railway')['$succeed!'](arg)
      }, TMP_Operation_succeed$B_7.$$arity = -1);
      
      Opal.defn(self, '$initialize', TMP_Operation_initialize_8 = function $$initialize() {
        var self = this;

        return (self._railway = self.$class().$_Railway().$new(self))
      }, TMP_Operation_initialize_8.$$arity = 0);
      (function(self, $parent_nesting) {
        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_run_9, TMP__run_11, TMP_then_12, TMP_fail_13, TMP_param_14, TMP_inbound_15, TMP_outbound_17, TMP_validate_18, TMP_add_error_19, TMP_step_20, TMP_failed_21, TMP_async_22, TMP_on_dispatch_23, TMP__Railway_24, TMP_inherited_38;

        
        
        Opal.defn(self, '$run', TMP_run_9 = function $$run($a_rest) {
          var self = this, args;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          return $send(self, '_run', Opal.to_a(args))
        }, TMP_run_9.$$arity = -1);
        
        Opal.defn(self, '$_run', TMP__run_11 = function $$_run($a_rest) {
          var TMP_10, self = this, args;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          return $send(self.$new(), 'instance_eval', [], (TMP_10 = function(){var self = TMP_10.$$s || this;
            if (self._railway == null) self._railway = nil;

          
            self._railway.$process_params(args);
            self._railway.$process_validations();
            self._railway.$run();
            self._railway.$dispatch();
            return self._railway.$result();}, TMP_10.$$s = self, TMP_10.$$arity = 0, TMP_10))
        }, TMP__run_11.$$arity = -1);
        
        Opal.defn(self, '$then', TMP_then_12 = function $$then($a_rest) {
          var self = this, args, $iter = TMP_then_12.$$p, block = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_then_12.$$p = null;
          return $send($send(self, 'run', Opal.to_a(args)), 'then', [], block.$to_proc())
        }, TMP_then_12.$$arity = -1);
        
        Opal.defn(self, '$fail', TMP_fail_13 = function $$fail($a_rest) {
          var self = this, args, $iter = TMP_fail_13.$$p, block = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_fail_13.$$p = null;
          return $send($send(self, 'run', Opal.to_a(args)), 'fail', [], block.$to_proc())
        }, TMP_fail_13.$$arity = -1);
        
        Opal.defn(self, '$param', TMP_param_14 = function $$param($a_rest) {
          var self = this, args, $iter = TMP_param_14.$$p, block = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_param_14.$$p = null;
          return $send(self.$_Railway(), 'add_param', Opal.to_a(args), block.$to_proc())
        }, TMP_param_14.$$arity = -1);
        
        Opal.defn(self, '$inbound', TMP_inbound_15 = function $$inbound($a_rest) {
          var $b, $c, self = this, args, $iter = TMP_inbound_15.$$p, block = $iter || nil, name = nil, opts = nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_inbound_15.$$p = null;
          
          $c = $send(Opal.const_get_relative($nesting, 'ParamsWrapper'), 'get_name_and_opts', Opal.to_a(args)), $b = Opal.to_ary($c), (name = ($b[0] == null ? nil : $b[0])), (opts = ($b[1] == null ? nil : $b[1])), $c;
          return $send(self.$_Railway(), 'add_param', [name, opts.$merge($hash2(["inbound"], {"inbound": "true"}))], block.$to_proc());
        }, TMP_inbound_15.$$arity = -1);
        
        Opal.defn(self, '$outbound', TMP_outbound_17 = function $$outbound($a_rest) {
          var TMP_16, self = this, keys;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          keys = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            keys[$arg_idx - 0] = arguments[$arg_idx];
          }
          return $send(keys, 'each', [], (TMP_16 = function(key){var self = TMP_16.$$s || this;
if (key == null) key = nil;
          return self.$_Railway().$add_param($hash(key, nil, "type", "outbound"))}, TMP_16.$$s = self, TMP_16.$$arity = 1, TMP_16))
        }, TMP_outbound_17.$$arity = -1);
        
        Opal.defn(self, '$validate', TMP_validate_18 = function $$validate($a_rest) {
          var self = this, args, $iter = TMP_validate_18.$$p, block = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_validate_18.$$p = null;
          return $send(self.$_Railway(), 'add_validation', Opal.to_a(args), block.$to_proc())
        }, TMP_validate_18.$$arity = -1);
        
        Opal.defn(self, '$add_error', TMP_add_error_19 = function $$add_error(param, symbol, message, $a_rest) {
          var self = this, args, $iter = TMP_add_error_19.$$p, block = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 3;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 3; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 3] = arguments[$arg_idx];
          }
          if ($iter) TMP_add_error_19.$$p = null;
          return $send(self.$_Railway(), 'add_error', [param, symbol, message].concat(Opal.to_a(args)), block.$to_proc())
        }, TMP_add_error_19.$$arity = -4);
        
        Opal.defn(self, '$step', TMP_step_20 = function $$step($a_rest) {
          var self = this, args, $iter = TMP_step_20.$$p, block = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_step_20.$$p = null;
          return $send(self.$_Railway(), 'add_step', Opal.to_a(args), block.$to_proc())
        }, TMP_step_20.$$arity = -1);
        
        Opal.defn(self, '$failed', TMP_failed_21 = function $$failed($a_rest) {
          var self = this, args, $iter = TMP_failed_21.$$p, block = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_failed_21.$$p = null;
          return $send(self.$_Railway(), 'add_failed', Opal.to_a(args), block.$to_proc())
        }, TMP_failed_21.$$arity = -1);
        
        Opal.defn(self, '$async', TMP_async_22 = function $$async($a_rest) {
          var self = this, args, $iter = TMP_async_22.$$p, block = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_async_22.$$p = null;
          return $send(self.$_Railway(), 'add_async', Opal.to_a(args), block.$to_proc())
        }, TMP_async_22.$$arity = -1);
        
        Opal.defn(self, '$on_dispatch', TMP_on_dispatch_23 = function $$on_dispatch() {
          var self = this, $iter = TMP_on_dispatch_23.$$p, block = $iter || nil;

          if ($iter) TMP_on_dispatch_23.$$p = null;
          return $send(self.$_Railway(), 'add_receiver', [], block.$to_proc())
        }, TMP_on_dispatch_23.$$arity = 0);
        
        Opal.defn(self, '$_Railway', TMP__Railway_24 = function $$_Railway() {
          var self = this;

          return self.$singleton_class().$_Railway()
        }, TMP__Railway_24.$$arity = 0);
        return (Opal.defn(self, '$inherited', TMP_inherited_38 = function $$inherited(child) {
          var TMP_25, TMP_26, TMP_27, TMP_29, TMP_30, TMP_31, TMP_32, TMP_33, TMP_34, self = this;

          
          $send(child.$singleton_class(), 'define_singleton_method', ["param"], (TMP_25 = function($a_rest){var self = TMP_25.$$s || this, block, args;

            block = TMP_25.$$p || nil;
            if (block) TMP_25.$$p = null;
            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
          return $send(self.$_Railway(), 'add_param', Opal.to_a(args), block.$to_proc())}, TMP_25.$$s = self, TMP_25.$$arity = -1, TMP_25));
          $send(child.$singleton_class(), 'define_singleton_method', ["inbound"], (TMP_26 = function($a_rest){var self = TMP_26.$$s || this, block, args, $b, $c, name = nil, opts = nil;

            block = TMP_26.$$p || nil;
            if (block) TMP_26.$$p = null;
            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
          
            $c = $send(Opal.const_get_relative($nesting, 'ParamsWrapper'), 'get_name_and_opts', Opal.to_a(args)), $b = Opal.to_ary($c), (name = ($b[0] == null ? nil : $b[0])), (opts = ($b[1] == null ? nil : $b[1])), $c;
            return $send(self.$_Railway(), 'add_param', [name, opts.$merge($hash2(["inbound"], {"inbound": "true"}))], block.$to_proc());}, TMP_26.$$s = self, TMP_26.$$arity = -1, TMP_26));
          $send(child.$singleton_class(), 'define_singleton_method', ["outbound"], (TMP_27 = function($a_rest){var self = TMP_27.$$s || this, keys, TMP_28;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            keys = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              keys[$arg_idx - 0] = arguments[$arg_idx];
            }
          return $send(keys, 'each', [], (TMP_28 = function(key){var self = TMP_28.$$s || this;
if (key == null) key = nil;
            return self.$_Railway().$add_param($hash(key, nil, "type", "outbound"))}, TMP_28.$$s = self, TMP_28.$$arity = 1, TMP_28))}, TMP_27.$$s = self, TMP_27.$$arity = -1, TMP_27));
          $send(child.$singleton_class(), 'define_singleton_method', ["validate"], (TMP_29 = function($a_rest){var self = TMP_29.$$s || this, block, args;

            block = TMP_29.$$p || nil;
            if (block) TMP_29.$$p = null;
            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
          return $send(self.$_Railway(), 'add_validation', Opal.to_a(args), block.$to_proc())}, TMP_29.$$s = self, TMP_29.$$arity = -1, TMP_29));
          $send(child.$singleton_class(), 'define_singleton_method', ["add_error"], (TMP_30 = function(param, symbol, message, $a_rest){var self = TMP_30.$$s || this, block, args;

            block = TMP_30.$$p || nil;
            if (block) TMP_30.$$p = null;
            var $args_len = arguments.length, $rest_len = $args_len - 3;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 3; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 3] = arguments[$arg_idx];
            }if (param == null) param = nil;if (symbol == null) symbol = nil;if (message == null) message = nil;
          return $send(self.$_Railway(), 'add_error', [param, symbol, message].concat(Opal.to_a(args)), block.$to_proc())}, TMP_30.$$s = self, TMP_30.$$arity = -4, TMP_30));
          $send(child.$singleton_class(), 'define_singleton_method', ["step"], (TMP_31 = function($a_rest){var self = TMP_31.$$s || this, block, args;

            block = TMP_31.$$p || nil;
            if (block) TMP_31.$$p = null;
            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
          return $send(self.$_Railway(), 'add_step', [$hash2(["scope"], {"scope": "class"})].concat(Opal.to_a(args)), block.$to_proc())}, TMP_31.$$s = self, TMP_31.$$arity = -1, TMP_31));
          $send(child.$singleton_class(), 'define_singleton_method', ["failed"], (TMP_32 = function($a_rest){var self = TMP_32.$$s || this, block, args;

            block = TMP_32.$$p || nil;
            if (block) TMP_32.$$p = null;
            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
          return $send(self.$_Railway(), 'add_failed', [$hash2(["scope"], {"scope": "class"})].concat(Opal.to_a(args)), block.$to_proc())}, TMP_32.$$s = self, TMP_32.$$arity = -1, TMP_32));
          $send(child.$singleton_class(), 'define_singleton_method', ["async"], (TMP_33 = function($a_rest){var self = TMP_33.$$s || this, block, args;

            block = TMP_33.$$p || nil;
            if (block) TMP_33.$$p = null;
            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
          return $send(self.$_Railway(), 'add_async', [$hash2(["scope"], {"scope": "class"})].concat(Opal.to_a(args)), block.$to_proc())}, TMP_33.$$s = self, TMP_33.$$arity = -1, TMP_33));
          return $send(child.$singleton_class(), 'define_singleton_method', ["_Railway"], (TMP_34 = function(){var self = TMP_34.$$s || this, TMP_35;

          return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Context'), 'set_var', [self, "@_railway"], (TMP_35 = function(){var self = TMP_35.$$s || this, $a, TMP_36, my_super = nil;

            
              my_super = ($truthy($a = self.$superclass()) ? $a : (self.$$singleton_of).$superclass().$singleton_class());
              if (my_super['$=='](Opal.const_get_relative($nesting, 'Operation').$singleton_class())) {
                return Opal.const_get_relative($nesting, 'Class').$new(Opal.const_get_relative($nesting, 'Railway'))
                } else {
                return $send(Opal.const_get_relative($nesting, 'Class').$new(my_super.$_Railway()), 'tap', [], (TMP_36 = function(wrapper){var self = TMP_36.$$s || this, TMP_37;
if (wrapper == null) wrapper = nil;
                return $send(["@validations", "@tracks", "@receivers"], 'each', [], (TMP_37 = function(var$){var self = TMP_37.$$s || this, $b, value = nil;
if (var$ == null) var$ = nil;
                  
                    value = my_super.$_Railway().$instance_variable_get(var$);
                    return wrapper.$instance_variable_set(var$, ($truthy($b = value) ? value.$dup() : $b));}, TMP_37.$$s = self, TMP_37.$$arity = 1, TMP_37))}, TMP_36.$$s = self, TMP_36.$$arity = 1, TMP_36))
              };}, TMP_35.$$s = self, TMP_35.$$arity = 0, TMP_35))}, TMP_34.$$s = self, TMP_34.$$arity = 0, TMP_34));
        }, TMP_inherited_38.$$arity = 1), nil) && 'inherited';
      })(Opal.get_singleton_class(self), $nesting);
      return (function($base, $super, $parent_nesting) {
        function $Railway(){};
        var self = $Railway = $klass($base, $super, 'Railway', $Railway);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Railway_initialize_39;

        return (Opal.defn(self, '$initialize', TMP_Railway_initialize_39 = function $$initialize(operation) {
          var self = this;

          return (self.operation = operation)
        }, TMP_Railway_initialize_39.$$arity = 1), nil) && 'initialize'
      })($nesting[0], null, $nesting);
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/railway/dispatcher"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$receivers', '$class', '$set_var', '$lambda', '$call', '$to_proc', '$define_singleton_method', '$delete', '$<<', '$then', '$result', '$each', '$dispatch_params', '$params_wrapper', '$params']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Operation(){};
      var self = $Operation = $klass($base, $super, 'Operation', $Operation);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return (function($base, $super, $parent_nesting) {
        function $Railway(){};
        var self = $Railway = $klass($base, $super, 'Railway', $Railway);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Railway_receivers_1, TMP_Railway_dispatch_9;

        
        
        Opal.defn(self, '$receivers', TMP_Railway_receivers_1 = function $$receivers() {
          var self = this;

          return self.$class().$receivers()
        }, TMP_Railway_receivers_1.$$arity = 0);
        (function(self, $parent_nesting) {
          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_receivers_3, TMP_add_receiver_4;

          
          
          Opal.defn(self, '$receivers', TMP_receivers_3 = function $$receivers() {
            var TMP_2, self = this;

            return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Context'), 'set_var', [self, "@receivers", $hash2(["force"], {"force": true})], (TMP_2 = function(){var self = TMP_2.$$s || this;

            return []}, TMP_2.$$s = self, TMP_2.$$arity = 0, TMP_2))
          }, TMP_receivers_3.$$arity = 0);
          return (Opal.defn(self, '$add_receiver', TMP_add_receiver_4 = function $$add_receiver() {
            var TMP_5, TMP_6, self = this, $iter = TMP_add_receiver_4.$$p, block = $iter || nil, cloned_block = nil, operation = nil;

            if ($iter) TMP_add_receiver_4.$$p = null;
            
            cloned_block = $send(self, 'lambda', [], (TMP_5 = function($a_rest){var self = TMP_5.$$s || this, b, args;

              b = TMP_5.$$p || nil;
              if (b) TMP_5.$$p = null;
              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              args = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                args[$arg_idx - 0] = arguments[$arg_idx];
              }
            return $send(block, 'call', Opal.to_a(args), b.$to_proc())}, TMP_5.$$s = self, TMP_5.$$arity = -1, TMP_5));
            operation = self;
            $send(cloned_block, 'define_singleton_method', ["unmount"], (TMP_6 = function(){var self = TMP_6.$$s || this;

            return operation.$receivers().$delete(cloned_block)}, TMP_6.$$s = self, TMP_6.$$arity = 0, TMP_6));
            self.$receivers()['$<<'](cloned_block);
            return cloned_block;
          }, TMP_add_receiver_4.$$arity = 0), nil) && 'add_receiver';
        })(Opal.get_singleton_class(self), $nesting);
        return (Opal.defn(self, '$dispatch', TMP_Railway_dispatch_9 = function $$dispatch() {
          var TMP_7, self = this;

          return $send(self.$result(), 'then', [], (TMP_7 = function(){var self = TMP_7.$$s || this, TMP_8;

          return $send(self.$receivers(), 'each', [], (TMP_8 = function(receiver){var self = TMP_8.$$s || this;
              if (self.operation == null) self.operation = nil;
if (receiver == null) receiver = nil;
            return receiver.$call(self.$class().$params_wrapper().$dispatch_params(self.operation.$params()), self.operation)}, TMP_8.$$s = self, TMP_8.$$arity = 1, TMP_8))}, TMP_7.$$s = self, TMP_7.$$arity = 0, TMP_7))
        }, TMP_Railway_dispatch_9.$$arity = 0), nil) && 'dispatch';
      })($nesting[0], null, $nesting)
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/railway/params_wrapper"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  function $rb_gt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs > rhs : lhs['$>'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$dup', '$each', '$inbound_params', '$class', '$delete', '$with_indifferent_access', '$to_s', '$to_h', '$inject', '$respond_to?', '$raise', '$new', '$merge!', '$combine_arg_array', '$filter', '$hash_filter', '$instance_eval', '$translate_args', '$to_proc', '$<<', '$key?', '$optional', '$send', '$required', '$define_method', '$[]', '$method_missing', '$[]=', '$-', '$lock', '$get_name_and_opts', '$is_a?', '$>', '$count', '$first', '$==', '$proc', '$duck', '$underscore', '$last', '$process_params', '$params_wrapper', '$add_param', '$set_var', '$superclass', '$tap', '$instance_variable_set']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Operation(){};
      var self = $Operation = $klass($base, $super, 'Operation', $Operation);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      
      (function($base, $super, $parent_nesting) {
        function $ParamsWrapper(){};
        var self = $ParamsWrapper = $klass($base, $super, 'ParamsWrapper', $ParamsWrapper);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ParamsWrapper_initialize_1, TMP_ParamsWrapper_lock_2, TMP_ParamsWrapper_to_h_4, TMP_ParamsWrapper_to_s_5;

        def.inputs = def.locked = nil;
        
        
        Opal.defn(self, '$initialize', TMP_ParamsWrapper_initialize_1 = function $$initialize(inputs) {
          var self = this;

          return (self.inputs = inputs)
        }, TMP_ParamsWrapper_initialize_1.$$arity = 1);
        
        Opal.defn(self, '$lock', TMP_ParamsWrapper_lock_2 = function $$lock() {
          var self = this;

          
          self.locked = true;
          return self;
        }, TMP_ParamsWrapper_lock_2.$$arity = 0);
        
        Opal.defn(self, '$to_h', TMP_ParamsWrapper_to_h_4 = function $$to_h() {
          var TMP_3, self = this, inputs = nil;

          
          inputs = self.inputs;
          if ($truthy(self.locked)) {
            
            inputs = inputs.$dup();
            $send(self.$class().$inbound_params(), 'each', [], (TMP_3 = function(name){var self = TMP_3.$$s || this;
if (name == null) name = nil;
            return inputs.$delete("" + (name))}, TMP_3.$$s = self, TMP_3.$$arity = 1, TMP_3));};
          return inputs.$with_indifferent_access();
        }, TMP_ParamsWrapper_to_h_4.$$arity = 0);
        
        Opal.defn(self, '$to_s', TMP_ParamsWrapper_to_s_5 = function $$to_s() {
          var self = this;

          return self.$to_h().$to_s()
        }, TMP_ParamsWrapper_to_s_5.$$arity = 0);
        return (function(self, $parent_nesting) {
          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_combine_arg_array_7, TMP_process_params_9, TMP_add_param_10, TMP_dispatch_params_17, TMP_hash_filter_18, TMP_inbound_params_19, TMP_translate_args_20, TMP_get_name_and_opts_23;

          
          
          Opal.defn(self, '$combine_arg_array', TMP_combine_arg_array_7 = function $$combine_arg_array(args) {
            var TMP_6, self = this, hash = nil;

            return (hash = $send(args, 'inject', [$hash2([], {}).$with_indifferent_access()], (TMP_6 = function(h, arg){var self = TMP_6.$$s || this;
if (h == null) h = nil;if (arg == null) arg = nil;
            
              if ($truthy(arg['$respond_to?']("to_h"))) {
                } else {
                self.$raise(Opal.const_get_relative($nesting, 'ArgumentError').$new("All arguments must be hashes"))
              };
              return h['$merge!'](arg.$to_h());}, TMP_6.$$s = self, TMP_6.$$arity = 2, TMP_6)))
          }, TMP_combine_arg_array_7.$$arity = 1);
          
          Opal.defn(self, '$process_params', TMP_process_params_9 = function $$process_params(operation, args) {
            var $a, $b, TMP_8, self = this, raw_inputs = nil, inputs = nil, errors = nil, params_wrapper = nil;

            
            raw_inputs = self.$combine_arg_array(args);
            $b = self.$hash_filter().$filter(raw_inputs), $a = Opal.to_ary($b), (inputs = ($a[0] == null ? nil : $a[0])), (errors = ($a[1] == null ? nil : $a[1])), $b;
            params_wrapper = self.$new(inputs);
            return $send(operation, 'instance_eval', [], (TMP_8 = function(){var self = TMP_8.$$s || this, $c;

            return $c = [raw_inputs, params_wrapper, errors], (self.raw_inputs = $c[0]), (self.params = $c[1]), (self.errors = $c[2]), $c}, TMP_8.$$s = self, TMP_8.$$arity = 0, TMP_8));
          }, TMP_process_params_9.$$arity = 2);
          
          Opal.defn(self, '$add_param', TMP_add_param_10 = function $$add_param($a_rest) {
            var $b, $c, TMP_11, TMP_12, TMP_13, TMP_14, self = this, args, $iter = TMP_add_param_10.$$p, block = $iter || nil, type_method = nil, name = nil, opts = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($iter) TMP_add_param_10.$$p = null;
            
            $c = $send(self, 'translate_args', Opal.to_a(args), block.$to_proc()), $b = Opal.to_ary($c), (type_method = ($b[0] == null ? nil : $b[0])), (name = ($b[1] == null ? nil : $b[1])), (opts = ($b[2] == null ? nil : $b[2])), (block = ($b[3] == null ? nil : $b[3])), $c;
            if ($truthy(opts.$delete("inbound"))) {
              self.$inbound_params()['$<<']("" + (name))};
            if ($truthy(opts['$key?']("default"))) {
              $send(self.$hash_filter(), 'optional', [], (TMP_11 = function(){var self = TMP_11.$$s || this;

              return $send(self, 'send', [type_method, name, opts], block.$to_proc())}, TMP_11.$$s = self, TMP_11.$$arity = 0, TMP_11))
              } else {
              $send(self.$hash_filter(), 'required', [], (TMP_12 = function(){var self = TMP_12.$$s || this;

              return $send(self, 'send', [type_method, name, opts], block.$to_proc())}, TMP_12.$$s = self, TMP_12.$$arity = 0, TMP_12))
            };
            $send(self, 'define_method', [name], (TMP_13 = function(){var self = TMP_13.$$s || this;
              if (self.inputs == null) self.inputs = nil;

            return self.inputs['$[]'](name)}, TMP_13.$$s = self, TMP_13.$$arity = 0, TMP_13));
            return $send(self, 'define_method', ["" + (name) + "="], (TMP_14 = function(x){var self = TMP_14.$$s || this, $writer = nil;
              if (self.locked == null) self.locked = nil;
              if (self.inputs == null) self.inputs = nil;
if (x == null) x = nil;
            
              if ($truthy(self.locked)) {
                self.$method_missing("" + (name) + "=", x)};
              
              $writer = [name, x];
              $send(self.inputs, '[]=', Opal.to_a($writer));
              return $writer[$rb_minus($writer["length"], 1)];;}, TMP_14.$$s = self, TMP_14.$$arity = 1, TMP_14));
          }, TMP_add_param_10.$$arity = -1);
          
          Opal.defn(self, '$dispatch_params', TMP_dispatch_params_17 = function $$dispatch_params(params, hashes) {
            var TMP_15, self = this;

            if (hashes == null) {
              hashes = $hash2([], {});
            }
            
            params = params.$dup();
            $send(hashes, 'each', [], (TMP_15 = function(hash){var self = TMP_15.$$s || this, TMP_16;
if (hash == null) hash = nil;
            return $send(hash, 'each', [], (TMP_16 = function(k, v){var self = TMP_16.$$s || this;
if (k == null) k = nil;if (v == null) v = nil;
              return params.$send("" + (k) + "=", v)}, TMP_16.$$s = self, TMP_16.$$arity = 2, TMP_16))}, TMP_15.$$s = self, TMP_15.$$arity = 1, TMP_15));
            return params.$lock();
          }, TMP_dispatch_params_17.$$arity = -2);
          
          Opal.defn(self, '$hash_filter', TMP_hash_filter_18 = function $$hash_filter() {
            var $a, self = this;
            if (self.hash_filter == null) self.hash_filter = nil;

            return (self.hash_filter = ($truthy($a = self.hash_filter) ? $a : Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Mutations'), 'HashFilter').$new()))
          }, TMP_hash_filter_18.$$arity = 0);
          
          Opal.defn(self, '$inbound_params', TMP_inbound_params_19 = function $$inbound_params() {
            var $a, self = this;
            if (self.inbound_params == null) self.inbound_params = nil;

            return (self.inbound_params = ($truthy($a = self.inbound_params) ? $a : Opal.const_get_relative($nesting, 'Set').$new()))
          }, TMP_inbound_params_19.$$arity = 0);
          
          Opal.defn(self, '$translate_args', TMP_translate_args_20 = function $$translate_args($a_rest) {
            var $b, $c, TMP_21, TMP_22, self = this, args, $iter = TMP_translate_args_20.$$p, block = $iter || nil, name = nil, opts = nil, type_method = nil, $writer = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($iter) TMP_translate_args_20.$$p = null;
            
            $c = $send(self, 'get_name_and_opts', Opal.to_a(args)), $b = Opal.to_ary($c), (name = ($b[0] == null ? nil : $b[0])), (opts = ($b[1] == null ? nil : $b[1])), $c;
            if ($truthy(opts['$key?']("type"))) {
              
              type_method = opts.$delete("type");
              if ($truthy(type_method['$is_a?'](Opal.const_get_relative($nesting, 'Array')))) {
                
                if ($truthy($rb_gt(type_method.$count(), 0))) {
                  
                  $writer = ["class", type_method.$first()];
                  $send(opts, '[]=', Opal.to_a($writer));
                  $writer[$rb_minus($writer["length"], 1)];};
                type_method = Opal.const_get_relative($nesting, 'Array');
              } else if ($truthy(($truthy($b = type_method['$is_a?'](Opal.const_get_relative($nesting, 'Hash'))) ? $b : type_method['$=='](Opal.const_get_relative($nesting, 'Hash'))))) {
                
                type_method = Opal.const_get_relative($nesting, 'Hash');
                block = ($truthy($b = block) ? $b : $send(self, 'proc', [], (TMP_21 = function(){var self = TMP_21.$$s || this;

                return self.$duck("*")}, TMP_21.$$s = self, TMP_21.$$arity = 0, TMP_21)));};
              type_method = type_method.$to_s().$underscore();
              } else {
              type_method = "duck"
            };
            return [type_method, name, opts, ($truthy($b = block) ? $b : $send(self, 'proc', [], (TMP_22 = function(){var self = TMP_22.$$s || this;

            return nil}, TMP_22.$$s = self, TMP_22.$$arity = 0, TMP_22)))];
          }, TMP_translate_args_20.$$arity = -1);
          return (Opal.defn(self, '$get_name_and_opts', TMP_get_name_and_opts_23 = function $$get_name_and_opts($a_rest) {
            var $b, self = this, args, opts = nil, name = nil, $writer = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            
            if ($truthy(args['$[]'](0)['$is_a?'](Opal.const_get_relative($nesting, 'Hash')))) {
              
              opts = args['$[]'](0);
              name = opts.$first().$first();
              
              $writer = ["default", opts.$first().$last()];
              $send(opts, '[]=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;
              opts.$delete(name);
              } else {
              
              name = args['$[]'](0);
              opts = ($truthy($b = args['$[]'](1)) ? $b : $hash2([], {}));
            };
            return [name, opts];
          }, TMP_get_name_and_opts_23.$$arity = -1), nil) && 'get_name_and_opts';
        })(Opal.get_singleton_class(self), $nesting);
      })($nesting[0], null, $nesting);
      return (function($base, $super, $parent_nesting) {
        function $Railway(){};
        var self = $Railway = $klass($base, $super, 'Railway', $Railway);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Railway_process_params_24, TMP_Railway_add_param_25, TMP_Railway_params_wrapper_28;

        def.operation = nil;
        
        
        Opal.defn(self, '$process_params', TMP_Railway_process_params_24 = function $$process_params(args) {
          var self = this;

          return self.$class().$params_wrapper().$process_params(self.operation, args)
        }, TMP_Railway_process_params_24.$$arity = 1);
        Opal.defs(self, '$add_param', TMP_Railway_add_param_25 = function $$add_param($a_rest) {
          var self = this, args, $iter = TMP_Railway_add_param_25.$$p, block = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_Railway_add_param_25.$$p = null;
          return $send(self.$params_wrapper(), 'add_param', Opal.to_a(args), block.$to_proc())
        }, TMP_Railway_add_param_25.$$arity = -1);
        return Opal.defs(self, '$params_wrapper', TMP_Railway_params_wrapper_28 = function $$params_wrapper() {
          var TMP_26, self = this;

          return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Context'), 'set_var', [self, "@params_wrapper"], (TMP_26 = function(){var self = TMP_26.$$s || this, TMP_27;

          if (Opal.const_get_relative($nesting, 'Railway')['$=='](self.$superclass())) {
              return Opal.const_get_relative($nesting, 'Class').$new(Opal.const_get_relative($nesting, 'ParamsWrapper'))
              } else {
              return $send(Opal.const_get_relative($nesting, 'Class').$new(self.$superclass().$params_wrapper()), 'tap', [], (TMP_27 = function(wrapper){var self = TMP_27.$$s || this, $a, hash_filter = nil, inbound_params = nil;
if (wrapper == null) wrapper = nil;
              
                hash_filter = self.$superclass().$params_wrapper().$hash_filter();
                wrapper.$instance_variable_set("@hash_filter", ($truthy($a = hash_filter) ? hash_filter.$dup() : $a));
                inbound_params = self.$superclass().$params_wrapper().$inbound_params();
                return wrapper.$instance_variable_set("@inbound_params", ($truthy($a = inbound_params) ? inbound_params.$dup() : $a));}, TMP_27.$$s = self, TMP_27.$$arity = 1, TMP_27))
            }}, TMP_26.$$s = self, TMP_26.$$arity = 0, TMP_26))
        }, TMP_Railway_params_wrapper_28.$$arity = 0);
      })($nesting[0], null, $nesting);
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/railway/run"] = function(Opal) {
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $hash2 = Opal.hash2, $send = Opal.send;

  Opal.add_stubs(['$attr_reader', '$tracks', '$class', '$merge', '$zero?', '$count', '$is_a?', '$[]', '$==', '$<', '$proc', '$run', '$params', '$instance_method', '$each', '$define_method', '$<<', '$to_opts', '$raise', '$new', '$then', '$apply', '$fail', '$!=', '$method', '$arity', '$instance_exec', '$to_proc', '$rejected?', '$error', '$resolved?', '$value', '$state', '$result', '$has_errors?', '$instance_variable_get', '$call', '$bind', '$resolve', '$reject']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Operation(){};
      var self = $Operation = $klass($base, $super, 'Operation', $Operation);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      
      (function($base, $super, $parent_nesting) {
        function $Exit(){};
        var self = $Exit = $klass($base, $super, 'Exit', $Exit);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Exit_initialize_1;

        
        self.$attr_reader("state");
        self.$attr_reader("result");
        return (Opal.defn(self, '$initialize', TMP_Exit_initialize_1 = function $$initialize(state, result) {
          var self = this;

          
          self.state = state;
          return (self.result = result);
        }, TMP_Exit_initialize_1.$$arity = 2), nil) && 'initialize';
      })($nesting[0], Opal.const_get_relative($nesting, 'StandardError'), $nesting);
      return (function($base, $super, $parent_nesting) {
        function $Railway(){};
        var self = $Railway = $klass($base, $super, 'Railway', $Railway);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Railway_tracks_2, TMP_Railway_step_11, TMP_Railway_failed_13, TMP_Railway_async_14, TMP_Railway_apply_15, TMP_Railway_run_17, TMP_Railway_result_18;

        def.last_result = def.state = def.operation = nil;
        
        
        Opal.defn(self, '$tracks', TMP_Railway_tracks_2 = function $$tracks() {
          var self = this;

          return self.$class().$tracks()
        }, TMP_Railway_tracks_2.$$arity = 0);
        (function(self, $parent_nesting) {
          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_tracks_3, TMP_to_opts_5, TMP_6, TMP_abort$B_8, TMP_succeed$B_9;

          
          
          Opal.defn(self, '$tracks', TMP_tracks_3 = function $$tracks() {
            var $a, self = this;
            if (self.tracks == null) self.tracks = nil;

            return (self.tracks = ($truthy($a = self.tracks) ? $a : []))
          }, TMP_tracks_3.$$arity = 0);
          
          Opal.defn(self, '$to_opts', TMP_to_opts_5 = function $$to_opts(tie, args, block) {
            var $a, $b, TMP_4, self = this, scope = nil;

            return (function() {if ($truthy(args.$count()['$zero?']())) {
              return $hash2(["run"], {"run": block})
            } else if ($truthy(args['$[]'](0)['$is_a?'](Opal.const_get_relative($nesting, 'Hash')))) {
              return $hash2(["scope", "run"], {"scope": (function() {if ($truthy(args['$[]'](0)['$[]']("class"))) {
                return "class"
                } else {
                return args['$[]'](0)['$[]']("scope")
              }; return nil; })(), "run": ($truthy($a = ($truthy($b = args['$[]'](0)['$[]']("class")) ? $b : args['$[]'](0)['$[]']("run"))) ? $a : block)})
            } else if ($truthy((($a = args['$[]'](0)['$==']("class")) ? block : args['$[]'](0)['$==']("class")))) {
              return $hash2(["run", "scope"], {"run": block, "scope": "class"})
            } else if ($truthy(($truthy($a = args['$[]'](0)['$is_a?'](Opal.const_get_relative($nesting, 'Class'))) ? $rb_lt(args['$[]'](0), Opal.const_get_relative($nesting, 'Operation')) : $a))) {
              return $hash2(["run"], {"run": $send(self, 'proc', [], (TMP_4 = function(){var self = TMP_4.$$s || this;

              return args['$[]'](0).$run(self.$params())}, TMP_4.$$s = self, TMP_4.$$arity = 0, TMP_4))})
              } else {
              
              if ($truthy(args['$[]'](1)['$is_a?'](Opal.const_get_relative($nesting, 'Hash')))) {
                scope = args['$[]'](1)['$[]']("scope")};
              return $hash2(["run", "scope"], {"run": args['$[]'](0), "scope": scope});
            }; return nil; })().$merge($hash2(["tie"], {"tie": self.$instance_method(tie)}))
          }, TMP_to_opts_5.$$arity = 3);
          $send(["step", "failed", "async"], 'each', [], (TMP_6 = function(tie){var self = TMP_6.$$s || this, TMP_7;
if (tie == null) tie = nil;
          return $send(self, 'define_method', ["" + "add_" + (tie)], (TMP_7 = function($a_rest){var self = TMP_7.$$s || this, block, args;

              block = TMP_7.$$p || nil;
              if (block) TMP_7.$$p = null;
              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              args = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                args[$arg_idx - 0] = arguments[$arg_idx];
              }
            return self.$tracks()['$<<'](self.$to_opts(tie, args, block))}, TMP_7.$$s = self, TMP_7.$$arity = -1, TMP_7))}, TMP_6.$$s = self, TMP_6.$$arity = 1, TMP_6));
          
          Opal.defn(self, '$abort!', TMP_abort$B_8 = function(arg) {
            var self = this;

            return self.$raise(Opal.const_get_relative($nesting, 'Exit').$new("failed", arg))
          }, TMP_abort$B_8.$$arity = 1);
          return (Opal.defn(self, '$succeed!', TMP_succeed$B_9 = function(arg) {
            var self = this;

            return self.$raise(Opal.const_get_relative($nesting, 'Exit').$new("success", arg))
          }, TMP_succeed$B_9.$$arity = 1), nil) && 'succeed!';
        })(Opal.get_singleton_class(self), $nesting);
        
        Opal.defn(self, '$step', TMP_Railway_step_11 = function $$step(opts) {
          var TMP_10, self = this;

          if ($truthy(self.last_result['$is_a?'](Opal.const_get_relative($nesting, 'Promise')))) {
            return (self.last_result = $send(self.last_result, 'then', [], (TMP_10 = function($a_rest){var self = TMP_10.$$s || this, result;

              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              result = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                result[$arg_idx - 0] = arguments[$arg_idx];
              }
            
              self.last_result = result;
              return self.$apply(opts, "in_promise");}, TMP_10.$$s = self, TMP_10.$$arity = -1, TMP_10)))
          } else if (self.state['$==']("success")) {
            return self.$apply(opts)
            } else {
            return nil
          }
        }, TMP_Railway_step_11.$$arity = 1);
        
        Opal.defn(self, '$failed', TMP_Railway_failed_13 = function $$failed(opts) {
          var TMP_12, self = this;

          if ($truthy(self.last_result['$is_a?'](Opal.const_get_relative($nesting, 'Promise')))) {
            return (self.last_result = $send(self.last_result, 'fail', [], (TMP_12 = function(e){var self = TMP_12.$$s || this;
              if (self.last_result == null) self.last_result = nil;
if (e == null) e = nil;
            
              self.last_result = e;
              self.$apply(opts, "in_promise");
              if ($truthy(self.last_result['$is_a?'](Opal.const_get_relative($nesting, 'Exception')))) {
                self.$raise(self.last_result)};
              return self.$raise(e);}, TMP_12.$$s = self, TMP_12.$$arity = 1, TMP_12)))
          } else if (self.state['$==']("failed")) {
            return self.$apply(opts)
            } else {
            return nil
          }
        }, TMP_Railway_failed_13.$$arity = 1);
        
        Opal.defn(self, '$async', TMP_Railway_async_14 = function $$async(opts) {
          var self = this;

          if ($truthy(self.state['$!=']("failed"))) {
            return self.$apply(opts)
            } else {
            return nil
          }
        }, TMP_Railway_async_14.$$arity = 1);
        
        Opal.defn(self, '$apply', TMP_Railway_apply_15 = function $$apply(opts, in_promise) {
          var $a, self = this, args = nil, instance = nil, block = nil, e = nil;

          if (in_promise == null) {
            in_promise = nil;
          }
          try {
            
            if (opts['$[]']("scope")['$==']("class")) {
              
              args = [self.operation].concat(Opal.to_a(self.last_result));
              instance = self.operation.$class();
              } else {
              
              args = self.last_result;
              instance = self.operation;
            };
            block = opts['$[]']("run");
            if ($truthy(block['$is_a?'](Opal.const_get_relative($nesting, 'Symbol')))) {
              block = instance.$method(block)};
            self.last_result = (function() {if ($truthy(block.$arity()['$zero?']())) {
              return $send(instance, 'instance_exec', [], block.$to_proc())
            } else if ($truthy(($truthy($a = args['$is_a?'](Opal.const_get_relative($nesting, 'Array'))) ? block.$arity()['$=='](args.$count()) : $a))) {
              return $send(instance, 'instance_exec', Opal.to_a(args), block.$to_proc())
              } else {
              return $send(instance, 'instance_exec', [args], block.$to_proc())
            }; return nil; })();
            if ($truthy(self.last_result['$is_a?'](Opal.const_get_relative($nesting, 'Promise')))) {
              } else {
              return self.last_result
            };
            if ($truthy(self.last_result['$rejected?']())) {
              self.$raise(self.last_result.$error())};
            if ($truthy(self.last_result['$resolved?']())) {
              self.last_result = self.last_result.$value()};
            return self.last_result;
          } catch ($err) {
            if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exit')])) {e = $err;
              try {
                
                self.state = e.$state();
                self.last_result = (function() {if ($truthy(($truthy($a = e.$state()['$!=']("failed")) ? $a : e.$result()['$is_a?'](Opal.const_get_relative($nesting, 'Exception'))))) {
                  return e.$result()
                  } else {
                  return e
                }; return nil; })();
                return self.$raise(e);
              } finally { Opal.pop_exception() }
            } else 
            if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exception')])) {e = $err;
              try {
                
                self.state = "failed";
                self.last_result = e;
                if ($truthy(in_promise)) {
                  return self.$raise(e)
                  } else {
                  return nil
                };
              } finally { Opal.pop_exception() }
            } else { throw $err; }
          }
        }, TMP_Railway_apply_15.$$arity = -2);
        
        Opal.defn(self, '$run', TMP_Railway_run_17 = function $$run() {
          var $a, TMP_16, self = this;

          try {
            
            if ($truthy(($truthy($a = self.operation['$has_errors?']()) ? $a : self.state))) {
              
              self.last_result = ($truthy($a = self.last_result) ? $a : Opal.const_get_relative($nesting, 'ValidationException').$new(self.operation.$instance_variable_get("@errors")));
              if ($truthy(self.state)) {
                return nil};
              self.state = "failed";
              } else {
              self.state = "success"
            };
            return $send(self.$tracks(), 'each', [], (TMP_16 = function(opts){var self = TMP_16.$$s || this;
if (opts == null) opts = nil;
            return opts['$[]']("tie").$bind(self).$call(opts)}, TMP_16.$$s = self, TMP_16.$$arity = 1, TMP_16));
          } catch ($err) {
            if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exit')])) {
              try {
                return nil
              } finally { Opal.pop_exception() }
            } else { throw $err; }
          }
        }, TMP_Railway_run_17.$$arity = 0);
        return (Opal.defn(self, '$result', TMP_Railway_result_18 = function $$result() {
          var self = this;

          
          if ($truthy(self.last_result['$is_a?'](Opal.const_get_relative($nesting, 'Promise')))) {
            return self.last_result};
          return (self.last_result = (function() {if (self.state['$==']("success")) {
            return Opal.const_get_relative($nesting, 'Promise').$new().$resolve(self.last_result)
            } else {
            return Opal.const_get_relative($nesting, 'Promise').$new().$reject(self.last_result)
          }; return nil; })());
        }, TMP_Railway_result_18.$$arity = 0), nil) && 'result';
      })($nesting[0], null, $nesting);
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/railway/validations"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$validations', '$class', '$add_error', '$+', '$to_s', '$[]', '$<<', '$add_validation', '$instance_eval', '$to_proc', '$==', '$state', '$raise', '$new', '$result', '$each_with_index', '$is_a?', '$method', '$instance_exec', '$add_validation_error', '$===']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Operation(){};
      var self = $Operation = $klass($base, $super, 'Operation', $Operation);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return (function($base, $super, $parent_nesting) {
        function $Railway(){};
        var self = $Railway = $klass($base, $super, 'Railway', $Railway);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Railway_validations_1, TMP_Railway_add_validation_error_2, TMP_Railway_process_validations_8;

        def.operation = nil;
        
        
        Opal.defn(self, '$validations', TMP_Railway_validations_1 = function $$validations() {
          var self = this;

          return self.$class().$validations()
        }, TMP_Railway_validations_1.$$arity = 0);
        
        Opal.defn(self, '$add_validation_error', TMP_Railway_add_validation_error_2 = function $$add_validation_error(i, e) {
          var self = this;

          return self.operation.$add_error("" + "param validation " + ($rb_plus(i, 1)), "validation_error", e.$to_s())
        }, TMP_Railway_add_validation_error_2.$$arity = 2);
        (function(self, $parent_nesting) {
          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_validations_3, TMP_add_validation_4, TMP_add_error_5;

          
          
          Opal.defn(self, '$validations', TMP_validations_3 = function $$validations() {
            var $a, self = this;
            if (self.validations == null) self.validations = nil;

            return (self.validations = ($truthy($a = self.validations) ? $a : []))
          }, TMP_validations_3.$$arity = 0);
          
          Opal.defn(self, '$add_validation', TMP_add_validation_4 = function $$add_validation($a_rest) {
            var self = this, args, $iter = TMP_add_validation_4.$$p, block = $iter || nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($iter) TMP_add_validation_4.$$p = null;
            
            if ($truthy(args['$[]'](0))) {
              block = args['$[]'](0)};
            return self.$validations()['$<<'](block);
          }, TMP_add_validation_4.$$arity = -1);
          return (Opal.defn(self, '$add_error', TMP_add_error_5 = function $$add_error(param, symbol, message, $a_rest) {
            var TMP_6, self = this, args, $iter = TMP_add_error_5.$$p, block = $iter || nil;

            var $args_len = arguments.length, $rest_len = $args_len - 3;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 3; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 3] = arguments[$arg_idx];
            }
            if ($iter) TMP_add_error_5.$$p = null;
            return $send(self, 'add_validation', [], (TMP_6 = function(){var self = TMP_6.$$s || this, e = nil;

            
              try {
                
                if ($truthy($send(self, 'instance_eval', [], block.$to_proc()))) {
                  self.$add_error(param, symbol, message)};
                return true;
              } catch ($err) {
                if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exit')])) {e = $err;
                  try {
                    
                    if (e.$state()['$==']("failed")) {
                      } else {
                      self.$raise(e)
                    };
                    self.$add_error(param, symbol, message);
                    return self.$raise(Opal.const_get_relative($nesting, 'Exit').$new("abort_from_add_error", e.$result()));
                  } finally { Opal.pop_exception() }
                } else { throw $err; }
              };}, TMP_6.$$s = self, TMP_6.$$arity = 0, TMP_6))
          }, TMP_add_error_5.$$arity = -4), nil) && 'add_error';
        })(Opal.get_singleton_class(self), $nesting);
        return (Opal.defn(self, '$process_validations', TMP_Railway_process_validations_8 = function $$process_validations() {try {

          var TMP_7, self = this;

          return $send(self.$validations(), 'each_with_index', [], (TMP_7 = function(validator, i){var self = TMP_7.$$s || this, e = nil, $case = nil;
            if (self.operation == null) self.operation = nil;
if (validator == null) validator = nil;if (i == null) i = nil;
          
            try {
              
              if ($truthy(validator['$is_a?'](Opal.const_get_relative($nesting, 'Symbol')))) {
                validator = self.operation.$method(validator)};
              if ($truthy($send(self.operation, 'instance_exec', [], validator.$to_proc()))) {
                return nil;};
              return self.$add_validation_error(i, "" + "param validation " + ($rb_plus(i, 1)) + " failed");
            } catch ($err) {
              if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exit')])) {e = $err;
                try {
                  
                  $case = e.$state();
                  if ("success"['$===']($case)) {self.$add_validation_error(i, "illegal use of succeed! in validation")}
                  else if ("failed"['$===']($case)) {self.$add_validation_error(i, "" + "param validation " + ($rb_plus(i, 1)) + " aborted")};
                  self.state = "failed";
                  Opal.ret(nil);
                } finally { Opal.pop_exception() }
              } else 
              if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'AccessViolation')])) {e = $err;
                try {
                  
                  self.$add_validation_error(i, e);
                  self.state = "failed";
                  self.last_result = e;
                  Opal.ret(nil);
                } finally { Opal.pop_exception() }
              } else 
              if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exception')])) {e = $err;
                try {
                  return self.$add_validation_error(i, e)
                } finally { Opal.pop_exception() }
              } else { throw $err; }
            };}, TMP_7.$$s = self, TMP_7.$$arity = 2, TMP_7))
          } catch ($returner) { if ($returner === Opal.returner) { return $returner.$v } throw $returner; }
        }, TMP_Railway_process_validations_8.$$arity = 0), nil) && 'process_validations';
      })($nesting[0], null, $nesting)
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/server_op"] = function(Opal) {
  function $rb_lt(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs < rhs : lhs['$<'](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$==', '$include', '$on_opal_client?', '$combine_arg_array', '$params_wrapper', '$_Railway', '$serialize_params', '$fail', '$then', '$post', '$to_json', '$name', '$[]', '$opts', '$deserialize_response', '$json', '$new', '$const_get', '$on_opal_server?', '$internal_iso_run', '$resolve', '$reject', '$isomorphic_method', '$send_to_server', '$when_on_server', '$run_from_client', '$controller', '$map', '$descendants', '$to_proc', '$production?', '$env', '$include?', '$descendants_map_cache', '$raise_operation_access_violation', '$<', '$class_eval', '$constantize', '$method_defined?', '$[]=', '$-', '$!', '$raise', '$run', '$deserialize_params', '$serialize_response', '$handle_exception', '$is_a?', '$respond_to?', '$to_h', '$<<', '$red', '$inspect', '$each', '$truncate', '$details', '$__hyperstack_on_error', '$join', '$to_s', '$class', '$status', '$URI', '$host', '$port', '$path', '$scheme', '$use_ssl=', '$body=', '$request', '$!=', '$lock', '$deserialize_dispatch', '$receivers', '$call', '$inbound', '$params', '$send', '$pre_controller_op_method_missing']);
  
  if (Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$==']("opal")) {
    } else {
    nil
  };
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    
    (function($base, $super, $parent_nesting) {
      function $ServerOp(){};
      var self = $ServerOp = $klass($base, $super, 'ServerOp', $ServerOp);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return (function(self, $parent_nesting) {
        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_run_3, TMP_run_4, TMP_5, TMP_descendants_map_cache_7, TMP_run_from_client_11, TMP_status_12, TMP_handle_exception_14, TMP_remote_15, TMP_serialize_params_16, TMP_deserialize_params_17, TMP_serialize_response_18, TMP_deserialize_response_19, TMP_serialize_dispatch_20, TMP_deserialize_dispatch_21, TMP_dispatch_to_22, TMP_dispatch_from_server_24;

        
        self.$include(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'IsomorphicHelpers'));
        if (Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$==']("opal")) {
          if ($truthy(self['$on_opal_client?']())) {
            
            Opal.defn(self, '$run', TMP_run_3 = function $$run($a_rest) {
              var TMP_1, TMP_2, self = this, args, hash = nil;

              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              args = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                args[$arg_idx - 0] = arguments[$arg_idx];
              }
              
              hash = self.$_Railway().$params_wrapper().$combine_arg_array(args);
              hash = self.$serialize_params(hash);
              return $send($send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'HTTP').$post("" + (window.HyperstackEnginePath) + "/execute_remote", $hash2(["payload", "headers"], {"payload": $hash2(["json"], {"json": $hash2(["operation", "params"], {"operation": self.$name(), "params": hash}).$to_json()}), "headers": $hash2(["X-CSRF-Token"], {"X-CSRF-Token": Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'ClientDrivers').$opts()['$[]']("form_authenticity_token")})})), 'then', [], (TMP_1 = function(response){var self = TMP_1.$$s || this;
if (response == null) response = nil;
              return self.$deserialize_response(response.$json()['$[]']("response"))}, TMP_1.$$s = self, TMP_1.$$arity = 1, TMP_1)), 'fail', [], (TMP_2 = function(response){var self = TMP_2.$$s || this;
if (response == null) response = nil;
              
                try {
                  return self.$const_get(response.$json()['$[]']("error_class")).$new(response.$json()['$[]']("error"))
                } catch ($err) {
                  if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'StandardError')])) {
                    try {
                      return Opal.const_get_relative($nesting, 'Exception').$new(response.$json()['$[]']("error"))
                    } finally { Opal.pop_exception() }
                  } else { throw $err; }
                };}, TMP_2.$$s = self, TMP_2.$$arity = 1, TMP_2));
            }, TMP_run_3.$$arity = -1)
          } else if ($truthy(self['$on_opal_server?']())) {
            
            Opal.defn(self, '$run', TMP_run_4 = function $$run($a_rest) {
              var self = this, args, promise = nil, response = nil;

              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              args = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                args[$arg_idx - 0] = arguments[$arg_idx];
              }
              
              promise = Opal.const_get_relative($nesting, 'Promise').$new();
              response = self.$internal_iso_run(self.$name(), args);
              if ($truthy(response['$[]']("json")['$[]']("response"))) {
                promise.$resolve(response['$[]']("json")['$[]']("response"))
                } else {
                promise.$reject(Opal.const_get_relative($nesting, 'Exception').$new(response['$[]']("json")['$[]']("error")))
              };
              return promise;
            }, TMP_run_4.$$arity = -1)}
          } else {
          nil
        };
        $send(self, 'isomorphic_method', ["internal_iso_run"], (TMP_5 = function(f, klass_name, op_params){var self = TMP_5.$$s || this, TMP_6;
if (f == null) f = nil;if (klass_name == null) klass_name = nil;if (op_params == null) op_params = nil;
        
          f.$send_to_server(klass_name, op_params);
          return $send(f, 'when_on_server', [], (TMP_6 = function(){var self = TMP_6.$$s || this;

          return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'ServerOp'), 'run_from_client', ["acting_user", self.$controller(), klass_name].concat(Opal.to_a(op_params)))}, TMP_6.$$s = self, TMP_6.$$arity = 0, TMP_6));}, TMP_5.$$s = self, TMP_5.$$arity = 3, TMP_5));
        
        Opal.defn(self, '$descendants_map_cache', TMP_descendants_map_cache_7 = function $$descendants_map_cache() {
          var $a, self = this;
          if (self.cached_descendants == null) self.cached_descendants = nil;

          return (self.cached_descendants = ($truthy($a = self.cached_descendants) ? $a : $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'ServerOp').$descendants(), 'map', [], "to_s".$to_proc())))
        }, TMP_descendants_map_cache_7.$$arity = 0);
        
        Opal.defn(self, '$run_from_client', TMP_run_from_client_11 = function $$run_from_client(security_param, controller, operation, params) {try {

          var TMP_8, self = this, const$ = nil, e = nil;

          try {
            
            if ($truthy(Opal.const_get_relative($nesting, 'Rails').$env()['$production?']())) {
              if ($truthy(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'ServerOp').$descendants_map_cache()['$include?'](operation))) {
                } else {
                Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'InternalPolicy').$raise_operation_access_violation("illegal_remote_op_call", "" + "Operation: " + (operation) + " (in production)")
              }
              } else {
              
              
              try {
                const$ = Opal.const_get_relative($nesting, 'Object').$const_get(operation)
              } catch ($err) {
                if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'NameError')])) {
                  try {
                    Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'InternalPolicy').$raise_operation_access_violation("illegal_remote_op_call", "" + "Operation: " + (operation) + " (const not found)")
                  } finally { Opal.pop_exception() }
                } else { throw $err; }
              };;
              if ($truthy($rb_lt(const$, Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'ServerOp')))) {
                } else {
                Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'InternalPolicy').$raise_operation_access_violation("illegal_remote_op_call", "" + "Operation: " + (operation) + " (not a ServerOp subclass)")
              };
            };
            return $send(operation.$constantize(), 'class_eval', [], (TMP_8 = function(){var self = TMP_8.$$s || this, TMP_9, TMP_10, $writer = nil;

            
              if ($truthy(self.$_Railway().$params_wrapper()['$method_defined?']("controller"))) {
                
                $writer = ["controller", controller];
                $send(params, '[]=', Opal.to_a($writer));
                $writer[$rb_minus($writer["length"], 1)];
              } else if ($truthy(self.$_Railway().$params_wrapper()['$method_defined?'](security_param)['$!']())) {
                self.$raise(Opal.const_get_relative($nesting, 'AccessViolation').$new("remote_access_not_allowed"))};
              return $send($send(self.$run(self.$deserialize_params(params)), 'then', [], (TMP_9 = function(r){var self = TMP_9.$$s || this;
if (r == null) r = nil;
              Opal.ret($hash2(["json"], {"json": $hash2(["response"], {"response": self.$serialize_response(r)})}))}, TMP_9.$$s = self, TMP_9.$$arity = 1, TMP_9)), 'fail', [], (TMP_10 = function(e){var self = TMP_10.$$s || this;
if (e == null) e = nil;
              Opal.ret(self.$handle_exception(e, operation, params))}, TMP_10.$$s = self, TMP_10.$$arity = 1, TMP_10));}, TMP_8.$$s = self, TMP_8.$$arity = 0, TMP_8));
          } catch ($err) {
            if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exception')])) {e = $err;
              try {
                return self.$handle_exception(e, operation, params)
              } finally { Opal.pop_exception() }
            } else { throw $err; }
          }
          } catch ($returner) { if ($returner === Opal.returner) { return $returner.$v } throw $returner; }
        }, TMP_run_from_client_11.$$arity = 4);
        
        Opal.defn(self, '$status', TMP_status_12 = function $$status(e) {
          var self = this;

          if ($truthy(e['$is_a?'](Opal.const_get_relative($nesting, 'AccessViolation')))) {
            return 403
          } else if ($truthy(e['$is_a?'](Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Operation'), 'ValidationException')))) {
            return 400
            } else {
            return 500
          }
        }, TMP_status_12.$$arity = 1);
        
        Opal.defn(self, '$handle_exception', TMP_handle_exception_14 = function $$handle_exception(e, operation, params) {
          var TMP_13, self = this, message = nil;

          
          if ($truthy(e['$respond_to?']("__hyperstack_on_error"))) {
            
            params = params.$to_h();
            message = [];
            message['$<<'](Opal.const_get_relative($nesting, 'Pastel').$new().$red("" + "HYPERSTACK ERROR during " + (operation) + " " + (e.$inspect())));
            $send(params, 'each', [], (TMP_13 = function(param, value){var self = TMP_13.$$s || this;
if (param == null) param = nil;if (value == null) value = nil;
            return message['$<<']("" + "  " + (param) + " => " + (value.$inspect().$truncate(120, $hash2(["separator"], {"separator": "..."}))))}, TMP_13.$$s = self, TMP_13.$$arity = 2, TMP_13));
            if ($truthy(e['$respond_to?']("details"))) {
              message['$<<']("" + "\n" + (e.$details()))};
            e.$__hyperstack_on_error(operation, params, message.$join("\n"));};
          return $hash2(["json", "status"], {"json": $hash2(["error_class", "error"], {"error_class": e.$class().$to_s(), "error": e}), "status": self.$status(e)});
        }, TMP_handle_exception_14.$$arity = 3);
        
        Opal.defn(self, '$remote', TMP_remote_15 = function $$remote(path, $a_rest) {
          var self = this, args, promise = nil, uri = nil, http = nil, request = nil, $writer = nil, e = nil;

          var $args_len = arguments.length, $rest_len = $args_len - 1;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 1] = arguments[$arg_idx];
          }
          try {
            
            promise = Opal.const_get_relative($nesting, 'Promise').$new();
            uri = self.$URI("" + (path) + "execute_remote_api");
            http = Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Net'), 'HTTP').$new(uri.$host(), uri.$port());
            request = Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Net'), 'HTTP'), 'Post').$new(uri.$path(), $hash2(["Content-Type"], {"Content-Type": "application/json"}));
            if (uri.$scheme()['$==']("https")) {
              
              $writer = [true];
              $send(http, 'use_ssl=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];};
            
            $writer = [$hash2(["operation", "params"], {"operation": self.$name(), "params": Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Operation'), 'ParamsWrapper').$combine_arg_array(args)}).$to_json()];
            $send(request, 'body=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];;
            return promise.$resolve(http.$request(request));
          } catch ($err) {
            if (Opal.rescue($err, [Opal.const_get_relative($nesting, 'Exception')])) {e = $err;
              try {
                return promise.$reject(e)
              } finally { Opal.pop_exception() }
            } else { throw $err; }
          }
        }, TMP_remote_15.$$arity = -2);
        
        Opal.defn(self, '$serialize_params', TMP_serialize_params_16 = function $$serialize_params(hash) {
          var self = this;

          return hash
        }, TMP_serialize_params_16.$$arity = 1);
        
        Opal.defn(self, '$deserialize_params', TMP_deserialize_params_17 = function $$deserialize_params(hash) {
          var self = this;

          return hash
        }, TMP_deserialize_params_17.$$arity = 1);
        
        Opal.defn(self, '$serialize_response', TMP_serialize_response_18 = function $$serialize_response(hash) {
          var self = this;

          return hash
        }, TMP_serialize_response_18.$$arity = 1);
        
        Opal.defn(self, '$deserialize_response', TMP_deserialize_response_19 = function $$deserialize_response(hash) {
          var self = this;

          return hash
        }, TMP_deserialize_response_19.$$arity = 1);
        
        Opal.defn(self, '$serialize_dispatch', TMP_serialize_dispatch_20 = function $$serialize_dispatch(hash) {
          var self = this;

          return hash
        }, TMP_serialize_dispatch_20.$$arity = 1);
        
        Opal.defn(self, '$deserialize_dispatch', TMP_deserialize_dispatch_21 = function $$deserialize_dispatch(hash) {
          var self = this;

          return hash
        }, TMP_deserialize_dispatch_21.$$arity = 1);
        
        Opal.defn(self, '$dispatch_to', TMP_dispatch_to_22 = function $$dispatch_to($a_rest) {
          var self = this, args, $iter = TMP_dispatch_to_22.$$p, regulation = $iter || nil;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          if ($iter) TMP_dispatch_to_22.$$p = null;
          if ($truthy(Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$!=']("opal"))) {
            return nil
            } else {
            return nil
          }
        }, TMP_dispatch_to_22.$$arity = -1);
        if ($truthy(Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$!=']("opal"))) {
          nil};
        return (Opal.defn(self, '$dispatch_from_server', TMP_dispatch_from_server_24 = function $$dispatch_from_server(params_hash) {
          var TMP_23, self = this, params = nil;

          
          params = self.$_Railway().$params_wrapper().$new(self.$deserialize_dispatch(params_hash)).$lock();
          return $send(self.$_Railway().$receivers(), 'each', [], (TMP_23 = function(receiver){var self = TMP_23.$$s || this;
if (receiver == null) receiver = nil;
          return receiver.$call(params)}, TMP_23.$$s = self, TMP_23.$$arity = 1, TMP_23));
        }, TMP_dispatch_from_server_24.$$arity = 1), nil) && 'dispatch_from_server';
      })(Opal.get_singleton_class(self), $nesting)
    })($nesting[0], Opal.const_get_relative($nesting, 'Operation'), $nesting);
    (function($base, $super, $parent_nesting) {
      function $ControllerOp(){};
      var self = $ControllerOp = $klass($base, $super, 'ControllerOp', $ControllerOp);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ControllerOp_method_missing_25;

      
      self.$inbound("controller");
      Opal.alias(self, "pre_controller_op_method_missing", "method_missing");
      return (Opal.defn(self, '$method_missing', TMP_ControllerOp_method_missing_25 = function $$method_missing(name, $a_rest) {
        var self = this, args, $iter = TMP_ControllerOp_method_missing_25.$$p, block = $iter || nil;

        var $args_len = arguments.length, $rest_len = $args_len - 1;
        if ($rest_len < 0) { $rest_len = 0; }
        args = new Array($rest_len);
        for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
          args[$arg_idx - 1] = arguments[$arg_idx];
        }
        if ($iter) TMP_ControllerOp_method_missing_25.$$p = null;
        if ($truthy(self.$params().$controller()['$respond_to?'](name))) {
          return $send(self.$params().$controller(), 'send', [name].concat(Opal.to_a(args)), block.$to_proc())
          } else {
          return $send(self, 'pre_controller_op_method_missing', [name].concat(Opal.to_a(args)), block.$to_proc())
        }
      }, TMP_ControllerOp_method_missing_25.$$arity = -2), nil) && 'method_missing';
    })($nesting[0], Opal.const_get_relative($nesting, 'ServerOp'), $nesting);
  })($nesting[0], $nesting);
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation/boot"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$inherited', '$add_receiver', '$_Railway', '$to_proc', '$initialize_client_drivers_on_boot', '$_run', '$respond_to?', '$each', '$receivers', '$on_dispatch']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Application(){};
      var self = $Application = $klass($base, $super, 'Application', $Application);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), $a, TMP_Application_3;

      
      if ($truthy((($a = Opal.const_get_relative($nesting, 'Boot', 'skip_raise')) ? 'constant' : nil))) {
        Opal.const_get_relative($nesting, 'Operation').$inherited(Opal.const_get_relative($nesting, 'Boot'))};
      (function($base, $super, $parent_nesting) {
        function $Boot(){};
        var self = $Boot = $klass($base, $super, 'Boot', $Boot);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Boot_on_dispatch_1, TMP_Boot_run_2;

        
        Opal.defs(self, '$on_dispatch', TMP_Boot_on_dispatch_1 = function $$on_dispatch() {
          var self = this, $iter = TMP_Boot_on_dispatch_1.$$p, block = $iter || nil;

          if ($iter) TMP_Boot_on_dispatch_1.$$p = null;
          return $send(self.$_Railway(), 'add_receiver', [], block.$to_proc())
        }, TMP_Boot_on_dispatch_1.$$arity = 0);
        return Opal.defs(self, '$run', TMP_Boot_run_2 = function $$run($a_rest) {
          var self = this, args;

          var $args_len = arguments.length, $rest_len = $args_len - 0;
          if ($rest_len < 0) { $rest_len = 0; }
          args = new Array($rest_len);
          for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
            args[$arg_idx - 0] = arguments[$arg_idx];
          }
          
          Opal.const_get_relative($nesting, 'ClientDrivers').$initialize_client_drivers_on_boot();
          return $send(self, '_run', Opal.to_a(args));
        }, TMP_Boot_run_2.$$arity = -1);
      })($nesting[0], Opal.const_get_relative($nesting, 'Operation'), $nesting);
      if ($truthy(Opal.const_get_relative($nesting, 'Boot')['$respond_to?']("receivers"))) {
        return $send(Opal.const_get_relative($nesting, 'Boot').$receivers(), 'each', [], (TMP_Application_3 = function(r){var self = TMP_Application_3.$$s || this;
if (r == null) r = nil;
        return $send(Opal.const_get_relative($nesting, 'Boot'), 'on_dispatch', [], r.$to_proc())}, TMP_Application_3.$$s = self, TMP_Application_3.$$arity = 1, TMP_Application_3))
        } else {
        return nil
      };
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-operation"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $klass = Opal.klass;

  Opal.add_stubs(['$require', '$import', '$==', '$register_additional_filter']);
  
  self.$require("hyper-operation/version");
  self.$require("hyperstack-config");
  Opal.const_get_relative($nesting, 'Hyperstack').$import("hyper-operation");
  if (Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$==']("opal")) {
    
    self.$require("active_support/core_ext/string");
    self.$require("mutations");
    Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Mutations'), 'HashFilter').$register_additional_filter(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Mutations'), 'DuckFilter'), "duck");
    self.$require("hyper-operation/filters/outbound_filter");
    self.$require("hyper-component");
    self.$require("hyper-operation/http");
    self.$require("hyper-operation/transport/client_drivers");
    (function($base, $super, $parent_nesting) {
      function $HashWithIndifferentAccess(){};
      var self = $HashWithIndifferentAccess = $klass($base, $super, 'HashWithIndifferentAccess', $HashWithIndifferentAccess);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return nil
    })($nesting[0], Opal.const_get_relative($nesting, 'Hash'), $nesting);
    (function($base, $super, $parent_nesting) {
      function $String(){};
      var self = $String = $klass($base, $super, 'String', $String);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_String_titleize_1;

      return (Opal.defn(self, '$titleize', TMP_String_titleize_1 = function $$titleize() {
        var self = this;

        return self
      }, TMP_String_titleize_1.$$arity = 0), nil) && 'titleize'
    })($nesting[0], null, $nesting);
    self.$require("hyper-operation/exception");
    self.$require("hyper-operation/promise");
    self.$require("hyper-operation/railway");
    self.$require("hyper-operation/api");
    self.$require("hyper-operation/railway/dispatcher");
    self.$require("hyper-operation/railway/params_wrapper");
    self.$require("hyper-operation/railway/run");
    self.$require("hyper-operation/railway/validations");
    self.$require("hyper-operation/server_op");
    return self.$require("hyper-operation/boot");
    } else {
    return nil
  };
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/state/mapper"] = function(Opal) {
  function $rb_plus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs + rhs : lhs['$+'](rhs);
  }
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$+', '$observed!', '$class', '$update_objects_to_observe', '$-', '$<<', '$[]', '$new_objects', '$update_exclusions', '$delay_updates?', '$schedule_delayed_updater', '$zero?', '$key?', '$current_observers', '$each', '$mutations', '$remove_current_observers_and_objects', '$delete', '$[]=', '$current_objects', '$new', '$raise', '$empty?', '$on_client?', '$!=', '$after', '$run_delayed_updater', '$observers_to_update', '$include?', '$tap']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $State, self = $State = $module($base, 'State');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $parent_nesting) {
          var $Mapper, self = $Mapper = $module($base, 'Mapper');

          var def = self.$$proto, $nesting = [self].concat($parent_nesting);

          
          self.rendering_level = 0;
          (function(self, $parent_nesting) {
            var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_observing_1, TMP_observed$B_2, TMP_mutated$B_4, TMP_observed$q_5, TMP_bulk_update_6, TMP_ignore_bulk_updates_7, TMP_ignore_mutations_8, TMP_update_objects_to_observe_10, TMP_remove_11, TMP_new_objects_13, TMP_current_observers_15, TMP_current_objects_17, TMP_update_exclusions_18, TMP_remove_current_observers_and_objects_20, TMP_delay_updates$q_21, TMP_schedule_delayed_updater_23, TMP_run_delayed_updater_25, TMP_observers_to_update_30;

            
            
            Opal.defn(self, '$observing', TMP_observing_1 = function $$observing(observer, immediate_update, rendering, update_objects) {
              var $a, $b, self = this, $iter = TMP_observing_1.$$p, $yield = $iter || nil, saved_context = nil, return_value = nil;
              if (self.current_observer == null) self.current_observer = nil;
              if (self.immediate_update == null) self.immediate_update = nil;
              if (self.rendering_level == null) self.rendering_level = nil;

              if ($iter) TMP_observing_1.$$p = null;
              return (function() { try {
              
              saved_context = [self.current_observer, self.immediate_update];
              self.current_observer = observer;
              self.immediate_update = ($truthy($a = immediate_update) ? observer : $a);
              if ($truthy(rendering)) {
                
                self.rendering_level = $rb_plus(self.rendering_level, 1);
                self['$observed!'](observer);
                self['$observed!'](observer.$class());};
              return_value = Opal.yieldX($yield, []);
              if ($truthy(update_objects)) {
                self.$update_objects_to_observe(observer)};
              return return_value;
              } finally {
                ($b = saved_context, $a = Opal.to_ary($b), (self.current_observer = ($a[0] == null ? nil : $a[0])), (self.immediate_update = ($a[1] == null ? nil : $a[1])), $b, (function() {if ($truthy(rendering)) {
                  return (self.rendering_level = $rb_minus(self.rendering_level, 1))
                  } else {
                  return nil
                }; return nil; })(), return_value)
              }; })()
            }, TMP_observing_1.$$arity = 4);
            
            Opal.defn(self, '$observed!', TMP_observed$B_2 = function(object) {
              var self = this;
              if (self.current_observer == null) self.current_observer = nil;

              
              if ($truthy(self.current_observer)) {
                } else {
                return nil
              };
              self.$new_objects()['$[]'](self.current_observer)['$<<'](object);
              if ($truthy(self.$update_exclusions()['$[]'](object))) {
                } else {
                return nil
              };
              return self.$update_exclusions()['$[]'](object)['$<<'](self.current_observer);
            }, TMP_observed$B_2.$$arity = 1);
            
            Opal.defn(self, '$mutated!', TMP_mutated$B_4 = function(object) {
              var TMP_3, self = this;
              if (self.ignore_mutations == null) self.ignore_mutations = nil;
              if (self.rendering_level == null) self.rendering_level = nil;

              
              if ($truthy(self.ignore_mutations)) {
                return nil};
              if ($truthy(self['$delay_updates?'](object))) {
                return self.$schedule_delayed_updater(object)
              } else if ($truthy(self.rendering_level['$zero?']())) {
                if ($truthy(self.$current_observers()['$key?'](object))) {
                  return $send(self.$current_observers()['$[]'](object), 'each', [], (TMP_3 = function(observer){var self = TMP_3.$$s || this;
if (observer == null) observer = nil;
                  return observer.$mutations([object])}, TMP_3.$$s = self, TMP_3.$$arity = 1, TMP_3))
                  } else {
                  return nil
                }
                } else {
                return nil
              };
            }, TMP_mutated$B_4.$$arity = 1);
            
            Opal.defn(self, '$observed?', TMP_observed$q_5 = function(object) {
              var self = this;

              return self.$current_observers()['$key?'](object)
            }, TMP_observed$q_5.$$arity = 1);
            
            Opal.defn(self, '$bulk_update', TMP_bulk_update_6 = function $$bulk_update() {
              var self = this, $iter = TMP_bulk_update_6.$$p, $yield = $iter || nil, saved_bulk_update_flag = nil;
              if (self.bulk_update_flag == null) self.bulk_update_flag = nil;

              if ($iter) TMP_bulk_update_6.$$p = null;
              return (function() { try {
              
              saved_bulk_update_flag = self.bulk_update_flag;
              self.bulk_update_flag = true;
              return Opal.yieldX($yield, []);;
              } finally {
                (self.bulk_update_flag = saved_bulk_update_flag)
              }; })()
            }, TMP_bulk_update_6.$$arity = 0);
            
            Opal.defn(self, '$ignore_bulk_updates', TMP_ignore_bulk_updates_7 = function $$ignore_bulk_updates($a_rest) {
              var self = this, args, $iter = TMP_ignore_bulk_updates_7.$$p, $yield = $iter || nil, saved_ignore_bulk_update_flag = nil;
              if (self.ignore_bulk_update_flag == null) self.ignore_bulk_update_flag = nil;

              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              args = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                args[$arg_idx - 0] = arguments[$arg_idx];
              }
              if ($iter) TMP_ignore_bulk_updates_7.$$p = null;
              return (function() { try {
              
              saved_ignore_bulk_update_flag = self.ignore_bulk_update_flag;
              self.ignore_bulk_update_flag = true;
              return Opal.yieldX($yield, Opal.to_a(args));;
              } finally {
                (self.ignore_bulk_update_flag = saved_ignore_bulk_update_flag)
              }; })()
            }, TMP_ignore_bulk_updates_7.$$arity = -1);
            
            Opal.defn(self, '$ignore_mutations', TMP_ignore_mutations_8 = function $$ignore_mutations() {
              var self = this, $iter = TMP_ignore_mutations_8.$$p, $yield = $iter || nil, saved_ignore_mutations_flag = nil;
              if (self.ignore_mutations == null) self.ignore_mutations = nil;

              if ($iter) TMP_ignore_mutations_8.$$p = null;
              return (function() { try {
              
              saved_ignore_mutations_flag = self.ignore_mutations;
              self.ignore_mutations = true;
              return Opal.yieldX($yield, []);;
              } finally {
                (self.ignore_mutations = saved_ignore_mutations_flag)
              }; })()
            }, TMP_ignore_mutations_8.$$arity = 0);
            
            Opal.defn(self, '$update_objects_to_observe', TMP_update_objects_to_observe_10 = function $$update_objects_to_observe(observer) {
              var TMP_9, self = this, objects = nil, $writer = nil;
              if (self.current_observer == null) self.current_observer = nil;

              if (observer == null) {
                observer = self.current_observer;
              }
              
              self.$remove_current_observers_and_objects(observer);
              objects = self.$new_objects().$delete(observer);
              if ($truthy(objects)) {
                $send(objects, 'each', [], (TMP_9 = function(object){var self = TMP_9.$$s || this;
if (object == null) object = nil;
                return self.$current_observers()['$[]'](object)['$<<'](observer)}, TMP_9.$$s = self, TMP_9.$$arity = 1, TMP_9))};
              
              $writer = [observer, objects];
              $send(self.$current_objects(), '[]=', Opal.to_a($writer));
              return $writer[$rb_minus($writer["length"], 1)];;
            }, TMP_update_objects_to_observe_10.$$arity = -1);
            
            Opal.defn(self, '$remove', TMP_remove_11 = function $$remove(observer) {
              var self = this;
              if (self.removed_observers == null) self.removed_observers = nil;
              if (self.current_observer == null) self.current_observer = nil;

              if (observer == null) {
                observer = self.current_observer;
              }
              
              self.$remove_current_observers_and_objects(observer);
              self.$new_objects().$delete(observer);
              if ($truthy(self.removed_observers)) {
                return self.removed_observers['$<<'](observer)
                } else {
                return nil
              };
            }, TMP_remove_11.$$arity = -1);
            
            Opal.defn(self, '$new_objects', TMP_new_objects_13 = function $$new_objects() {
              var $a, TMP_12, self = this;
              if (self.new_objects == null) self.new_objects = nil;

              return (self.new_objects = ($truthy($a = self.new_objects) ? $a : $send(Opal.const_get_relative($nesting, 'Hash'), 'new', [], (TMP_12 = function(h, k){var self = TMP_12.$$s || this, $writer = nil;
if (h == null) h = nil;if (k == null) k = nil;
              
                $writer = [k, Opal.const_get_relative($nesting, 'Set').$new()];
                $send(h, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];}, TMP_12.$$s = self, TMP_12.$$arity = 2, TMP_12))))
            }, TMP_new_objects_13.$$arity = 0);
            
            Opal.defn(self, '$current_observers', TMP_current_observers_15 = function $$current_observers() {
              var $a, TMP_14, self = this;
              if (self.current_observers == null) self.current_observers = nil;

              return (self.current_observers = ($truthy($a = self.current_observers) ? $a : $send(Opal.const_get_relative($nesting, 'Hash'), 'new', [], (TMP_14 = function(h, k){var self = TMP_14.$$s || this, $writer = nil;
if (h == null) h = nil;if (k == null) k = nil;
              
                $writer = [k, []];
                $send(h, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];}, TMP_14.$$s = self, TMP_14.$$arity = 2, TMP_14))))
            }, TMP_current_observers_15.$$arity = 0);
            
            Opal.defn(self, '$current_objects', TMP_current_objects_17 = function $$current_objects() {
              var $a, TMP_16, self = this;
              if (self.current_objects == null) self.current_objects = nil;

              return (self.current_objects = ($truthy($a = self.current_objects) ? $a : $send(Opal.const_get_relative($nesting, 'Hash'), 'new', [], (TMP_16 = function(h, k){var self = TMP_16.$$s || this, $writer = nil;
if (h == null) h = nil;if (k == null) k = nil;
              
                $writer = [k, []];
                $send(h, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];}, TMP_16.$$s = self, TMP_16.$$arity = 2, TMP_16))))
            }, TMP_current_objects_17.$$arity = 0);
            
            Opal.defn(self, '$update_exclusions', TMP_update_exclusions_18 = function $$update_exclusions() {
              var $a, self = this;
              if (self.update_exclusions == null) self.update_exclusions = nil;

              return (self.update_exclusions = ($truthy($a = self.update_exclusions) ? $a : Opal.const_get_relative($nesting, 'Hash').$new()))
            }, TMP_update_exclusions_18.$$arity = 0);
            
            Opal.defn(self, '$remove_current_observers_and_objects', TMP_remove_current_observers_and_objects_20 = function $$remove_current_observers_and_objects(observer) {
              var TMP_19, self = this, deleted_objects = nil;

              
              if ($truthy(observer)) {
                } else {
                self.$raise("state management called outside of watch block")
              };
              deleted_objects = self.$current_objects().$delete(observer);
              if ($truthy(deleted_objects)) {
                } else {
                return nil
              };
              return $send(deleted_objects, 'each', [], (TMP_19 = function(object){var self = TMP_19.$$s || this;
if (object == null) object = nil;
              
                if ($truthy(self.$current_observers()['$key?'](object))) {
                  } else {
                  return nil;
                };
                self.$current_observers()['$[]'](object).$delete(observer);
                if ($truthy(self.$current_observers()['$[]'](object)['$empty?']())) {
                  return self.$current_observers().$delete(object)
                  } else {
                  return nil
                };}, TMP_19.$$s = self, TMP_19.$$arity = 1, TMP_19));
            }, TMP_remove_current_observers_and_objects_20.$$arity = 1);
            
            Opal.defn(self, '$delay_updates?', TMP_delay_updates$q_21 = function(object) {
              var $a, self = this;
              if (self.ignore_bulk_update_flag == null) self.ignore_bulk_update_flag = nil;
              if (self.bulk_update_flag == null) self.bulk_update_flag = nil;
              if (self.immediate_update == null) self.immediate_update = nil;
              if (self.current_observer == null) self.current_observer = nil;

              
              if ($truthy(self.ignore_bulk_update_flag)) {
                return false};
              if ($truthy(self.bulk_update_flag)) {
                return true};
              if ($truthy(Opal.const_get_relative($nesting, 'Hyperstack')['$on_client?']())) {
                } else {
                return false
              };
              
              return ($truthy($a = self.immediate_update['$!='](self.current_observer)) ? $a : self.current_observer['$!='](object));;
            }, TMP_delay_updates$q_21.$$arity = 1);
            
            Opal.defn(self, '$schedule_delayed_updater', TMP_schedule_delayed_updater_23 = function $$schedule_delayed_updater(object) {
              var $a, TMP_22, self = this, $writer = nil;
              if (self.delayed_updater == null) self.delayed_updater = nil;

              
              
              $writer = [object, Opal.const_get_relative($nesting, 'Set').$new()];
              $send(self.$update_exclusions(), '[]=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;
              return (self.delayed_updater = ($truthy($a = self.delayed_updater) ? $a : $send(self, 'after', [0], (TMP_22 = function(){var self = TMP_22.$$s || this;

              return self.$run_delayed_updater()}, TMP_22.$$s = self, TMP_22.$$arity = 0, TMP_22))));
            }, TMP_schedule_delayed_updater_23.$$arity = 1);
            
            Opal.defn(self, '$run_delayed_updater', TMP_run_delayed_updater_25 = function $$run_delayed_updater() {
              var TMP_24, self = this, current_update_exclusions = nil;
              if (self.update_exclusions == null) self.update_exclusions = nil;

              return (function() { try {
              
              current_update_exclusions = self.update_exclusions;
              self.update_exclusions = (self.delayed_updater = nil);
              self.removed_observers = Opal.const_get_relative($nesting, 'Set').$new();
              return $send(self.$observers_to_update(current_update_exclusions), 'each', [], (TMP_24 = function(observer, objects){var self = TMP_24.$$s || this;
                if (self.removed_observers == null) self.removed_observers = nil;
if (observer == null) observer = nil;if (objects == null) objects = nil;
              if ($truthy(self.removed_observers['$include?'](observer))) {
                  return nil
                  } else {
                  return observer.$mutations(objects)
                }}, TMP_24.$$s = self, TMP_24.$$arity = 2, TMP_24));
              } finally {
                (self.removed_observers = nil)
              }; })()
            }, TMP_run_delayed_updater_25.$$arity = 0);
            return (Opal.defn(self, '$observers_to_update', TMP_observers_to_update_30 = function $$observers_to_update(exclusions) {
              var TMP_26, TMP_27, self = this;

              return $send($send(Opal.const_get_relative($nesting, 'Hash'), 'new', [], (TMP_26 = function(hash, key){var self = TMP_26.$$s || this, $writer = nil;
if (hash == null) hash = nil;if (key == null) key = nil;
              
                $writer = [key, Opal.const_get_relative($nesting, 'Array').$new()];
                $send(hash, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];}, TMP_26.$$s = self, TMP_26.$$arity = 2, TMP_26)), 'tap', [], (TMP_27 = function(updates){var self = TMP_27.$$s || this, TMP_28;
if (updates == null) updates = nil;
              return $send(exclusions, 'each', [], (TMP_28 = function(object, excluded_observers){var self = TMP_28.$$s || this, TMP_29;
if (object == null) object = nil;if (excluded_observers == null) excluded_observers = nil;
                if ($truthy(self.$current_observers()['$key?'](object))) {
                    return $send(self.$current_observers()['$[]'](object), 'each', [], (TMP_29 = function(observer){var self = TMP_29.$$s || this;
if (observer == null) observer = nil;
                    
                      if ($truthy(excluded_observers['$include?'](observer))) {
                        return nil;};
                      return updates['$[]'](observer)['$<<'](object);}, TMP_29.$$s = self, TMP_29.$$arity = 1, TMP_29))
                    } else {
                    return nil
                  }}, TMP_28.$$s = self, TMP_28.$$arity = 2, TMP_28))}, TMP_27.$$s = self, TMP_27.$$arity = 1, TMP_27))
            }, TMP_observers_to_update_30.$$arity = 1), nil) && 'observers_to_update';
          })(Opal.get_singleton_class(self), $nesting);
        })($nesting[0], $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/state/variable"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$new', '$[]=', '$-', '$[]', '$legacy_map', '$observed!', '$object_id', '$mutated!', '$observed?']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $State, self = $State = $module($base, 'State');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $parent_nesting) {
          var $Variable, self = $Variable = $module($base, 'Variable');

          var def = self.$$proto, $nesting = [self].concat($parent_nesting);

          (function(self, $parent_nesting) {
            var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_legacy_map_3, TMP_get_4, TMP_set_5, TMP_observed$q_6;

            
            
            Opal.defn(self, '$legacy_map', TMP_legacy_map_3 = function $$legacy_map() {
              var $a, TMP_1, self = this;
              if (self.legacy_map == null) self.legacy_map = nil;

              return (self.legacy_map = ($truthy($a = self.legacy_map) ? $a : $send(Opal.const_get_relative($nesting, 'Hash'), 'new', [], (TMP_1 = function(h, k){var self = TMP_1.$$s || this, TMP_2, $writer = nil;
if (h == null) h = nil;if (k == null) k = nil;
              
                $writer = [k, $send(Opal.const_get_relative($nesting, 'Hash'), 'new', [], (TMP_2 = function(h2, k2){var self = TMP_2.$$s || this;
if (h2 == null) h2 = nil;if (k2 == null) k2 = nil;
                
                  $writer = [k2, Opal.const_get_relative($nesting, 'Array').$new()];
                  $send(h2, '[]=', Opal.to_a($writer));
                  return $writer[$rb_minus($writer["length"], 1)];}, TMP_2.$$s = self, TMP_2.$$arity = 2, TMP_2))];
                $send(h, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];}, TMP_1.$$s = self, TMP_1.$$arity = 2, TMP_1))))
            }, TMP_legacy_map_3.$$arity = 0);
            
            Opal.defn(self, '$get', TMP_get_4 = function $$get(obj, name) {
              var self = this, map_object = nil;

              
              map_object = self.$legacy_map()['$[]'](obj)['$[]'](name);
              Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'State'), 'Mapper')['$observed!'](map_object.$object_id());
              return map_object['$[]'](0);
            }, TMP_get_4.$$arity = 2);
            
            Opal.defn(self, '$set', TMP_set_5 = function $$set(obj, name, value) {
              var self = this, map_object = nil, $writer = nil;

              
              map_object = self.$legacy_map()['$[]'](obj)['$[]'](name);
              
              $writer = [0, value];
              $send(map_object, '[]=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;
              Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'State'), 'Mapper')['$mutated!'](map_object.$object_id());
              return value;
            }, TMP_set_5.$$arity = 3);
            return (Opal.defn(self, '$observed?', TMP_observed$q_6 = function(obj, name) {
              var self = this, map_object = nil;

              
              map_object = self.$legacy_map()['$[]'](obj)['$[]'](name);
              return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'State'), 'Mapper')['$observed?'](map_object.$object_id());
            }, TMP_observed$q_6.$$arity = 2), nil) && 'observed?';
          })(Opal.get_singleton_class(self), $nesting)
        })($nesting[0], $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/receiver"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$respond_to?', '$unmounted?', '$format_callback', '$each', '$on_dispatch', '$call', '$<<', '$[]', '$objects_to_unmount', '$is_a?', '$last', '$pop', '$lambda', '$send', '$empty?', '$raise']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Receiver, self = $Receiver = $module($base, 'Receiver');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function(self, $parent_nesting) {
          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_mount_1, TMP_format_callback_5;

          
          
          Opal.defn(self, '$mount', TMP_mount_1 = function $$mount(receiver, $a_rest) {
            var $b, TMP_2, self = this, args, $iter = TMP_mount_1.$$p, block = $iter || nil, callback = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 1;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 1; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 1] = arguments[$arg_idx];
            }
            if ($iter) TMP_mount_1.$$p = null;
            
            if ($truthy(($truthy($b = receiver['$respond_to?']("unmounted?")) ? receiver['$unmounted?']() : $b))) {
              return nil};
            callback = self.$format_callback(receiver, args);
            return $send(args, 'each', [], (TMP_2 = function(operation){var self = TMP_2.$$s || this, TMP_3, id = nil;
if (operation == null) operation = nil;
            
              id = $send(operation, 'on_dispatch', [], (TMP_3 = function(params){var self = TMP_3.$$s || this;
if (params == null) params = nil;
              
                if ($truthy(callback)) {
                  callback.$call(params)};
                if ($truthy(block)) {
                  return Opal.yield1(block, params);
                  } else {
                  return nil
                };}, TMP_3.$$s = self, TMP_3.$$arity = 1, TMP_3));
              if ($truthy(receiver['$respond_to?']("unmount"))) {
                return Opal.const_get_relative($nesting, 'AutoUnmount').$objects_to_unmount()['$[]'](receiver)['$<<'](id)
                } else {
                return nil
              };}, TMP_2.$$s = self, TMP_2.$$arity = 1, TMP_2));
          }, TMP_mount_1.$$arity = -2);
          return (Opal.defn(self, '$format_callback', TMP_format_callback_5 = function $$format_callback(receiver, args) {
            var TMP_4, self = this, call_back = nil, method_name = nil, message = nil;

            
            call_back = (function() {if ($truthy(args.$last()['$is_a?'](Opal.const_get_relative($nesting, 'Symbol')))) {
              
              method_name = args.$pop();
              return $send(self, 'lambda', [], (TMP_4 = function($a_rest){var self = TMP_4.$$s || this, aargs;

                var $args_len = arguments.length, $rest_len = $args_len - 0;
                if ($rest_len < 0) { $rest_len = 0; }
                aargs = new Array($rest_len);
                for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                  aargs[$arg_idx - 0] = arguments[$arg_idx];
                }
              return $send(receiver, 'send', ["" + (method_name)].concat(Opal.to_a(aargs)))}, TMP_4.$$s = self, TMP_4.$$arity = -1, TMP_4));
            } else if ($truthy(args.$last()['$is_a?'](Opal.const_get_relative($nesting, 'Proc')))) {
              return args.$pop()
              } else {
              return nil
            }; return nil; })();
            if ($truthy(args['$empty?']())) {
              } else {
              return call_back
            };
            message = "At least one operation must be passed in to the 'receives' macro";
            return self.$raise(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Legacy'), 'Store'), 'InvalidOperationError'), message);
          }, TMP_format_callback_5.$$arity = 2), nil) && 'format_callback';
        })(Opal.get_singleton_class(self), $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/state/observable"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send, $truthy = Opal.truthy;

  Opal.add_stubs(['$bulk_update', '$to_proc', '$include', '$each', '$send', '$mount', '$call', '$last', '$observed!', '$mutated!', '$instance_variable_set', '$!', '$instance_variable_get', '$==', '$naming_convention', '$!~', '$!=', '$lambda', '$mutate', '$singleton_class', '$define_method', '$tap', '$instance_exec', '$state_reader', '$state_writer']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $State, self = $State = $module($base, 'State');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Observable, self = $Observable = $module($base, 'Observable');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Observable_bulk_update_1, TMP_Observable_included_24;

        
        Opal.defs(self, '$bulk_update', TMP_Observable_bulk_update_1 = function $$bulk_update() {
          var self = this, $iter = TMP_Observable_bulk_update_1.$$p, block = $iter || nil;

          if ($iter) TMP_Observable_bulk_update_1.$$p = null;
          return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper'), 'bulk_update', [], block.$to_proc())
        }, TMP_Observable_bulk_update_1.$$arity = 0);
        Opal.defs(self, '$included', TMP_Observable_included_24 = function $$included(base) {
          var TMP_2, self = this;

          
          base.$include(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'AutoUnmount'));
          return $send(["singleton_method", "method"], 'each', [], (TMP_2 = function(kind){var self = TMP_2.$$s || this, TMP_3, TMP_4, TMP_5, TMP_6, TMP_7, TMP_9, TMP_12, TMP_15, TMP_19, TMP_23;
if (kind == null) kind = nil;
          
            $send(base, 'send', ["" + "define_" + (kind), "receives"], (TMP_3 = function($a_rest){var self = TMP_3.$$s || this, block, args;

              block = TMP_3.$$p || nil;
              if (block) TMP_3.$$p = null;
              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              args = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                args[$arg_idx - 0] = arguments[$arg_idx];
              }
            return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'Receiver'), 'mount', [self].concat(Opal.to_a(args)), block.$to_proc())}, TMP_3.$$s = self, TMP_3.$$arity = -1, TMP_3));
            $send(base, 'send', ["" + "define_" + (kind), "observe"], (TMP_4 = function($a_rest){var self = TMP_4.$$s || this, block, args, $b, $c, result = nil;

              block = TMP_4.$$p || nil;
              if (block) TMP_4.$$p = null;
              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              args = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                args[$arg_idx - 0] = arguments[$arg_idx];
              }
            
              result = ($truthy($b = ($truthy($c = block) ? block.$call() : $c)) ? $b : args.$last());
              Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper')['$observed!'](self);
              return result;}, TMP_4.$$s = self, TMP_4.$$arity = -1, TMP_4));
            $send(base, 'send', ["" + "define_" + (kind), "mutate"], (TMP_5 = function($a_rest){var self = TMP_5.$$s || this, block, args, $b, $c, result = nil;

              block = TMP_5.$$p || nil;
              if (block) TMP_5.$$p = null;
              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              args = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                args[$arg_idx - 0] = arguments[$arg_idx];
              }
            
              result = ($truthy($b = ($truthy($c = block) ? block.$call() : $c)) ? $b : args.$last());
              Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper')['$mutated!'](self);
              return result;}, TMP_5.$$s = self, TMP_5.$$arity = -1, TMP_5));
            $send(base, 'send', ["" + "define_" + (kind), "toggle"], (TMP_6 = function(var$){var self = TMP_6.$$s || this, result = nil;
if (var$ == null) var$ = nil;
            
              var$ = "" + "@" + (var$);
              result = self.$instance_variable_set(var$, self.$instance_variable_get(var$)['$!']());
              Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper')['$mutated!'](self);
              return result;}, TMP_6.$$s = self, TMP_6.$$arity = 1, TMP_6));
            if (Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$==']("opal")) {
              $send(base, 'send', ["" + "define_" + (kind), "set"], (TMP_7 = function(var$){var self = TMP_7.$$s || this, $a, TMP_8, dont_mutate = nil;
if (var$ == null) var$ = nil;
              
                if (Opal.const_get_relative($nesting, 'Hyperstack').$naming_convention()['$==']("prefix_state")) {
                  if ($truthy(var$['$!~'](/^_/))) {
                    var$ = "" + "_" + (var$)}
                } else if ($truthy(($truthy($a = Opal.const_get_relative($nesting, 'Hyperstack').$naming_convention()['$!=']("none")) ? var$['$!~'](/^[a-z]/) : $a))) {
                  dont_mutate = true};
                return $send(self, 'lambda', [], (TMP_8 = function(val){var self = TMP_8.$$s || this;
if (val == null) val = nil;
                
                  self[var$] = val;
                  if ($truthy(dont_mutate)) {
                    return nil
                    } else {
                    return self.$mutate()
                  };}, TMP_8.$$s = self, TMP_8.$$arity = 1, TMP_8));}, TMP_7.$$s = self, TMP_7.$$arity = 1, TMP_7))
              } else {
              nil
            };
            $send(base.$singleton_class(), 'send', ["" + "define_" + (kind), "observer"], (TMP_9 = function(name){var self = TMP_9.$$s || this, block, TMP_10;

              block = TMP_9.$$p || nil;
              if (block) TMP_9.$$p = null;if (name == null) name = nil;
            return $send(self, 'define_method', [name], (TMP_10 = function($a_rest){var self = TMP_10.$$s || this, args, TMP_11;

                var $args_len = arguments.length, $rest_len = $args_len - 0;
                if ($rest_len < 0) { $rest_len = 0; }
                args = new Array($rest_len);
                for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                  args[$arg_idx - 0] = arguments[$arg_idx];
                }
              return $send($send(self, 'instance_exec', Opal.to_a(args), block.$to_proc()), 'tap', [], (TMP_11 = function(){var self = TMP_11.$$s || this;

                return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper')['$observed!'](self)}, TMP_11.$$s = self, TMP_11.$$arity = 0, TMP_11))}, TMP_10.$$s = self, TMP_10.$$arity = -1, TMP_10))}, TMP_9.$$s = self, TMP_9.$$arity = 1, TMP_9));
            $send(base.$singleton_class(), 'send', ["" + "define_" + (kind), "mutator"], (TMP_12 = function(name){var self = TMP_12.$$s || this, block, TMP_13;

              block = TMP_12.$$p || nil;
              if (block) TMP_12.$$p = null;if (name == null) name = nil;
            return $send(self, 'define_method', [name], (TMP_13 = function($a_rest){var self = TMP_13.$$s || this, args, TMP_14;

                var $args_len = arguments.length, $rest_len = $args_len - 0;
                if ($rest_len < 0) { $rest_len = 0; }
                args = new Array($rest_len);
                for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                  args[$arg_idx - 0] = arguments[$arg_idx];
                }
              return $send($send(self, 'instance_exec', Opal.to_a(args), block.$to_proc()), 'tap', [], (TMP_14 = function(){var self = TMP_14.$$s || this;

                return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper')['$mutated!'](self)}, TMP_14.$$s = self, TMP_14.$$arity = 0, TMP_14))}, TMP_13.$$s = self, TMP_13.$$arity = -1, TMP_13))}, TMP_12.$$s = self, TMP_12.$$arity = 1, TMP_12));
            $send(base.$singleton_class(), 'send', ["" + "define_" + (kind), "state_reader"], (TMP_15 = function($a_rest){var self = TMP_15.$$s || this, names, TMP_16;

              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              names = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                names[$arg_idx - 0] = arguments[$arg_idx];
              }
            return $send(names, 'each', [], (TMP_16 = function(name){var self = TMP_16.$$s || this, $a, TMP_17, var_name = nil;
if (name == null) name = nil;
              
                var_name = (function() {if ($truthy((($a = Opal.const_get_relative($nesting, 'Hyperstack').$naming_convention()['$==']("prefix_state")) ? name['$!~'](/^_/) : Opal.const_get_relative($nesting, 'Hyperstack').$naming_convention()['$==']("prefix_state")))) {
                  return "" + "_" + (name)
                  } else {
                  return name
                }; return nil; })();
                return $send(self, 'define_method', [name], (TMP_17 = function(){var self = TMP_17.$$s || this, TMP_18;

                return $send(self.$instance_variable_get("" + "@" + (var_name)), 'tap', [], (TMP_18 = function(){var self = TMP_18.$$s || this;

                  return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper')['$observed!'](self)}, TMP_18.$$s = self, TMP_18.$$arity = 0, TMP_18))}, TMP_17.$$s = self, TMP_17.$$arity = 0, TMP_17));}, TMP_16.$$s = self, TMP_16.$$arity = 1, TMP_16))}, TMP_15.$$s = self, TMP_15.$$arity = -1, TMP_15));
            $send(base.$singleton_class(), 'send', ["" + "define_" + (kind), "state_writer"], (TMP_19 = function($a_rest){var self = TMP_19.$$s || this, names, TMP_20;

              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              names = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                names[$arg_idx - 0] = arguments[$arg_idx];
              }
            return $send(names, 'each', [], (TMP_20 = function(name){var self = TMP_20.$$s || this, $a, TMP_21, var_name = nil;
if (name == null) name = nil;
              
                var_name = (function() {if ($truthy((($a = Opal.const_get_relative($nesting, 'Hyperstack').$naming_convention()['$==']("prefix_state")) ? name['$!~'](/^_/) : Opal.const_get_relative($nesting, 'Hyperstack').$naming_convention()['$==']("prefix_state")))) {
                  return "" + "_" + (name)
                  } else {
                  return name
                }; return nil; })();
                return $send(self, 'define_method', ["" + (name) + "="], (TMP_21 = function(x){var self = TMP_21.$$s || this, TMP_22;
if (x == null) x = nil;
                return $send(self.$instance_variable_set("" + "@" + (var_name), x), 'tap', [], (TMP_22 = function(){var self = TMP_22.$$s || this;

                  return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Internal'), 'State'), 'Mapper')['$mutated!'](self)}, TMP_22.$$s = self, TMP_22.$$arity = 0, TMP_22))}, TMP_21.$$s = self, TMP_21.$$arity = 1, TMP_21));}, TMP_20.$$s = self, TMP_20.$$arity = 1, TMP_20))}, TMP_19.$$s = self, TMP_19.$$arity = -1, TMP_19));
            return $send(base.$singleton_class(), 'send', ["" + "define_" + (kind), "state_accessor"], (TMP_23 = function($a_rest){var self = TMP_23.$$s || this, names;

              var $args_len = arguments.length, $rest_len = $args_len - 0;
              if ($rest_len < 0) { $rest_len = 0; }
              names = new Array($rest_len);
              for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
                names[$arg_idx - 0] = arguments[$arg_idx];
              }
            
              $send(self, 'state_reader', Opal.to_a(names));
              return $send(self, 'state_writer', Opal.to_a(names));}, TMP_23.$$s = self, TMP_23.$$arity = -1, TMP_23));}, TMP_2.$$s = self, TMP_2.$$arity = 1, TMP_2));
        }, TMP_Observable_included_24.$$arity = 1);
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/state/version"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module;

  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $State, self = $State = $module($base, 'State');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      Opal.const_set($nesting[0], 'VERSION', "1.0.alpha1.4")
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-state"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $truthy = Opal.truthy;

  Opal.add_stubs(['$require', '$import', '$!=']);
  
  self.$require("set");
  self.$require("hyperstack-config");
  Opal.const_get_relative($nesting, 'Hyperstack').$import("hyper-state");
  self.$require("hyperstack/internal/callbacks");
  self.$require("hyperstack/internal/auto_unmount");
  self.$require("hyperstack/internal/state/mapper");
  self.$require("hyperstack/internal/state/variable");
  self.$require("hyperstack/internal/auto_unmount");
  self.$require("hyperstack/internal/receiver");
  self.$require("hyperstack/state/observable");
  self.$require("hyperstack/state/observer");
  self.$require("hyperstack/state/version");
  if ($truthy(Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$!=']("opal"))) {
    return nil
    } else {
    return nil
  };
};

/* Generated by Opal 0.11.4 */
Opal.modules["react/router"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass;

  Opal.add_stubs(['$imports']);
  return (function($base, $parent_nesting) {
    var $React, self = $React = $module($base, 'React');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Router(){};
      var self = $Router = $klass($base, $super, 'Router', $Router);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return self.$imports("ReactRouter")
    })($nesting[0], Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'NativeLibrary'), $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["react/router/dom"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass;

  Opal.add_stubs(['$imports']);
  return (function($base, $parent_nesting) {
    var $React, self = $React = $module($base, 'React');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Router(){};
      var self = $Router = $klass($base, $super, 'Router', $Router);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return (function($base, $super, $parent_nesting) {
        function $DOM(){};
        var self = $DOM = $klass($base, $super, 'DOM', $DOM);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        return self.$imports("ReactRouterDOM")
      })($nesting[0], Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'NativeLibrary'), $nesting)
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["react/router/history"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass;

  Opal.add_stubs(['$include', '$new', '$alias_native']);
  return (function($base, $parent_nesting) {
    var $React, self = $React = $module($base, 'React');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $super, $parent_nesting) {
      function $Router(){};
      var self = $Router = $klass($base, $super, 'Router', $Router);

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      return (function($base, $super, $parent_nesting) {
        function $History(){};
        var self = $History = $klass($base, $super, 'History', $History);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_History_current_1, TMP_History_initialize_2, TMP_History_to_n_3;

        def["native"] = nil;
        
        self.$include(Opal.const_get_relative($nesting, 'Native'));
        Opal.defs(self, '$current', TMP_History_current_1 = function $$current() {
          var self = this;

          return self.$new(History)
        }, TMP_History_current_1.$$arity = 0);
        
        Opal.defn(self, '$initialize', TMP_History_initialize_2 = function $$initialize(native$) {
          var self = this;

          return (self["native"] = native$)
        }, TMP_History_initialize_2.$$arity = 1);
        
        Opal.defn(self, '$to_n', TMP_History_to_n_3 = function $$to_n() {
          var self = this;

          return self["native"]
        }, TMP_History_to_n_3.$$arity = 0);
        self.$alias_native("create_browser_history", "createBrowserHistory");
        self.$alias_native("create_hash_history", "createHashHistory");
        self.$alias_native("create_location", "createLocation");
        self.$alias_native("create_memory_history", "createMemoryHistory");
        return self.$alias_native("create_path", "createPath");
      })($nesting[0], null, $nesting)
    })($nesting[0], null, $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/router/isomorphic_methods"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$include', '$prerender_footer', '$on_opal_server?', '$new', '$[]', '$raise', '$isomorphic_method', '$when_on_client', '$send_to_server', '$when_on_server', '$fullpath', '$request', '$controller', '$context']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Router, self = $Router = $module($base, 'Router');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $super, $parent_nesting) {
          function $IsomorphicMethods(){};
          var self = $IsomorphicMethods = $klass($base, $super, 'IsomorphicMethods', $IsomorphicMethods);

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_IsomorphicMethods_ctx_1, TMP_IsomorphicMethods_2, TMP_IsomorphicMethods_3;

          
          self.$include(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'IsomorphicHelpers'));
          Opal.defs(self, '$ctx', TMP_IsomorphicMethods_ctx_1 = function $$ctx() {
            var $a, self = this;
            if (self.ctx == null) self.ctx = nil;

            return (self.ctx = ($truthy($a = self.ctx) ? $a : {}))
          }, TMP_IsomorphicMethods_ctx_1.$$arity = 0);
          $send(self, 'prerender_footer', [], (TMP_IsomorphicMethods_2 = function(_controller){var self = TMP_IsomorphicMethods_2.$$s || this, ctx_as_hash = nil;
            if (self.ctx == null) self.ctx = nil;
if (_controller == null) _controller = nil;
          
            if ($truthy(self['$on_opal_server?']())) {
              } else {
              return nil;
            };
            ctx_as_hash = Opal.const_get_relative($nesting, 'Hash').$new(self.ctx);
            self.ctx = {};
            if ($truthy(ctx_as_hash['$[]']("url"))) {
              return self.$raise("" + "Hyperstack::Internal::Component::Redirect " + (ctx_as_hash['$[]']("url")) + " status: " + (ctx_as_hash['$[]']("status")))
              } else {
              return nil
            };}, TMP_IsomorphicMethods_2.$$s = self, TMP_IsomorphicMethods_2.$$arity = 1, TMP_IsomorphicMethods_2));
          return $send(self, 'isomorphic_method', ["request_fullpath"], (TMP_IsomorphicMethods_3 = function(f){var self = TMP_IsomorphicMethods_3.$$s || this, TMP_4, TMP_5;
if (f == null) f = nil;
          
            $send(f, 'when_on_client', [], (TMP_4 = function(){var self = TMP_4.$$s || this;

            return window.location.pathname}, TMP_4.$$s = self, TMP_4.$$arity = 0, TMP_4));
            f.$send_to_server();
            return $send(f, 'when_on_server', [], (TMP_5 = function(){var self = TMP_5.$$s || this;

            return f.$context().$controller().$request().$fullpath()}, TMP_5.$$s = self, TMP_5.$$arity = 0, TMP_5));}, TMP_IsomorphicMethods_3.$$s = self, TMP_IsomorphicMethods_3.$$arity = 1, TMP_IsomorphicMethods_3));
        })($nesting[0], null, $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/router/history"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$include', '$new', '$native_block', '$to_n', '$native_listen', '$alias_native']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Router, self = $Router = $module($base, 'Router');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $super, $parent_nesting) {
        function $History(){};
        var self = $History = $klass($base, $super, 'History', $History);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_History_initialize_1, TMP_History_to_n_2, TMP_History_location_3, TMP_History_block_5, TMP_History_listen_7;

        def["native"] = nil;
        
        self.$include(Opal.const_get_relative($nesting, 'Native'));
        
        Opal.defn(self, '$initialize', TMP_History_initialize_1 = function $$initialize(native$) {
          var self = this;

          return (self["native"] = native$)
        }, TMP_History_initialize_1.$$arity = 1);
        
        Opal.defn(self, '$to_n', TMP_History_to_n_2 = function $$to_n() {
          var self = this;

          return self["native"]
        }, TMP_History_to_n_2.$$arity = 0);
        
        Opal.defn(self, '$location', TMP_History_location_3 = function $$location() {
          var self = this;

          return Opal.const_get_relative($nesting, 'Location').$new(self["native"].location)
        }, TMP_History_location_3.$$arity = 0);
        
        Opal.defn(self, '$block', TMP_History_block_5 = function $$block(message) {
          var TMP_4, self = this, $iter = TMP_History_block_5.$$p, $yield = $iter || nil;

          if (message == null) {
            message = nil;
          }
          if ($iter) TMP_History_block_5.$$p = null;
          if ($truthy(message)) {
            return self.$native_block(message.$to_n())
            } else {
            return $send(self, 'native_block', [], (TMP_4 = function(location, action){var self = TMP_4.$$s || this;
if (location == null) location = nil;if (action == null) action = nil;
            return Opal.yieldX($yield, [Opal.const_get_relative($nesting, 'Location').$new(location), action]);}, TMP_4.$$s = self, TMP_4.$$arity = 2, TMP_4))
          }
        }, TMP_History_block_5.$$arity = -1);
        
        Opal.defn(self, '$listen', TMP_History_listen_7 = function $$listen() {
          var TMP_6, self = this, $iter = TMP_History_listen_7.$$p, $yield = $iter || nil;

          if ($iter) TMP_History_listen_7.$$p = null;
          return $send(self, 'native_listen', [], (TMP_6 = function(location, action){var self = TMP_6.$$s || this;
if (location == null) location = nil;if (action == null) action = nil;
          return Opal.yieldX($yield, [Opal.const_get_relative($nesting, 'Location').$new(location), action]);}, TMP_6.$$s = self, TMP_6.$$arity = 2, TMP_6))
        }, TMP_History_listen_7.$$arity = 0);
        self.$alias_native("action");
        self.$alias_native("native_block", "block");
        self.$alias_native("create_href", "createHref");
        self.$alias_native("entries");
        self.$alias_native("go");
        self.$alias_native("go_back", "goBack");
        self.$alias_native("go_forward", "goForward");
        self.$alias_native("index");
        self.$alias_native("length");
        self.$alias_native("native_listen", "listen");
        self.$alias_native("push", "push");
        return self.$alias_native("replace", "replace");
      })($nesting[0], null, $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/router/location"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $hash2 = Opal.hash2, $send = Opal.send, $range = Opal.range;

  Opal.add_stubs(['$include', '$blank?', '$search', '$[]', '$map', '$split', '$alias_native']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Router, self = $Router = $module($base, 'Router');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $super, $parent_nesting) {
        function $Location(){};
        var self = $Location = $klass($base, $super, 'Location', $Location);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Location_initialize_1, TMP_Location_to_n_2, TMP_Location_query_4;

        def["native"] = nil;
        
        self.$include(Opal.const_get_relative($nesting, 'Native'));
        
        Opal.defn(self, '$initialize', TMP_Location_initialize_1 = function $$initialize(native$) {
          var self = this;

          return (self["native"] = native$)
        }, TMP_Location_initialize_1.$$arity = 1);
        
        Opal.defn(self, '$to_n', TMP_Location_to_n_2 = function $$to_n() {
          var self = this;

          return self["native"]
        }, TMP_Location_to_n_2.$$arity = 0);
        
        Opal.defn(self, '$query', TMP_Location_query_4 = function $$query() {
          var TMP_3, self = this;

          
          if ($truthy(self.$search()['$blank?']())) {
            return $hash2([], {})};
          return Opal.const_get_relative($nesting, 'Hash')['$[]']($send(self.$search()['$[]']($range(1, -1, false)).$split("&"), 'map', [], (TMP_3 = function(part){var self = TMP_3.$$s || this, $a, $b, name = nil, value = nil;
if (part == null) part = nil;
          
            $b = part.$split("="), $a = Opal.to_ary($b), (name = ($a[0] == null ? nil : $a[0])), (value = ($a[1] == null ? nil : $a[1])), $b;
            return [decodeURIComponent(name), decodeURIComponent(value)];}, TMP_3.$$s = self, TMP_3.$$arity = 1, TMP_3)));
        }, TMP_Location_query_4.$$arity = 0);
        self.$alias_native("pathname");
        self.$alias_native("search");
        self.$alias_native("hash");
        self.$alias_native("state");
        return self.$alias_native("key");
      })($nesting[0], null, $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/router/match"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass;

  Opal.add_stubs(['$include', '$alias_native']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Router, self = $Router = $module($base, 'Router');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $super, $parent_nesting) {
        function $Match(){};
        var self = $Match = $klass($base, $super, 'Match', $Match);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Match_initialize_1, TMP_Match_to_n_2;

        def["native"] = nil;
        
        self.$include(Opal.const_get_relative($nesting, 'Native'));
        
        Opal.defn(self, '$initialize', TMP_Match_initialize_1 = function $$initialize(native$) {
          var self = this;

          return (self["native"] = native$)
        }, TMP_Match_initialize_1.$$arity = 1);
        
        Opal.defn(self, '$to_n', TMP_Match_to_n_2 = function $$to_n() {
          var self = this;

          return self["native"]
        }, TMP_Match_to_n_2.$$arity = 0);
        self.$alias_native("params");
        self.$alias_native("is_exact", "isExact");
        self.$alias_native("path");
        return self.$alias_native("url");
      })($nesting[0], null, $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/router/class_methods"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send;

  Opal.add_stubs(['$positive?', '$count', '$first', '$send', '$new', '$to_n', '$history', '$private', '$create_browser_history', '$current', '$create_hash_history', '$create_memory_history']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Router, self = $Router = $module($base, 'Router');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $parent_nesting) {
          var $ClassMethods, self = $ClassMethods = $module($base, 'ClassMethods');

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_ClassMethods_history_1, TMP_ClassMethods_location_2, TMP_ClassMethods_browser_history_3, TMP_ClassMethods_hash_history_4, TMP_ClassMethods_memory_history_5;

          
          
          Opal.defn(self, '$history', TMP_ClassMethods_history_1 = function $$history($a_rest) {
            var $b, self = this, args;
            if (self.__history_type == null) self.__history_type = nil;
            if (self.__history == null) self.__history = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            if ($truthy(args.$count()['$positive?']())) {
              return (self.__history_type = args.$first())
            } else if ($truthy(self.__history_type)) {
              return (self.__history = ($truthy($b = self.__history) ? $b : self.$send("" + (self.__history_type) + "_history")))
              } else {
              return nil
            }
          }, TMP_ClassMethods_history_1.$$arity = -1);
          
          Opal.defn(self, '$location', TMP_ClassMethods_location_2 = function $$location() {
            var self = this;

            return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Router'), 'Location').$new(self.$history().$to_n().location)
          }, TMP_ClassMethods_location_2.$$arity = 0);
          self.$private();
          
          Opal.defn(self, '$browser_history', TMP_ClassMethods_browser_history_3 = function $$browser_history() {
            var $a, self = this;
            if (self.__browser_history == null) self.__browser_history = nil;

            return (self.__browser_history = ($truthy($a = self.__browser_history) ? $a : Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'React'), 'Router'), 'History').$current().$create_browser_history()))
          }, TMP_ClassMethods_browser_history_3.$$arity = 0);
          
          Opal.defn(self, '$hash_history', TMP_ClassMethods_hash_history_4 = function $$hash_history($a_rest) {
            var $b, self = this, args;
            if (self.__hash_history == null) self.__hash_history = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            return (self.__hash_history = ($truthy($b = self.__hash_history) ? $b : $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'React'), 'Router'), 'History').$current(), 'create_hash_history', Opal.to_a(args))))
          }, TMP_ClassMethods_hash_history_4.$$arity = -1);
          
          Opal.defn(self, '$memory_history', TMP_ClassMethods_memory_history_5 = function $$memory_history($a_rest) {
            var $b, self = this, args;
            if (self.__memory_history == null) self.__memory_history = nil;

            var $args_len = arguments.length, $rest_len = $args_len - 0;
            if ($rest_len < 0) { $rest_len = 0; }
            args = new Array($rest_len);
            for (var $arg_idx = 0; $arg_idx < $args_len; $arg_idx++) {
              args[$arg_idx - 0] = arguments[$arg_idx];
            }
            return (self.__memory_history = ($truthy($b = self.__memory_history) ? $b : $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'React'), 'Router'), 'History').$current(), 'create_memory_history', Opal.to_a(args))))
          }, TMP_ClassMethods_memory_history_5.$$arity = -1);
        })($nesting[0], $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/router/helpers"] = function(Opal) {
  function $rb_minus(lhs, rhs) {
    return (typeof(lhs) === 'number' && typeof(rhs) === 'number') ? lhs - rhs : lhs['$-'](rhs);
  }
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $send = Opal.send, $hash2 = Opal.hash2, $truthy = Opal.truthy;

  Opal.add_stubs(['$to_n', '$tap', '$[]=', '$-', '$[]', '$delete', '$Link', '$to_proc', '$any?', '$&', '$keys', '$observed!', '$NavLink', '$ctx', '$Redirect', '$new', '$lambda', '$format_params', '$create_element', '$values', '$Route', '$Switch']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Router, self = $Router = $module($base, 'Router');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $parent_nesting) {
          var $Helpers, self = $Helpers = $module($base, 'Helpers');

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Helpers_Link_1, TMP_Helpers_NavLink_3, TMP_Helpers_Redirect_4, TMP_Helpers_format_params_5, TMP_Helpers_Route_6, TMP_Helpers_Switch_9;

          
          
          Opal.defn(self, '$Link', TMP_Helpers_Link_1 = function $$Link(to, opts) {
            var TMP_2, self = this, $iter = TMP_Helpers_Link_1.$$p, children = $iter || nil, $writer = nil;

            if (opts == null) {
              opts = $hash2([], {});
            }
            if ($iter) TMP_Helpers_Link_1.$$p = null;
            
            
            $writer = ["to", $send($hash2([], {}), 'tap', [], (TMP_2 = function(hash){var self = TMP_2.$$s || this;
if (hash == null) hash = nil;
            
              
              $writer = ["pathname", to];
              $send(hash, '[]=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;
              if ($truthy(opts['$[]']("search"))) {
                
                $writer = ["search", opts.$delete("search")];
                $send(hash, '[]=', Opal.to_a($writer));
                $writer[$rb_minus($writer["length"], 1)];};
              if ($truthy(opts['$[]']("hash"))) {
                
                $writer = ["hash", opts.$delete("hash")];
                $send(hash, '[]=', Opal.to_a($writer));
                return $writer[$rb_minus($writer["length"], 1)];
                } else {
                return nil
              };}, TMP_2.$$s = self, TMP_2.$$arity = 1, TMP_2)).$to_n()];
            $send(opts, '[]=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];;
            return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'React'), 'Router'), 'DOM'), 'Link', [opts], children.$to_proc());
          }, TMP_Helpers_Link_1.$$arity = -2);
          
          Opal.defn(self, '$NavLink', TMP_Helpers_NavLink_3 = function $$NavLink(to, opts) {
            var self = this, $iter = TMP_Helpers_NavLink_3.$$p, children = $iter || nil, $writer = nil;

            if (opts == null) {
              opts = $hash2([], {});
            }
            if ($iter) TMP_Helpers_NavLink_3.$$p = null;
            
            
            $writer = ["to", to.$to_n()];
            $send(opts, '[]=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];;
            if ($truthy(["active_class", "active_style", "active"]['$&'](opts.$keys())['$any?']())) {
              
              if ($truthy(opts['$[]']("active_class"))) {
                
                $writer = ["activeClassName", opts.$delete("active_class").$to_n()];
                $send(opts, '[]=', Opal.to_a($writer));
                $writer[$rb_minus($writer["length"], 1)];};
              if ($truthy(opts['$[]']("active_style"))) {
                
                $writer = ["activeStyle", opts.$delete("active_style").$to_n()];
                $send(opts, '[]=', Opal.to_a($writer));
                $writer[$rb_minus($writer["length"], 1)];};
              if ($truthy(opts['$[]']("active"))) {
                
                $writer = ["isActive", opts.$delete("active").$to_n()];
                $send(opts, '[]=', Opal.to_a($writer));
                $writer[$rb_minus($writer["length"], 1)];};
              Opal.const_get_qualified(Opal.const_get_relative($nesting, 'State'), 'Mapper')['$observed!'](Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Router'), 'Location'));};
            return $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'React'), 'Router'), 'DOM'), 'NavLink', [opts], children.$to_proc());
          }, TMP_Helpers_NavLink_3.$$arity = -2);
          
          Opal.defn(self, '$Redirect', TMP_Helpers_Redirect_4 = function $$Redirect(to, opts) {
            var $a, self = this, $writer = nil, status = nil;

            if (opts == null) {
              opts = $hash2([], {});
            }
            
            
            $writer = ["to", to.$to_n()];
            $send(opts, '[]=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];;
            status = opts.$delete("status");
            status = ($truthy($a = status) ? $a : 302);
            Opal.const_get_relative($nesting, 'IsomorphicMethods').$ctx().status = status;
            return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'React'), 'Router').$Redirect(opts);
          }, TMP_Helpers_Redirect_4.$$arity = -2);
          
          Opal.defn(self, '$format_params', TMP_Helpers_format_params_5 = function $$format_params(e) {
            var self = this;

            return $hash2(["match", "location", "history"], {"match": Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Router'), 'Match').$new(e.match), "location": Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Router'), 'Location').$new(e.location), "history": Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Router'), 'History').$new(e.history)})
          }, TMP_Helpers_format_params_5.$$arity = 1);
          
          Opal.defn(self, '$Route', TMP_Helpers_Route_6 = function $$Route(to, opts) {
            var TMP_7, TMP_8, self = this, $iter = TMP_Helpers_Route_6.$$p, block = $iter || nil, $writer = nil, component = nil;

            if (opts == null) {
              opts = $hash2([], {});
            }
            if ($iter) TMP_Helpers_Route_6.$$p = null;
            
            Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'State'), 'Mapper')['$observed!'](Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Router'), 'Location'));
            
            $writer = ["path", to.$to_n()];
            $send(opts, '[]=', Opal.to_a($writer));
            $writer[$rb_minus($writer["length"], 1)];;
            if ($truthy(opts['$[]']("mounts"))) {
              
              component = opts.$delete("mounts");
              
              $writer = ["component", $send(self, 'lambda', [], (TMP_7 = function(e){var self = TMP_7.$$s || this, route_params = nil;
if (e == null) e = nil;
              
                route_params = self.$format_params(e);
                return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'ReactAPI').$create_element(component, route_params).$to_n();}, TMP_7.$$s = self, TMP_7.$$arity = 1, TMP_7))];
              $send(opts, '[]=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];;};
            if ($truthy(block)) {
              
              $writer = ["render", $send(self, 'lambda', [], (TMP_8 = function(e){var self = TMP_8.$$s || this, route_params = nil;
if (e == null) e = nil;
              
                route_params = self.$format_params(e);
                return Opal.yieldX(block, Opal.to_a(route_params.$values())).$to_n();}, TMP_8.$$s = self, TMP_8.$$arity = 1, TMP_8))];
              $send(opts, '[]=', Opal.to_a($writer));
              $writer[$rb_minus($writer["length"], 1)];};
            return Opal.const_get_qualified(Opal.const_get_relative($nesting, 'React'), 'Router').$Route(opts);
          }, TMP_Helpers_Route_6.$$arity = -2);
          
          Opal.defn(self, '$Switch', TMP_Helpers_Switch_9 = function $$Switch() {
            var self = this, $iter = TMP_Helpers_Switch_9.$$p, children = $iter || nil;

            if ($iter) TMP_Helpers_Switch_9.$$p = null;
            return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'React'), 'Router'), 'Switch', [], children.$to_proc())
          }, TMP_Helpers_Switch_9.$$arity = 0);
        })($nesting[0], $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/internal/router/instance_methods"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module;

  Opal.add_stubs(['$history', '$class', '$location']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Internal, self = $Internal = $module($base, 'Internal');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Router, self = $Router = $module($base, 'Router');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        (function($base, $parent_nesting) {
          var $InstanceMethods, self = $InstanceMethods = $module($base, 'InstanceMethods');

          var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_InstanceMethods_history_1, TMP_InstanceMethods_location_2;

          
          
          Opal.defn(self, '$history', TMP_InstanceMethods_history_1 = function $$history() {
            var self = this;

            return self.$class().$history()
          }, TMP_InstanceMethods_history_1.$$arity = 0);
          
          Opal.defn(self, '$location', TMP_InstanceMethods_location_2 = function $$location() {
            var self = this;

            return self.$class().$location()
          }, TMP_InstanceMethods_location_2.$$arity = 0);
        })($nesting[0], $nesting)
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/router/helpers"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$!=', '$param_accessor_style', '$match', '$params', '$location', '$history', '$include', '$class_eval', '$param']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Router, self = $Router = $module($base, 'Router');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting);

      (function($base, $parent_nesting) {
        var $Helpers, self = $Helpers = $module($base, 'Helpers');

        var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Helpers_match_1, TMP_Helpers_location_2, TMP_Helpers_history_3, TMP_Helpers_included_5;

        
        
        Opal.defn(self, '$match', TMP_Helpers_match_1 = function $$match() {
          var self = this;
          if (self.__hyperstack_component_params_wrapper == null) self.__hyperstack_component_params_wrapper = nil;
          if (self.Match == null) self.Match = nil;

          if ($truthy(self.__hyperstack_component_params_wrapper.$param_accessor_style()['$!=']("hyperstack"))) {
            return self.$params().$match()
            } else {
            return self.Match
          }
        }, TMP_Helpers_match_1.$$arity = 0);
        
        Opal.defn(self, '$location', TMP_Helpers_location_2 = function $$location() {
          var self = this;
          if (self.__hyperstack_component_params_wrapper == null) self.__hyperstack_component_params_wrapper = nil;
          if (self.Location == null) self.Location = nil;

          if ($truthy(self.__hyperstack_component_params_wrapper.$param_accessor_style()['$!=']("hyperstack"))) {
            return self.$params().$location()
            } else {
            return self.Location
          }
        }, TMP_Helpers_location_2.$$arity = 0);
        
        Opal.defn(self, '$history', TMP_Helpers_history_3 = function $$history() {
          var self = this;
          if (self.__hyperstack_component_params_wrapper == null) self.__hyperstack_component_params_wrapper = nil;
          if (self.History == null) self.History = nil;

          if ($truthy(self.__hyperstack_component_params_wrapper.$param_accessor_style()['$!=']("hyperstack"))) {
            return self.$params().$history()
            } else {
            return self.History
          }
        }, TMP_Helpers_history_3.$$arity = 0);
        Opal.defs(self, '$included', TMP_Helpers_included_5 = function $$included(base) {
          var TMP_4, self = this;

          
          base.$include(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Router'), 'Helpers'));
          return $send(base, 'class_eval', [], (TMP_4 = function(){var self = TMP_4.$$s || this;

          
            self.$param("match", $hash2(["default"], {"default": nil}));
            self.$param("location", $hash2(["default"], {"default": nil}));
            return self.$param("history", $hash2(["default"], {"default": nil}));}, TMP_4.$$s = self, TMP_4.$$arity = 0, TMP_4));
        }, TMP_Helpers_included_5.$$arity = 1);
      })($nesting[0], $nesting)
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyperstack/router"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $module = Opal.module, $klass = Opal.klass, $truthy = Opal.truthy, $send = Opal.send, $hash2 = Opal.hash2;

  Opal.add_stubs(['$on_opal_server?', '$lambda', '$__hyperstack_prerender_router', '$to_proc', '$__hyperstack_render_router', '$instance_eval', '$is_a?', '$respond_to?', '$acts_as_string?', '$render', '$to_s', '$history', '$class', '$Router', '$to_n', '$__eval_block', '$split', '$request_fullpath', '$StaticRouter', '$ctx', '$extend', '$include', '$class_eval', '$location', '$after_mount', '$listen', '$mutated!', '$before_unmount', '$call']);
  return (function($base, $parent_nesting) {
    var $Hyperstack, self = $Hyperstack = $module($base, 'Hyperstack');

    var def = self.$$proto, $nesting = [self].concat($parent_nesting);

    (function($base, $parent_nesting) {
      var $Router, self = $Router = $module($base, 'Router');

      var def = self.$$proto, $nesting = [self].concat($parent_nesting), TMP_Router___hyperstack_router_wrapper_1, TMP_Router___eval_block_5, TMP_Router___hyperstack_render_router_6, TMP_Router___hyperstack_prerender_router_9, TMP_Router_included_18;

      
      (function($base, $super, $parent_nesting) {
        function $NoHistoryError(){};
        var self = $NoHistoryError = $klass($base, $super, 'NoHistoryError', $NoHistoryError);

        var def = self.$$proto, $nesting = [self].concat($parent_nesting);

        return nil
      })($nesting[0], Opal.const_get_relative($nesting, 'StandardError'), $nesting);
      
      Opal.defn(self, '$__hyperstack_router_wrapper', TMP_Router___hyperstack_router_wrapper_1 = function $$__hyperstack_router_wrapper() {
        var TMP_2, TMP_3, self = this, $iter = TMP_Router___hyperstack_router_wrapper_1.$$p, block = $iter || nil;

        if ($iter) TMP_Router___hyperstack_router_wrapper_1.$$p = null;
        if ($truthy(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Component'), 'IsomorphicHelpers')['$on_opal_server?']())) {
          return $send(self, 'lambda', [], (TMP_2 = function(){var self = TMP_2.$$s || this;

          return $send(self, '__hyperstack_prerender_router', [], block.$to_proc())}, TMP_2.$$s = self, TMP_2.$$arity = 0, TMP_2))
          } else {
          return $send(self, 'lambda', [], (TMP_3 = function(){var self = TMP_3.$$s || this;

          return $send(self, '__hyperstack_render_router', [], block.$to_proc())}, TMP_3.$$s = self, TMP_3.$$arity = 0, TMP_3))
        }
      }, TMP_Router___hyperstack_router_wrapper_1.$$arity = 0);
      
      Opal.defn(self, '$__eval_block', TMP_Router___eval_block_5 = function $$__eval_block(block) {
        var $a, $b, TMP_4, self = this, result = nil;

        
        result = $send(self, 'instance_eval', [], block.$to_proc());
        if ($truthy(($truthy($a = result['$is_a?'](Opal.const_get_relative($nesting, 'String'))) ? $a : ($truthy($b = result['$respond_to?']("acts_as_string?")) ? result['$acts_as_string?']() : $b)))) {
          result = $send(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Component'), 'RenderingContext'), 'render', ["span"], (TMP_4 = function(){var self = TMP_4.$$s || this;

          return result.$to_s()}, TMP_4.$$s = self, TMP_4.$$arity = 0, TMP_4))};
        return result;
      }, TMP_Router___eval_block_5.$$arity = 1);
      
      Opal.defn(self, '$__hyperstack_render_router', TMP_Router___hyperstack_render_router_6 = function $$__hyperstack_render_router() {
        var TMP_7, self = this, $iter = TMP_Router___hyperstack_render_router_6.$$p, block = $iter || nil;

        if ($iter) TMP_Router___hyperstack_render_router_6.$$p = null;
        return $send(self, 'instance_eval', [], (TMP_7 = function(){var self = TMP_7.$$s || this, TMP_8;

        
          if ($truthy(self.$history())) {
            } else {
            self.$class().$history("browser")
          };
          return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'React'), 'Router'), 'Router', [$hash2(["history"], {"history": self.$history().$to_n()})], (TMP_8 = function(){var self = TMP_8.$$s || this;

          return self.$__eval_block(block)}, TMP_8.$$s = self, TMP_8.$$arity = 0, TMP_8));}, TMP_7.$$s = self, TMP_7.$$arity = 0, TMP_7))
      }, TMP_Router___hyperstack_render_router_6.$$arity = 0);
      
      Opal.defn(self, '$__hyperstack_prerender_router', TMP_Router___hyperstack_prerender_router_9 = function $$__hyperstack_prerender_router() {
        var TMP_10, self = this, $iter = TMP_Router___hyperstack_prerender_router_9.$$p, block = $iter || nil;

        if ($iter) TMP_Router___hyperstack_prerender_router_9.$$p = null;
        return $send(self, 'instance_eval', [], (TMP_10 = function(){var self = TMP_10.$$s || this, $a, $b, TMP_11, pathname = nil, search = nil, location = nil;

        
          $b = Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Router'), 'IsomorphicMethods').$request_fullpath().$split("?", 2), $a = Opal.to_ary($b), (pathname = ($a[0] == null ? nil : $a[0])), (search = ($a[1] == null ? nil : $a[1])), $b;
          location = $hash2(["pathname", "search"], {"pathname": pathname, "search": (function() {if ($truthy(search)) {
            return "" + "?" + (search)
            } else {
            return ""
          }; return nil; })()}).$to_n();
          return $send(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'React'), 'Router'), 'StaticRouter', [$hash2(["location", "context"], {"location": location, "context": Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Router'), 'IsomorphicMethods').$ctx()})], (TMP_11 = function(){var self = TMP_11.$$s || this;

          return self.$__eval_block(block)}, TMP_11.$$s = self, TMP_11.$$arity = 0, TMP_11));}, TMP_10.$$s = self, TMP_10.$$arity = 0, TMP_10))
      }, TMP_Router___hyperstack_prerender_router_9.$$arity = 0);
      Opal.defs(self, '$included', TMP_Router_included_18 = function $$included(base) {
        var TMP_12, self = this;

        
        base.$extend(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Router'), 'ClassMethods'));
        base.$include(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'Router'), 'Helpers'));
        return $send(base, 'class_eval', [], (TMP_12 = function(){var self = TMP_12.$$s || this, TMP_history_13, TMP_location_14, TMP_15, TMP_17;

        
          
          Opal.def(self, '$history', TMP_history_13 = function $$history() {
            var self = this;

            return self.$class().$history()
          }, TMP_history_13.$$arity = 0);
          
          Opal.def(self, '$location', TMP_location_14 = function $$location() {
            var self = this;

            return self.$class().$location()
          }, TMP_location_14.$$arity = 0);
          $send(self, 'after_mount', [], (TMP_15 = function(){var self = TMP_15.$$s || this, TMP_16;

          return (self._react_router_unlisten = $send(self.$history(), 'listen', [], (TMP_16 = function(location, _action){var self = TMP_16.$$s || this;
if (location == null) location = nil;if (_action == null) _action = nil;
            return Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Internal'), 'State'), 'Mapper')['$mutated!'](Opal.const_get_qualified(Opal.const_get_qualified(Opal.const_get_relative($nesting, 'Hyperstack'), 'Router'), 'Location'))}, TMP_16.$$s = self, TMP_16.$$arity = 2, TMP_16)))}, TMP_15.$$s = self, TMP_15.$$arity = 0, TMP_15));
          return $send(self, 'before_unmount', [], (TMP_17 = function(){var self = TMP_17.$$s || this;
            if (self._react_router_unlisten == null) self._react_router_unlisten = nil;

          if ($truthy(self._react_router_unlisten)) {
              return self._react_router_unlisten.$call()
              } else {
              return nil
            }}, TMP_17.$$s = self, TMP_17.$$arity = 0, TMP_17));}, TMP_12.$$s = self, TMP_12.$$arity = 0, TMP_12));
      }, TMP_Router_included_18.$$arity = 1);
    })($nesting[0], $nesting)
  })($nesting[0], $nesting)
};

/* Generated by Opal 0.11.4 */
Opal.modules["hyper-router"] = function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice, $hash2 = Opal.hash2;

  Opal.add_stubs(['$require', '$js_import', '$import', '$==']);
  
  self.$require("hyper-component");
  Opal.const_get_relative($nesting, 'Hyperstack').$js_import("hyperstack/router/react-router-source", $hash2(["defines"], {"defines": ["ReactRouter", "ReactRouterDOM", "History"]}));
  Opal.const_get_relative($nesting, 'Hyperstack').$import("hyper-router");
  if (Opal.const_get_relative($nesting, 'RUBY_ENGINE')['$==']("opal")) {
    
    self.$require("react/router");
    self.$require("react/router/dom");
    self.$require("react/router/history");
    self.$require("hyperstack/internal/router/isomorphic_methods");
    self.$require("hyperstack/router/history");
    self.$require("hyperstack/router/location");
    self.$require("hyperstack/router/match");
    self.$require("hyperstack/internal/router/class_methods");
    self.$require("hyperstack/internal/router/helpers");
    self.$require("hyperstack/internal/router/instance_methods");
    self.$require("hyperstack/router/helpers");
    return self.$require("hyperstack/router");
    } else {
    return nil
  };
};

/* Generated by Opal 0.11.4 */
(function(Opal) {
  var self = Opal.top, $nesting = [], nil = Opal.nil, $breaker = Opal.breaker, $slice = Opal.slice;

  Opal.add_stubs(['$require']);
  
  self.$require("active_support");
  self.$require("browser/interval");
  self.$require("browser/delay");
  self.$require("opal-jquery");
  self.$require("hyper-component");
  self.$require("hyper-operation");
  self.$require("hyper-state");
  return self.$require("hyper-router");
})(Opal);
